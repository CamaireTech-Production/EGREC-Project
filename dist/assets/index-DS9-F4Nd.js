var gR=Object.defineProperty;var xR=(t,e,n)=>e in t?gR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Lt=(t,e,n)=>xR(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function J6(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Z6={exports:{}},yx={},eC={exports:{}},vn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Op=Symbol.for("react.element"),yR=Symbol.for("react.portal"),vR=Symbol.for("react.fragment"),bR=Symbol.for("react.strict_mode"),wR=Symbol.for("react.profiler"),_R=Symbol.for("react.provider"),NR=Symbol.for("react.context"),AR=Symbol.for("react.forward_ref"),SR=Symbol.for("react.suspense"),ER=Symbol.for("react.memo"),CR=Symbol.for("react.lazy"),a3=Symbol.iterator;function PR(t){return t===null||typeof t!="object"?null:(t=a3&&t[a3]||t["@@iterator"],typeof t=="function"?t:null)}var tC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nC=Object.assign,rC={};function df(t,e,n){this.props=t,this.context=e,this.refs=rC,this.updater=n||tC}df.prototype.isReactComponent={};df.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};df.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iC(){}iC.prototype=df.prototype;function W5(t,e,n){this.props=t,this.context=e,this.refs=rC,this.updater=n||tC}var $5=W5.prototype=new iC;$5.constructor=W5;nC($5,df.prototype);$5.isPureReactComponent=!0;var l3=Array.isArray,sC=Object.prototype.hasOwnProperty,G5={current:null},oC={key:!0,ref:!0,__self:!0,__source:!0};function aC(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sC.call(e,r)&&!oC.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Op,type:t,key:s,ref:o,props:i,_owner:G5.current}}function kR(t,e){return{$$typeof:Op,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function K5(t){return typeof t=="object"&&t!==null&&t.$$typeof===Op}function TR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var c3=/\/+/g;function Hy(t,e){return typeof t=="object"&&t!==null&&t.key!=null?TR(""+t.key):e.toString(36)}function Tg(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Op:case yR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Hy(o,0):r,l3(i)?(n="",t!=null&&(n=t.replace(c3,"$&/")+"/"),Tg(i,e,n,"",function(c){return c})):i!=null&&(K5(i)&&(i=kR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(c3,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",l3(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Hy(s,a);o+=Tg(s,e,n,l,i)}else if(l=PR(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Hy(s,a++),o+=Tg(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Lm(t,e,n){if(t==null)return t;var r=[],i=0;return Tg(t,r,"","",function(s){return e.call(n,s,i++)}),r}function IR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var hs={current:null},Ig={transition:null},jR={ReactCurrentDispatcher:hs,ReactCurrentBatchConfig:Ig,ReactCurrentOwner:G5};function lC(){throw Error("act(...) is not supported in production builds of React.")}vn.Children={map:Lm,forEach:function(t,e,n){Lm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Lm(t,function(){e++}),e},toArray:function(t){return Lm(t,function(e){return e})||[]},only:function(t){if(!K5(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};vn.Component=df;vn.Fragment=vR;vn.Profiler=wR;vn.PureComponent=W5;vn.StrictMode=bR;vn.Suspense=SR;vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jR;vn.act=lC;vn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=nC({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=G5.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)sC.call(e,l)&&!oC.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Op,type:t.type,key:i,ref:s,props:r,_owner:o}};vn.createContext=function(t){return t={$$typeof:NR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_R,_context:t},t.Consumer=t};vn.createElement=aC;vn.createFactory=function(t){var e=aC.bind(null,t);return e.type=t,e};vn.createRef=function(){return{current:null}};vn.forwardRef=function(t){return{$$typeof:AR,render:t}};vn.isValidElement=K5;vn.lazy=function(t){return{$$typeof:CR,_payload:{_status:-1,_result:t},_init:IR}};vn.memo=function(t,e){return{$$typeof:ER,type:t,compare:e===void 0?null:e}};vn.startTransition=function(t){var e=Ig.transition;Ig.transition={};try{t()}finally{Ig.transition=e}};vn.unstable_act=lC;vn.useCallback=function(t,e){return hs.current.useCallback(t,e)};vn.useContext=function(t){return hs.current.useContext(t)};vn.useDebugValue=function(){};vn.useDeferredValue=function(t){return hs.current.useDeferredValue(t)};vn.useEffect=function(t,e){return hs.current.useEffect(t,e)};vn.useId=function(){return hs.current.useId()};vn.useImperativeHandle=function(t,e,n){return hs.current.useImperativeHandle(t,e,n)};vn.useInsertionEffect=function(t,e){return hs.current.useInsertionEffect(t,e)};vn.useLayoutEffect=function(t,e){return hs.current.useLayoutEffect(t,e)};vn.useMemo=function(t,e){return hs.current.useMemo(t,e)};vn.useReducer=function(t,e,n){return hs.current.useReducer(t,e,n)};vn.useRef=function(t){return hs.current.useRef(t)};vn.useState=function(t){return hs.current.useState(t)};vn.useSyncExternalStore=function(t,e,n){return hs.current.useSyncExternalStore(t,e,n)};vn.useTransition=function(){return hs.current.useTransition()};vn.version="18.3.1";eC.exports=vn;var he=eC.exports;const Ko=H5(he);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DR=he,RR=Symbol.for("react.element"),FR=Symbol.for("react.fragment"),LR=Object.prototype.hasOwnProperty,MR=DR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,BR={key:!0,ref:!0,__self:!0,__source:!0};function cC(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)LR.call(e,r)&&!BR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:RR,type:t,key:s,ref:o,props:i,_owner:MR.current}}yx.Fragment=FR;yx.jsx=cC;yx.jsxs=cC;Z6.exports=yx;var u=Z6.exports,uC={exports:{}},Js={},dC={exports:{}},hC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,z){var J=W.length;W.push(z);e:for(;0<J;){var ne=J-1>>>1,V=W[ne];if(0<i(V,z))W[ne]=z,W[J]=V,J=ne;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var z=W[0],J=W.pop();if(J!==z){W[0]=J;e:for(var ne=0,V=W.length,$=V>>>1;ne<$;){var K=2*(ne+1)-1,X=W[K],ae=K+1,ye=W[ae];if(0>i(X,J))ae<V&&0>i(ye,X)?(W[ne]=ye,W[ae]=J,ne=ae):(W[ne]=X,W[K]=J,ne=K);else if(ae<V&&0>i(ye,J))W[ne]=ye,W[ae]=J,ne=ae;else break e}}return z}function i(W,z){var J=W.sortIndex-z.sortIndex;return J!==0?J:W.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,f=null,h=3,p=!1,m=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(W){for(var z=n(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=W)r(c),z.sortIndex=z.expirationTime,e(l,z);else break;z=n(c)}}function E(W){if(g=!1,N(W),!m)if(n(l)!==null)m=!0,O(D);else{var z=n(c);z!==null&&M(E,z.startTime-W)}}function D(W,z){m=!1,g&&(g=!1,x(v),v=-1),p=!0;var J=h;try{for(N(z),f=n(l);f!==null&&(!(f.expirationTime>z)||W&&!S());){var ne=f.callback;if(typeof ne=="function"){f.callback=null,h=f.priorityLevel;var V=ne(f.expirationTime<=z);z=t.unstable_now(),typeof V=="function"?f.callback=V:f===n(l)&&r(l),N(z)}else r(l);f=n(l)}if(f!==null)var $=!0;else{var K=n(c);K!==null&&M(E,K.startTime-z),$=!1}return $}finally{f=null,h=J,p=!1}}var j=!1,C=null,v=-1,A=5,I=-1;function S(){return!(t.unstable_now()-I<A)}function P(){if(C!==null){var W=t.unstable_now();I=W;var z=!0;try{z=C(!0,W)}finally{z?k():(j=!1,C=null)}}else j=!1}var k;if(typeof w=="function")k=function(){w(P)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,q=F.port2;F.port1.onmessage=P,k=function(){q.postMessage(null)}}else k=function(){b(P,0)};function O(W){C=W,j||(j=!0,k())}function M(W,z){v=b(function(){W(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,O(D))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(W){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var J=h;h=z;try{return W()}finally{h=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,z){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var J=h;h=W;try{return z()}finally{h=J}},t.unstable_scheduleCallback=function(W,z,J){var ne=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ne+J:ne):J=ne,W){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=J+V,W={id:d++,callback:z,priorityLevel:W,startTime:J,expirationTime:V,sortIndex:-1},J>ne?(W.sortIndex=J,e(c,W),n(l)===null&&W===n(c)&&(g?(x(v),v=-1):g=!0,M(E,J-ne))):(W.sortIndex=V,e(l,W),m||p||(m=!0,O(D))),W},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(W){var z=h;return function(){var J=h;h=z;try{return W.apply(this,arguments)}finally{h=J}}}})(hC);dC.exports=hC;var OR=dC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VR=he,Ys=OR;function ct(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fC=new Set,V0={};function Td(t,e){Hh(t,e),Hh(t+"Capture",e)}function Hh(t,e){for(V0[t]=e,t=0;t<e.length;t++)fC.add(e[t])}var Il=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),O2=Object.prototype.hasOwnProperty,UR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u3={},d3={};function zR(t){return O2.call(d3,t)?!0:O2.call(u3,t)?!1:UR.test(t)?d3[t]=!0:(u3[t]=!0,!1)}function qR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function HR(t,e,n,r){if(e===null||typeof e>"u"||qR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fs(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Fi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fi[t]=new fs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Fi[e]=new fs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fi[t]=new fs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fi[t]=new fs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fi[t]=new fs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fi[t]=new fs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fi[t]=new fs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fi[t]=new fs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fi[t]=new fs(t,5,!1,t.toLowerCase(),null,!1,!1)});var Q5=/[\-:]([a-z])/g;function Y5(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Q5,Y5);Fi[e]=new fs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Q5,Y5);Fi[e]=new fs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Q5,Y5);Fi[e]=new fs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fi[t]=new fs(t,1,!1,t.toLowerCase(),null,!1,!1)});Fi.xlinkHref=new fs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fi[t]=new fs(t,1,!1,t.toLowerCase(),null,!0,!0)});function X5(t,e,n,r){var i=Fi.hasOwnProperty(e)?Fi[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(HR(e,n,i,r)&&(n=null),r||i===null?zR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Vl=VR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Mm=Symbol.for("react.element"),fh=Symbol.for("react.portal"),ph=Symbol.for("react.fragment"),J5=Symbol.for("react.strict_mode"),V2=Symbol.for("react.profiler"),pC=Symbol.for("react.provider"),mC=Symbol.for("react.context"),Z5=Symbol.for("react.forward_ref"),U2=Symbol.for("react.suspense"),z2=Symbol.for("react.suspense_list"),ew=Symbol.for("react.memo"),_c=Symbol.for("react.lazy"),gC=Symbol.for("react.offscreen"),h3=Symbol.iterator;function Df(t){return t===null||typeof t!="object"?null:(t=h3&&t[h3]||t["@@iterator"],typeof t=="function"?t:null)}var Er=Object.assign,Wy;function t0(t){if(Wy===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wy=e&&e[1]||""}return`
`+Wy+t}var $y=!1;function Gy(t,e){if(!t||$y)return"";$y=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{$y=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?t0(t):""}function WR(t){switch(t.tag){case 5:return t0(t.type);case 16:return t0("Lazy");case 13:return t0("Suspense");case 19:return t0("SuspenseList");case 0:case 2:case 15:return t=Gy(t.type,!1),t;case 11:return t=Gy(t.type.render,!1),t;case 1:return t=Gy(t.type,!0),t;default:return""}}function q2(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ph:return"Fragment";case fh:return"Portal";case V2:return"Profiler";case J5:return"StrictMode";case U2:return"Suspense";case z2:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mC:return(t.displayName||"Context")+".Consumer";case pC:return(t._context.displayName||"Context")+".Provider";case Z5:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ew:return e=t.displayName||null,e!==null?e:q2(t.type)||"Memo";case _c:e=t._payload,t=t._init;try{return q2(t(e))}catch{}}return null}function $R(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q2(e);case 8:return e===J5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ru(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function GR(t){var e=xC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Bm(t){t._valueTracker||(t._valueTracker=GR(t))}function yC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=xC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function a1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function H2(t,e){var n=e.checked;return Er({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function f3(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ru(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vC(t,e){e=e.checked,e!=null&&X5(t,"checked",e,!1)}function W2(t,e){vC(t,e);var n=ru(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$2(t,e.type,n):e.hasOwnProperty("defaultValue")&&$2(t,e.type,ru(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function p3(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $2(t,e,n){(e!=="number"||a1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var n0=Array.isArray;function Th(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ru(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function G2(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ct(91));return Er({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function m3(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ct(92));if(n0(n)){if(1<n.length)throw Error(ct(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ru(n)}}function bC(t,e){var n=ru(e.value),r=ru(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function g3(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function K2(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Om,_C=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Om=Om||document.createElement("div"),Om.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Om.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function U0(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var p0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},KR=["Webkit","ms","Moz","O"];Object.keys(p0).forEach(function(t){KR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),p0[e]=p0[t]})});function NC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||p0.hasOwnProperty(t)&&p0[t]?(""+e).trim():e+"px"}function AC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=NC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var QR=Er({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Q2(t,e){if(e){if(QR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ct(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ct(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ct(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ct(62))}}function Y2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X2=null;function tw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var J2=null,Ih=null,jh=null;function x3(t){if(t=zp(t)){if(typeof J2!="function")throw Error(ct(280));var e=t.stateNode;e&&(e=Nx(e),J2(t.stateNode,t.type,e))}}function SC(t){Ih?jh?jh.push(t):jh=[t]:Ih=t}function EC(){if(Ih){var t=Ih,e=jh;if(jh=Ih=null,x3(t),e)for(t=0;t<e.length;t++)x3(e[t])}}function CC(t,e){return t(e)}function PC(){}var Ky=!1;function kC(t,e,n){if(Ky)return t(e,n);Ky=!0;try{return CC(t,e,n)}finally{Ky=!1,(Ih!==null||jh!==null)&&(PC(),EC())}}function z0(t,e){var n=t.stateNode;if(n===null)return null;var r=Nx(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ct(231,e,typeof n));return n}var Z2=!1;if(Il)try{var Rf={};Object.defineProperty(Rf,"passive",{get:function(){Z2=!0}}),window.addEventListener("test",Rf,Rf),window.removeEventListener("test",Rf,Rf)}catch{Z2=!1}function YR(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var m0=!1,l1=null,c1=!1,eb=null,XR={onError:function(t){m0=!0,l1=t}};function JR(t,e,n,r,i,s,o,a,l){m0=!1,l1=null,YR.apply(XR,arguments)}function ZR(t,e,n,r,i,s,o,a,l){if(JR.apply(this,arguments),m0){if(m0){var c=l1;m0=!1,l1=null}else throw Error(ct(198));c1||(c1=!0,eb=c)}}function Id(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function TC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function y3(t){if(Id(t)!==t)throw Error(ct(188))}function e7(t){var e=t.alternate;if(!e){if(e=Id(t),e===null)throw Error(ct(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return y3(i),t;if(s===r)return y3(i),e;s=s.sibling}throw Error(ct(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ct(189))}}if(n.alternate!==r)throw Error(ct(190))}if(n.tag!==3)throw Error(ct(188));return n.stateNode.current===n?t:e}function IC(t){return t=e7(t),t!==null?jC(t):null}function jC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jC(t);if(e!==null)return e;t=t.sibling}return null}var DC=Ys.unstable_scheduleCallback,v3=Ys.unstable_cancelCallback,t7=Ys.unstable_shouldYield,n7=Ys.unstable_requestPaint,Br=Ys.unstable_now,r7=Ys.unstable_getCurrentPriorityLevel,nw=Ys.unstable_ImmediatePriority,RC=Ys.unstable_UserBlockingPriority,u1=Ys.unstable_NormalPriority,i7=Ys.unstable_LowPriority,FC=Ys.unstable_IdlePriority,vx=null,Fa=null;function s7(t){if(Fa&&typeof Fa.onCommitFiberRoot=="function")try{Fa.onCommitFiberRoot(vx,t,void 0,(t.current.flags&128)===128)}catch{}}var Qo=Math.clz32?Math.clz32:l7,o7=Math.log,a7=Math.LN2;function l7(t){return t>>>=0,t===0?32:31-(o7(t)/a7|0)|0}var Vm=64,Um=4194304;function r0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function d1(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=r0(a):(s&=o,s!==0&&(r=r0(s)))}else o=n&~i,o!==0?r=r0(o):s!==0&&(r=r0(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Qo(e),i=1<<n,r|=t[n],e&=~i;return r}function c7(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function u7(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Qo(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=c7(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function tb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function LC(){var t=Vm;return Vm<<=1,!(Vm&4194240)&&(Vm=64),t}function Qy(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qo(e),t[e]=n}function d7(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Qo(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function rw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Qo(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Yn=0;function MC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var BC,iw,OC,VC,UC,nb=!1,zm=[],zc=null,qc=null,Hc=null,q0=new Map,H0=new Map,Ac=[],h7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b3(t,e){switch(t){case"focusin":case"focusout":zc=null;break;case"dragenter":case"dragleave":qc=null;break;case"mouseover":case"mouseout":Hc=null;break;case"pointerover":case"pointerout":q0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":H0.delete(e.pointerId)}}function Ff(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=zp(e),e!==null&&iw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function f7(t,e,n,r,i){switch(e){case"focusin":return zc=Ff(zc,t,e,n,r,i),!0;case"dragenter":return qc=Ff(qc,t,e,n,r,i),!0;case"mouseover":return Hc=Ff(Hc,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return q0.set(s,Ff(q0.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,H0.set(s,Ff(H0.get(s)||null,t,e,n,r,i)),!0}return!1}function zC(t){var e=Wu(t.target);if(e!==null){var n=Id(e);if(n!==null){if(e=n.tag,e===13){if(e=TC(n),e!==null){t.blockedOn=e,UC(t.priority,function(){OC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=rb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);X2=r,n.target.dispatchEvent(r),X2=null}else return e=zp(n),e!==null&&iw(e),t.blockedOn=n,!1;e.shift()}return!0}function w3(t,e,n){jg(t)&&n.delete(e)}function p7(){nb=!1,zc!==null&&jg(zc)&&(zc=null),qc!==null&&jg(qc)&&(qc=null),Hc!==null&&jg(Hc)&&(Hc=null),q0.forEach(w3),H0.forEach(w3)}function Lf(t,e){t.blockedOn===e&&(t.blockedOn=null,nb||(nb=!0,Ys.unstable_scheduleCallback(Ys.unstable_NormalPriority,p7)))}function W0(t){function e(i){return Lf(i,t)}if(0<zm.length){Lf(zm[0],t);for(var n=1;n<zm.length;n++){var r=zm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zc!==null&&Lf(zc,t),qc!==null&&Lf(qc,t),Hc!==null&&Lf(Hc,t),q0.forEach(e),H0.forEach(e),n=0;n<Ac.length;n++)r=Ac[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ac.length&&(n=Ac[0],n.blockedOn===null);)zC(n),n.blockedOn===null&&Ac.shift()}var Dh=Vl.ReactCurrentBatchConfig,h1=!0;function m7(t,e,n,r){var i=Yn,s=Dh.transition;Dh.transition=null;try{Yn=1,sw(t,e,n,r)}finally{Yn=i,Dh.transition=s}}function g7(t,e,n,r){var i=Yn,s=Dh.transition;Dh.transition=null;try{Yn=4,sw(t,e,n,r)}finally{Yn=i,Dh.transition=s}}function sw(t,e,n,r){if(h1){var i=rb(t,e,n,r);if(i===null)sv(t,e,r,f1,n),b3(t,r);else if(f7(i,t,e,n,r))r.stopPropagation();else if(b3(t,r),e&4&&-1<h7.indexOf(t)){for(;i!==null;){var s=zp(i);if(s!==null&&BC(s),s=rb(t,e,n,r),s===null&&sv(t,e,r,f1,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else sv(t,e,r,null,n)}}var f1=null;function rb(t,e,n,r){if(f1=null,t=tw(r),t=Wu(t),t!==null)if(e=Id(t),e===null)t=null;else if(n=e.tag,n===13){if(t=TC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return f1=t,null}function qC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(r7()){case nw:return 1;case RC:return 4;case u1:case i7:return 16;case FC:return 536870912;default:return 16}default:return 16}}var Lc=null,ow=null,Dg=null;function HC(){if(Dg)return Dg;var t,e=ow,n=e.length,r,i="value"in Lc?Lc.value:Lc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Dg=i.slice(t,1<r?1-r:void 0)}function Rg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qm(){return!0}function _3(){return!1}function Zs(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?qm:_3,this.isPropagationStopped=_3,this}return Er(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=qm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=qm)},persist:function(){},isPersistent:qm}),e}var hf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aw=Zs(hf),Up=Er({},hf,{view:0,detail:0}),x7=Zs(Up),Yy,Xy,Mf,bx=Er({},Up,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mf&&(Mf&&t.type==="mousemove"?(Yy=t.screenX-Mf.screenX,Xy=t.screenY-Mf.screenY):Xy=Yy=0,Mf=t),Yy)},movementY:function(t){return"movementY"in t?t.movementY:Xy}}),N3=Zs(bx),y7=Er({},bx,{dataTransfer:0}),v7=Zs(y7),b7=Er({},Up,{relatedTarget:0}),Jy=Zs(b7),w7=Er({},hf,{animationName:0,elapsedTime:0,pseudoElement:0}),_7=Zs(w7),N7=Er({},hf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),A7=Zs(N7),S7=Er({},hf,{data:0}),A3=Zs(S7),E7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},P7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function k7(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=P7[t])?!!e[t]:!1}function lw(){return k7}var T7=Er({},Up,{key:function(t){if(t.key){var e=E7[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Rg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?C7[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lw,charCode:function(t){return t.type==="keypress"?Rg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Rg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),I7=Zs(T7),j7=Er({},bx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),S3=Zs(j7),D7=Er({},Up,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lw}),R7=Zs(D7),F7=Er({},hf,{propertyName:0,elapsedTime:0,pseudoElement:0}),L7=Zs(F7),M7=Er({},bx,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),B7=Zs(M7),O7=[9,13,27,32],cw=Il&&"CompositionEvent"in window,g0=null;Il&&"documentMode"in document&&(g0=document.documentMode);var V7=Il&&"TextEvent"in window&&!g0,WC=Il&&(!cw||g0&&8<g0&&11>=g0),E3=" ",C3=!1;function $C(t,e){switch(t){case"keyup":return O7.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mh=!1;function U7(t,e){switch(t){case"compositionend":return GC(e);case"keypress":return e.which!==32?null:(C3=!0,E3);case"textInput":return t=e.data,t===E3&&C3?null:t;default:return null}}function z7(t,e){if(mh)return t==="compositionend"||!cw&&$C(t,e)?(t=HC(),Dg=ow=Lc=null,mh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WC&&e.locale!=="ko"?null:e.data;default:return null}}var q7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!q7[t.type]:e==="textarea"}function KC(t,e,n,r){SC(r),e=p1(e,"onChange"),0<e.length&&(n=new aw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var x0=null,$0=null;function H7(t){s8(t,0)}function wx(t){var e=yh(t);if(yC(e))return t}function W7(t,e){if(t==="change")return e}var QC=!1;if(Il){var Zy;if(Il){var ev="oninput"in document;if(!ev){var k3=document.createElement("div");k3.setAttribute("oninput","return;"),ev=typeof k3.oninput=="function"}Zy=ev}else Zy=!1;QC=Zy&&(!document.documentMode||9<document.documentMode)}function T3(){x0&&(x0.detachEvent("onpropertychange",YC),$0=x0=null)}function YC(t){if(t.propertyName==="value"&&wx($0)){var e=[];KC(e,$0,t,tw(t)),kC(H7,e)}}function $7(t,e,n){t==="focusin"?(T3(),x0=e,$0=n,x0.attachEvent("onpropertychange",YC)):t==="focusout"&&T3()}function G7(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wx($0)}function K7(t,e){if(t==="click")return wx(e)}function Q7(t,e){if(t==="input"||t==="change")return wx(e)}function Y7(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Jo=typeof Object.is=="function"?Object.is:Y7;function G0(t,e){if(Jo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!O2.call(e,i)||!Jo(t[i],e[i]))return!1}return!0}function I3(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function j3(t,e){var n=I3(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=I3(n)}}function XC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?XC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function JC(){for(var t=window,e=a1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=a1(t.document)}return e}function uw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function X7(t){var e=JC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&XC(n.ownerDocument.documentElement,n)){if(r!==null&&uw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=j3(n,s);var o=j3(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var J7=Il&&"documentMode"in document&&11>=document.documentMode,gh=null,ib=null,y0=null,sb=!1;function D3(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sb||gh==null||gh!==a1(r)||(r=gh,"selectionStart"in r&&uw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),y0&&G0(y0,r)||(y0=r,r=p1(ib,"onSelect"),0<r.length&&(e=new aw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gh)))}function Hm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xh={animationend:Hm("Animation","AnimationEnd"),animationiteration:Hm("Animation","AnimationIteration"),animationstart:Hm("Animation","AnimationStart"),transitionend:Hm("Transition","TransitionEnd")},tv={},ZC={};Il&&(ZC=document.createElement("div").style,"AnimationEvent"in window||(delete xh.animationend.animation,delete xh.animationiteration.animation,delete xh.animationstart.animation),"TransitionEvent"in window||delete xh.transitionend.transition);function _x(t){if(tv[t])return tv[t];if(!xh[t])return t;var e=xh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ZC)return tv[t]=e[n];return t}var e8=_x("animationend"),t8=_x("animationiteration"),n8=_x("animationstart"),r8=_x("transitionend"),i8=new Map,R3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hu(t,e){i8.set(t,e),Td(e,[t])}for(var nv=0;nv<R3.length;nv++){var rv=R3[nv],Z7=rv.toLowerCase(),eF=rv[0].toUpperCase()+rv.slice(1);hu(Z7,"on"+eF)}hu(e8,"onAnimationEnd");hu(t8,"onAnimationIteration");hu(n8,"onAnimationStart");hu("dblclick","onDoubleClick");hu("focusin","onFocus");hu("focusout","onBlur");hu(r8,"onTransitionEnd");Hh("onMouseEnter",["mouseout","mouseover"]);Hh("onMouseLeave",["mouseout","mouseover"]);Hh("onPointerEnter",["pointerout","pointerover"]);Hh("onPointerLeave",["pointerout","pointerover"]);Td("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Td("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Td("onBeforeInput",["compositionend","keypress","textInput","paste"]);Td("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Td("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Td("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var i0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tF=new Set("cancel close invalid load scroll toggle".split(" ").concat(i0));function F3(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ZR(r,e,void 0,t),t.currentTarget=null}function s8(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;F3(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;F3(i,a,c),s=l}}}if(c1)throw t=eb,c1=!1,eb=null,t}function dr(t,e){var n=e[ub];n===void 0&&(n=e[ub]=new Set);var r=t+"__bubble";n.has(r)||(o8(e,t,2,!1),n.add(r))}function iv(t,e,n){var r=0;e&&(r|=4),o8(n,t,r,e)}var Wm="_reactListening"+Math.random().toString(36).slice(2);function K0(t){if(!t[Wm]){t[Wm]=!0,fC.forEach(function(n){n!=="selectionchange"&&(tF.has(n)||iv(n,!1,t),iv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wm]||(e[Wm]=!0,iv("selectionchange",!1,e))}}function o8(t,e,n,r){switch(qC(e)){case 1:var i=m7;break;case 4:i=g7;break;default:i=sw}n=i.bind(null,e,n,t),i=void 0,!Z2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sv(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Wu(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}kC(function(){var c=s,d=tw(n),f=[];e:{var h=i8.get(t);if(h!==void 0){var p=aw,m=t;switch(t){case"keypress":if(Rg(n)===0)break e;case"keydown":case"keyup":p=I7;break;case"focusin":m="focus",p=Jy;break;case"focusout":m="blur",p=Jy;break;case"beforeblur":case"afterblur":p=Jy;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=N3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=v7;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=R7;break;case e8:case t8:case n8:p=_7;break;case r8:p=L7;break;case"scroll":p=x7;break;case"wheel":p=B7;break;case"copy":case"cut":case"paste":p=A7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=S3}var g=(e&4)!==0,b=!g&&t==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var w=c,N;w!==null;){N=w;var E=N.stateNode;if(N.tag===5&&E!==null&&(N=E,x!==null&&(E=z0(w,x),E!=null&&g.push(Q0(w,E,N)))),b)break;w=w.return}0<g.length&&(h=new p(h,m,null,n,d),f.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==X2&&(m=n.relatedTarget||n.fromElement)&&(Wu(m)||m[jl]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=c,m=m?Wu(m):null,m!==null&&(b=Id(m),m!==b||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(g=N3,E="onMouseLeave",x="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=S3,E="onPointerLeave",x="onPointerEnter",w="pointer"),b=p==null?h:yh(p),N=m==null?h:yh(m),h=new g(E,w+"leave",p,n,d),h.target=b,h.relatedTarget=N,E=null,Wu(d)===c&&(g=new g(x,w+"enter",m,n,d),g.target=N,g.relatedTarget=b,E=g),b=E,p&&m)t:{for(g=p,x=m,w=0,N=g;N;N=Yd(N))w++;for(N=0,E=x;E;E=Yd(E))N++;for(;0<w-N;)g=Yd(g),w--;for(;0<N-w;)x=Yd(x),N--;for(;w--;){if(g===x||x!==null&&g===x.alternate)break t;g=Yd(g),x=Yd(x)}g=null}else g=null;p!==null&&L3(f,h,p,g,!1),m!==null&&b!==null&&L3(f,b,m,g,!0)}}e:{if(h=c?yh(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var D=W7;else if(P3(h))if(QC)D=Q7;else{D=G7;var j=$7}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(D=K7);if(D&&(D=D(t,c))){KC(f,D,n,d);break e}j&&j(t,h,c),t==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&$2(h,"number",h.value)}switch(j=c?yh(c):window,t){case"focusin":(P3(j)||j.contentEditable==="true")&&(gh=j,ib=c,y0=null);break;case"focusout":y0=ib=gh=null;break;case"mousedown":sb=!0;break;case"contextmenu":case"mouseup":case"dragend":sb=!1,D3(f,n,d);break;case"selectionchange":if(J7)break;case"keydown":case"keyup":D3(f,n,d)}var C;if(cw)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else mh?$C(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(WC&&n.locale!=="ko"&&(mh||v!=="onCompositionStart"?v==="onCompositionEnd"&&mh&&(C=HC()):(Lc=d,ow="value"in Lc?Lc.value:Lc.textContent,mh=!0)),j=p1(c,v),0<j.length&&(v=new A3(v,t,null,n,d),f.push({event:v,listeners:j}),C?v.data=C:(C=GC(n),C!==null&&(v.data=C)))),(C=V7?U7(t,n):z7(t,n))&&(c=p1(c,"onBeforeInput"),0<c.length&&(d=new A3("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:c}),d.data=C))}s8(f,e)})}function Q0(t,e,n){return{instance:t,listener:e,currentTarget:n}}function p1(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=z0(t,n),s!=null&&r.unshift(Q0(t,s,i)),s=z0(t,e),s!=null&&r.push(Q0(t,s,i))),t=t.return}return r}function Yd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function L3(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=z0(n,s),l!=null&&o.unshift(Q0(n,l,a))):i||(l=z0(n,s),l!=null&&o.push(Q0(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var nF=/\r\n?/g,rF=/\u0000|\uFFFD/g;function M3(t){return(typeof t=="string"?t:""+t).replace(nF,`
`).replace(rF,"")}function $m(t,e,n){if(e=M3(e),M3(t)!==e&&n)throw Error(ct(425))}function m1(){}var ob=null,ab=null;function lb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cb=typeof setTimeout=="function"?setTimeout:void 0,iF=typeof clearTimeout=="function"?clearTimeout:void 0,B3=typeof Promise=="function"?Promise:void 0,sF=typeof queueMicrotask=="function"?queueMicrotask:typeof B3<"u"?function(t){return B3.resolve(null).then(t).catch(oF)}:cb;function oF(t){setTimeout(function(){throw t})}function ov(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),W0(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);W0(e)}function Wc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function O3(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ff=Math.random().toString(36).slice(2),Ea="__reactFiber$"+ff,Y0="__reactProps$"+ff,jl="__reactContainer$"+ff,ub="__reactEvents$"+ff,aF="__reactListeners$"+ff,lF="__reactHandles$"+ff;function Wu(t){var e=t[Ea];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jl]||n[Ea]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=O3(t);t!==null;){if(n=t[Ea])return n;t=O3(t)}return e}t=n,n=t.parentNode}return null}function zp(t){return t=t[Ea]||t[jl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function yh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ct(33))}function Nx(t){return t[Y0]||null}var db=[],vh=-1;function fu(t){return{current:t}}function pr(t){0>vh||(t.current=db[vh],db[vh]=null,vh--)}function cr(t,e){vh++,db[vh]=t.current,t.current=e}var iu={},es=fu(iu),Ps=fu(!1),ld=iu;function Wh(t,e){var n=t.type.contextTypes;if(!n)return iu;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ks(t){return t=t.childContextTypes,t!=null}function g1(){pr(Ps),pr(es)}function V3(t,e,n){if(es.current!==iu)throw Error(ct(168));cr(es,e),cr(Ps,n)}function a8(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ct(108,$R(t)||"Unknown",i));return Er({},n,r)}function x1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||iu,ld=es.current,cr(es,t),cr(Ps,Ps.current),!0}function U3(t,e,n){var r=t.stateNode;if(!r)throw Error(ct(169));n?(t=a8(t,e,ld),r.__reactInternalMemoizedMergedChildContext=t,pr(Ps),pr(es),cr(es,t)):pr(Ps),cr(Ps,n)}var yl=null,Ax=!1,av=!1;function l8(t){yl===null?yl=[t]:yl.push(t)}function cF(t){Ax=!0,l8(t)}function pu(){if(!av&&yl!==null){av=!0;var t=0,e=Yn;try{var n=yl;for(Yn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}yl=null,Ax=!1}catch(i){throw yl!==null&&(yl=yl.slice(t+1)),DC(nw,pu),i}finally{Yn=e,av=!1}}return null}var bh=[],wh=0,y1=null,v1=0,vo=[],bo=0,cd=null,bl=1,wl="";function Du(t,e){bh[wh++]=v1,bh[wh++]=y1,y1=t,v1=e}function c8(t,e,n){vo[bo++]=bl,vo[bo++]=wl,vo[bo++]=cd,cd=t;var r=bl;t=wl;var i=32-Qo(r)-1;r&=~(1<<i),n+=1;var s=32-Qo(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,bl=1<<32-Qo(e)+i|n<<i|r,wl=s+t}else bl=1<<s|n<<i|r,wl=t}function dw(t){t.return!==null&&(Du(t,1),c8(t,1,0))}function hw(t){for(;t===y1;)y1=bh[--wh],bh[wh]=null,v1=bh[--wh],bh[wh]=null;for(;t===cd;)cd=vo[--bo],vo[bo]=null,wl=vo[--bo],vo[bo]=null,bl=vo[--bo],vo[bo]=null}var Qs=null,Ws=null,vr=!1,Go=null;function u8(t,e){var n=wo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function z3(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qs=t,Ws=Wc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qs=t,Ws=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=cd!==null?{id:bl,overflow:wl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qs=t,Ws=null,!0):!1;default:return!1}}function hb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fb(t){if(vr){var e=Ws;if(e){var n=e;if(!z3(t,e)){if(hb(t))throw Error(ct(418));e=Wc(n.nextSibling);var r=Qs;e&&z3(t,e)?u8(r,n):(t.flags=t.flags&-4097|2,vr=!1,Qs=t)}}else{if(hb(t))throw Error(ct(418));t.flags=t.flags&-4097|2,vr=!1,Qs=t}}}function q3(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qs=t}function Gm(t){if(t!==Qs)return!1;if(!vr)return q3(t),vr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!lb(t.type,t.memoizedProps)),e&&(e=Ws)){if(hb(t))throw d8(),Error(ct(418));for(;e;)u8(t,e),e=Wc(e.nextSibling)}if(q3(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ct(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ws=Wc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ws=null}}else Ws=Qs?Wc(t.stateNode.nextSibling):null;return!0}function d8(){for(var t=Ws;t;)t=Wc(t.nextSibling)}function $h(){Ws=Qs=null,vr=!1}function fw(t){Go===null?Go=[t]:Go.push(t)}var uF=Vl.ReactCurrentBatchConfig;function Bf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ct(309));var r=n.stateNode}if(!r)throw Error(ct(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ct(284));if(!n._owner)throw Error(ct(290,t))}return t}function Km(t,e){throw t=Object.prototype.toString.call(e),Error(ct(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function H3(t){var e=t._init;return e(t._payload)}function h8(t){function e(x,w){if(t){var N=x.deletions;N===null?(x.deletions=[w],x.flags|=16):N.push(w)}}function n(x,w){if(!t)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function i(x,w){return x=Qc(x,w),x.index=0,x.sibling=null,x}function s(x,w,N){return x.index=N,t?(N=x.alternate,N!==null?(N=N.index,N<w?(x.flags|=2,w):N):(x.flags|=2,w)):(x.flags|=1048576,w)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,w,N,E){return w===null||w.tag!==6?(w=pv(N,x.mode,E),w.return=x,w):(w=i(w,N),w.return=x,w)}function l(x,w,N,E){var D=N.type;return D===ph?d(x,w,N.props.children,E,N.key):w!==null&&(w.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===_c&&H3(D)===w.type)?(E=i(w,N.props),E.ref=Bf(x,w,N),E.return=x,E):(E=Ug(N.type,N.key,N.props,null,x.mode,E),E.ref=Bf(x,w,N),E.return=x,E)}function c(x,w,N,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==N.containerInfo||w.stateNode.implementation!==N.implementation?(w=mv(N,x.mode,E),w.return=x,w):(w=i(w,N.children||[]),w.return=x,w)}function d(x,w,N,E,D){return w===null||w.tag!==7?(w=Ju(N,x.mode,E,D),w.return=x,w):(w=i(w,N),w.return=x,w)}function f(x,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return w=pv(""+w,x.mode,N),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Mm:return N=Ug(w.type,w.key,w.props,null,x.mode,N),N.ref=Bf(x,null,w),N.return=x,N;case fh:return w=mv(w,x.mode,N),w.return=x,w;case _c:var E=w._init;return f(x,E(w._payload),N)}if(n0(w)||Df(w))return w=Ju(w,x.mode,N,null),w.return=x,w;Km(x,w)}return null}function h(x,w,N,E){var D=w!==null?w.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return D!==null?null:a(x,w,""+N,E);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Mm:return N.key===D?l(x,w,N,E):null;case fh:return N.key===D?c(x,w,N,E):null;case _c:return D=N._init,h(x,w,D(N._payload),E)}if(n0(N)||Df(N))return D!==null?null:d(x,w,N,E,null);Km(x,N)}return null}function p(x,w,N,E,D){if(typeof E=="string"&&E!==""||typeof E=="number")return x=x.get(N)||null,a(w,x,""+E,D);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Mm:return x=x.get(E.key===null?N:E.key)||null,l(w,x,E,D);case fh:return x=x.get(E.key===null?N:E.key)||null,c(w,x,E,D);case _c:var j=E._init;return p(x,w,N,j(E._payload),D)}if(n0(E)||Df(E))return x=x.get(N)||null,d(w,x,E,D,null);Km(w,E)}return null}function m(x,w,N,E){for(var D=null,j=null,C=w,v=w=0,A=null;C!==null&&v<N.length;v++){C.index>v?(A=C,C=null):A=C.sibling;var I=h(x,C,N[v],E);if(I===null){C===null&&(C=A);break}t&&C&&I.alternate===null&&e(x,C),w=s(I,w,v),j===null?D=I:j.sibling=I,j=I,C=A}if(v===N.length)return n(x,C),vr&&Du(x,v),D;if(C===null){for(;v<N.length;v++)C=f(x,N[v],E),C!==null&&(w=s(C,w,v),j===null?D=C:j.sibling=C,j=C);return vr&&Du(x,v),D}for(C=r(x,C);v<N.length;v++)A=p(C,x,v,N[v],E),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?v:A.key),w=s(A,w,v),j===null?D=A:j.sibling=A,j=A);return t&&C.forEach(function(S){return e(x,S)}),vr&&Du(x,v),D}function g(x,w,N,E){var D=Df(N);if(typeof D!="function")throw Error(ct(150));if(N=D.call(N),N==null)throw Error(ct(151));for(var j=D=null,C=w,v=w=0,A=null,I=N.next();C!==null&&!I.done;v++,I=N.next()){C.index>v?(A=C,C=null):A=C.sibling;var S=h(x,C,I.value,E);if(S===null){C===null&&(C=A);break}t&&C&&S.alternate===null&&e(x,C),w=s(S,w,v),j===null?D=S:j.sibling=S,j=S,C=A}if(I.done)return n(x,C),vr&&Du(x,v),D;if(C===null){for(;!I.done;v++,I=N.next())I=f(x,I.value,E),I!==null&&(w=s(I,w,v),j===null?D=I:j.sibling=I,j=I);return vr&&Du(x,v),D}for(C=r(x,C);!I.done;v++,I=N.next())I=p(C,x,v,I.value,E),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?v:I.key),w=s(I,w,v),j===null?D=I:j.sibling=I,j=I);return t&&C.forEach(function(P){return e(x,P)}),vr&&Du(x,v),D}function b(x,w,N,E){if(typeof N=="object"&&N!==null&&N.type===ph&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Mm:e:{for(var D=N.key,j=w;j!==null;){if(j.key===D){if(D=N.type,D===ph){if(j.tag===7){n(x,j.sibling),w=i(j,N.props.children),w.return=x,x=w;break e}}else if(j.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===_c&&H3(D)===j.type){n(x,j.sibling),w=i(j,N.props),w.ref=Bf(x,j,N),w.return=x,x=w;break e}n(x,j);break}else e(x,j);j=j.sibling}N.type===ph?(w=Ju(N.props.children,x.mode,E,N.key),w.return=x,x=w):(E=Ug(N.type,N.key,N.props,null,x.mode,E),E.ref=Bf(x,w,N),E.return=x,x=E)}return o(x);case fh:e:{for(j=N.key;w!==null;){if(w.key===j)if(w.tag===4&&w.stateNode.containerInfo===N.containerInfo&&w.stateNode.implementation===N.implementation){n(x,w.sibling),w=i(w,N.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else e(x,w);w=w.sibling}w=mv(N,x.mode,E),w.return=x,x=w}return o(x);case _c:return j=N._init,b(x,w,j(N._payload),E)}if(n0(N))return m(x,w,N,E);if(Df(N))return g(x,w,N,E);Km(x,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,w!==null&&w.tag===6?(n(x,w.sibling),w=i(w,N),w.return=x,x=w):(n(x,w),w=pv(N,x.mode,E),w.return=x,x=w),o(x)):n(x,w)}return b}var Gh=h8(!0),f8=h8(!1),b1=fu(null),w1=null,_h=null,pw=null;function mw(){pw=_h=w1=null}function gw(t){var e=b1.current;pr(b1),t._currentValue=e}function pb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Rh(t,e){w1=t,pw=_h=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Es=!0),t.firstContext=null)}function Eo(t){var e=t._currentValue;if(pw!==t)if(t={context:t,memoizedValue:e,next:null},_h===null){if(w1===null)throw Error(ct(308));_h=t,w1.dependencies={lanes:0,firstContext:t}}else _h=_h.next=t;return e}var $u=null;function xw(t){$u===null?$u=[t]:$u.push(t)}function p8(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,xw(e)):(n.next=i.next,i.next=n),e.interleaved=n,Dl(t,r)}function Dl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Nc=!1;function yw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m8(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Pl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $c(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Tn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Dl(t,n)}return i=r.interleaved,i===null?(e.next=e,xw(r)):(e.next=i.next,i.next=e),r.interleaved=e,Dl(t,n)}function Fg(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rw(t,n)}}function W3(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _1(t,e,n,r){var i=t.updateQueue;Nc=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,d=c=l=null,a=s;do{var h=a.lane,p=a.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(h=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(p,f,h):m,h==null)break e;f=Er({},f,h);break e;case 2:Nc=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=p,l=f):d=d.next=p,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);dd|=o,t.lanes=o,t.memoizedState=f}}function $3(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ct(191,i));i.call(r)}}}var qp={},La=fu(qp),X0=fu(qp),J0=fu(qp);function Gu(t){if(t===qp)throw Error(ct(174));return t}function vw(t,e){switch(cr(J0,e),cr(X0,t),cr(La,qp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:K2(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=K2(e,t)}pr(La),cr(La,e)}function Kh(){pr(La),pr(X0),pr(J0)}function g8(t){Gu(J0.current);var e=Gu(La.current),n=K2(e,t.type);e!==n&&(cr(X0,t),cr(La,n))}function bw(t){X0.current===t&&(pr(La),pr(X0))}var _r=fu(0);function N1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lv=[];function ww(){for(var t=0;t<lv.length;t++)lv[t]._workInProgressVersionPrimary=null;lv.length=0}var Lg=Vl.ReactCurrentDispatcher,cv=Vl.ReactCurrentBatchConfig,ud=0,Sr=null,ni=null,xi=null,A1=!1,v0=!1,Z0=0,dF=0;function Ui(){throw Error(ct(321))}function _w(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Jo(t[n],e[n]))return!1;return!0}function Nw(t,e,n,r,i,s){if(ud=s,Sr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lg.current=t===null||t.memoizedState===null?mF:gF,t=n(r,i),v0){s=0;do{if(v0=!1,Z0=0,25<=s)throw Error(ct(301));s+=1,xi=ni=null,e.updateQueue=null,Lg.current=xF,t=n(r,i)}while(v0)}if(Lg.current=S1,e=ni!==null&&ni.next!==null,ud=0,xi=ni=Sr=null,A1=!1,e)throw Error(ct(300));return t}function Aw(){var t=Z0!==0;return Z0=0,t}function _a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Sr.memoizedState=xi=t:xi=xi.next=t,xi}function Co(){if(ni===null){var t=Sr.alternate;t=t!==null?t.memoizedState:null}else t=ni.next;var e=xi===null?Sr.memoizedState:xi.next;if(e!==null)xi=e,ni=t;else{if(t===null)throw Error(ct(310));ni=t,t={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},xi===null?Sr.memoizedState=xi=t:xi=xi.next=t}return xi}function ep(t,e){return typeof e=="function"?e(t):e}function uv(t){var e=Co(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=ni,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((ud&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,Sr.lanes|=d,dd|=d}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Jo(r,e.memoizedState)||(Es=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Sr.lanes|=s,dd|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function dv(t){var e=Co(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Jo(s,e.memoizedState)||(Es=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function x8(){}function y8(t,e){var n=Sr,r=Co(),i=e(),s=!Jo(r.memoizedState,i);if(s&&(r.memoizedState=i,Es=!0),r=r.queue,Sw(w8.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||xi!==null&&xi.memoizedState.tag&1){if(n.flags|=2048,tp(9,b8.bind(null,n,r,i,e),void 0,null),yi===null)throw Error(ct(349));ud&30||v8(n,e,i)}return i}function v8(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Sr.updateQueue,e===null?(e={lastEffect:null,stores:null},Sr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function b8(t,e,n,r){e.value=n,e.getSnapshot=r,_8(e)&&N8(t)}function w8(t,e,n){return n(function(){_8(e)&&N8(t)})}function _8(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Jo(t,n)}catch{return!0}}function N8(t){var e=Dl(t,1);e!==null&&Yo(e,t,1,-1)}function G3(t){var e=_a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ep,lastRenderedState:t},e.queue=t,t=t.dispatch=pF.bind(null,Sr,t),[e.memoizedState,t]}function tp(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Sr.updateQueue,e===null?(e={lastEffect:null,stores:null},Sr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function A8(){return Co().memoizedState}function Mg(t,e,n,r){var i=_a();Sr.flags|=t,i.memoizedState=tp(1|e,n,void 0,r===void 0?null:r)}function Sx(t,e,n,r){var i=Co();r=r===void 0?null:r;var s=void 0;if(ni!==null){var o=ni.memoizedState;if(s=o.destroy,r!==null&&_w(r,o.deps)){i.memoizedState=tp(e,n,s,r);return}}Sr.flags|=t,i.memoizedState=tp(1|e,n,s,r)}function K3(t,e){return Mg(8390656,8,t,e)}function Sw(t,e){return Sx(2048,8,t,e)}function S8(t,e){return Sx(4,2,t,e)}function E8(t,e){return Sx(4,4,t,e)}function C8(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function P8(t,e,n){return n=n!=null?n.concat([t]):null,Sx(4,4,C8.bind(null,e,t),n)}function Ew(){}function k8(t,e){var n=Co();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_w(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function T8(t,e){var n=Co();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_w(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function I8(t,e,n){return ud&21?(Jo(n,e)||(n=LC(),Sr.lanes|=n,dd|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Es=!0),t.memoizedState=n)}function hF(t,e){var n=Yn;Yn=n!==0&&4>n?n:4,t(!0);var r=cv.transition;cv.transition={};try{t(!1),e()}finally{Yn=n,cv.transition=r}}function j8(){return Co().memoizedState}function fF(t,e,n){var r=Kc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},D8(t))R8(e,n);else if(n=p8(t,e,n,r),n!==null){var i=us();Yo(n,t,r,i),F8(n,e,r)}}function pF(t,e,n){var r=Kc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(D8(t))R8(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Jo(a,o)){var l=e.interleaved;l===null?(i.next=i,xw(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=p8(t,e,i,r),n!==null&&(i=us(),Yo(n,t,r,i),F8(n,e,r))}}function D8(t){var e=t.alternate;return t===Sr||e!==null&&e===Sr}function R8(t,e){v0=A1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function F8(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rw(t,n)}}var S1={readContext:Eo,useCallback:Ui,useContext:Ui,useEffect:Ui,useImperativeHandle:Ui,useInsertionEffect:Ui,useLayoutEffect:Ui,useMemo:Ui,useReducer:Ui,useRef:Ui,useState:Ui,useDebugValue:Ui,useDeferredValue:Ui,useTransition:Ui,useMutableSource:Ui,useSyncExternalStore:Ui,useId:Ui,unstable_isNewReconciler:!1},mF={readContext:Eo,useCallback:function(t,e){return _a().memoizedState=[t,e===void 0?null:e],t},useContext:Eo,useEffect:K3,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mg(4194308,4,C8.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mg(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mg(4,2,t,e)},useMemo:function(t,e){var n=_a();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_a();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=fF.bind(null,Sr,t),[r.memoizedState,t]},useRef:function(t){var e=_a();return t={current:t},e.memoizedState=t},useState:G3,useDebugValue:Ew,useDeferredValue:function(t){return _a().memoizedState=t},useTransition:function(){var t=G3(!1),e=t[0];return t=hF.bind(null,t[1]),_a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Sr,i=_a();if(vr){if(n===void 0)throw Error(ct(407));n=n()}else{if(n=e(),yi===null)throw Error(ct(349));ud&30||v8(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,K3(w8.bind(null,r,s,t),[t]),r.flags|=2048,tp(9,b8.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=_a(),e=yi.identifierPrefix;if(vr){var n=wl,r=bl;n=(r&~(1<<32-Qo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Z0++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=dF++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gF={readContext:Eo,useCallback:k8,useContext:Eo,useEffect:Sw,useImperativeHandle:P8,useInsertionEffect:S8,useLayoutEffect:E8,useMemo:T8,useReducer:uv,useRef:A8,useState:function(){return uv(ep)},useDebugValue:Ew,useDeferredValue:function(t){var e=Co();return I8(e,ni.memoizedState,t)},useTransition:function(){var t=uv(ep)[0],e=Co().memoizedState;return[t,e]},useMutableSource:x8,useSyncExternalStore:y8,useId:j8,unstable_isNewReconciler:!1},xF={readContext:Eo,useCallback:k8,useContext:Eo,useEffect:Sw,useImperativeHandle:P8,useInsertionEffect:S8,useLayoutEffect:E8,useMemo:T8,useReducer:dv,useRef:A8,useState:function(){return dv(ep)},useDebugValue:Ew,useDeferredValue:function(t){var e=Co();return ni===null?e.memoizedState=t:I8(e,ni.memoizedState,t)},useTransition:function(){var t=dv(ep)[0],e=Co().memoizedState;return[t,e]},useMutableSource:x8,useSyncExternalStore:y8,useId:j8,unstable_isNewReconciler:!1};function Ho(t,e){if(t&&t.defaultProps){e=Er({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function mb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Er({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ex={isMounted:function(t){return(t=t._reactInternals)?Id(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=us(),i=Kc(t),s=Pl(r,i);s.payload=e,n!=null&&(s.callback=n),e=$c(t,s,i),e!==null&&(Yo(e,t,i,r),Fg(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=us(),i=Kc(t),s=Pl(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=$c(t,s,i),e!==null&&(Yo(e,t,i,r),Fg(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=us(),r=Kc(t),i=Pl(n,r);i.tag=2,e!=null&&(i.callback=e),e=$c(t,i,r),e!==null&&(Yo(e,t,r,n),Fg(e,t,r))}};function Q3(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!G0(n,r)||!G0(i,s):!0}function L8(t,e,n){var r=!1,i=iu,s=e.contextType;return typeof s=="object"&&s!==null?s=Eo(s):(i=ks(e)?ld:es.current,r=e.contextTypes,s=(r=r!=null)?Wh(t,i):iu),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ex,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Y3(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ex.enqueueReplaceState(e,e.state,null)}function gb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},yw(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Eo(s):(s=ks(e)?ld:es.current,i.context=Wh(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(mb(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ex.enqueueReplaceState(i,i.state,null),_1(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Qh(t,e){try{var n="",r=e;do n+=WR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function hv(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function xb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var yF=typeof WeakMap=="function"?WeakMap:Map;function M8(t,e,n){n=Pl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){C1||(C1=!0,Cb=r),xb(t,e)},n}function B8(t,e,n){n=Pl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){xb(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){xb(t,e),typeof r!="function"&&(Gc===null?Gc=new Set([this]):Gc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function X3(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new yF;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=jF.bind(null,t,e,n),e.then(t,t))}function J3(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Z3(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Pl(-1,1),e.tag=2,$c(n,e,1))),n.lanes|=1),t)}var vF=Vl.ReactCurrentOwner,Es=!1;function ls(t,e,n,r){e.child=t===null?f8(e,null,n,r):Gh(e,t.child,n,r)}function eN(t,e,n,r,i){n=n.render;var s=e.ref;return Rh(e,i),r=Nw(t,e,n,r,s,i),n=Aw(),t!==null&&!Es?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Rl(t,e,i)):(vr&&n&&dw(e),e.flags|=1,ls(t,e,r,i),e.child)}function tN(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Rw(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,O8(t,e,s,r,i)):(t=Ug(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:G0,n(o,r)&&t.ref===e.ref)return Rl(t,e,i)}return e.flags|=1,t=Qc(s,r),t.ref=e.ref,t.return=e,e.child=t}function O8(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(G0(s,r)&&t.ref===e.ref)if(Es=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Es=!0);else return e.lanes=t.lanes,Rl(t,e,i)}return yb(t,e,n,r,i)}function V8(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(Ah,Hs),Hs|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,cr(Ah,Hs),Hs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,cr(Ah,Hs),Hs|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,cr(Ah,Hs),Hs|=r;return ls(t,e,i,n),e.child}function U8(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function yb(t,e,n,r,i){var s=ks(n)?ld:es.current;return s=Wh(e,s),Rh(e,i),n=Nw(t,e,n,r,s,i),r=Aw(),t!==null&&!Es?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Rl(t,e,i)):(vr&&r&&dw(e),e.flags|=1,ls(t,e,n,i),e.child)}function nN(t,e,n,r,i){if(ks(n)){var s=!0;x1(e)}else s=!1;if(Rh(e,i),e.stateNode===null)Bg(t,e),L8(e,n,r),gb(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Eo(c):(c=ks(n)?ld:es.current,c=Wh(e,c));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Y3(e,o,r,c),Nc=!1;var h=e.memoizedState;o.state=h,_1(e,r,o,i),l=e.memoizedState,a!==r||h!==l||Ps.current||Nc?(typeof d=="function"&&(mb(e,n,d,r),l=e.memoizedState),(a=Nc||Q3(e,n,a,r,h,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,m8(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ho(e.type,a),o.props=c,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Eo(l):(l=ks(n)?ld:es.current,l=Wh(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&Y3(e,o,r,l),Nc=!1,h=e.memoizedState,o.state=h,_1(e,r,o,i);var m=e.memoizedState;a!==f||h!==m||Ps.current||Nc?(typeof p=="function"&&(mb(e,n,p,r),m=e.memoizedState),(c=Nc||Q3(e,n,c,r,h,m,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return vb(t,e,n,r,s,i)}function vb(t,e,n,r,i,s){U8(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&U3(e,n,!1),Rl(t,e,s);r=e.stateNode,vF.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Gh(e,t.child,null,s),e.child=Gh(e,null,a,s)):ls(t,e,a,s),e.memoizedState=r.state,i&&U3(e,n,!0),e.child}function z8(t){var e=t.stateNode;e.pendingContext?V3(t,e.pendingContext,e.pendingContext!==e.context):e.context&&V3(t,e.context,!1),vw(t,e.containerInfo)}function rN(t,e,n,r,i){return $h(),fw(i),e.flags|=256,ls(t,e,n,r),e.child}var bb={dehydrated:null,treeContext:null,retryLane:0};function wb(t){return{baseLanes:t,cachePool:null,transitions:null}}function q8(t,e,n){var r=e.pendingProps,i=_r.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),cr(_r,i&1),t===null)return fb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=kx(o,r,0,null),t=Ju(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=wb(n),e.memoizedState=bb,t):Cw(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return bF(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Qc(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Qc(a,s):(s=Ju(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?wb(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=bb,r}return s=t.child,t=s.sibling,r=Qc(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Cw(t,e){return e=kx({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qm(t,e,n,r){return r!==null&&fw(r),Gh(e,t.child,null,n),t=Cw(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bF(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=hv(Error(ct(422))),Qm(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=kx({mode:"visible",children:r.children},i,0,null),s=Ju(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Gh(e,t.child,null,o),e.child.memoizedState=wb(o),e.memoizedState=bb,s);if(!(e.mode&1))return Qm(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ct(419)),r=hv(s,r,void 0),Qm(t,e,o,r)}if(a=(o&t.childLanes)!==0,Es||a){if(r=yi,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Dl(t,i),Yo(r,t,i,-1))}return Dw(),r=hv(Error(ct(421))),Qm(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=DF.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ws=Wc(i.nextSibling),Qs=e,vr=!0,Go=null,t!==null&&(vo[bo++]=bl,vo[bo++]=wl,vo[bo++]=cd,bl=t.id,wl=t.overflow,cd=e),e=Cw(e,r.children),e.flags|=4096,e)}function iN(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),pb(t.return,e,n)}function fv(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function H8(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ls(t,e,r.children,n),r=_r.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&iN(t,n,e);else if(t.tag===19)iN(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(cr(_r,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&N1(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),fv(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&N1(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}fv(e,!0,n,null,s);break;case"together":fv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Rl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),dd|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ct(153));if(e.child!==null){for(t=e.child,n=Qc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wF(t,e,n){switch(e.tag){case 3:z8(e),$h();break;case 5:g8(e);break;case 1:ks(e.type)&&x1(e);break;case 4:vw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;cr(b1,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(cr(_r,_r.current&1),e.flags|=128,null):n&e.child.childLanes?q8(t,e,n):(cr(_r,_r.current&1),t=Rl(t,e,n),t!==null?t.sibling:null);cr(_r,_r.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return H8(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),cr(_r,_r.current),r)break;return null;case 22:case 23:return e.lanes=0,V8(t,e,n)}return Rl(t,e,n)}var W8,_b,$8,G8;W8=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_b=function(){};$8=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Gu(La.current);var s=null;switch(n){case"input":i=H2(t,i),r=H2(t,r),s=[];break;case"select":i=Er({},i,{value:void 0}),r=Er({},r,{value:void 0}),s=[];break;case"textarea":i=G2(t,i),r=G2(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=m1)}Q2(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(V0.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(V0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&dr("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};G8=function(t,e,n,r){n!==r&&(e.flags|=4)};function Of(t,e){if(!vr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function _F(t,e,n){var r=e.pendingProps;switch(hw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zi(e),null;case 1:return ks(e.type)&&g1(),zi(e),null;case 3:return r=e.stateNode,Kh(),pr(Ps),pr(es),ww(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Go!==null&&(Tb(Go),Go=null))),_b(t,e),zi(e),null;case 5:bw(e);var i=Gu(J0.current);if(n=e.type,t!==null&&e.stateNode!=null)$8(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ct(166));return zi(e),null}if(t=Gu(La.current),Gm(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ea]=e,r[Y0]=s,t=(e.mode&1)!==0,n){case"dialog":dr("cancel",r),dr("close",r);break;case"iframe":case"object":case"embed":dr("load",r);break;case"video":case"audio":for(i=0;i<i0.length;i++)dr(i0[i],r);break;case"source":dr("error",r);break;case"img":case"image":case"link":dr("error",r),dr("load",r);break;case"details":dr("toggle",r);break;case"input":f3(r,s),dr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},dr("invalid",r);break;case"textarea":m3(r,s),dr("invalid",r)}Q2(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&$m(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&$m(r.textContent,a,t),i=["children",""+a]):V0.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&dr("scroll",r)}switch(n){case"input":Bm(r),p3(r,s,!0);break;case"textarea":Bm(r),g3(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=m1)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ea]=e,t[Y0]=r,W8(t,e,!1,!1),e.stateNode=t;e:{switch(o=Y2(n,r),n){case"dialog":dr("cancel",t),dr("close",t),i=r;break;case"iframe":case"object":case"embed":dr("load",t),i=r;break;case"video":case"audio":for(i=0;i<i0.length;i++)dr(i0[i],t);i=r;break;case"source":dr("error",t),i=r;break;case"img":case"image":case"link":dr("error",t),dr("load",t),i=r;break;case"details":dr("toggle",t),i=r;break;case"input":f3(t,r),i=H2(t,r),dr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Er({},r,{value:void 0}),dr("invalid",t);break;case"textarea":m3(t,r),i=G2(t,r),dr("invalid",t);break;default:i=r}Q2(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?AC(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&_C(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&U0(t,l):typeof l=="number"&&U0(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(V0.hasOwnProperty(s)?l!=null&&s==="onScroll"&&dr("scroll",t):l!=null&&X5(t,s,l,o))}switch(n){case"input":Bm(t),p3(t,r,!1);break;case"textarea":Bm(t),g3(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ru(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Th(t,!!r.multiple,s,!1):r.defaultValue!=null&&Th(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=m1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zi(e),null;case 6:if(t&&e.stateNode!=null)G8(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ct(166));if(n=Gu(J0.current),Gu(La.current),Gm(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ea]=e,(s=r.nodeValue!==n)&&(t=Qs,t!==null))switch(t.tag){case 3:$m(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$m(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ea]=e,e.stateNode=r}return zi(e),null;case 13:if(pr(_r),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vr&&Ws!==null&&e.mode&1&&!(e.flags&128))d8(),$h(),e.flags|=98560,s=!1;else if(s=Gm(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ct(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ct(317));s[Ea]=e}else $h(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zi(e),s=!1}else Go!==null&&(Tb(Go),Go=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||_r.current&1?ii===0&&(ii=3):Dw())),e.updateQueue!==null&&(e.flags|=4),zi(e),null);case 4:return Kh(),_b(t,e),t===null&&K0(e.stateNode.containerInfo),zi(e),null;case 10:return gw(e.type._context),zi(e),null;case 17:return ks(e.type)&&g1(),zi(e),null;case 19:if(pr(_r),s=e.memoizedState,s===null)return zi(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Of(s,!1);else{if(ii!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=N1(t),o!==null){for(e.flags|=128,Of(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return cr(_r,_r.current&1|2),e.child}t=t.sibling}s.tail!==null&&Br()>Yh&&(e.flags|=128,r=!0,Of(s,!1),e.lanes=4194304)}else{if(!r)if(t=N1(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Of(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!vr)return zi(e),null}else 2*Br()-s.renderingStartTime>Yh&&n!==1073741824&&(e.flags|=128,r=!0,Of(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Br(),e.sibling=null,n=_r.current,cr(_r,r?n&1|2:n&1),e):(zi(e),null);case 22:case 23:return jw(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Hs&1073741824&&(zi(e),e.subtreeFlags&6&&(e.flags|=8192)):zi(e),null;case 24:return null;case 25:return null}throw Error(ct(156,e.tag))}function NF(t,e){switch(hw(e),e.tag){case 1:return ks(e.type)&&g1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Kh(),pr(Ps),pr(es),ww(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bw(e),null;case 13:if(pr(_r),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ct(340));$h()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pr(_r),null;case 4:return Kh(),null;case 10:return gw(e.type._context),null;case 22:case 23:return jw(),null;case 24:return null;default:return null}}var Ym=!1,Qi=!1,AF=typeof WeakSet=="function"?WeakSet:Set,kt=null;function Nh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){jr(t,e,r)}else n.current=null}function Nb(t,e,n){try{n()}catch(r){jr(t,e,r)}}var sN=!1;function SF(t,e){if(ob=h1,t=JC(),uw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,f=t,h=null;t:for(;;){for(var p;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++d===r&&(l=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ab={focusedElem:t,selectionRange:n},h1=!1,kt=e;kt!==null;)if(e=kt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,kt=t;else for(;kt!==null;){e=kt;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,b=m.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:Ho(e.type,g),b);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ct(163))}}catch(E){jr(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,kt=t;break}kt=e.return}return m=sN,sN=!1,m}function b0(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Nb(e,n,s)}i=i.next}while(i!==r)}}function Cx(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ab(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function K8(t){var e=t.alternate;e!==null&&(t.alternate=null,K8(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ea],delete e[Y0],delete e[ub],delete e[aF],delete e[lF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Q8(t){return t.tag===5||t.tag===3||t.tag===4}function oN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Q8(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=m1));else if(r!==4&&(t=t.child,t!==null))for(Sb(t,e,n),t=t.sibling;t!==null;)Sb(t,e,n),t=t.sibling}function Eb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Eb(t,e,n),t=t.sibling;t!==null;)Eb(t,e,n),t=t.sibling}var Pi=null,$o=!1;function pc(t,e,n){for(n=n.child;n!==null;)Y8(t,e,n),n=n.sibling}function Y8(t,e,n){if(Fa&&typeof Fa.onCommitFiberUnmount=="function")try{Fa.onCommitFiberUnmount(vx,n)}catch{}switch(n.tag){case 5:Qi||Nh(n,e);case 6:var r=Pi,i=$o;Pi=null,pc(t,e,n),Pi=r,$o=i,Pi!==null&&($o?(t=Pi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pi.removeChild(n.stateNode));break;case 18:Pi!==null&&($o?(t=Pi,n=n.stateNode,t.nodeType===8?ov(t.parentNode,n):t.nodeType===1&&ov(t,n),W0(t)):ov(Pi,n.stateNode));break;case 4:r=Pi,i=$o,Pi=n.stateNode.containerInfo,$o=!0,pc(t,e,n),Pi=r,$o=i;break;case 0:case 11:case 14:case 15:if(!Qi&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Nb(n,e,o),i=i.next}while(i!==r)}pc(t,e,n);break;case 1:if(!Qi&&(Nh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){jr(n,e,a)}pc(t,e,n);break;case 21:pc(t,e,n);break;case 22:n.mode&1?(Qi=(r=Qi)||n.memoizedState!==null,pc(t,e,n),Qi=r):pc(t,e,n);break;default:pc(t,e,n)}}function aN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new AF),e.forEach(function(r){var i=RF.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Vo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Pi=a.stateNode,$o=!1;break e;case 3:Pi=a.stateNode.containerInfo,$o=!0;break e;case 4:Pi=a.stateNode.containerInfo,$o=!0;break e}a=a.return}if(Pi===null)throw Error(ct(160));Y8(s,o,i),Pi=null,$o=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){jr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)X8(e,t),e=e.sibling}function X8(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vo(e,t),ya(t),r&4){try{b0(3,t,t.return),Cx(3,t)}catch(g){jr(t,t.return,g)}try{b0(5,t,t.return)}catch(g){jr(t,t.return,g)}}break;case 1:Vo(e,t),ya(t),r&512&&n!==null&&Nh(n,n.return);break;case 5:if(Vo(e,t),ya(t),r&512&&n!==null&&Nh(n,n.return),t.flags&32){var i=t.stateNode;try{U0(i,"")}catch(g){jr(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&vC(i,s),Y2(a,o);var c=Y2(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?AC(i,f):d==="dangerouslySetInnerHTML"?_C(i,f):d==="children"?U0(i,f):X5(i,d,f,c)}switch(a){case"input":W2(i,s);break;case"textarea":bC(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Th(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Th(i,!!s.multiple,s.defaultValue,!0):Th(i,!!s.multiple,s.multiple?[]:"",!1))}i[Y0]=s}catch(g){jr(t,t.return,g)}}break;case 6:if(Vo(e,t),ya(t),r&4){if(t.stateNode===null)throw Error(ct(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){jr(t,t.return,g)}}break;case 3:if(Vo(e,t),ya(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{W0(e.containerInfo)}catch(g){jr(t,t.return,g)}break;case 4:Vo(e,t),ya(t);break;case 13:Vo(e,t),ya(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Tw=Br())),r&4&&aN(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Qi=(c=Qi)||d,Vo(e,t),Qi=c):Vo(e,t),ya(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(kt=t,d=t.child;d!==null;){for(f=kt=d;kt!==null;){switch(h=kt,p=h.child,h.tag){case 0:case 11:case 14:case 15:b0(4,h,h.return);break;case 1:Nh(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){jr(r,n,g)}}break;case 5:Nh(h,h.return);break;case 22:if(h.memoizedState!==null){cN(f);continue}}p!==null?(p.return=h,kt=p):cN(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=NC("display",o))}catch(g){jr(t,t.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){jr(t,t.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Vo(e,t),ya(t),r&4&&aN(t);break;case 21:break;default:Vo(e,t),ya(t)}}function ya(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Q8(n)){var r=n;break e}n=n.return}throw Error(ct(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(U0(i,""),r.flags&=-33);var s=oN(t);Eb(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=oN(t);Sb(t,a,o);break;default:throw Error(ct(161))}}catch(l){jr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EF(t,e,n){kt=t,J8(t)}function J8(t,e,n){for(var r=(t.mode&1)!==0;kt!==null;){var i=kt,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ym;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Qi;a=Ym;var c=Qi;if(Ym=o,(Qi=l)&&!c)for(kt=i;kt!==null;)o=kt,l=o.child,o.tag===22&&o.memoizedState!==null?uN(i):l!==null?(l.return=o,kt=l):uN(i);for(;s!==null;)kt=s,J8(s),s=s.sibling;kt=i,Ym=a,Qi=c}lN(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,kt=s):lN(t)}}function lN(t){for(;kt!==null;){var e=kt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qi||Cx(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qi)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ho(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&$3(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$3(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&W0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ct(163))}Qi||e.flags&512&&Ab(e)}catch(h){jr(e,e.return,h)}}if(e===t){kt=null;break}if(n=e.sibling,n!==null){n.return=e.return,kt=n;break}kt=e.return}}function cN(t){for(;kt!==null;){var e=kt;if(e===t){kt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,kt=n;break}kt=e.return}}function uN(t){for(;kt!==null;){var e=kt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cx(4,e)}catch(l){jr(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){jr(e,i,l)}}var s=e.return;try{Ab(e)}catch(l){jr(e,s,l)}break;case 5:var o=e.return;try{Ab(e)}catch(l){jr(e,o,l)}}}catch(l){jr(e,e.return,l)}if(e===t){kt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,kt=a;break}kt=e.return}}var CF=Math.ceil,E1=Vl.ReactCurrentDispatcher,Pw=Vl.ReactCurrentOwner,Ao=Vl.ReactCurrentBatchConfig,Tn=0,yi=null,Yr=null,Di=0,Hs=0,Ah=fu(0),ii=0,np=null,dd=0,Px=0,kw=0,w0=null,Ns=null,Tw=0,Yh=1/0,xl=null,C1=!1,Cb=null,Gc=null,Xm=!1,Mc=null,P1=0,_0=0,Pb=null,Og=-1,Vg=0;function us(){return Tn&6?Br():Og!==-1?Og:Og=Br()}function Kc(t){return t.mode&1?Tn&2&&Di!==0?Di&-Di:uF.transition!==null?(Vg===0&&(Vg=LC()),Vg):(t=Yn,t!==0||(t=window.event,t=t===void 0?16:qC(t.type)),t):1}function Yo(t,e,n,r){if(50<_0)throw _0=0,Pb=null,Error(ct(185));Vp(t,n,r),(!(Tn&2)||t!==yi)&&(t===yi&&(!(Tn&2)&&(Px|=n),ii===4&&Sc(t,Di)),Ts(t,r),n===1&&Tn===0&&!(e.mode&1)&&(Yh=Br()+500,Ax&&pu()))}function Ts(t,e){var n=t.callbackNode;u7(t,e);var r=d1(t,t===yi?Di:0);if(r===0)n!==null&&v3(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&v3(n),e===1)t.tag===0?cF(dN.bind(null,t)):l8(dN.bind(null,t)),sF(function(){!(Tn&6)&&pu()}),n=null;else{switch(MC(r)){case 1:n=nw;break;case 4:n=RC;break;case 16:n=u1;break;case 536870912:n=FC;break;default:n=u1}n=oP(n,Z8.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Z8(t,e){if(Og=-1,Vg=0,Tn&6)throw Error(ct(327));var n=t.callbackNode;if(Fh()&&t.callbackNode!==n)return null;var r=d1(t,t===yi?Di:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=k1(t,r);else{e=r;var i=Tn;Tn|=2;var s=tP();(yi!==t||Di!==e)&&(xl=null,Yh=Br()+500,Xu(t,e));do try{TF();break}catch(a){eP(t,a)}while(!0);mw(),E1.current=s,Tn=i,Yr!==null?e=0:(yi=null,Di=0,e=ii)}if(e!==0){if(e===2&&(i=tb(t),i!==0&&(r=i,e=kb(t,i))),e===1)throw n=np,Xu(t,0),Sc(t,r),Ts(t,Br()),n;if(e===6)Sc(t,r);else{if(i=t.current.alternate,!(r&30)&&!PF(i)&&(e=k1(t,r),e===2&&(s=tb(t),s!==0&&(r=s,e=kb(t,s))),e===1))throw n=np,Xu(t,0),Sc(t,r),Ts(t,Br()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ct(345));case 2:Ru(t,Ns,xl);break;case 3:if(Sc(t,r),(r&130023424)===r&&(e=Tw+500-Br(),10<e)){if(d1(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){us(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=cb(Ru.bind(null,t,Ns,xl),e);break}Ru(t,Ns,xl);break;case 4:if(Sc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Qo(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Br()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*CF(r/1960))-r,10<r){t.timeoutHandle=cb(Ru.bind(null,t,Ns,xl),r);break}Ru(t,Ns,xl);break;case 5:Ru(t,Ns,xl);break;default:throw Error(ct(329))}}}return Ts(t,Br()),t.callbackNode===n?Z8.bind(null,t):null}function kb(t,e){var n=w0;return t.current.memoizedState.isDehydrated&&(Xu(t,e).flags|=256),t=k1(t,e),t!==2&&(e=Ns,Ns=n,e!==null&&Tb(e)),t}function Tb(t){Ns===null?Ns=t:Ns.push.apply(Ns,t)}function PF(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Jo(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sc(t,e){for(e&=~kw,e&=~Px,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Qo(e),r=1<<n;t[n]=-1,e&=~r}}function dN(t){if(Tn&6)throw Error(ct(327));Fh();var e=d1(t,0);if(!(e&1))return Ts(t,Br()),null;var n=k1(t,e);if(t.tag!==0&&n===2){var r=tb(t);r!==0&&(e=r,n=kb(t,r))}if(n===1)throw n=np,Xu(t,0),Sc(t,e),Ts(t,Br()),n;if(n===6)throw Error(ct(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ru(t,Ns,xl),Ts(t,Br()),null}function Iw(t,e){var n=Tn;Tn|=1;try{return t(e)}finally{Tn=n,Tn===0&&(Yh=Br()+500,Ax&&pu())}}function hd(t){Mc!==null&&Mc.tag===0&&!(Tn&6)&&Fh();var e=Tn;Tn|=1;var n=Ao.transition,r=Yn;try{if(Ao.transition=null,Yn=1,t)return t()}finally{Yn=r,Ao.transition=n,Tn=e,!(Tn&6)&&pu()}}function jw(){Hs=Ah.current,pr(Ah)}function Xu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,iF(n)),Yr!==null)for(n=Yr.return;n!==null;){var r=n;switch(hw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&g1();break;case 3:Kh(),pr(Ps),pr(es),ww();break;case 5:bw(r);break;case 4:Kh();break;case 13:pr(_r);break;case 19:pr(_r);break;case 10:gw(r.type._context);break;case 22:case 23:jw()}n=n.return}if(yi=t,Yr=t=Qc(t.current,null),Di=Hs=e,ii=0,np=null,kw=Px=dd=0,Ns=w0=null,$u!==null){for(e=0;e<$u.length;e++)if(n=$u[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}$u=null}return t}function eP(t,e){do{var n=Yr;try{if(mw(),Lg.current=S1,A1){for(var r=Sr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}A1=!1}if(ud=0,xi=ni=Sr=null,v0=!1,Z0=0,Pw.current=null,n===null||n.return===null){ii=1,np=e,Yr=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Di,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=J3(o);if(p!==null){p.flags&=-257,Z3(p,o,a,s,e),p.mode&1&&X3(s,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){X3(s,c,e),Dw();break e}l=Error(ct(426))}}else if(vr&&a.mode&1){var b=J3(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Z3(b,o,a,s,e),fw(Qh(l,a));break e}}s=l=Qh(l,a),ii!==4&&(ii=2),w0===null?w0=[s]:w0.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=M8(s,l,e);W3(s,x);break e;case 1:a=l;var w=s.type,N=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Gc===null||!Gc.has(N)))){s.flags|=65536,e&=-e,s.lanes|=e;var E=B8(s,a,e);W3(s,E);break e}}s=s.return}while(s!==null)}rP(n)}catch(D){e=D,Yr===n&&n!==null&&(Yr=n=n.return);continue}break}while(!0)}function tP(){var t=E1.current;return E1.current=S1,t===null?S1:t}function Dw(){(ii===0||ii===3||ii===2)&&(ii=4),yi===null||!(dd&268435455)&&!(Px&268435455)||Sc(yi,Di)}function k1(t,e){var n=Tn;Tn|=2;var r=tP();(yi!==t||Di!==e)&&(xl=null,Xu(t,e));do try{kF();break}catch(i){eP(t,i)}while(!0);if(mw(),Tn=n,E1.current=r,Yr!==null)throw Error(ct(261));return yi=null,Di=0,ii}function kF(){for(;Yr!==null;)nP(Yr)}function TF(){for(;Yr!==null&&!t7();)nP(Yr)}function nP(t){var e=sP(t.alternate,t,Hs);t.memoizedProps=t.pendingProps,e===null?rP(t):Yr=e,Pw.current=null}function rP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=NF(n,e),n!==null){n.flags&=32767,Yr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ii=6,Yr=null;return}}else if(n=_F(n,e,Hs),n!==null){Yr=n;return}if(e=e.sibling,e!==null){Yr=e;return}Yr=e=t}while(e!==null);ii===0&&(ii=5)}function Ru(t,e,n){var r=Yn,i=Ao.transition;try{Ao.transition=null,Yn=1,IF(t,e,n,r)}finally{Ao.transition=i,Yn=r}return null}function IF(t,e,n,r){do Fh();while(Mc!==null);if(Tn&6)throw Error(ct(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ct(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(d7(t,s),t===yi&&(Yr=yi=null,Di=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xm||(Xm=!0,oP(u1,function(){return Fh(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ao.transition,Ao.transition=null;var o=Yn;Yn=1;var a=Tn;Tn|=4,Pw.current=null,SF(t,n),X8(n,t),X7(ab),h1=!!ob,ab=ob=null,t.current=n,EF(n),n7(),Tn=a,Yn=o,Ao.transition=s}else t.current=n;if(Xm&&(Xm=!1,Mc=t,P1=i),s=t.pendingLanes,s===0&&(Gc=null),s7(n.stateNode),Ts(t,Br()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(C1)throw C1=!1,t=Cb,Cb=null,t;return P1&1&&t.tag!==0&&Fh(),s=t.pendingLanes,s&1?t===Pb?_0++:(_0=0,Pb=t):_0=0,pu(),null}function Fh(){if(Mc!==null){var t=MC(P1),e=Ao.transition,n=Yn;try{if(Ao.transition=null,Yn=16>t?16:t,Mc===null)var r=!1;else{if(t=Mc,Mc=null,P1=0,Tn&6)throw Error(ct(331));var i=Tn;for(Tn|=4,kt=t.current;kt!==null;){var s=kt,o=s.child;if(kt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(kt=c;kt!==null;){var d=kt;switch(d.tag){case 0:case 11:case 15:b0(8,d,s)}var f=d.child;if(f!==null)f.return=d,kt=f;else for(;kt!==null;){d=kt;var h=d.sibling,p=d.return;if(K8(d),d===c){kt=null;break}if(h!==null){h.return=p,kt=h;break}kt=p}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}kt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,kt=o;else e:for(;kt!==null;){if(s=kt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:b0(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,kt=x;break e}kt=s.return}}var w=t.current;for(kt=w;kt!==null;){o=kt;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,kt=N;else e:for(o=w;kt!==null;){if(a=kt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Cx(9,a)}}catch(D){jr(a,a.return,D)}if(a===o){kt=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,kt=E;break e}kt=a.return}}if(Tn=i,pu(),Fa&&typeof Fa.onPostCommitFiberRoot=="function")try{Fa.onPostCommitFiberRoot(vx,t)}catch{}r=!0}return r}finally{Yn=n,Ao.transition=e}}return!1}function hN(t,e,n){e=Qh(n,e),e=M8(t,e,1),t=$c(t,e,1),e=us(),t!==null&&(Vp(t,1,e),Ts(t,e))}function jr(t,e,n){if(t.tag===3)hN(t,t,n);else for(;e!==null;){if(e.tag===3){hN(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Gc===null||!Gc.has(r))){t=Qh(n,t),t=B8(e,t,1),e=$c(e,t,1),t=us(),e!==null&&(Vp(e,1,t),Ts(e,t));break}}e=e.return}}function jF(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=us(),t.pingedLanes|=t.suspendedLanes&n,yi===t&&(Di&n)===n&&(ii===4||ii===3&&(Di&130023424)===Di&&500>Br()-Tw?Xu(t,0):kw|=n),Ts(t,e)}function iP(t,e){e===0&&(t.mode&1?(e=Um,Um<<=1,!(Um&130023424)&&(Um=4194304)):e=1);var n=us();t=Dl(t,e),t!==null&&(Vp(t,e,n),Ts(t,n))}function DF(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),iP(t,n)}function RF(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ct(314))}r!==null&&r.delete(e),iP(t,n)}var sP;sP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ps.current)Es=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Es=!1,wF(t,e,n);Es=!!(t.flags&131072)}else Es=!1,vr&&e.flags&1048576&&c8(e,v1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bg(t,e),t=e.pendingProps;var i=Wh(e,es.current);Rh(e,n),i=Nw(null,e,r,t,i,n);var s=Aw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ks(r)?(s=!0,x1(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yw(e),i.updater=Ex,e.stateNode=i,i._reactInternals=e,gb(e,r,t,n),e=vb(null,e,r,!0,s,n)):(e.tag=0,vr&&s&&dw(e),ls(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bg(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=LF(r),t=Ho(r,t),i){case 0:e=yb(null,e,r,t,n);break e;case 1:e=nN(null,e,r,t,n);break e;case 11:e=eN(null,e,r,t,n);break e;case 14:e=tN(null,e,r,Ho(r.type,t),n);break e}throw Error(ct(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ho(r,i),yb(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ho(r,i),nN(t,e,r,i,n);case 3:e:{if(z8(e),t===null)throw Error(ct(387));r=e.pendingProps,s=e.memoizedState,i=s.element,m8(t,e),_1(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Qh(Error(ct(423)),e),e=rN(t,e,r,n,i);break e}else if(r!==i){i=Qh(Error(ct(424)),e),e=rN(t,e,r,n,i);break e}else for(Ws=Wc(e.stateNode.containerInfo.firstChild),Qs=e,vr=!0,Go=null,n=f8(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($h(),r===i){e=Rl(t,e,n);break e}ls(t,e,r,n)}e=e.child}return e;case 5:return g8(e),t===null&&fb(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,lb(r,i)?o=null:s!==null&&lb(r,s)&&(e.flags|=32),U8(t,e),ls(t,e,o,n),e.child;case 6:return t===null&&fb(e),null;case 13:return q8(t,e,n);case 4:return vw(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Gh(e,null,r,n):ls(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ho(r,i),eN(t,e,r,i,n);case 7:return ls(t,e,e.pendingProps,n),e.child;case 8:return ls(t,e,e.pendingProps.children,n),e.child;case 12:return ls(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,cr(b1,r._currentValue),r._currentValue=o,s!==null)if(Jo(s.value,o)){if(s.children===i.children&&!Ps.current){e=Rl(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Pl(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),pb(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ct(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),pb(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ls(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Rh(e,n),i=Eo(i),r=r(i),e.flags|=1,ls(t,e,r,n),e.child;case 14:return r=e.type,i=Ho(r,e.pendingProps),i=Ho(r.type,i),tN(t,e,r,i,n);case 15:return O8(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ho(r,i),Bg(t,e),e.tag=1,ks(r)?(t=!0,x1(e)):t=!1,Rh(e,n),L8(e,r,i),gb(e,r,i,n),vb(null,e,r,!0,t,n);case 19:return H8(t,e,n);case 22:return V8(t,e,n)}throw Error(ct(156,e.tag))};function oP(t,e){return DC(t,e)}function FF(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wo(t,e,n,r){return new FF(t,e,n,r)}function Rw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function LF(t){if(typeof t=="function")return Rw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Z5)return 11;if(t===ew)return 14}return 2}function Qc(t,e){var n=t.alternate;return n===null?(n=wo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ug(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Rw(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ph:return Ju(n.children,i,s,e);case J5:o=8,i|=8;break;case V2:return t=wo(12,n,e,i|2),t.elementType=V2,t.lanes=s,t;case U2:return t=wo(13,n,e,i),t.elementType=U2,t.lanes=s,t;case z2:return t=wo(19,n,e,i),t.elementType=z2,t.lanes=s,t;case gC:return kx(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pC:o=10;break e;case mC:o=9;break e;case Z5:o=11;break e;case ew:o=14;break e;case _c:o=16,r=null;break e}throw Error(ct(130,t==null?t:typeof t,""))}return e=wo(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ju(t,e,n,r){return t=wo(7,t,r,e),t.lanes=n,t}function kx(t,e,n,r){return t=wo(22,t,r,e),t.elementType=gC,t.lanes=n,t.stateNode={isHidden:!1},t}function pv(t,e,n){return t=wo(6,t,null,e),t.lanes=n,t}function mv(t,e,n){return e=wo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MF(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qy(0),this.expirationTimes=Qy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qy(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Fw(t,e,n,r,i,s,o,a,l){return t=new MF(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=wo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yw(s),t}function BF(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function aP(t){if(!t)return iu;t=t._reactInternals;e:{if(Id(t)!==t||t.tag!==1)throw Error(ct(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ks(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ct(171))}if(t.tag===1){var n=t.type;if(ks(n))return a8(t,n,e)}return e}function lP(t,e,n,r,i,s,o,a,l){return t=Fw(n,r,!0,t,i,s,o,a,l),t.context=aP(null),n=t.current,r=us(),i=Kc(n),s=Pl(r,i),s.callback=e??null,$c(n,s,i),t.current.lanes=i,Vp(t,i,r),Ts(t,r),t}function Tx(t,e,n,r){var i=e.current,s=us(),o=Kc(i);return n=aP(n),e.context===null?e.context=n:e.pendingContext=n,e=Pl(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$c(i,e,o),t!==null&&(Yo(t,i,o,s),Fg(t,i,o)),o}function T1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Lw(t,e){fN(t,e),(t=t.alternate)&&fN(t,e)}function OF(){return null}var cP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mw(t){this._internalRoot=t}Ix.prototype.render=Mw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ct(409));Tx(t,e,null,null)};Ix.prototype.unmount=Mw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hd(function(){Tx(null,t,null,null)}),e[jl]=null}};function Ix(t){this._internalRoot=t}Ix.prototype.unstable_scheduleHydration=function(t){if(t){var e=VC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ac.length&&e!==0&&e<Ac[n].priority;n++);Ac.splice(n,0,t),n===0&&zC(t)}};function Bw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function jx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pN(){}function VF(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=T1(o);s.call(c)}}var o=lP(e,r,t,0,null,!1,!1,"",pN);return t._reactRootContainer=o,t[jl]=o.current,K0(t.nodeType===8?t.parentNode:t),hd(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=T1(l);a.call(c)}}var l=Fw(t,0,!1,null,null,!1,!1,"",pN);return t._reactRootContainer=l,t[jl]=l.current,K0(t.nodeType===8?t.parentNode:t),hd(function(){Tx(e,l,n,r)}),l}function Dx(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=T1(o);a.call(l)}}Tx(e,o,t,i)}else o=VF(n,e,t,i,r);return T1(o)}BC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=r0(e.pendingLanes);n!==0&&(rw(e,n|1),Ts(e,Br()),!(Tn&6)&&(Yh=Br()+500,pu()))}break;case 13:hd(function(){var r=Dl(t,1);if(r!==null){var i=us();Yo(r,t,1,i)}}),Lw(t,1)}};iw=function(t){if(t.tag===13){var e=Dl(t,134217728);if(e!==null){var n=us();Yo(e,t,134217728,n)}Lw(t,134217728)}};OC=function(t){if(t.tag===13){var e=Kc(t),n=Dl(t,e);if(n!==null){var r=us();Yo(n,t,e,r)}Lw(t,e)}};VC=function(){return Yn};UC=function(t,e){var n=Yn;try{return Yn=t,e()}finally{Yn=n}};J2=function(t,e,n){switch(e){case"input":if(W2(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Nx(r);if(!i)throw Error(ct(90));yC(r),W2(r,i)}}}break;case"textarea":bC(t,n);break;case"select":e=n.value,e!=null&&Th(t,!!n.multiple,e,!1)}};CC=Iw;PC=hd;var UF={usingClientEntryPoint:!1,Events:[zp,yh,Nx,SC,EC,Iw]},Vf={findFiberByHostInstance:Wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zF={bundleType:Vf.bundleType,version:Vf.version,rendererPackageName:Vf.rendererPackageName,rendererConfig:Vf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=IC(t),t===null?null:t.stateNode},findFiberByHostInstance:Vf.findFiberByHostInstance||OF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jm.isDisabled&&Jm.supportsFiber)try{vx=Jm.inject(zF),Fa=Jm}catch{}}Js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UF;Js.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bw(e))throw Error(ct(200));return BF(t,e,null,n)};Js.createRoot=function(t,e){if(!Bw(t))throw Error(ct(299));var n=!1,r="",i=cP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Fw(t,1,!1,null,null,n,!1,r,i),t[jl]=e.current,K0(t.nodeType===8?t.parentNode:t),new Mw(e)};Js.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ct(188)):(t=Object.keys(t).join(","),Error(ct(268,t)));return t=IC(e),t=t===null?null:t.stateNode,t};Js.flushSync=function(t){return hd(t)};Js.hydrate=function(t,e,n){if(!jx(e))throw Error(ct(200));return Dx(null,t,e,!0,n)};Js.hydrateRoot=function(t,e,n){if(!Bw(t))throw Error(ct(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=cP;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=lP(e,null,t,1,n??null,i,!1,s,o),t[jl]=e.current,K0(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ix(e)};Js.render=function(t,e,n){if(!jx(e))throw Error(ct(200));return Dx(null,t,e,!1,n)};Js.unmountComponentAtNode=function(t){if(!jx(t))throw Error(ct(40));return t._reactRootContainer?(hd(function(){Dx(null,null,t,!1,function(){t._reactRootContainer=null,t[jl]=null})}),!0):!1};Js.unstable_batchedUpdates=Iw;Js.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!jx(n))throw Error(ct(200));if(t==null||t._reactInternals===void 0)throw Error(ct(38));return Dx(t,e,n,!1,r)};Js.version="18.3.1-next-f1338f8080-20240426";function uP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uP)}catch(t){console.error(t)}}uP(),uC.exports=Js;var qF=uC.exports,dP,mN=qF;dP=mN.createRoot,mN.hydrateRoot;var gN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},HF=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},fP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,f=(s&3)<<4|a>>4;let h=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(h=64)),r.push(n[d],n[f],n[h],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(hP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HF(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||f==null)throw new WF;const h=s<<2|a>>4;if(r.push(h),c!==64){const p=a<<4&240|c>>2;if(r.push(p),f!==64){const m=c<<6&192|f;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $F=function(t){const e=hP(t);return fP.encodeByteArray(e,!0)},I1=function(t){return $F(t).replace(/\./g,"")},pP=function(t){try{return fP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=()=>GF().__FIREBASE_DEFAULTS__,QF=()=>{if(typeof process>"u"||typeof gN>"u")return;const t=gN.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YF=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&pP(t[1]);return e&&JSON.parse(e)},Rx=()=>{try{return KF()||QF()||YF()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},mP=t=>{var e,n;return(n=(e=Rx())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},gP=t=>{const e=mP(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},xP=()=>{var t;return(t=Rx())===null||t===void 0?void 0:t.config},yP=t=>{var e;return(e=Rx())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[I1(JSON.stringify(n)),I1(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JF(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ai())}function ZF(){var t;const e=(t=Rx())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tL(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function nL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rL(){const t=ai();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function bP(){return!ZF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wP(){try{return typeof indexedDB=="object"}catch{return!1}}function iL(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL="FirebaseError";class qa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=sL,Object.setPrototypeOf(this,qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hp.prototype.create)}}class Hp{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?oL(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new qa(i,a,r)}}function oL(t,e){return t.replace(aL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const aL=/\{\$([^}]+)}/g;function lL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function rp(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(xN(s)&&xN(o)){if(!rp(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function xN(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function s0(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function o0(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function cL(t,e){const n=new uL(t,e);return n.subscribe.bind(n)}class uL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");dL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=gv),i.error===void 0&&(i.error=gv),i.complete===void 0&&(i.complete=gv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t){return t&&t._delegate?t._delegate:t}class su{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new XF;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pL(e))try{this.getOrInitializeService({instanceIdentifier:Fu})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Fu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fu){return this.instances.has(e)}getOptions(e=Fu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:fL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fu){return this.component?this.component.multipleInstances?e:Fu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fL(t){return t===Fu?void 0:t}function pL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new hL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(wn||(wn={}));const gL={debug:wn.DEBUG,verbose:wn.VERBOSE,info:wn.INFO,warn:wn.WARN,error:wn.ERROR,silent:wn.SILENT},xL=wn.INFO,yL={[wn.DEBUG]:"log",[wn.VERBOSE]:"log",[wn.INFO]:"info",[wn.WARN]:"warn",[wn.ERROR]:"error"},vL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=yL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ow{constructor(e){this.name=e,this._logLevel=xL,this._logHandler=vL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wn.DEBUG,...e),this._logHandler(this,wn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wn.VERBOSE,...e),this._logHandler(this,wn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wn.INFO,...e),this._logHandler(this,wn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wn.WARN,...e),this._logHandler(this,wn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wn.ERROR,...e),this._logHandler(this,wn.ERROR,...e)}}const bL=(t,e)=>e.some(n=>t instanceof n);let yN,vN;function wL(){return yN||(yN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _L(){return vN||(vN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _P=new WeakMap,Ib=new WeakMap,NP=new WeakMap,xv=new WeakMap,Vw=new WeakMap;function NL(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Yc(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&_P.set(n,t)}).catch(()=>{}),Vw.set(e,t),e}function AL(t){if(Ib.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Ib.set(t,e)}let jb={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ib.get(t);if(e==="objectStoreNames")return t.objectStoreNames||NP.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SL(t){jb=t(jb)}function EL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(yv(this),e,...n);return NP.set(r,e.sort?e.sort():[e]),Yc(r)}:_L().includes(t)?function(...e){return t.apply(yv(this),e),Yc(_P.get(this))}:function(...e){return Yc(t.apply(yv(this),e))}}function CL(t){return typeof t=="function"?EL(t):(t instanceof IDBTransaction&&AL(t),bL(t,wL())?new Proxy(t,jb):t)}function Yc(t){if(t instanceof IDBRequest)return NL(t);if(xv.has(t))return xv.get(t);const e=CL(t);return e!==t&&(xv.set(t,e),Vw.set(e,t)),e}const yv=t=>Vw.get(t);function PL(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Yc(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Yc(o.result),l.oldVersion,l.newVersion,Yc(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const kL=["get","getKey","getAll","getAllKeys","count"],TL=["put","add","delete","clear"],vv=new Map;function bN(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vv.get(e))return vv.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=TL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||kL.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return vv.set(e,s),s}SL(t=>({...t,get:(e,n,r)=>bN(e,n)||t.get(e,n,r),has:(e,n)=>!!bN(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function jL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Db="@firebase/app",wN="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=new Ow("@firebase/app"),DL="@firebase/app-compat",RL="@firebase/analytics-compat",FL="@firebase/analytics",LL="@firebase/app-check-compat",ML="@firebase/app-check",BL="@firebase/auth",OL="@firebase/auth-compat",VL="@firebase/database",UL="@firebase/data-connect",zL="@firebase/database-compat",qL="@firebase/functions",HL="@firebase/functions-compat",WL="@firebase/installations",$L="@firebase/installations-compat",GL="@firebase/messaging",KL="@firebase/messaging-compat",QL="@firebase/performance",YL="@firebase/performance-compat",XL="@firebase/remote-config",JL="@firebase/remote-config-compat",ZL="@firebase/storage",eM="@firebase/storage-compat",tM="@firebase/firestore",nM="@firebase/vertexai-preview",rM="@firebase/firestore-compat",iM="firebase",sM="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb="[DEFAULT]",oM={[Db]:"fire-core",[DL]:"fire-core-compat",[FL]:"fire-analytics",[RL]:"fire-analytics-compat",[ML]:"fire-app-check",[LL]:"fire-app-check-compat",[BL]:"fire-auth",[OL]:"fire-auth-compat",[VL]:"fire-rtdb",[UL]:"fire-data-connect",[zL]:"fire-rtdb-compat",[qL]:"fire-fn",[HL]:"fire-fn-compat",[WL]:"fire-iid",[$L]:"fire-iid-compat",[GL]:"fire-fcm",[KL]:"fire-fcm-compat",[QL]:"fire-perf",[YL]:"fire-perf-compat",[XL]:"fire-rc",[JL]:"fire-rc-compat",[ZL]:"fire-gcs",[eM]:"fire-gcs-compat",[tM]:"fire-fst",[rM]:"fire-fst-compat",[nM]:"fire-vertex","fire-js":"fire-js",[iM]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=new Map,aM=new Map,Fb=new Map;function _N(t,e){try{t.container.addComponent(e)}catch(n){Fl.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fd(t){const e=t.name;if(Fb.has(e))return Fl.debug(`There were multiple attempts to register component ${e}.`),!1;Fb.set(e,t);for(const n of j1.values())_N(n,t);for(const n of aM.values())_N(n,t);return!0}function Fx(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ka(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xc=new Hp("app","Firebase",lM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new su("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=sM;function AP(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Rb,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Xc.create("bad-app-name",{appName:String(i)});if(n||(n=xP()),!n)throw Xc.create("no-options");const s=j1.get(i);if(s){if(rp(n,s.options)&&rp(r,s.config))return s;throw Xc.create("duplicate-app",{appName:i})}const o=new mL(i);for(const l of Fb.values())o.addComponent(l);const a=new cM(n,r,o);return j1.set(i,a),a}function Uw(t=Rb){const e=j1.get(t);if(!e&&t===Rb&&xP())return AP();if(!e)throw Xc.create("no-app",{appName:t});return e}function Ma(t,e,n){var r;let i=(r=oM[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fl.warn(a.join(" "));return}fd(new su(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM="firebase-heartbeat-database",dM=1,ip="firebase-heartbeat-store";let bv=null;function SP(){return bv||(bv=PL(uM,dM,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ip)}catch(n){console.warn(n)}}}}).catch(t=>{throw Xc.create("idb-open",{originalErrorMessage:t.message})})),bv}async function hM(t){try{const n=(await SP()).transaction(ip),r=await n.objectStore(ip).get(EP(t));return await n.done,r}catch(e){if(e instanceof qa)Fl.warn(e.message);else{const n=Xc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fl.warn(n.message)}}}async function NN(t,e){try{const r=(await SP()).transaction(ip,"readwrite");await r.objectStore(ip).put(e,EP(t)),await r.done}catch(n){if(n instanceof qa)Fl.warn(n.message);else{const r=Xc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Fl.warn(r.message)}}}function EP(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=1024,pM=30*24*60*60*1e3;class mM{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xM(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=AN();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=pM}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Fl.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=AN(),{heartbeatsToSend:r,unsentEntries:i}=gM(this._heartbeatsCache.heartbeats),s=I1(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Fl.warn(n),""}}}function AN(){return new Date().toISOString().substring(0,10)}function gM(t,e=fM){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),SN(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),SN(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class xM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wP()?iL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await hM(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return NN(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return NN(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function SN(t){return I1(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(t){fd(new su("platform-logger",e=>new IL(e),"PRIVATE")),fd(new su("heartbeat",e=>new mM(e),"PRIVATE")),Ma(Db,wN,t),Ma(Db,wN,"esm2017"),Ma("fire-js","")}yM("");function zw(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function CP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const vM=CP,PP=new Hp("auth","Firebase",CP());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=new Ow("@firebase/auth");function bM(t,...e){D1.logLevel<=wn.WARN&&D1.warn(`Auth (${jd}): ${t}`,...e)}function zg(t,...e){D1.logLevel<=wn.ERROR&&D1.error(`Auth (${jd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(t,...e){throw qw(t,...e)}function Ba(t,...e){return qw(t,...e)}function kP(t,e,n){const r=Object.assign(Object.assign({},vM()),{[e]:n});return new Hp("auth","Firebase",r).create(e,{appName:t.name})}function kl(t){return kP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qw(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return PP.create(t,...e)}function Jt(t,e,...n){if(!t)throw qw(e,...n)}function _l(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zg(e),new Error(e)}function Ll(t,e){t||_l(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function wM(){return EN()==="http:"||EN()==="https:"}function EN(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _M(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wM()||tL()||"connection"in navigator)?navigator.onLine:!0}function NM(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ll(n>e,"Short delay should be less than long delay!"),this.isMobile=JF()||nL()}get(){return _M()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t,e){Ll(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_l("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_l("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_l("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=new $p(3e4,6e4);function Ul(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zl(t,e,n,r,i={}){return IP(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Wp(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return eL()||(c.referrerPolicy="no-referrer"),TP.fetch()(jP(t,t.config.apiHost,n,a),c)})}async function IP(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},AM),e);try{const i=new CM(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Zm(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zm(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Zm(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Zm(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw kP(t,d,c);Zo(t,d)}}catch(i){if(i instanceof qa)throw i;Zo(t,"network-request-failed",{message:String(i)})}}async function Gp(t,e,n,r,i={}){const s=await zl(t,e,n,r,i);return"mfaPendingCredential"in s&&Zo(t,"multi-factor-auth-required",{_serverResponse:s}),s}function jP(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Hw(t.config,i):`${t.config.apiScheme}://${i}`}function EM(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class CM{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ba(this.auth,"network-request-failed")),SM.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Zm(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Ba(t,e,r);return i.customData._tokenResponse=n,i}function CN(t){return t!==void 0&&t.enterprise!==void 0}class PM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return EM(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function kM(t,e){return zl(t,"GET","/v2/recaptchaConfig",Ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TM(t,e){return zl(t,"POST","/v1/accounts:delete",e)}async function DP(t,e){return zl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function IM(t,e=!1){const n=ur(t),r=await n.getIdToken(e),i=Ww(r);Jt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:N0(wv(i.auth_time)),issuedAtTime:N0(wv(i.iat)),expirationTime:N0(wv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function wv(t){return Number(t)*1e3}function Ww(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return zg("JWT malformed, contained fewer than 3 sections"),null;try{const i=pP(n);return i?JSON.parse(i):(zg("Failed to decode base64 JWT payload"),null)}catch(i){return zg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function PN(t){const e=Ww(t);return Jt(e,"internal-error"),Jt(typeof e.exp<"u","internal-error"),Jt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sp(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof qa&&jM(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function jM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=N0(this.lastLoginAt),this.creationTime=N0(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R1(t){var e;const n=t.auth,r=await t.getIdToken(),i=await sp(t,DP(n,{idToken:r}));Jt(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?RP(s.providerUserInfo):[],a=FM(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Mb(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function RM(t){const e=ur(t);await R1(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function FM(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function RP(t){return t.map(e=>{var{providerId:n}=e,r=zw(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LM(t,e){const n=await IP(t,{},async()=>{const r=Wp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=jP(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",TP.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function MM(t,e){return zl(t,"POST","/v2/accounts:revokeToken",Ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Jt(e.idToken,"internal-error"),Jt(typeof e.idToken<"u","internal-error"),Jt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):PN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Jt(e.length!==0,"internal-error");const n=PN(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Jt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await LM(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Lh;return r&&(Jt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Jt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Jt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Lh,this.toJSON())}_performRefresh(){return _l("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t,e){Jt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Nl{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=zw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new DM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Mb(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await sp(this,this.stsTokenManager.getToken(this.auth,e));return Jt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return IM(this,e)}reload(){return RM(this)}_assign(e){this!==e&&(Jt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Nl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Jt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await R1(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ka(this.auth.app))return Promise.reject(kl(this.auth));const e=await this.getIdToken();return await sp(this,TM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,c,d;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,h=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=n.photoURL)!==null&&o!==void 0?o:void 0,g=(a=n.tenantId)!==null&&a!==void 0?a:void 0,b=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=n.createdAt)!==null&&c!==void 0?c:void 0,w=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:N,emailVerified:E,isAnonymous:D,providerData:j,stsTokenManager:C}=n;Jt(N&&C,e,"internal-error");const v=Lh.fromJSON(this.name,C);Jt(typeof N=="string",e,"internal-error"),mc(f,e.name),mc(h,e.name),Jt(typeof E=="boolean",e,"internal-error"),Jt(typeof D=="boolean",e,"internal-error"),mc(p,e.name),mc(m,e.name),mc(g,e.name),mc(b,e.name),mc(x,e.name),mc(w,e.name);const A=new Nl({uid:N,auth:e,email:h,emailVerified:E,displayName:f,isAnonymous:D,photoURL:m,phoneNumber:p,tenantId:g,stsTokenManager:v,createdAt:x,lastLoginAt:w});return j&&Array.isArray(j)&&(A.providerData=j.map(I=>Object.assign({},I))),b&&(A._redirectEventId=b),A}static async _fromIdTokenResponse(e,n,r=!1){const i=new Lh;i.updateFromServerResponse(n);const s=new Nl({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await R1(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Jt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?RP(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Lh;a.updateFromIdToken(r);const l=new Nl({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Mb(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=new Map;function Al(t){Ll(t instanceof Function,"Expected a class definition");let e=kN.get(t);return e?(Ll(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,kN.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}FP.type="NONE";const TN=FP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t,e,n){return`firebase:${t}:${e}:${n}`}class Mh{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=qg(this.userKey,i.apiKey,s),this.fullPersistenceKey=qg("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Nl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Mh(Al(TN),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Al(TN);const o=qg(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){const f=Nl._fromJSON(e,d);c!==s&&(a=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Mh(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Mh(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(OP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(LP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UP(e))return"Blackberry";if(zP(e))return"Webos";if(MP(e))return"Safari";if((e.includes("chrome/")||BP(e))&&!e.includes("edge/"))return"Chrome";if(VP(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function LP(t=ai()){return/firefox\//i.test(t)}function MP(t=ai()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BP(t=ai()){return/crios\//i.test(t)}function OP(t=ai()){return/iemobile/i.test(t)}function VP(t=ai()){return/android/i.test(t)}function UP(t=ai()){return/blackberry/i.test(t)}function zP(t=ai()){return/webos/i.test(t)}function $w(t=ai()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function BM(t=ai()){var e;return $w(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function OM(){return rL()&&document.documentMode===10}function qP(t=ai()){return $w(t)||VP(t)||zP(t)||UP(t)||/windows phone/i.test(t)||OP(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HP(t,e=[]){let n;switch(t){case"Browser":n=IN(ai());break;case"Worker":n=`${IN(ai())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${jd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UM(t,e={}){return zl(t,"GET","/v2/passwordPolicy",Ul(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM=6;class qM{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:zM,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jN(this),this.idTokenSubscription=new jN(this),this.beforeStateQueue=new VM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Al(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Mh.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await DP(this,{idToken:e}),r=await Nl._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(ka(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Jt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await R1(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ka(this.app))return Promise.reject(kl(this));const n=e?ur(e):null;return n&&Jt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Jt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ka(this.app)?Promise.reject(kl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ka(this.app)?Promise.reject(kl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Al(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UM(this),n=new qM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Hp("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await MM(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Al(e)||this._popupRedirectResolver;Jt(n,this,"argument-error"),this.redirectPersistenceManager=await Mh.create(this,[Al(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Jt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Jt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&bM(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function mu(t){return ur(t)}class jN{constructor(e){this.auth=e,this.observer=null,this.addObserver=cL(n=>this.observer=n)}get next(){return Jt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function WM(t){Lx=t}function WP(t){return Lx.loadJS(t)}function $M(){return Lx.recaptchaEnterpriseScript}function GM(){return Lx.gapiScript}function KM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const QM="recaptcha-enterprise",YM="NO_RECAPTCHA";class XM{constructor(e){this.type=QM,this.auth=mu(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{kM(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new PM(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;CN(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(YM)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&CN(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=$M();l.length!==0&&(l+=a),WP(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function DN(t,e,n,r=!1){const i=new XM(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function F1(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await DN(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await DN(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(t,e){const n=Fx(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(rp(s,e??{}))return i;Zo(i,"already-initialized")}return n.initialize({options:e})}function ZM(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Al);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function eB(t,e,n){const r=mu(t);Jt(r._canInitEmulator,r,"emulator-config-failed"),Jt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=$P(e),{host:o,port:a}=tB(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),nB()}function $P(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tB(t){const e=$P(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:RN(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:RN(o)}}}function RN(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return _l("not implemented")}_getIdTokenResponse(e){return _l("not implemented")}_linkToIdToken(e,n){return _l("not implemented")}_getReauthenticationResolver(e){return _l("not implemented")}}async function rB(t,e){return zl(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iB(t,e){return Gp(t,"POST","/v1/accounts:signInWithPassword",Ul(t,e))}async function sB(t,e){return zl(t,"POST","/v1/accounts:sendOobCode",Ul(t,e))}async function oB(t,e){return sB(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aB(t,e){return Gp(t,"POST","/v1/accounts:signInWithEmailLink",Ul(t,e))}async function lB(t,e){return Gp(t,"POST","/v1/accounts:signInWithEmailLink",Ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op extends Gw{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new op(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new op(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return F1(e,n,"signInWithPassword",iB);case"emailLink":return aB(e,{email:this._email,oobCode:this._password});default:Zo(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return F1(e,r,"signUpPassword",rB);case"emailLink":return lB(e,{idToken:n,email:this._email,oobCode:this._password});default:Zo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bh(t,e){return Gp(t,"POST","/v1/accounts:signInWithIdp",Ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cB="http://localhost";class pd extends Gw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new pd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=zw(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new pd(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Bh(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bh(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bh(e,n)}buildRequest(){const e={requestUri:cB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Wp(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dB(t){const e=s0(o0(t)).link,n=e?s0(o0(e)).deep_link_id:null,r=s0(o0(t)).deep_link_id;return(r?s0(o0(r)).link:null)||r||n||e||t}class Kw{constructor(e){var n,r,i,s,o,a;const l=s0(o0(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=uB((i=l.mode)!==null&&i!==void 0?i:null);Jt(c&&d&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=dB(e);try{return new Kw(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this.providerId=pf.PROVIDER_ID}static credential(e,n){return op._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Kw.parseLink(n);return Jt(r,"argument-error"),op._fromEmailAndCode(e,r.code,r.tenantId)}}pf.PROVIDER_ID="password";pf.EMAIL_PASSWORD_SIGN_IN_METHOD="password";pf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp extends GP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends Kp{constructor(){super("facebook.com")}static credential(e){return pd._fromParams({providerId:Ec.PROVIDER_ID,signInMethod:Ec.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ec.credentialFromTaggedObject(e)}static credentialFromError(e){return Ec.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ec.credential(e.oauthAccessToken)}catch{return null}}}Ec.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ec.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc extends Kp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return pd._fromParams({providerId:Cc.PROVIDER_ID,signInMethod:Cc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Cc.credentialFromTaggedObject(e)}static credentialFromError(e){return Cc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Cc.credential(n,r)}catch{return null}}}Cc.GOOGLE_SIGN_IN_METHOD="google.com";Cc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc extends Kp{constructor(){super("github.com")}static credential(e){return pd._fromParams({providerId:Pc.PROVIDER_ID,signInMethod:Pc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pc.credentialFromTaggedObject(e)}static credentialFromError(e){return Pc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pc.credential(e.oauthAccessToken)}catch{return null}}}Pc.GITHUB_SIGN_IN_METHOD="github.com";Pc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc extends Kp{constructor(){super("twitter.com")}static credential(e,n){return pd._fromParams({providerId:kc.PROVIDER_ID,signInMethod:kc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return kc.credentialFromTaggedObject(e)}static credentialFromError(e){return kc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return kc.credential(n,r)}catch{return null}}}kc.TWITTER_SIGN_IN_METHOD="twitter.com";kc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hB(t,e){return Gp(t,"POST","/v1/accounts:signUp",Ul(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Nl._fromIdTokenResponse(e,r,i),o=FN(r);return new md({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=FN(r);return new md({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function FN(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1 extends qa{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,L1.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new L1(e,n,r,i)}}function KP(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?L1._fromErrorAndOperation(t,s,e,r):s})}async function fB(t,e,n=!1){const r=await sp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return md._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pB(t,e,n=!1){const{auth:r}=t;if(ka(r.app))return Promise.reject(kl(r));const i="reauthenticate";try{const s=await sp(t,KP(r,i,e,t),n);Jt(s.idToken,r,"internal-error");const o=Ww(s.idToken);Jt(o,r,"internal-error");const{sub:a}=o;return Jt(t.uid===a,r,"user-mismatch"),md._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Zo(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QP(t,e,n=!1){if(ka(t.app))return Promise.reject(kl(t));const r="signIn",i=await KP(t,r,e),s=await md._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function mB(t,e){return QP(mu(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YP(t){const e=mu(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function gB(t,e,n){const r=mu(t);await F1(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",oB)}async function xB(t,e,n){if(ka(t.app))return Promise.reject(kl(t));const r=mu(t),o=await F1(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hB).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&YP(t),l}),a=await md._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function yB(t,e,n){return ka(t.app)?Promise.reject(kl(t)):mB(ur(t),pf.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&YP(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vB(t,e){return ur(t).setPersistence(e)}function bB(t,e,n,r){return ur(t).onIdTokenChanged(e,n,r)}function wB(t,e,n){return ur(t).beforeAuthStateChanged(e,n)}function XP(t,e,n,r){return ur(t).onAuthStateChanged(e,n,r)}const M1="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(M1,"1"),this.storage.removeItem(M1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B=1e3,NB=10;class ZP extends JP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qP(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);OM()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,NB):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},_B)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZP.type="LOCAL";const ek=ZP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk extends JP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}tk.type="SESSION";const nk=tk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Mx(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await AB(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mx.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=Qw("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(h.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(){return window}function EB(t){Oa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(){return typeof Oa().WorkerGlobalScope<"u"&&typeof Oa().importScripts=="function"}async function CB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function PB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function kB(){return rk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="firebaseLocalStorageDb",TB=1,B1="firebaseLocalStorage",sk="fbase_key";class Qp{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Bx(t,e){return t.transaction([B1],e?"readwrite":"readonly").objectStore(B1)}function IB(){const t=indexedDB.deleteDatabase(ik);return new Qp(t).toPromise()}function Bb(){const t=indexedDB.open(ik,TB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(B1,{keyPath:sk})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(B1)?e(r):(r.close(),await IB(),e(await Bb()))})})}async function LN(t,e,n){const r=Bx(t,!0).put({[sk]:e,value:n});return new Qp(r).toPromise()}async function jB(t,e){const n=Bx(t,!1).get(e),r=await new Qp(n).toPromise();return r===void 0?null:r.value}function MN(t,e){const n=Bx(t,!0).delete(e);return new Qp(n).toPromise()}const DB=800,RB=3;class ok{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bb(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>RB)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mx._getInstance(kB()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await CB(),!this.activeServiceWorker)return;this.sender=new SB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||PB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bb();return await LN(e,M1,"1"),await MN(e,M1),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>LN(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>jB(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>MN(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Bx(i,!1).getAll();return new Qp(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ok.type="LOCAL";const FB=ok;new $p(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LB(t,e){return e?Al(e):(Jt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw extends Gw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bh(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bh(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bh(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function MB(t){return QP(t.auth,new Yw(t),t.bypassAuthState)}function BB(t){const{auth:e,user:n}=t;return Jt(n,e,"internal-error"),pB(n,new Yw(t),t.bypassAuthState)}async function OB(t){const{auth:e,user:n}=t;return Jt(n,e,"internal-error"),fB(n,new Yw(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return MB;case"linkViaPopup":case"linkViaRedirect":return OB;case"reauthViaPopup":case"reauthViaRedirect":return BB;default:Zo(this.auth,"internal-error")}}resolve(e){Ll(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ll(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VB=new $p(2e3,1e4);class Sh extends ak{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Sh.currentPopupAction&&Sh.currentPopupAction.cancel(),Sh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Jt(e,this.auth,"internal-error"),e}async onExecution(){Ll(this.filter.length===1,"Popup operations only handle one event");const e=Qw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ba(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ba(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ba(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VB.get())};e()}}Sh.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB="pendingRedirect",Hg=new Map;class zB extends ak{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Hg.get(this.auth._key());if(!e){try{const r=await qB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Hg.set(this.auth._key(),e)}return this.bypassAuthState||Hg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qB(t,e){const n=$B(e),r=WB(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function HB(t,e){Hg.set(t._key(),e)}function WB(t){return Al(t._redirectPersistence)}function $B(t){return qg(UB,t.config.apiKey,t.name)}async function GB(t,e,n=!1){if(ka(t.app))return Promise.reject(kl(t));const r=mu(t),i=LB(r,e),o=await new zB(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KB=10*60*1e3;class QB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!YB(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lk(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ba(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=KB&&this.cachedEventUids.clear(),this.cachedEventUids.has(BN(e))}saveEventToCache(e){this.cachedEventUids.add(BN(e)),this.lastProcessedEventTime=Date.now()}}function BN(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function YB(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XB(t,e={}){return zl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZB=/^https?/;async function e9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await XB(t);for(const n of e)try{if(t9(n))return}catch{}Zo(t,"unauthorized-domain")}function t9(t){const e=Lb(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!ZB.test(n))return!1;if(JB.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n9=new $p(3e4,6e4);function ON(){const t=Oa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function r9(t){return new Promise((e,n)=>{var r,i,s;function o(){ON(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ON(),n(Ba(t,"network-request-failed"))},timeout:n9.get()})}if(!((i=(r=Oa().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Oa().gapi)===null||s===void 0)&&s.load)o();else{const a=KM("iframefcb");return Oa()[a]=()=>{gapi.load?o():n(Ba(t,"network-request-failed"))},WP(`${GM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Wg=null,e})}let Wg=null;function i9(t){return Wg=Wg||r9(t),Wg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9=new $p(5e3,15e3),o9="__/auth/iframe",a9="emulator/auth/iframe",l9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function u9(t){const e=t.config;Jt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Hw(e,a9):`https://${t.config.authDomain}/${o9}`,r={apiKey:e.apiKey,appName:t.name,v:jd},i=c9.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Wp(r).slice(1)}`}async function d9(t){const e=await i9(t),n=Oa().gapi;return Jt(n,t,"internal-error"),e.open({where:document.body,url:u9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:l9,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Ba(t,"network-request-failed"),a=Oa().setTimeout(()=>{s(o)},s9.get());function l(){Oa().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f9=500,p9=600,m9="_blank",g9="http://localhost";class VN{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function x9(t,e,n,r=f9,i=p9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},h9),{width:r.toString(),height:i.toString(),top:s,left:o}),c=ai().toLowerCase();n&&(a=BP(c)?m9:n),LP(c)&&(e=e||g9,l.scrollbars="yes");const d=Object.entries(l).reduce((h,[p,m])=>`${h}${p}=${m},`,"");if(BM(c)&&a!=="_self")return y9(e||"",a),new VN(null);const f=window.open(e||"",a,d);Jt(f,t,"popup-blocked");try{f.focus()}catch{}return new VN(f)}function y9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9="__/auth/handler",b9="emulator/auth/handler",w9=encodeURIComponent("fac");async function UN(t,e,n,r,i,s){Jt(t.config.authDomain,t,"auth-domain-config-required"),Jt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:jd,eventId:i};if(e instanceof GP){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",lL(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof Kp){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${w9}=${encodeURIComponent(l)}`:"";return`${_9(t)}?${Wp(a).slice(1)}${c}`}function _9({config:t}){return t.emulator?Hw(t,b9):`https://${t.authDomain}/${v9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v="webStorageSupport";class N9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nk,this._completeRedirectFn=GB,this._overrideRedirectResult=HB}async _openPopup(e,n,r,i){var s;Ll((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await UN(e,n,r,Lb(),i);return x9(e,o,Qw())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await UN(e,n,r,Lb(),i);return EB(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Ll(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await d9(e),r=new QB(e);return n.register("authEvent",i=>(Jt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(_v,{type:_v},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[_v];o!==void 0&&n(!!o),Zo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=e9(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return qP()||MP()||$w()}}const A9=N9;var zN="@firebase/auth",qN="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Jt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function C9(t){fd(new su("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Jt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HP(t)},c=new HM(r,i,s,l);return ZM(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),fd(new su("auth-internal",e=>{const n=mu(e.getProvider("auth").getImmediate());return(r=>new S9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ma(zN,qN,E9(t)),Ma(zN,qN,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9=5*60,k9=yP("authIdTokenMaxAge")||P9;let HN=null;const T9=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>k9)return;const i=n==null?void 0:n.token;HN!==i&&(HN=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function I9(t=Uw()){const e=Fx(t,"auth");if(e.isInitialized())return e.getImmediate();const n=JM(t,{popupRedirectResolver:A9,persistence:[FB,ek,nk]}),r=yP("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=T9(s.toString());wB(n,o,()=>o(n.currentUser)),bB(n,a=>o(a))}}const i=mP("auth");return i&&eB(n,`http://${i}`),n}function j9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}WM({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Ba("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",j9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});C9("Browser");var D9="firebase",R9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ma(D9,R9,"app");var WN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zu,ck;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,v){function A(){}A.prototype=v.prototype,C.D=v.prototype,C.prototype=new A,C.prototype.constructor=C,C.C=function(I,S,P){for(var k=Array(arguments.length-2),F=2;F<arguments.length;F++)k[F-2]=arguments[F];return v.prototype[S].apply(I,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,v,A){A||(A=0);var I=Array(16);if(typeof v=="string")for(var S=0;16>S;++S)I[S]=v.charCodeAt(A++)|v.charCodeAt(A++)<<8|v.charCodeAt(A++)<<16|v.charCodeAt(A++)<<24;else for(S=0;16>S;++S)I[S]=v[A++]|v[A++]<<8|v[A++]<<16|v[A++]<<24;v=C.g[0],A=C.g[1],S=C.g[2];var P=C.g[3],k=v+(P^A&(S^P))+I[0]+3614090360&4294967295;v=A+(k<<7&4294967295|k>>>25),k=P+(S^v&(A^S))+I[1]+3905402710&4294967295,P=v+(k<<12&4294967295|k>>>20),k=S+(A^P&(v^A))+I[2]+606105819&4294967295,S=P+(k<<17&4294967295|k>>>15),k=A+(v^S&(P^v))+I[3]+3250441966&4294967295,A=S+(k<<22&4294967295|k>>>10),k=v+(P^A&(S^P))+I[4]+4118548399&4294967295,v=A+(k<<7&4294967295|k>>>25),k=P+(S^v&(A^S))+I[5]+1200080426&4294967295,P=v+(k<<12&4294967295|k>>>20),k=S+(A^P&(v^A))+I[6]+2821735955&4294967295,S=P+(k<<17&4294967295|k>>>15),k=A+(v^S&(P^v))+I[7]+4249261313&4294967295,A=S+(k<<22&4294967295|k>>>10),k=v+(P^A&(S^P))+I[8]+1770035416&4294967295,v=A+(k<<7&4294967295|k>>>25),k=P+(S^v&(A^S))+I[9]+2336552879&4294967295,P=v+(k<<12&4294967295|k>>>20),k=S+(A^P&(v^A))+I[10]+4294925233&4294967295,S=P+(k<<17&4294967295|k>>>15),k=A+(v^S&(P^v))+I[11]+2304563134&4294967295,A=S+(k<<22&4294967295|k>>>10),k=v+(P^A&(S^P))+I[12]+1804603682&4294967295,v=A+(k<<7&4294967295|k>>>25),k=P+(S^v&(A^S))+I[13]+4254626195&4294967295,P=v+(k<<12&4294967295|k>>>20),k=S+(A^P&(v^A))+I[14]+2792965006&4294967295,S=P+(k<<17&4294967295|k>>>15),k=A+(v^S&(P^v))+I[15]+1236535329&4294967295,A=S+(k<<22&4294967295|k>>>10),k=v+(S^P&(A^S))+I[1]+4129170786&4294967295,v=A+(k<<5&4294967295|k>>>27),k=P+(A^S&(v^A))+I[6]+3225465664&4294967295,P=v+(k<<9&4294967295|k>>>23),k=S+(v^A&(P^v))+I[11]+643717713&4294967295,S=P+(k<<14&4294967295|k>>>18),k=A+(P^v&(S^P))+I[0]+3921069994&4294967295,A=S+(k<<20&4294967295|k>>>12),k=v+(S^P&(A^S))+I[5]+3593408605&4294967295,v=A+(k<<5&4294967295|k>>>27),k=P+(A^S&(v^A))+I[10]+38016083&4294967295,P=v+(k<<9&4294967295|k>>>23),k=S+(v^A&(P^v))+I[15]+3634488961&4294967295,S=P+(k<<14&4294967295|k>>>18),k=A+(P^v&(S^P))+I[4]+3889429448&4294967295,A=S+(k<<20&4294967295|k>>>12),k=v+(S^P&(A^S))+I[9]+568446438&4294967295,v=A+(k<<5&4294967295|k>>>27),k=P+(A^S&(v^A))+I[14]+3275163606&4294967295,P=v+(k<<9&4294967295|k>>>23),k=S+(v^A&(P^v))+I[3]+4107603335&4294967295,S=P+(k<<14&4294967295|k>>>18),k=A+(P^v&(S^P))+I[8]+1163531501&4294967295,A=S+(k<<20&4294967295|k>>>12),k=v+(S^P&(A^S))+I[13]+2850285829&4294967295,v=A+(k<<5&4294967295|k>>>27),k=P+(A^S&(v^A))+I[2]+4243563512&4294967295,P=v+(k<<9&4294967295|k>>>23),k=S+(v^A&(P^v))+I[7]+1735328473&4294967295,S=P+(k<<14&4294967295|k>>>18),k=A+(P^v&(S^P))+I[12]+2368359562&4294967295,A=S+(k<<20&4294967295|k>>>12),k=v+(A^S^P)+I[5]+4294588738&4294967295,v=A+(k<<4&4294967295|k>>>28),k=P+(v^A^S)+I[8]+2272392833&4294967295,P=v+(k<<11&4294967295|k>>>21),k=S+(P^v^A)+I[11]+1839030562&4294967295,S=P+(k<<16&4294967295|k>>>16),k=A+(S^P^v)+I[14]+4259657740&4294967295,A=S+(k<<23&4294967295|k>>>9),k=v+(A^S^P)+I[1]+2763975236&4294967295,v=A+(k<<4&4294967295|k>>>28),k=P+(v^A^S)+I[4]+1272893353&4294967295,P=v+(k<<11&4294967295|k>>>21),k=S+(P^v^A)+I[7]+4139469664&4294967295,S=P+(k<<16&4294967295|k>>>16),k=A+(S^P^v)+I[10]+3200236656&4294967295,A=S+(k<<23&4294967295|k>>>9),k=v+(A^S^P)+I[13]+681279174&4294967295,v=A+(k<<4&4294967295|k>>>28),k=P+(v^A^S)+I[0]+3936430074&4294967295,P=v+(k<<11&4294967295|k>>>21),k=S+(P^v^A)+I[3]+3572445317&4294967295,S=P+(k<<16&4294967295|k>>>16),k=A+(S^P^v)+I[6]+76029189&4294967295,A=S+(k<<23&4294967295|k>>>9),k=v+(A^S^P)+I[9]+3654602809&4294967295,v=A+(k<<4&4294967295|k>>>28),k=P+(v^A^S)+I[12]+3873151461&4294967295,P=v+(k<<11&4294967295|k>>>21),k=S+(P^v^A)+I[15]+530742520&4294967295,S=P+(k<<16&4294967295|k>>>16),k=A+(S^P^v)+I[2]+3299628645&4294967295,A=S+(k<<23&4294967295|k>>>9),k=v+(S^(A|~P))+I[0]+4096336452&4294967295,v=A+(k<<6&4294967295|k>>>26),k=P+(A^(v|~S))+I[7]+1126891415&4294967295,P=v+(k<<10&4294967295|k>>>22),k=S+(v^(P|~A))+I[14]+2878612391&4294967295,S=P+(k<<15&4294967295|k>>>17),k=A+(P^(S|~v))+I[5]+4237533241&4294967295,A=S+(k<<21&4294967295|k>>>11),k=v+(S^(A|~P))+I[12]+1700485571&4294967295,v=A+(k<<6&4294967295|k>>>26),k=P+(A^(v|~S))+I[3]+2399980690&4294967295,P=v+(k<<10&4294967295|k>>>22),k=S+(v^(P|~A))+I[10]+4293915773&4294967295,S=P+(k<<15&4294967295|k>>>17),k=A+(P^(S|~v))+I[1]+2240044497&4294967295,A=S+(k<<21&4294967295|k>>>11),k=v+(S^(A|~P))+I[8]+1873313359&4294967295,v=A+(k<<6&4294967295|k>>>26),k=P+(A^(v|~S))+I[15]+4264355552&4294967295,P=v+(k<<10&4294967295|k>>>22),k=S+(v^(P|~A))+I[6]+2734768916&4294967295,S=P+(k<<15&4294967295|k>>>17),k=A+(P^(S|~v))+I[13]+1309151649&4294967295,A=S+(k<<21&4294967295|k>>>11),k=v+(S^(A|~P))+I[4]+4149444226&4294967295,v=A+(k<<6&4294967295|k>>>26),k=P+(A^(v|~S))+I[11]+3174756917&4294967295,P=v+(k<<10&4294967295|k>>>22),k=S+(v^(P|~A))+I[2]+718787259&4294967295,S=P+(k<<15&4294967295|k>>>17),k=A+(P^(S|~v))+I[9]+3951481745&4294967295,C.g[0]=C.g[0]+v&4294967295,C.g[1]=C.g[1]+(S+(k<<21&4294967295|k>>>11))&4294967295,C.g[2]=C.g[2]+S&4294967295,C.g[3]=C.g[3]+P&4294967295}r.prototype.u=function(C,v){v===void 0&&(v=C.length);for(var A=v-this.blockSize,I=this.B,S=this.h,P=0;P<v;){if(S==0)for(;P<=A;)i(this,C,P),P+=this.blockSize;if(typeof C=="string"){for(;P<v;)if(I[S++]=C.charCodeAt(P++),S==this.blockSize){i(this,I),S=0;break}}else for(;P<v;)if(I[S++]=C[P++],S==this.blockSize){i(this,I),S=0;break}}this.h=S,this.o+=v},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var v=1;v<C.length-8;++v)C[v]=0;var A=8*this.o;for(v=C.length-8;v<C.length;++v)C[v]=A&255,A/=256;for(this.u(C),C=Array(16),v=A=0;4>v;++v)for(var I=0;32>I;I+=8)C[A++]=this.g[v]>>>I&255;return C};function s(C,v){var A=a;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=v(C)}function o(C,v){this.h=v;for(var A=[],I=!0,S=C.length-1;0<=S;S--){var P=C[S]|0;I&&P==v||(A[S]=P,I=!1)}this.g=A}var a={};function l(C){return-128<=C&&128>C?s(C,function(v){return new o([v|0],0>v?-1:0)}):new o([C|0],0>C?-1:0)}function c(C){if(isNaN(C)||!isFinite(C))return f;if(0>C)return b(c(-C));for(var v=[],A=1,I=0;C>=A;I++)v[I]=C/A|0,A*=4294967296;return new o(v,0)}function d(C,v){if(C.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(C.charAt(0)=="-")return b(d(C.substring(1),v));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(v,8)),I=f,S=0;S<C.length;S+=8){var P=Math.min(8,C.length-S),k=parseInt(C.substring(S,S+P),v);8>P?(P=c(Math.pow(v,P)),I=I.j(P).add(c(k))):(I=I.j(A),I=I.add(c(k)))}return I}var f=l(0),h=l(1),p=l(16777216);t=o.prototype,t.m=function(){if(g(this))return-b(this).m();for(var C=0,v=1,A=0;A<this.g.length;A++){var I=this.i(A);C+=(0<=I?I:4294967296+I)*v,v*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(m(this))return"0";if(g(this))return"-"+b(this).toString(C);for(var v=c(Math.pow(C,6)),A=this,I="";;){var S=E(A,v).g;A=x(A,S.j(v));var P=((0<A.g.length?A.g[0]:A.h)>>>0).toString(C);if(A=S,m(A))return P+I;for(;6>P.length;)P="0"+P;I=P+I}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function m(C){if(C.h!=0)return!1;for(var v=0;v<C.g.length;v++)if(C.g[v]!=0)return!1;return!0}function g(C){return C.h==-1}t.l=function(C){return C=x(this,C),g(C)?-1:m(C)?0:1};function b(C){for(var v=C.g.length,A=[],I=0;I<v;I++)A[I]=~C.g[I];return new o(A,~C.h).add(h)}t.abs=function(){return g(this)?b(this):this},t.add=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],I=0,S=0;S<=v;S++){var P=I+(this.i(S)&65535)+(C.i(S)&65535),k=(P>>>16)+(this.i(S)>>>16)+(C.i(S)>>>16);I=k>>>16,P&=65535,k&=65535,A[S]=k<<16|P}return new o(A,A[A.length-1]&-2147483648?-1:0)};function x(C,v){return C.add(b(v))}t.j=function(C){if(m(this)||m(C))return f;if(g(this))return g(C)?b(this).j(b(C)):b(b(this).j(C));if(g(C))return b(this.j(b(C)));if(0>this.l(p)&&0>C.l(p))return c(this.m()*C.m());for(var v=this.g.length+C.g.length,A=[],I=0;I<2*v;I++)A[I]=0;for(I=0;I<this.g.length;I++)for(var S=0;S<C.g.length;S++){var P=this.i(I)>>>16,k=this.i(I)&65535,F=C.i(S)>>>16,q=C.i(S)&65535;A[2*I+2*S]+=k*q,w(A,2*I+2*S),A[2*I+2*S+1]+=P*q,w(A,2*I+2*S+1),A[2*I+2*S+1]+=k*F,w(A,2*I+2*S+1),A[2*I+2*S+2]+=P*F,w(A,2*I+2*S+2)}for(I=0;I<v;I++)A[I]=A[2*I+1]<<16|A[2*I];for(I=v;I<2*v;I++)A[I]=0;return new o(A,0)};function w(C,v){for(;(C[v]&65535)!=C[v];)C[v+1]+=C[v]>>>16,C[v]&=65535,v++}function N(C,v){this.g=C,this.h=v}function E(C,v){if(m(v))throw Error("division by zero");if(m(C))return new N(f,f);if(g(C))return v=E(b(C),v),new N(b(v.g),b(v.h));if(g(v))return v=E(C,b(v)),new N(b(v.g),v.h);if(30<C.g.length){if(g(C)||g(v))throw Error("slowDivide_ only works with positive integers.");for(var A=h,I=v;0>=I.l(C);)A=D(A),I=D(I);var S=j(A,1),P=j(I,1);for(I=j(I,2),A=j(A,2);!m(I);){var k=P.add(I);0>=k.l(C)&&(S=S.add(A),P=k),I=j(I,1),A=j(A,1)}return v=x(C,S.j(v)),new N(S,v)}for(S=f;0<=C.l(v);){for(A=Math.max(1,Math.floor(C.m()/v.m())),I=Math.ceil(Math.log(A)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),P=c(A),k=P.j(v);g(k)||0<k.l(C);)A-=I,P=c(A),k=P.j(v);m(P)&&(P=h),S=S.add(P),C=x(C,k)}return new N(S,C)}t.A=function(C){return E(this,C).h},t.and=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],I=0;I<v;I++)A[I]=this.i(I)&C.i(I);return new o(A,this.h&C.h)},t.or=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],I=0;I<v;I++)A[I]=this.i(I)|C.i(I);return new o(A,this.h|C.h)},t.xor=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],I=0;I<v;I++)A[I]=this.i(I)^C.i(I);return new o(A,this.h^C.h)};function D(C){for(var v=C.g.length+1,A=[],I=0;I<v;I++)A[I]=C.i(I)<<1|C.i(I-1)>>>31;return new o(A,C.h)}function j(C,v){var A=v>>5;v%=32;for(var I=C.g.length-A,S=[],P=0;P<I;P++)S[P]=0<v?C.i(P+A)>>>v|C.i(P+A+1)<<32-v:C.i(P+A);return new o(S,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,ck=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Zu=o}).apply(typeof WN<"u"?WN:typeof self<"u"?self:typeof window<"u"?window:{});var eg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uk,a0,dk,$g,Ob,hk,fk,pk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,U,G){return _==Array.prototype||_==Object.prototype||(_[U]=G.value),_};function n(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof eg=="object"&&eg];for(var U=0;U<_.length;++U){var G=_[U];if(G&&G.Math==Math)return G}throw Error("Cannot find global object")}var r=n(this);function i(_,U){if(U)e:{var G=r;_=_.split(".");for(var ee=0;ee<_.length-1;ee++){var be=_[ee];if(!(be in G))break e;G=G[be]}_=_[_.length-1],ee=G[_],U=U(ee),U!=ee&&U!=null&&e(G,_,{configurable:!0,writable:!0,value:U})}}function s(_,U){_ instanceof String&&(_+="");var G=0,ee=!1,be={next:function(){if(!ee&&G<_.length){var Pe=G++;return{value:U(Pe,_[Pe]),done:!1}}return ee=!0,{done:!0,value:void 0}}};return be[Symbol.iterator]=function(){return be},be}i("Array.prototype.values",function(_){return _||function(){return s(this,function(U,G){return G})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(_){var U=typeof _;return U=U!="object"?U:_?Array.isArray(_)?"array":U:"null",U=="array"||U=="object"&&typeof _.length=="number"}function c(_){var U=typeof _;return U=="object"&&_!=null||U=="function"}function d(_,U,G){return _.call.apply(_.bind,arguments)}function f(_,U,G){if(!_)throw Error();if(2<arguments.length){var ee=Array.prototype.slice.call(arguments,2);return function(){var be=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(be,ee),_.apply(U,be)}}return function(){return _.apply(U,arguments)}}function h(_,U,G){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,h.apply(null,arguments)}function p(_,U){var G=Array.prototype.slice.call(arguments,1);return function(){var ee=G.slice();return ee.push.apply(ee,arguments),_.apply(this,ee)}}function m(_,U){function G(){}G.prototype=U.prototype,_.aa=U.prototype,_.prototype=new G,_.prototype.constructor=_,_.Qb=function(ee,be,Pe){for(var We=Array(arguments.length-2),Ft=2;Ft<arguments.length;Ft++)We[Ft-2]=arguments[Ft];return U.prototype[be].apply(ee,We)}}function g(_){const U=_.length;if(0<U){const G=Array(U);for(let ee=0;ee<U;ee++)G[ee]=_[ee];return G}return[]}function b(_,U){for(let G=1;G<arguments.length;G++){const ee=arguments[G];if(l(ee)){const be=_.length||0,Pe=ee.length||0;_.length=be+Pe;for(let We=0;We<Pe;We++)_[be+We]=ee[We]}else _.push(ee)}}class x{constructor(U,G){this.i=U,this.j=G,this.h=0,this.g=null}get(){let U;return 0<this.h?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function w(_){return/^[\s\xa0]*$/.test(_)}function N(){var _=a.navigator;return _&&(_=_.userAgent)?_:""}function E(_){return E[" "](_),_}E[" "]=function(){};var D=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function j(_,U,G){for(const ee in _)U.call(G,_[ee],ee,_)}function C(_,U){for(const G in _)U.call(void 0,_[G],G,_)}function v(_){const U={};for(const G in _)U[G]=_[G];return U}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(_,U){let G,ee;for(let be=1;be<arguments.length;be++){ee=arguments[be];for(G in ee)_[G]=ee[G];for(let Pe=0;Pe<A.length;Pe++)G=A[Pe],Object.prototype.hasOwnProperty.call(ee,G)&&(_[G]=ee[G])}}function S(_){var U=1;_=_.split(":");const G=[];for(;0<U&&_.length;)G.push(_.shift()),U--;return _.length&&G.push(_.join(":")),G}function P(_){a.setTimeout(()=>{throw _},0)}function k(){var _=z;let U=null;return _.g&&(U=_.g,_.g=_.g.next,_.g||(_.h=null),U.next=null),U}class F{constructor(){this.h=this.g=null}add(U,G){const ee=q.get();ee.set(U,G),this.h?this.h.next=ee:this.g=ee,this.h=ee}}var q=new x(()=>new O,_=>_.reset());class O{constructor(){this.next=this.g=this.h=null}set(U,G){this.h=U,this.g=G,this.next=null}reset(){this.next=this.g=this.h=null}}let M,W=!1,z=new F,J=()=>{const _=a.Promise.resolve(void 0);M=()=>{_.then(ne)}};var ne=()=>{for(var _;_=k();){try{_.h.call(_.g)}catch(G){P(G)}var U=q;U.j(_),100>U.h&&(U.h++,_.next=U.g,U.g=_)}W=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(_,U){this.type=_,this.g=this.target=U,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,U=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const G=()=>{};a.addEventListener("test",G,U),a.removeEventListener("test",G,U)}catch{}return _}();function X(_,U){if($.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var G=this.type=_.type,ee=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=U,U=_.relatedTarget){if(D){e:{try{E(U.nodeName);var be=!0;break e}catch{}be=!1}be||(U=null)}}else G=="mouseover"?U=_.fromElement:G=="mouseout"&&(U=_.toElement);this.relatedTarget=U,ee?(this.clientX=ee.clientX!==void 0?ee.clientX:ee.pageX,this.clientY=ee.clientY!==void 0?ee.clientY:ee.pageY,this.screenX=ee.screenX||0,this.screenY=ee.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:ae[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&X.aa.h.call(this)}}m(X,$);var ae={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),me=0;function _e(_,U,G,ee,be){this.listener=_,this.proxy=null,this.src=U,this.type=G,this.capture=!!ee,this.ha=be,this.key=++me,this.da=this.fa=!1}function Se(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function Ce(_){this.src=_,this.g={},this.h=0}Ce.prototype.add=function(_,U,G,ee,be){var Pe=_.toString();_=this.g[Pe],_||(_=this.g[Pe]=[],this.h++);var We=$e(_,U,ee,be);return-1<We?(U=_[We],G||(U.fa=!1)):(U=new _e(U,this.src,Pe,!!ee,be),U.fa=G,_.push(U)),U};function ze(_,U){var G=U.type;if(G in _.g){var ee=_.g[G],be=Array.prototype.indexOf.call(ee,U,void 0),Pe;(Pe=0<=be)&&Array.prototype.splice.call(ee,be,1),Pe&&(Se(U),_.g[G].length==0&&(delete _.g[G],_.h--))}}function $e(_,U,G,ee){for(var be=0;be<_.length;++be){var Pe=_[be];if(!Pe.da&&Pe.listener==U&&Pe.capture==!!G&&Pe.ha==ee)return be}return-1}var dt="closure_lm_"+(1e6*Math.random()|0),Ie={};function fe(_,U,G,ee,be){if(Array.isArray(U)){for(var Pe=0;Pe<U.length;Pe++)fe(_,U[Pe],G,ee,be);return null}return G=Dt(G),_&&_[ye]?_.K(U,G,c(ee)?!!ee.capture:!!ee,be):yt(_,U,G,!1,ee,be)}function yt(_,U,G,ee,be,Pe){if(!U)throw Error("Invalid event type");var We=c(be)?!!be.capture:!!be,Ft=ut(_);if(Ft||(_[dt]=Ft=new Ce(_)),G=Ft.add(U,G,ee,We,Pe),G.proxy)return G;if(ee=nt(),G.proxy=ee,ee.src=_,ee.listener=G,_.addEventListener)K||(be=We),be===void 0&&(be=!1),_.addEventListener(U.toString(),ee,be);else if(_.attachEvent)_.attachEvent(Ye(U.toString()),ee);else if(_.addListener&&_.removeListener)_.addListener(ee);else throw Error("addEventListener and attachEvent are unavailable.");return G}function nt(){function _(G){return U.call(_.src,_.listener,G)}const U=Je;return _}function qe(_,U,G,ee,be){if(Array.isArray(U))for(var Pe=0;Pe<U.length;Pe++)qe(_,U[Pe],G,ee,be);else ee=c(ee)?!!ee.capture:!!ee,G=Dt(G),_&&_[ye]?(_=_.i,U=String(U).toString(),U in _.g&&(Pe=_.g[U],G=$e(Pe,G,ee,be),-1<G&&(Se(Pe[G]),Array.prototype.splice.call(Pe,G,1),Pe.length==0&&(delete _.g[U],_.h--)))):_&&(_=ut(_))&&(U=_.g[U.toString()],_=-1,U&&(_=$e(U,G,ee,be)),(G=-1<_?U[_]:null)&&Xe(G))}function Xe(_){if(typeof _!="number"&&_&&!_.da){var U=_.src;if(U&&U[ye])ze(U.i,_);else{var G=_.type,ee=_.proxy;U.removeEventListener?U.removeEventListener(G,ee,_.capture):U.detachEvent?U.detachEvent(Ye(G),ee):U.addListener&&U.removeListener&&U.removeListener(ee),(G=ut(U))?(ze(G,_),G.h==0&&(G.src=null,U[dt]=null)):Se(_)}}}function Ye(_){return _ in Ie?Ie[_]:Ie[_]="on"+_}function Je(_,U){if(_.da)_=!0;else{U=new X(U,this);var G=_.listener,ee=_.ha||_.src;_.fa&&Xe(_),_=G.call(ee,U)}return _}function ut(_){return _=_[dt],_ instanceof Ce?_:null}var mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dt(_){return typeof _=="function"?_:(_[mt]||(_[mt]=function(U){return _.handleEvent(U)}),_[mt])}function _t(){V.call(this),this.i=new Ce(this),this.M=this,this.F=null}m(_t,V),_t.prototype[ye]=!0,_t.prototype.removeEventListener=function(_,U,G,ee){qe(this,_,U,G,ee)};function Mt(_,U){var G,ee=_.F;if(ee)for(G=[];ee;ee=ee.F)G.push(ee);if(_=_.M,ee=U.type||U,typeof U=="string")U=new $(U,_);else if(U instanceof $)U.target=U.target||_;else{var be=U;U=new $(ee,_),I(U,be)}if(be=!0,G)for(var Pe=G.length-1;0<=Pe;Pe--){var We=U.g=G[Pe];be=Ht(We,ee,!0,U)&&be}if(We=U.g=_,be=Ht(We,ee,!0,U)&&be,be=Ht(We,ee,!1,U)&&be,G)for(Pe=0;Pe<G.length;Pe++)We=U.g=G[Pe],be=Ht(We,ee,!1,U)&&be}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var _=this.i,U;for(U in _.g){for(var G=_.g[U],ee=0;ee<G.length;ee++)Se(G[ee]);delete _.g[U],_.h--}}this.F=null},_t.prototype.K=function(_,U,G,ee){return this.i.add(String(_),U,!1,G,ee)},_t.prototype.L=function(_,U,G,ee){return this.i.add(String(_),U,!0,G,ee)};function Ht(_,U,G,ee){if(U=_.i.g[String(U)],!U)return!0;U=U.concat();for(var be=!0,Pe=0;Pe<U.length;++Pe){var We=U[Pe];if(We&&!We.da&&We.capture==G){var Ft=We.listener,rn=We.ha||We.src;We.fa&&ze(_.i,We),be=Ft.call(rn,ee)!==!1&&be}}return be&&!ee.defaultPrevented}function Rt(_,U,G){if(typeof _=="function")G&&(_=h(_,G));else if(_&&typeof _.handleEvent=="function")_=h(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(U)?-1:a.setTimeout(_,U||0)}function Ot(_){_.g=Rt(()=>{_.g=null,_.i&&(_.i=!1,Ot(_))},_.l);const U=_.h;_.h=null,_.m.apply(null,U)}class at extends V{constructor(U,G){super(),this.m=U,this.l=G,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cn(_){V.call(this),this.h=_,this.g={}}m(cn,V);var Yt=[];function Rn(_){j(_.g,function(U,G){this.g.hasOwnProperty(G)&&Xe(U)},_),_.g={}}cn.prototype.N=function(){cn.aa.N.call(this),Rn(this)},cn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nn=a.JSON.stringify,An=a.JSON.parse,Zr=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function sn(){}sn.prototype.h=null;function ui(_){return _.h||(_.h=_.i())}function yn(){}var mr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xn(){$.call(this,"d")}m(Xn,$);function pn(){$.call(this,"c")}m(pn,$);var Et={},on=null;function Hr(){return on=on||new _t}Et.La="serverreachability";function In(_){$.call(this,Et.La,_)}m(In,$);function Hn(_){const U=Hr();Mt(U,new In(U))}Et.STAT_EVENT="statevent";function di(_,U){$.call(this,Et.STAT_EVENT,_),this.stat=U}m(di,$);function Nt(_){const U=Hr();Mt(U,new di(U,_))}Et.Ma="timingevent";function Wr(_,U){$.call(this,Et.Ma,_),this.size=U}m(Wr,$);function Cn(_,U){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},U)}function Fn(){this.g=!0}Fn.prototype.xa=function(){this.g=!1};function sr(_,U,G,ee,be,Pe){_.info(function(){if(_.g)if(Pe)for(var We="",Ft=Pe.split("&"),rn=0;rn<Ft.length;rn++){var Wt=Ft[rn].split("=");if(1<Wt.length){var Pn=Wt[0];Wt=Wt[1];var Mn=Pn.split("_");We=2<=Mn.length&&Mn[1]=="type"?We+(Pn+"="+Wt+"&"):We+(Pn+"=redacted&")}}else We=null;else We=Pe;return"XMLHTTP REQ ("+ee+") [attempt "+be+"]: "+U+`
`+G+`
`+We})}function tr(_,U,G,ee,be,Pe,We){_.info(function(){return"XMLHTTP RESP ("+ee+") [ attempt "+be+"]: "+U+`
`+G+`
`+Pe+" "+We})}function Pr(_,U,G,ee){_.info(function(){return"XMLHTTP TEXT ("+U+"): "+Ds(_,G)+(ee?" "+ee:"")})}function sa(_,U){_.info(function(){return"TIMEOUT: "+U})}Fn.prototype.info=function(){};function Ds(_,U){if(!_.g)return U;if(!U)return null;try{var G=JSON.parse(U);if(G){for(_=0;_<G.length;_++)if(Array.isArray(G[_])){var ee=G[_];if(!(2>ee.length)){var be=ee[1];if(Array.isArray(be)&&!(1>be.length)){var Pe=be[0];if(Pe!="noop"&&Pe!="stop"&&Pe!="close")for(var We=1;We<be.length;We++)be[We]=""}}}}return nn(G)}catch{return U}}var hi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Mi={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wi;function fi(){}m(fi,sn),fi.prototype.g=function(){return new XMLHttpRequest},fi.prototype.i=function(){return{}},wi=new fi;function gr(_,U,G,ee){this.j=_,this.i=U,this.l=G,this.R=ee||1,this.U=new cn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _i}function _i(){this.i=null,this.g="",this.h=!1}var Bi={},Rs={};function to(_,U,G){_.L=1,_.v=so(Ni(U)),_.m=G,_.P=!0,no(_,null)}function no(_,U){_.F=Date.now(),oa(_),_.A=Ni(_.v);var G=_.A,ee=_.R;Array.isArray(ee)||(ee=[String(ee)]),Qt(G.i,"t",ee),_.C=0,G=_.j.J,_.h=new _i,_.g=Q(_.j,G?U:null,!_.m),0<_.O&&(_.M=new at(h(_.Y,_,_.g),_.O)),U=_.U,G=_.g,ee=_.ca;var be="readystatechange";Array.isArray(be)||(be&&(Yt[0]=be.toString()),be=Yt);for(var Pe=0;Pe<be.length;Pe++){var We=fe(G,be[Pe],ee||U.handleEvent,!1,U.h||U);if(!We)break;U.g[We.key]=We}U=_.H?v(_.H):{},_.m?(_.u||(_.u="POST"),U["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,U)):(_.u="GET",_.g.ea(_.A,_.u,null,U)),Hn(),sr(_.i,_.u,_.A,_.l,_.R,_.m)}gr.prototype.ca=function(_){_=_.target;const U=this.M;U&&oe(_)==3?U.j():this.Y(_)},gr.prototype.Y=function(_){try{if(_==this.g)e:{const Mn=oe(this.g);var U=this.g.Ba();const Os=this.g.Z();if(!(3>Mn)&&(Mn!=3||this.g&&(this.h.h||this.g.oa()||ge(this.g)))){this.J||Mn!=4||U==7||(U==8||0>=Os?Hn(3):Hn(2)),Fs(this);var G=this.g.Z();this.X=G;t:if(To(this)){var ee=ge(this.g);_="";var be=ee.length,Pe=oe(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ls(this),ro(this);var We="";break t}this.h.i=new a.TextDecoder}for(U=0;U<be;U++)this.h.h=!0,_+=this.h.i.decode(ee[U],{stream:!(Pe&&U==be-1)});ee.length=0,this.h.g+=_,this.C=0,We=this.h.g}else We=this.g.oa();if(this.o=G==200,tr(this.i,this.u,this.A,this.l,this.R,Mn,G),this.o){if(this.T&&!this.K){t:{if(this.g){var Ft,rn=this.g;if((Ft=rn.g?rn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ft)){var Wt=Ft;break t}}Wt=null}if(G=Wt)Pr(this.i,this.l,G,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,io(this,G);else{this.o=!1,this.s=3,Nt(12),Ls(this),ro(this);break e}}if(this.P){G=!0;let kr;for(;!this.J&&this.C<We.length;)if(kr=$l(this,We),kr==Rs){Mn==4&&(this.s=4,Nt(14),G=!1),Pr(this.i,this.l,null,"[Incomplete Response]");break}else if(kr==Bi){this.s=4,Nt(15),Pr(this.i,this.l,We,"[Invalid Chunk]"),G=!1;break}else Pr(this.i,this.l,kr,null),io(this,kr);if(To(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mn!=4||We.length!=0||this.h.h||(this.s=1,Nt(16),G=!1),this.o=this.o&&G,!G)Pr(this.i,this.l,We,"[Invalid Chunked Response]"),Ls(this),ro(this);else if(0<We.length&&!this.W){this.W=!0;var Pn=this.j;Pn.g==this&&Pn.ba&&!Pn.M&&(Pn.j.info("Great, no buffering proxy detected. Bytes received: "+We.length),$t(Pn),Pn.M=!0,Nt(11))}}else Pr(this.i,this.l,We,null),io(this,We);Mn==4&&Ls(this),this.o&&!this.J&&(Mn==4?Ut(this.j,this):(this.o=!1,oa(this)))}else de(this.g),G==400&&0<We.indexOf("Unknown SID")?(this.s=3,Nt(12)):(this.s=0,Nt(13)),Ls(this),ro(this)}}}catch{}finally{}};function To(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function $l(_,U){var G=_.C,ee=U.indexOf(`
`,G);return ee==-1?Rs:(G=Number(U.substring(G,ee)),isNaN(G)?Bi:(ee+=1,ee+G>U.length?Rs:(U=U.slice(ee,ee+G),_.C=ee+G,U)))}gr.prototype.cancel=function(){this.J=!0,Ls(this)};function oa(_){_.S=Date.now()+_.I,Wa(_,_.I)}function Wa(_,U){if(_.B!=null)throw Error("WatchDog timer not null");_.B=Cn(h(_.ba,_),U)}function Fs(_){_.B&&(a.clearTimeout(_.B),_.B=null)}gr.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(sa(this.i,this.A),this.L!=2&&(Hn(),Nt(17)),Ls(this),this.s=2,ro(this)):Wa(this,this.S-_)};function ro(_){_.j.G==0||_.J||Ut(_.j,_)}function Ls(_){Fs(_);var U=_.M;U&&typeof U.ma=="function"&&U.ma(),_.M=null,Rn(_.U),_.g&&(U=_.g,_.g=null,U.abort(),U.ma())}function io(_,U){try{var G=_.j;if(G.G!=0&&(G.g==_||Ga(G.h,_))){if(!_.K&&Ga(G.h,_)&&G.G==3){try{var ee=G.Da.g.parse(U)}catch{ee=null}if(Array.isArray(ee)&&ee.length==3){var be=ee;if(be[0]==0){e:if(!G.u){if(G.g)if(G.g.F+3e3<_.F)st(G),Ve(G);else break e;St(G),Nt(18)}}else G.za=be[1],0<G.za-G.T&&37500>be[2]&&G.F&&G.v==0&&!G.C&&(G.C=Cn(h(G.Za,G),6e3));if(1>=Io(G.h)&&G.ca){try{G.ca()}catch{}G.ca=void 0}}else Pt(G,11)}else if((_.K||G.g==_)&&st(G),!w(U))for(be=G.Da.g.parse(U),U=0;U<be.length;U++){let Wt=be[U];if(G.T=Wt[0],Wt=Wt[1],G.G==2)if(Wt[0]=="c"){G.K=Wt[1],G.ia=Wt[2];const Pn=Wt[3];Pn!=null&&(G.la=Pn,G.j.info("VER="+G.la));const Mn=Wt[4];Mn!=null&&(G.Aa=Mn,G.j.info("SVER="+G.Aa));const Os=Wt[5];Os!=null&&typeof Os=="number"&&0<Os&&(ee=1.5*Os,G.L=ee,G.j.info("backChannelRequestTimeoutMs_="+ee)),ee=G;const kr=_.g;if(kr){const uo=kr.g?kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(uo){var Pe=ee.h;Pe.g||uo.indexOf("spdy")==-1&&uo.indexOf("quic")==-1&&uo.indexOf("h2")==-1||(Pe.j=Pe.l,Pe.g=new Set,Pe.h&&(nr(Pe,Pe.h),Pe.h=null))}if(ee.D){const Vs=kr.g?kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vs&&(ee.ya=Vs,Ln(ee.I,ee.D,Vs))}}G.G=3,G.l&&G.l.ua(),G.ba&&(G.R=Date.now()-_.F,G.j.info("Handshake RTT: "+G.R+"ms")),ee=G;var We=_;if(ee.qa=R(ee,ee.J?ee.ia:null,ee.W),We.K){Ka(ee.h,We);var Ft=We,rn=ee.L;rn&&(Ft.I=rn),Ft.B&&(Fs(Ft),oa(Ft)),ee.g=We}else gt(ee);0<G.i.length&&et(G)}else Wt[0]!="stop"&&Wt[0]!="close"||Pt(G,7);else G.G==3&&(Wt[0]=="stop"||Wt[0]=="close"?Wt[0]=="stop"?Pt(G,7):Le(G):Wt[0]!="noop"&&G.l&&G.l.ta(Wt),G.v=0)}}Hn(4)}catch{}}var Gl=class{constructor(_,U){this.g=_,this.map=U}};function $a(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kl(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function Io(_){return _.h?1:_.g?_.g.size:0}function Ga(_,U){return _.h?_.h==U:_.g?_.g.has(U):!1}function nr(_,U){_.g?_.g.add(U):_.h=U}function Ka(_,U){_.h&&_.h==U?_.h=null:_.g&&_.g.has(U)&&_.g.delete(U)}$a.prototype.cancel=function(){if(this.i=Qa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Qa(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let U=_.i;for(const G of _.g.values())U=U.concat(G.D);return U}return g(_.i)}function Ql(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(l(_)){for(var U=[],G=_.length,ee=0;ee<G;ee++)U.push(_[ee]);return U}U=[],G=0;for(ee in _)U[G++]=_[ee];return U}function Ya(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(l(_)||typeof _=="string"){var U=[];_=_.length;for(var G=0;G<_;G++)U.push(G);return U}U=[],G=0;for(const ee in _)U[G++]=ee;return U}}}function Yl(_,U){if(_.forEach&&typeof _.forEach=="function")_.forEach(U,void 0);else if(l(_)||typeof _=="string")Array.prototype.forEach.call(_,U,void 0);else for(var G=Ya(_),ee=Ql(_),be=ee.length,Pe=0;Pe<be;Pe++)U.call(void 0,ee[Pe],G&&G[Pe],_)}var Oi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jo(_,U){if(_){_=_.split("&");for(var G=0;G<_.length;G++){var ee=_[G].indexOf("="),be=null;if(0<=ee){var Pe=_[G].substring(0,ee);be=_[G].substring(ee+1)}else Pe=_[G];U(Pe,be?decodeURIComponent(be.replace(/\+/g," ")):"")}}}function xr(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof xr){this.h=_.h,Do(this,_.j),this.o=_.o,this.g=_.g,aa(this,_.s),this.l=_.l;var U=_.i,G=new ao;G.i=U.i,U.g&&(G.g=new Map(U.g),G.h=U.h),Xa(this,G),this.m=_.m}else _&&(U=String(_).match(Oi))?(this.h=!1,Do(this,U[1]||"",!0),this.o=oo(U[2]||""),this.g=oo(U[3]||"",!0),aa(this,U[4]),this.l=oo(U[5]||"",!0),Xa(this,U[6]||"",!0),this.m=oo(U[7]||"")):(this.h=!1,this.i=new ao(null,this.h))}xr.prototype.toString=function(){var _=[],U=this.j;U&&_.push(ms(U,Xl,!0),":");var G=this.g;return(G||U=="file")&&(_.push("//"),(U=this.o)&&_.push(ms(U,Xl,!0),"@"),_.push(encodeURIComponent(String(G)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),G=this.s,G!=null&&_.push(":",String(G))),(G=this.l)&&(this.g&&G.charAt(0)!="/"&&_.push("/"),_.push(ms(G,G.charAt(0)=="/"?gs:wu,!0))),(G=this.i.toString())&&_.push("?",G),(G=this.m)&&_.push("#",ms(G,ca)),_.join("")};function Ni(_){return new xr(_)}function Do(_,U,G){_.j=G?oo(U,!0):U,_.j&&(_.j=_.j.replace(/:$/,""))}function aa(_,U){if(U){if(U=Number(U),isNaN(U)||0>U)throw Error("Bad port number "+U);_.s=U}else _.s=null}function Xa(_,U,G){U instanceof ao?(_.i=U,Za(_.i,_.h)):(G||(U=ms(U,la)),_.i=new ao(U,_.h))}function Ln(_,U,G){_.i.set(U,G)}function so(_){return Ln(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function oo(_,U){return _?U?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function ms(_,U,G){return typeof _=="string"?(_=encodeURI(_).replace(U,bu),G&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function bu(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Xl=/[#\/\?@]/g,wu=/[#\?:]/g,gs=/[#\?]/g,la=/[#\?@]/g,ca=/#/g;function ao(_,U){this.h=this.g=null,this.i=_||null,this.j=!!U}function Jn(_){_.g||(_.g=new Map,_.h=0,_.i&&jo(_.i,function(U,G){_.add(decodeURIComponent(U.replace(/\+/g," ")),G)}))}t=ao.prototype,t.add=function(_,U){Jn(this),this.i=null,_=lo(this,_);var G=this.g.get(_);return G||this.g.set(_,G=[]),G.push(U),this.h+=1,this};function Jl(_,U){Jn(_),U=lo(_,U),_.g.has(U)&&(_.i=null,_.h-=_.g.get(U).length,_.g.delete(U))}function Ja(_,U){return Jn(_),U=lo(_,U),_.g.has(U)}t.forEach=function(_,U){Jn(this),this.g.forEach(function(G,ee){G.forEach(function(be){_.call(U,be,ee,this)},this)},this)},t.na=function(){Jn(this);const _=Array.from(this.g.values()),U=Array.from(this.g.keys()),G=[];for(let ee=0;ee<U.length;ee++){const be=_[ee];for(let Pe=0;Pe<be.length;Pe++)G.push(U[ee])}return G},t.V=function(_){Jn(this);let U=[];if(typeof _=="string")Ja(this,_)&&(U=U.concat(this.g.get(lo(this,_))));else{_=Array.from(this.g.values());for(let G=0;G<_.length;G++)U=U.concat(_[G])}return U},t.set=function(_,U){return Jn(this),this.i=null,_=lo(this,_),Ja(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[U]),this.h+=1,this},t.get=function(_,U){return _?(_=this.V(_),0<_.length?String(_[0]):U):U};function Qt(_,U,G){Jl(_,U),0<G.length&&(_.i=null,_.g.set(lo(_,U),g(G)),_.h+=G.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],U=Array.from(this.g.keys());for(var G=0;G<U.length;G++){var ee=U[G];const Pe=encodeURIComponent(String(ee)),We=this.V(ee);for(ee=0;ee<We.length;ee++){var be=Pe;We[ee]!==""&&(be+="="+encodeURIComponent(String(We[ee]))),_.push(be)}}return this.i=_.join("&")};function lo(_,U){return U=String(U),_.j&&(U=U.toLowerCase()),U}function Za(_,U){U&&!_.j&&(Jn(_),_.i=null,_.g.forEach(function(G,ee){var be=ee.toLowerCase();ee!=be&&(Jl(this,ee),Qt(this,be,G))},_)),_.j=U}function ns(_,U){const G=new Fn;if(a.Image){const ee=new Image;ee.onload=p(Ai,G,"TestLoadImage: loaded",!0,U,ee),ee.onerror=p(Ai,G,"TestLoadImage: error",!1,U,ee),ee.onabort=p(Ai,G,"TestLoadImage: abort",!1,U,ee),ee.ontimeout=p(Ai,G,"TestLoadImage: timeout",!1,U,ee),a.setTimeout(function(){ee.ontimeout&&ee.ontimeout()},1e4),ee.src=_}else U(!1)}function Ro(_,U){const G=new Fn,ee=new AbortController,be=setTimeout(()=>{ee.abort(),Ai(G,"TestPingServer: timeout",!1,U)},1e4);fetch(_,{signal:ee.signal}).then(Pe=>{clearTimeout(be),Pe.ok?Ai(G,"TestPingServer: ok",!0,U):Ai(G,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(be),Ai(G,"TestPingServer: error",!1,U)})}function Ai(_,U,G,ee,be){try{be&&(be.onload=null,be.onerror=null,be.onabort=null,be.ontimeout=null),ee(G)}catch{}}function co(){this.g=new Zr}function ua(_,U,G){const ee=G||"";try{Yl(_,function(be,Pe){let We=be;c(be)&&(We=nn(be)),U.push(ee+Pe+"="+encodeURIComponent(We))})}catch(be){throw U.push(ee+"type="+encodeURIComponent("_badmap")),be}}function Fo(_){this.l=_.Ub||null,this.j=_.eb||!1}m(Fo,sn),Fo.prototype.g=function(){return new da(this.l,this.j)},Fo.prototype.i=function(_){return function(){return _}}({});function da(_,U){_t.call(this),this.D=_,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(da,_t),t=da.prototype,t.open=function(_,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=U,this.readyState=1,rs(this)},t.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const U={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(U.body=_),(this.D||a).fetch(new Request(this.A,U)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=0},t.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,rs(this)),this.g&&(this.readyState=3,rs(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ha(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function ha(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}t.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var U=_.value?_.value:new Uint8Array(0);(U=this.v.decode(U,{stream:!_.done}))&&(this.response=this.responseText+=U)}_.done?Ms(this):rs(this),this.readyState==3&&ha(this)}},t.Ra=function(_){this.g&&(this.response=this.responseText=_,Ms(this))},t.Qa=function(_){this.g&&(this.response=_,Ms(this))},t.ga=function(){this.g&&Ms(this)};function Ms(_){_.readyState=4,_.l=null,_.j=null,_.v=null,rs(_)}t.setRequestHeader=function(_,U){this.u.append(_,U)},t.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],U=this.h.entries();for(var G=U.next();!G.done;)G=G.value,_.push(G[0]+": "+G[1]),G=U.next();return _.join(`\r
`)};function rs(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(da.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function Bs(_){let U="";return j(_,function(G,ee){U+=ee,U+=":",U+=G,U+=`\r
`}),U}function fa(_,U,G){e:{for(ee in G){var ee=!1;break e}ee=!0}ee||(G=Bs(G),typeof _=="string"?G!=null&&encodeURIComponent(String(G)):Ln(_,U,G))}function jn(_){_t.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(jn,_t);var el=/^https?$/i,pa=["POST","PUT"];t=jn.prototype,t.Ha=function(_){this.J=_},t.ea=function(_,U,G,ee){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);U=U?U.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wi.g(),this.v=this.o?ui(this.o):ui(wi),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(U,String(_),!0),this.B=!1}catch(Pe){tl(this,Pe);return}if(_=G||"",G=new Map(this.headers),ee)if(Object.getPrototypeOf(ee)===Object.prototype)for(var be in ee)G.set(be,ee[be]);else if(typeof ee.keys=="function"&&typeof ee.get=="function")for(const Pe of ee.keys())G.set(Pe,ee.get(Pe));else throw Error("Unknown input type for opt_headers: "+String(ee));ee=Array.from(G.keys()).find(Pe=>Pe.toLowerCase()=="content-type"),be=a.FormData&&_ instanceof a.FormData,!(0<=Array.prototype.indexOf.call(pa,U,void 0))||ee||be||G.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Pe,We]of G)this.g.setRequestHeader(Pe,We);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{te(this),this.u=!0,this.g.send(_),this.u=!1}catch(Pe){tl(this,Pe)}};function tl(_,U){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=U,_.m=5,Lo(_),Y(_)}function Lo(_){_.A||(_.A=!0,Mt(_,"complete"),Mt(_,"error"))}t.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,Mt(this,"complete"),Mt(this,"abort"),Y(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Y(this,!0)),jn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?L(this):this.bb())},t.bb=function(){L(this)};function L(_){if(_.h&&typeof o<"u"&&(!_.v[1]||oe(_)!=4||_.Z()!=2)){if(_.u&&oe(_)==4)Rt(_.Ea,0,_);else if(Mt(_,"readystatechange"),oe(_)==4){_.h=!1;try{const We=_.Z();e:switch(We){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var G;if(!(G=U)){var ee;if(ee=We===0){var be=String(_.D).match(Oi)[1]||null;!be&&a.self&&a.self.location&&(be=a.self.location.protocol.slice(0,-1)),ee=!el.test(be?be.toLowerCase():"")}G=ee}if(G)Mt(_,"complete"),Mt(_,"success");else{_.m=6;try{var Pe=2<oe(_)?_.g.statusText:""}catch{Pe=""}_.l=Pe+" ["+_.Z()+"]",Lo(_)}}finally{Y(_)}}}}function Y(_,U){if(_.g){te(_);const G=_.g,ee=_.v[0]?()=>{}:null;_.g=null,_.v=null,U||Mt(_,"ready");try{G.onreadystatechange=ee}catch{}}}function te(_){_.I&&(a.clearTimeout(_.I),_.I=null)}t.isActive=function(){return!!this.g};function oe(_){return _.g?_.g.readyState:0}t.Z=function(){try{return 2<oe(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(_){if(this.g){var U=this.g.responseText;return _&&U.indexOf(_)==0&&(U=U.substring(_.length)),An(U)}};function ge(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function de(_){const U={};_=(_.g&&2<=oe(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let ee=0;ee<_.length;ee++){if(w(_[ee]))continue;var G=S(_[ee]);const be=G[0];if(G=G[1],typeof G!="string")continue;G=G.trim();const Pe=U[be]||[];U[be]=Pe,Pe.push(G)}C(U,function(ee){return ee.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xe(_,U,G){return G&&G.internalChannelParams&&G.internalChannelParams[_]||U}function Fe(_){this.Aa=0,this.i=[],this.j=new Fn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xe("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xe("baseRetryDelayMs",5e3,_),this.cb=xe("retryDelaySeedMs",1e4,_),this.Wa=xe("forwardChannelMaxRetries",2,_),this.wa=xe("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new $a(_&&_.concurrentRequestLimit),this.Da=new co,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Fe.prototype,t.la=8,t.G=1,t.connect=function(_,U,G,ee){Nt(0),this.W=_,this.H=U||{},G&&ee!==void 0&&(this.H.OSID=G,this.H.OAID=ee),this.F=this.X,this.I=R(this,null,this.W),et(this)};function Le(_){if(rt(_),_.G==3){var U=_.U++,G=Ni(_.I);if(Ln(G,"SID",_.K),Ln(G,"RID",U),Ln(G,"TYPE","terminate"),tt(_,G),U=new gr(_,_.j,U),U.L=2,U.v=so(Ni(G)),G=!1,a.navigator&&a.navigator.sendBeacon)try{G=a.navigator.sendBeacon(U.v.toString(),"")}catch{}!G&&a.Image&&(new Image().src=U.v,G=!0),G||(U.g=Q(U.j,null),U.g.ea(U.v)),U.F=Date.now(),oa(U)}Zt(_)}function Ve(_){_.g&&($t(_),_.g.cancel(),_.g=null)}function rt(_){Ve(_),_.u&&(a.clearTimeout(_.u),_.u=null),st(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&a.clearTimeout(_.s),_.s=null)}function et(_){if(!Kl(_.h)&&!_.s){_.s=!0;var U=_.Ga;M||J(),W||(M(),W=!0),z.add(U,_),_.B=0}}function it(_,U){return Io(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=U.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=Cn(h(_.Ga,_,U),bt(_,_.B)),_.B++,!0)}t.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const be=new gr(this,this.j,_);let Pe=this.o;if(this.S&&(Pe?(Pe=v(Pe),I(Pe,this.S)):Pe=this.S),this.m!==null||this.O||(be.H=Pe,Pe=null),this.P)e:{for(var U=0,G=0;G<this.i.length;G++){t:{var ee=this.i[G];if("__data__"in ee.map&&(ee=ee.map.__data__,typeof ee=="string")){ee=ee.length;break t}ee=void 0}if(ee===void 0)break;if(U+=ee,4096<U){U=G;break e}if(U===4096||G===this.i.length-1){U=G+1;break e}}U=1e3}else U=1e3;U=ht(this,be,U),G=Ni(this.I),Ln(G,"RID",_),Ln(G,"CVER",22),this.D&&Ln(G,"X-HTTP-Session-Id",this.D),tt(this,G),Pe&&(this.O?U="headers="+encodeURIComponent(String(Bs(Pe)))+"&"+U:this.m&&fa(G,this.m,Pe)),nr(this.h,be),this.Ua&&Ln(G,"TYPE","init"),this.P?(Ln(G,"$req",U),Ln(G,"SID","null"),be.T=!0,to(be,G,null)):to(be,G,U),this.G=2}}else this.G==3&&(_?He(this,_):this.i.length==0||Kl(this.h)||He(this))};function He(_,U){var G;U?G=U.l:G=_.U++;const ee=Ni(_.I);Ln(ee,"SID",_.K),Ln(ee,"RID",G),Ln(ee,"AID",_.T),tt(_,ee),_.m&&_.o&&fa(ee,_.m,_.o),G=new gr(_,_.j,G,_.B+1),_.m===null&&(G.H=_.o),U&&(_.i=U.D.concat(_.i)),U=ht(_,G,1e3),G.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),nr(_.h,G),to(G,ee,U)}function tt(_,U){_.H&&j(_.H,function(G,ee){Ln(U,ee,G)}),_.l&&Yl({},function(G,ee){Ln(U,ee,G)})}function ht(_,U,G){G=Math.min(_.i.length,G);var ee=_.l?h(_.l.Na,_.l,_):null;e:{var be=_.i;let Pe=-1;for(;;){const We=["count="+G];Pe==-1?0<G?(Pe=be[0].g,We.push("ofs="+Pe)):Pe=0:We.push("ofs="+Pe);let Ft=!0;for(let rn=0;rn<G;rn++){let Wt=be[rn].g;const Pn=be[rn].map;if(Wt-=Pe,0>Wt)Pe=Math.max(0,be[rn].g-100),Ft=!1;else try{ua(Pn,We,"req"+Wt+"_")}catch{ee&&ee(Pn)}}if(Ft){ee=We.join("&");break e}}}return _=_.i.splice(0,G),U.D=_,ee}function gt(_){if(!_.g&&!_.u){_.Y=1;var U=_.Fa;M||J(),W||(M(),W=!0),z.add(U,_),_.v=0}}function St(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=Cn(h(_.Fa,_),bt(_,_.v)),_.v++,!0)}t.Fa=function(){if(this.u=null,Ct(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=Cn(h(this.ab,this),_)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nt(10),Ve(this),Ct(this))};function $t(_){_.A!=null&&(a.clearTimeout(_.A),_.A=null)}function Ct(_){_.g=new gr(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var U=Ni(_.qa);Ln(U,"RID","rpc"),Ln(U,"SID",_.K),Ln(U,"AID",_.T),Ln(U,"CI",_.F?"0":"1"),!_.F&&_.ja&&Ln(U,"TO",_.ja),Ln(U,"TYPE","xmlhttp"),tt(_,U),_.m&&_.o&&fa(U,_.m,_.o),_.L&&(_.g.I=_.L);var G=_.g;_=_.ia,G.L=1,G.v=so(Ni(U)),G.m=null,G.P=!0,no(G,_)}t.Za=function(){this.C!=null&&(this.C=null,Ve(this),St(this),Nt(19))};function st(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Ut(_,U){var G=null;if(_.g==U){st(_),$t(_),_.g=null;var ee=2}else if(Ga(_.h,U))G=U.D,Ka(_.h,U),ee=1;else return;if(_.G!=0){if(U.o)if(ee==1){G=U.m?U.m.length:0,U=Date.now()-U.F;var be=_.B;ee=Hr(),Mt(ee,new Wr(ee,G)),et(_)}else gt(_);else if(be=U.s,be==3||be==0&&0<U.X||!(ee==1&&it(_,U)||ee==2&&St(_)))switch(G&&0<G.length&&(U=_.h,U.i=U.i.concat(G)),be){case 1:Pt(_,5);break;case 4:Pt(_,10);break;case 3:Pt(_,6);break;default:Pt(_,2)}}}function bt(_,U){let G=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(G*=2),G*U}function Pt(_,U){if(_.j.info("Error code "+U),U==2){var G=h(_.fb,_),ee=_.Xa;const be=!ee;ee=new xr(ee||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Do(ee,"https"),so(ee),be?ns(ee.toString(),G):Ro(ee.toString(),G)}else Nt(2);_.G=0,_.l&&_.l.sa(U),Zt(_),rt(_)}t.fb=function(_){_?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function Zt(_){if(_.G=0,_.ka=[],_.l){const U=Qa(_.h);(U.length!=0||_.i.length!=0)&&(b(_.ka,U),b(_.ka,_.i),_.h.i.length=0,g(_.i),_.i.length=0),_.l.ra()}}function R(_,U,G){var ee=G instanceof xr?Ni(G):new xr(G);if(ee.g!="")U&&(ee.g=U+"."+ee.g),aa(ee,ee.s);else{var be=a.location;ee=be.protocol,U=U?U+"."+be.hostname:be.hostname,be=+be.port;var Pe=new xr(null);ee&&Do(Pe,ee),U&&(Pe.g=U),be&&aa(Pe,be),G&&(Pe.l=G),ee=Pe}return G=_.D,U=_.ya,G&&U&&Ln(ee,G,U),Ln(ee,"VER",_.la),tt(_,ee),ee}function Q(_,U,G){if(U&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return U=_.Ca&&!_.pa?new jn(new Fo({eb:G})):new jn(_.pa),U.Ha(_.J),U}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ce(){}t=ce.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function pe(){}pe.prototype.g=function(_,U){return new ve(_,U)};function ve(_,U){_t.call(this),this.g=new Fe(U),this.l=_,this.h=U&&U.messageUrlParams||null,_=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(_?_["X-WebChannel-Content-Type"]=U.messageContentType:_={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.va&&(_?_["X-WebChannel-Client-Profile"]=U.va:_={"X-WebChannel-Client-Profile":U.va}),this.g.S=_,(_=U&&U.Sb)&&!w(_)&&(this.g.m=_),this.v=U&&U.supportsCrossDomainXhr||!1,this.u=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!w(U)&&(this.g.D=U,_=this.h,_!==null&&U in _&&(_=this.h,U in _&&delete _[U])),this.j=new Me(this)}m(ve,_t),ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ve.prototype.close=function(){Le(this.g)},ve.prototype.o=function(_){var U=this.g;if(typeof _=="string"){var G={};G.__data__=_,_=G}else this.u&&(G={},G.__data__=nn(_),_=G);U.i.push(new Gl(U.Ya++,_)),U.G==3&&et(U)},ve.prototype.N=function(){this.g.l=null,delete this.j,Le(this.g),delete this.g,ve.aa.N.call(this)};function Te(_){Xn.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var U=_.__sm__;if(U){e:{for(const G in U){_=G;break e}_=void 0}(this.i=_)&&(_=this.i,U=U!==null&&_ in U?U[_]:void 0),this.data=U}else this.data=_}m(Te,Xn);function Oe(){pn.call(this),this.status=1}m(Oe,pn);function Me(_){this.g=_}m(Me,ce),Me.prototype.ua=function(){Mt(this.g,"a")},Me.prototype.ta=function(_){Mt(this.g,new Te(_))},Me.prototype.sa=function(_){Mt(this.g,new Oe)},Me.prototype.ra=function(){Mt(this.g,"b")},pe.prototype.createWebChannel=pe.prototype.g,ve.prototype.send=ve.prototype.o,ve.prototype.open=ve.prototype.m,ve.prototype.close=ve.prototype.close,pk=function(){return new pe},fk=function(){return Hr()},hk=Et,Ob={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},hi.NO_ERROR=0,hi.TIMEOUT=8,hi.HTTP_ERROR=6,$g=hi,Mi.COMPLETE="complete",dk=Mi,yn.EventType=mr,mr.OPEN="a",mr.CLOSE="b",mr.ERROR="c",mr.MESSAGE="d",_t.prototype.listen=_t.prototype.K,a0=yn,jn.prototype.listenOnce=jn.prototype.L,jn.prototype.getLastError=jn.prototype.Ka,jn.prototype.getLastErrorCode=jn.prototype.Ba,jn.prototype.getStatus=jn.prototype.Z,jn.prototype.getResponseJson=jn.prototype.Oa,jn.prototype.getResponseText=jn.prototype.oa,jn.prototype.send=jn.prototype.ea,jn.prototype.setWithCredentials=jn.prototype.Ha,uk=jn}).apply(typeof eg<"u"?eg:typeof self<"u"?self:typeof window<"u"?window:{});const $N="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ki.UNAUTHENTICATED=new ki(null),ki.GOOGLE_CREDENTIALS=new ki("google-credentials-uid"),ki.FIRST_PARTY=new ki("first-party-uid"),ki.MOCK_USER=new ki("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mf="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gd=new Ow("@firebase/firestore");function oh(){return gd.logLevel}function lt(t,...e){if(gd.logLevel<=wn.DEBUG){const n=e.map(Xw);gd.debug(`Firestore (${mf}): ${t}`,...n)}}function cs(t,...e){if(gd.logLevel<=wn.ERROR){const n=e.map(Xw);gd.error(`Firestore (${mf}): ${t}`,...n)}}function xd(t,...e){if(gd.logLevel<=wn.WARN){const n=e.map(Xw);gd.warn(`Firestore (${mf}): ${t}`,...n)}}function Xw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(t="Unexpected state"){const e=`FIRESTORE (${mf}) INTERNAL ASSERTION FAILED: `+t;throw cs(e),new Error(e)}function Vt(t,e){t||It()}function tn(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ft extends qa{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class F9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ki.UNAUTHENTICATED))}shutdown(){}}class L9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class M9{constructor(e){this.t=e,this.currentUser=ki.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Vt(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Xo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Xo,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{lt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(lt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Xo)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(lt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Vt(typeof r.accessToken=="string"),new mk(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Vt(e===null||typeof e=="string"),new ki(e)}}class B9{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ki.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class O9{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new B9(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ki.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class V9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class U9{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Vt(this.o===void 0);const r=s=>{s.error!=null&&lt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,lt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{lt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):lt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Vt(typeof n.token=="string"),this.R=n.token,new V9(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=z9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function un(t,e){return t<e?-1:t>e?1:0}function Xh(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function xk(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ft(Ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ft(Ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ft(Ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ft(Ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Bt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?un(this.nanoseconds,e.nanoseconds):un(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new qt(e)}static min(){return new qt(new Bt(0,0))}static max(){return new qt(new Bt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n,r){n===void 0?n=0:n>e.length&&It(),r===void 0?r=e.length-n:r>e.length-n&&It(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ap.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ap?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Dn extends ap{construct(e,n,r){return new Dn(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ft(Ue.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Dn(n)}static emptyPath(){return new Dn([])}}const q9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nr extends ap{construct(e,n,r){return new Nr(e,n,r)}static isValidIdentifier(e){return q9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nr(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ft(Ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ft(Ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ft(Ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ft(Ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nr(n)}static emptyPath(){return new Nr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.path=e}static fromPath(e){return new wt(Dn.fromString(e))}static fromName(e){return new wt(Dn.fromString(e).popFirst(5))}static empty(){return new wt(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Dn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new wt(new Dn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Vb(t){return t.fields.find(e=>e.kind===2)}function Lu(t){return t.fields.filter(e=>e.kind!==2)}O1.UNKNOWN_ID=-1;class Gg{constructor(e,n){this.fieldPath=e,this.kind=n}}class lp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new lp(0,Xs.min())}}function H9(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=qt.fromTimestamp(r===1e9?new Bt(n+1,0):new Bt(n,r));return new Xs(i,wt.empty(),e)}function yk(t){return new Xs(t.readTime,t.key,-1)}class Xs{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xs(qt.min(),wt.empty(),-1)}static max(){return new Xs(qt.max(),wt.empty(),-1)}}function Jw(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=wt.comparator(t.documentKey,e.documentKey),n!==0?n:un(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dd(t){if(t.code!==Ue.FAILED_PRECONDITION||t.message!==vk)throw t;lt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&It(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Re((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Re?n:Re.resolve(n)}catch(n){return Re.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Re.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Re.reject(n)}static resolve(e){return new Re((n,r)=>{n(e)})}static reject(e){return new Re((n,r)=>{r(e)})}static waitFor(e){return new Re((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=Re.resolve(!1);for(const r of e)n=n.next(i=>i?Re.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new Re((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new Re((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Xo,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new A0(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Zw(r.target.error);this.V.reject(new A0(e,i))}}static open(e,n,r,i){try{return new Ox(n,e.transaction(i,r))}catch(s){throw new A0(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(lt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new $9(n)}}class Jc{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Jc.S(ai())===12.2&&cs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return lt("SimpleDb","Removing database:",e),Uu(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!wP())return!1;if(Jc.v())return!0;const e=ai(),n=Jc.S(e),r=0<n&&n<10,i=wk(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(lt("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new A0(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ft(Ue.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ft(Ue.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new A0(e,o))},i.onupgradeneeded=s=>{lt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{lt("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Ox.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),Re.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(lt("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function wk(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class W9{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Uu(this.B.delete())}}class A0 extends ft{constructor(e,n){super(Ue.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function gu(t){return t.name==="IndexedDbTransactionError"}class $9{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(lt("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(lt("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Uu(r)}add(e){return lt("SimpleDb","ADD",this.store.name,e,e),Uu(this.store.add(e))}get(e){return Uu(this.store.get(e)).next(n=>(n===void 0&&(n=null),lt("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return lt("SimpleDb","DELETE",this.store.name,e),Uu(this.store.delete(e))}count(){return lt("SimpleDb","COUNT",this.store.name),Uu(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new Re((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new Re((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){lt("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new Re((r,i)=>{n.onerror=s=>{const o=Zw(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new Re((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new W9(a),c=n(a.primaryKey,a.value,l);if(c instanceof Re){const d=c.catch(f=>(l.done(),Re.reject(f)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>Re.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Uu(t){return new Re((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Zw(r.target.error);n(i)}})}let GN=!1;function Zw(t){const e=Jc.S(ai());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ft("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return GN||(GN=!0,setTimeout(()=>{throw r},0)),r}}return t}class G9{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){lt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{lt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){gu(n)?lt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Dd(n)}await this.X(6e4)})}}class K9{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return Re.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return lt("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(lt("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=yk(s);Jw(o,r)>0&&(r=o)}),new Xs(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}_o.oe=-1;function Yp(t){return t==null}function cp(t){return t===0&&1/t==-1/0}function Q9(t){return typeof t=="number"&&Number.isInteger(t)&&!cp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=KN(e)),e=Y9(t.get(n),e);return KN(e)}function Y9(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function KN(t){return t+""}function Ta(t){const e=t.length;if(Vt(e>=2),e===2)return Vt(t.charAt(0)===""&&t.charAt(1)===""),Dn.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&It(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:It()}s=o+2}return new Dn(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t,e){return[t,ds(e)]}function _k(t,e,n){return[t,ds(e),n]}const X9={},J9=["prefixPath","collectionGroup","readTime","documentId"],Z9=["prefixPath","collectionGroup","documentId"],eO=["collectionGroup","readTime","prefixPath","documentId"],tO=["canonicalId","targetId"],nO=["targetId","path"],rO=["path","targetId"],iO=["collectionId","parent"],sO=["indexId","uid"],oO=["uid","sequenceNumber"],aO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lO=["indexId","uid","orderedDocumentKey"],cO=["userId","collectionPath","documentId"],uO=["userId","collectionPath","largestBatchId"],dO=["userId","collectionGroup","largestBatchId"],Nk=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],hO=[...Nk,"documentOverlays"],Ak=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Sk=Ak,e_=[...Sk,"indexConfiguration","indexState","indexEntries"],fO=e_,pO=[...e_,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub extends bk{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function li(t,e){const n=tn(t);return Jc.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Rd(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ek(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n){this.comparator=e,this.root=n||Ti.EMPTY}insert(e,n){return new wr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ti.BLACK,null,null))}remove(e){return new wr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ti.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tg(this.root,e,this.comparator,!1)}getReverseIterator(){return new tg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tg(this.root,e,this.comparator,!0)}}class tg{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ti{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ti.RED,this.left=i??Ti.EMPTY,this.right=s??Ti.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ti(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ti.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ti.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ti.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ti.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw It();const e=this.left.check();if(e!==this.right.check())throw It();return e+(this.isRed()?0:1)}}Ti.EMPTY=null,Ti.RED=!0,Ti.BLACK=!1;Ti.EMPTY=new class{constructor(){this.size=0}get key(){throw It()}get value(){throw It()}get color(){throw It()}get left(){throw It()}get right(){throw It()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ti(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.comparator=e,this.data=new wr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new XN(this.data.getIterator())}getIteratorFrom(e){return new XN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof er)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new er(this.comparator);return n.data=e,n}}class XN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xd(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.fields=e,e.sort(Nr.comparator)}static empty(){return new Cs([])}unionWith(e){let n=new er(Nr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Cs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Xh(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ck("Invalid base64 string: "+s):s}}(e);return new Jr(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Jr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return un(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jr.EMPTY_BYTE_STRING=new Jr("");const mO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ml(t){if(Vt(!!t),typeof t=="string"){let e=0;const n=mO.exec(t);if(Vt(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yr(t.seconds),nanos:yr(t.nanos)}}function yr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ou(t){return typeof t=="string"?Jr.fromBase64String(t):Jr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function n_(t){const e=t.mapValue.fields.__previous_value__;return t_(e)?n_(e):e}function up(t){const e=Ml(t.mapValue.fields.__local_write_time__.timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class yd{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new yd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof yd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Qg={nullValue:"NULL_VALUE"};function vd(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?t_(t)?4:Pk(t)?9007199254740991:Vx(t)?10:11:It()}function za(t,e){if(t===e)return!0;const n=vd(t);if(n!==vd(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return up(t).isEqual(up(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ml(i.timestampValue),a=Ml(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ou(i.bytesValue).isEqual(ou(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return yr(i.geoPointValue.latitude)===yr(s.geoPointValue.latitude)&&yr(i.geoPointValue.longitude)===yr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return yr(i.integerValue)===yr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=yr(i.doubleValue),a=yr(s.doubleValue);return o===a?cp(o)===cp(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Xh(t.arrayValue.values||[],e.arrayValue.values||[],za);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(YN(o)!==YN(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!za(o[l],a[l])))return!1;return!0}(t,e);default:return It()}}function dp(t,e){return(t.values||[]).find(n=>za(n,e))!==void 0}function au(t,e){if(t===e)return 0;const n=vd(t),r=vd(e);if(n!==r)return un(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return un(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=yr(s.integerValue||s.doubleValue),l=yr(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return JN(t.timestampValue,e.timestampValue);case 4:return JN(up(t),up(e));case 5:return un(t.stringValue,e.stringValue);case 6:return function(s,o){const a=ou(s),l=ou(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=un(a[c],l[c]);if(d!==0)return d}return un(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=un(yr(s.latitude),yr(o.latitude));return a!==0?a:un(yr(s.longitude),yr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ZN(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,d;const f=s.fields||{},h=o.fields||{},p=(a=f.value)===null||a===void 0?void 0:a.arrayValue,m=(l=h.value)===null||l===void 0?void 0:l.arrayValue,g=un(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return g!==0?g:ZN(p,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Bc.mapValue&&o===Bc.mapValue)return 0;if(s===Bc.mapValue)return 1;if(o===Bc.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const h=un(l[f],d[f]);if(h!==0)return h;const p=au(a[l[f]],c[d[f]]);if(p!==0)return p}return un(l.length,d.length)}(t.mapValue,e.mapValue);default:throw It()}}function JN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return un(t,e);const n=Ml(t),r=Ml(e),i=un(n.seconds,r.seconds);return i!==0?i:un(n.nanos,r.nanos)}function ZN(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=au(n[i],r[i]);if(s)return s}return un(n.length,r.length)}function Jh(t){return zb(t)}function zb(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ml(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ou(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return wt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=zb(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${zb(n.fields[o])}`;return i+"}"}(t.mapValue):It()}function hp(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function qb(t){return!!t&&"integerValue"in t}function fp(t){return!!t&&"arrayValue"in t}function eA(t){return!!t&&"nullValue"in t}function tA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yg(t){return!!t&&"mapValue"in t}function Vx(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function S0(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Rd(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=S0(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=S0(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Pk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const kk={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function xO(t){return"nullValue"in t?Qg:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?hp(yd.empty(),wt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Vx(t)?kk:{mapValue:{}}:It()}function yO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?hp(yd.empty(),wt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?kk:"mapValue"in t?Vx(t)?{mapValue:{}}:Bc:It()}function nA(t,e){const n=au(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function rA(t,e){const n=au(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this.value=e}static empty(){return new Ii({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Yg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=S0(n)}setAll(e){let n=Nr.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=S0(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Yg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return za(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Yg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Rd(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ii(S0(this.value))}}function Tk(t){const e=[];return Rd(t.fields,(n,r)=>{const i=new Nr([n]);if(Yg(r)){const s=Tk(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Cs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new br(e,0,qt.min(),qt.min(),qt.min(),Ii.empty(),0)}static newFoundDocument(e,n,r,i){return new br(e,1,n,qt.min(),r,i,0)}static newNoDocument(e,n){return new br(e,2,n,qt.min(),qt.min(),Ii.empty(),0)}static newUnknownDocument(e,n){return new br(e,3,n,qt.min(),qt.min(),Ii.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(qt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ii.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ii.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=qt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof br&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,n){this.position=e,this.inclusive=n}}function iA(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=wt.comparator(wt.fromName(o.referenceValue),n.key):r=au(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function sA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!za(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,n="asc"){this.field=e,this.dir=n}}function vO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ik=class{};class _n extends Ik{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new bO(e,n,r):n==="array-contains"?new NO(e,r):n==="in"?new Mk(e,r):n==="not-in"?new AO(e,r):n==="array-contains-any"?new SO(e,r):new _n(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new wO(e,r):new _O(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(au(n,this.value)):n!==null&&vd(this.value)===vd(n)&&this.matchesComparison(au(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return It()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qn extends Ik{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Qn(e,n)}matches(e){return ef(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ef(t){return t.op==="and"}function Hb(t){return t.op==="or"}function r_(t){return jk(t)&&ef(t)}function jk(t){for(const e of t.filters)if(e instanceof Qn)return!1;return!0}function Wb(t){if(t instanceof _n)return t.field.canonicalString()+t.op.toString()+Jh(t.value);if(r_(t))return t.filters.map(e=>Wb(e)).join(",");{const e=t.filters.map(n=>Wb(n)).join(",");return`${t.op}(${e})`}}function Dk(t,e){return t instanceof _n?function(r,i){return i instanceof _n&&r.op===i.op&&r.field.isEqual(i.field)&&za(r.value,i.value)}(t,e):t instanceof Qn?function(r,i){return i instanceof Qn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Dk(o,i.filters[a]),!0):!1}(t,e):void It()}function Rk(t,e){const n=t.filters.concat(e);return Qn.create(n,t.op)}function Fk(t){return t instanceof _n?function(n){return`${n.field.canonicalString()} ${n.op} ${Jh(n.value)}`}(t):t instanceof Qn?function(n){return n.op.toString()+" {"+n.getFilters().map(Fk).join(" ,")+"}"}(t):"Filter"}class bO extends _n{constructor(e,n,r){super(e,n,r),this.key=wt.fromName(r.referenceValue)}matches(e){const n=wt.comparator(e.key,this.key);return this.matchesComparison(n)}}class wO extends _n{constructor(e,n){super(e,"in",n),this.keys=Lk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class _O extends _n{constructor(e,n){super(e,"not-in",n),this.keys=Lk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Lk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>wt.fromName(r.referenceValue))}class NO extends _n{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return fp(n)&&dp(n.arrayValue,this.value)}}class Mk extends _n{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&dp(this.value.arrayValue,n)}}class AO extends _n{constructor(e,n){super(e,"not-in",n)}matches(e){if(dp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!dp(this.value.arrayValue,n)}}class SO extends _n{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!fp(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>dp(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function $b(t,e=null,n=[],r=[],i=null,s=null,o=null){return new EO(t,e,n,r,i,s,o)}function bd(t){const e=tn(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Wb(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Yp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Jh(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Jh(r)).join(",")),e.ue=n}return e.ue}function Xp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!vO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Dk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sA(t.startAt,e.startAt)&&sA(t.endAt,e.endAt)}function V1(t){return wt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function U1(t,e){return t.filters.filter(n=>n instanceof _n&&n.field.isEqual(e))}function oA(t,e,n){let r=Qg,i=!0;for(const s of U1(t,e)){let o=Qg,a=!0;switch(s.op){case"<":case"<=":o=xO(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Qg}nA({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];nA({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function aA(t,e,n){let r=Bc,i=!0;for(const s of U1(t,e)){let o=Bc,a=!0;switch(s.op){case">=":case">":o=yO(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Bc}rA({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];rA({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function CO(t,e,n,r,i,s,o,a){return new gf(t,e,n,r,i,s,o,a)}function Jp(t){return new gf(t)}function lA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Bk(t){return t.collectionGroup!==null}function E0(t){const e=tn(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new er(Nr.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new pp(s,r))}),n.has(Nr.keyField().canonicalString())||e.ce.push(new pp(Nr.keyField(),r))}return e.ce}function So(t){const e=tn(t);return e.le||(e.le=PO(e,E0(t))),e.le}function PO(t,e){if(t.limitType==="F")return $b(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pp(i.field,s)});const n=t.endAt?new Zh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Zh(t.startAt.position,t.startAt.inclusive):null;return $b(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Gb(t,e){const n=t.filters.concat([e]);return new gf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function z1(t,e,n){return new gf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ux(t,e){return Xp(So(t),So(e))&&t.limitType===e.limitType}function Ok(t){return`${bd(So(t))}|lt:${t.limitType}`}function ah(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Fk(i)).join(", ")}]`),Yp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Jh(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Jh(i)).join(",")),`Target(${r})`}(So(t))}; limitType=${t.limitType})`}function Zp(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):wt.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of E0(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=iA(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,E0(r),i)||r.endAt&&!function(o,a,l){const c=iA(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,E0(r),i))}(t,e)}function kO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Vk(t){return(e,n)=>{let r=!1;for(const i of E0(t)){const s=TO(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function TO(t,e,n){const r=t.field.isKeyField()?wt.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?au(l,c):It()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return It()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Rd(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Ek(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=new wr(wt.comparator);function $s(){return IO}const Uk=new wr(wt.comparator);function l0(...t){let e=Uk;for(const n of t)e=e.insert(n.key,n);return e}function zk(t){let e=Uk;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ia(){return C0()}function qk(){return C0()}function C0(){return new xu(t=>t.toString(),(t,e)=>t.isEqual(e))}const jO=new wr(wt.comparator),DO=new er(wt.comparator);function gn(...t){let e=DO;for(const n of t)e=e.add(n);return e}const RO=new er(un);function FO(){return RO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cp(e)?"-0":e}}function Hk(t){return{integerValue:""+t}}function Wk(t,e){return Q9(e)?Hk(e):i_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(){this._=void 0}}function LO(t,e,n){return t instanceof mp?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&t_(s)&&(s=n_(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof wd?Gk(t,e):t instanceof tf?Kk(t,e):function(i,s){const o=$k(i,s),a=cA(o)+cA(i.Pe);return qb(o)&&qb(i.Pe)?Hk(a):i_(i.serializer,a)}(t,e)}function MO(t,e,n){return t instanceof wd?Gk(t,e):t instanceof tf?Kk(t,e):n}function $k(t,e){return t instanceof nf?function(r){return qb(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class mp extends zx{}class wd extends zx{constructor(e){super(),this.elements=e}}function Gk(t,e){const n=Qk(e);for(const r of t.elements)n.some(i=>za(i,r))||n.push(r);return{arrayValue:{values:n}}}class tf extends zx{constructor(e){super(),this.elements=e}}function Kk(t,e){let n=Qk(e);for(const r of t.elements)n=n.filter(i=>!za(i,r));return{arrayValue:{values:n}}}class nf extends zx{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function cA(t){return yr(t.integerValue||t.doubleValue)}function Qk(t){return fp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,n){this.field=e,this.transform=n}}function BO(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof wd&&i instanceof wd||r instanceof tf&&i instanceof tf?Xh(r.elements,i.elements,za):r instanceof nf&&i instanceof nf?za(r.Pe,i.Pe):r instanceof mp&&i instanceof mp}(t.transform,e.transform)}class OO{constructor(e,n){this.version=e,this.transformResults=n}}class zr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new zr}static exists(e){return new zr(void 0,e)}static updateTime(e){return new zr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qx{}function Yk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new em(t.key,zr.none()):new xf(t.key,t.data,zr.none());{const n=t.data,r=Ii.empty();let i=new er(Nr.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ql(t.key,r,new Cs(i.toArray()),zr.none())}}function VO(t,e,n){t instanceof xf?function(i,s,o){const a=i.value.clone(),l=dA(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ql?function(i,s,o){if(!Xg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=dA(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Xk(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function P0(t,e,n,r){return t instanceof xf?function(s,o,a,l){if(!Xg(s.precondition,o))return a;const c=s.value.clone(),d=hA(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ql?function(s,o,a,l){if(!Xg(s.precondition,o))return a;const c=hA(s.fieldTransforms,l,o),d=o.data;return d.setAll(Xk(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return Xg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function UO(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=$k(r.transform,i||null);s!=null&&(n===null&&(n=Ii.empty()),n.set(r.field,s))}return n||null}function uA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Xh(r,i,(s,o)=>BO(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class xf extends qx{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ql extends qx{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Xk(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function dA(t,e,n){const r=new Map;Vt(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,MO(o,a,n[i]))}return r}function hA(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,LO(s,o,e))}return r}class em extends qx{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class o_ extends qx{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&VO(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=P0(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=P0(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=qk();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=Yk(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(qt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),gn())}isEqual(e){return this.batchId===e.batchId&&Xh(this.mutations,e.mutations,(n,r)=>uA(n,r))&&Xh(this.baseMutations,e.baseMutations,(n,r)=>uA(n,r))}}class l_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Vt(e.mutations.length===r.length);let i=function(){return jO}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new l_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qr,En;function Jk(t){switch(t){default:return It();case Ue.CANCELLED:case Ue.UNKNOWN:case Ue.DEADLINE_EXCEEDED:case Ue.RESOURCE_EXHAUSTED:case Ue.INTERNAL:case Ue.UNAVAILABLE:case Ue.UNAUTHENTICATED:return!1;case Ue.INVALID_ARGUMENT:case Ue.NOT_FOUND:case Ue.ALREADY_EXISTS:case Ue.PERMISSION_DENIED:case Ue.FAILED_PRECONDITION:case Ue.ABORTED:case Ue.OUT_OF_RANGE:case Ue.UNIMPLEMENTED:case Ue.DATA_LOSS:return!0}}function Zk(t){if(t===void 0)return cs("GRPC error has no .code"),Ue.UNKNOWN;switch(t){case Qr.OK:return Ue.OK;case Qr.CANCELLED:return Ue.CANCELLED;case Qr.UNKNOWN:return Ue.UNKNOWN;case Qr.DEADLINE_EXCEEDED:return Ue.DEADLINE_EXCEEDED;case Qr.RESOURCE_EXHAUSTED:return Ue.RESOURCE_EXHAUSTED;case Qr.INTERNAL:return Ue.INTERNAL;case Qr.UNAVAILABLE:return Ue.UNAVAILABLE;case Qr.UNAUTHENTICATED:return Ue.UNAUTHENTICATED;case Qr.INVALID_ARGUMENT:return Ue.INVALID_ARGUMENT;case Qr.NOT_FOUND:return Ue.NOT_FOUND;case Qr.ALREADY_EXISTS:return Ue.ALREADY_EXISTS;case Qr.PERMISSION_DENIED:return Ue.PERMISSION_DENIED;case Qr.FAILED_PRECONDITION:return Ue.FAILED_PRECONDITION;case Qr.ABORTED:return Ue.ABORTED;case Qr.OUT_OF_RANGE:return Ue.OUT_OF_RANGE;case Qr.UNIMPLEMENTED:return Ue.UNIMPLEMENTED;case Qr.DATA_LOSS:return Ue.DATA_LOSS;default:return It()}}(En=Qr||(Qr={}))[En.OK=0]="OK",En[En.CANCELLED=1]="CANCELLED",En[En.UNKNOWN=2]="UNKNOWN",En[En.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",En[En.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",En[En.NOT_FOUND=5]="NOT_FOUND",En[En.ALREADY_EXISTS=6]="ALREADY_EXISTS",En[En.PERMISSION_DENIED=7]="PERMISSION_DENIED",En[En.UNAUTHENTICATED=16]="UNAUTHENTICATED",En[En.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",En[En.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",En[En.ABORTED=10]="ABORTED",En[En.OUT_OF_RANGE=11]="OUT_OF_RANGE",En[En.UNIMPLEMENTED=12]="UNIMPLEMENTED",En[En.INTERNAL=13]="INTERNAL",En[En.UNAVAILABLE=14]="UNAVAILABLE",En[En.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=new Zu([4294967295,4294967295],0);function fA(t){const e=qO().encode(t),n=new ck;return n.update(e),new Uint8Array(n.digest())}function pA(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Zu([n,r],0),new Zu([i,s],0)]}class u_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new c0(`Invalid padding: ${n}`);if(r<0)throw new c0(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new c0(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new c0(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Zu.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Zu.fromNumber(r)));return i.compare(HO)===1&&(i=new Zu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=fA(e),[r,i]=pA(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new u_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=fA(e),[r,i]=pA(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class c0 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,tm.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Hx(qt.min(),i,new wr(un),$s(),gn())}}class tm{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new tm(r,n,gn(),gn(),gn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class eT{constructor(e,n){this.targetId=e,this.me=n}}class tT{constructor(e,n,r=Jr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class mA{constructor(){this.fe=0,this.ge=xA(),this.pe=Jr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=gn(),n=gn(),r=gn();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:It()}}),new tm(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=xA()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Vt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class WO{constructor(e){this.Le=e,this.Be=new Map,this.ke=$s(),this.qe=gA(),this.Qe=new wr(un)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:It()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(V1(s))if(r===0){const o=new wt(s.path);this.Ue(n,o,br.newNoDocument(o,qt.min()))}else Vt(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=ou(r).toUint8Array()}catch(l){if(l instanceof Ck)return xd("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new u_(o,i,s)}catch(l){return xd(l instanceof c0?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&V1(a.target)){const l=new wt(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,br.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=gn();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Hx(e,n,this.Qe,this.ke,r);return this.ke=$s(),this.qe=gA(),this.Qe=new wr(un),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new mA,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new er(un),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||lt("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new mA),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function gA(){return new wr(wt.comparator)}function xA(){return new wr(wt.comparator)}const $O={asc:"ASCENDING",desc:"DESCENDING"},GO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KO={and:"AND",or:"OR"};class QO{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Kb(t,e){return t.useProto3Json||Yp(e)?e:{value:e}}function rf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function YO(t,e){return rf(t,e.toTimestamp())}function vi(t){return Vt(!!t),qt.fromTimestamp(function(n){const r=Ml(n);return new Bt(r.seconds,r.nanos)}(t))}function d_(t,e){return Qb(t,e).canonicalString()}function Qb(t,e){const n=function(i){return new Dn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function rT(t){const e=Dn.fromString(t);return Vt(hT(e)),e}function gp(t,e){return d_(t.databaseId,e.path)}function Tl(t,e){const n=rT(e);if(n.get(1)!==t.databaseId.projectId)throw new ft(Ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ft(Ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new wt(oT(n))}function iT(t,e){return d_(t.databaseId,e)}function sT(t){const e=rT(t);return e.length===4?Dn.emptyPath():oT(e)}function Yb(t){return new Dn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function oT(t){return Vt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function yA(t,e,n){return{name:gp(t,e),fields:n.value.mapValue.fields}}function XO(t,e,n){const r=Tl(t,e.name),i=vi(e.updateTime),s=e.createTime?vi(e.createTime):qt.min(),o=new Ii({mapValue:{fields:e.fields}}),a=br.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function JO(t,e){return"found"in e?function(r,i){Vt(!!i.found),i.found.name,i.found.updateTime;const s=Tl(r,i.found.name),o=vi(i.found.updateTime),a=i.found.createTime?vi(i.found.createTime):qt.min(),l=new Ii({mapValue:{fields:i.found.fields}});return br.newFoundDocument(s,o,a,l)}(t,e):"missing"in e?function(r,i){Vt(!!i.missing),Vt(!!i.readTime);const s=Tl(r,i.missing),o=vi(i.readTime);return br.newNoDocument(s,o)}(t,e):It()}function ZO(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:It()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(Vt(d===void 0||typeof d=="string"),Jr.fromBase64String(d||"")):(Vt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Jr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?Ue.UNKNOWN:Zk(c.code);return new ft(d,c.message||"")}(o);n=new tT(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Tl(t,r.document.name),s=vi(r.document.updateTime),o=r.document.createTime?vi(r.document.createTime):qt.min(),a=new Ii({mapValue:{fields:r.document.fields}}),l=br.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Jg(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Tl(t,r.document),s=r.readTime?vi(r.readTime):qt.min(),o=br.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Jg([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Tl(t,r.document),s=r.removedTargetIds||[];n=new Jg([],s,i,null)}else{if(!("filter"in e))return It();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new zO(i,s),a=r.targetId;n=new eT(a,o)}}return n}function xp(t,e){let n;if(e instanceof xf)n={update:yA(t,e.key,e.value)};else if(e instanceof em)n={delete:gp(t,e.key)};else if(e instanceof ql)n={update:yA(t,e.key,e.data),updateMask:sV(e.fieldMask)};else{if(!(e instanceof o_))return It();n={verify:gp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof mp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof wd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof tf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof nf)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw It()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:YO(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:It()}(t,e.precondition)),n}function Xb(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?zr.updateTime(vi(s.updateTime)):s.exists!==void 0?zr.exists(s.exists):zr.none()}(e.currentDocument):zr.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)Vt(a.setToServerValue==="REQUEST_TIME"),l=new mp;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new wd(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new tf(d)}else"increment"in a?l=new nf(o,a.increment):It();const c=Nr.fromServerFormat(a.fieldPath);return new s_(c,l)}(t,i)):[];if(e.update){e.update.name;const i=Tl(t,e.update.name),s=new Ii({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new Cs(c.map(d=>Nr.fromServerFormat(d)))}(e.updateMask);return new ql(i,s,o,n,r)}return new xf(i,s,n,r)}if(e.delete){const i=Tl(t,e.delete);return new em(i,n)}if(e.verify){const i=Tl(t,e.verify);return new o_(i,n)}return It()}function eV(t,e){return t&&t.length>0?(Vt(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?vi(i.updateTime):vi(s);return o.isEqual(qt.min())&&(o=vi(s)),new OO(o,i.transformResults||[])}(n,e))):[]}function aT(t,e){return{documents:[iT(t,e.path)]}}function lT(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=iT(t,i);const s=function(c){if(c.length!==0)return dT(Qn.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(h){return{field:lh(h.field),direction:nV(h.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Kb(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function cT(t){let e=sT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Vt(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(f){const h=uT(f);return h instanceof Qn&&r_(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(h=>function(m){return new pp(ch(m.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(f){let h;return h=typeof f=="object"?f.value:f,Yp(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(f){const h=!!f.before,p=f.values||[];return new Zh(p,h)}(n.startAt));let c=null;return n.endAt&&(c=function(f){const h=!f.before,p=f.values||[];return new Zh(p,h)}(n.endAt)),CO(e,i,o,s,a,"F",l,c)}function tV(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return It()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function uT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ch(n.unaryFilter.field);return _n.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ch(n.unaryFilter.field);return _n.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ch(n.unaryFilter.field);return _n.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ch(n.unaryFilter.field);return _n.create(o,"!=",{nullValue:"NULL_VALUE"});default:return It()}}(t):t.fieldFilter!==void 0?function(n){return _n.create(ch(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return It()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Qn.create(n.compositeFilter.filters.map(r=>uT(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return It()}}(n.compositeFilter.op))}(t):It()}function nV(t){return $O[t]}function rV(t){return GO[t]}function iV(t){return KO[t]}function lh(t){return{fieldPath:t.canonicalString()}}function ch(t){return Nr.fromServerFormat(t.fieldPath)}function dT(t){return t instanceof _n?function(n){if(n.op==="=="){if(tA(n.value))return{unaryFilter:{field:lh(n.field),op:"IS_NAN"}};if(eA(n.value))return{unaryFilter:{field:lh(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(tA(n.value))return{unaryFilter:{field:lh(n.field),op:"IS_NOT_NAN"}};if(eA(n.value))return{unaryFilter:{field:lh(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lh(n.field),op:rV(n.op),value:n.value}}}(t):t instanceof Qn?function(n){const r=n.getFilters().map(i=>dT(i));return r.length===1?r[0]:{compositeFilter:{op:iV(n.op),filters:r}}}(t):It()}function sV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n,r,i,s=qt.min(),o=qt.min(),a=Jr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Sl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Sl(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e){this.ct=e}}function oV(t,e){let n;if(e.document)n=XO(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=wt.fromSegments(e.noDocument.path),i=Nd(e.noDocument.readTime);n=br.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return It();{const r=wt.fromSegments(e.unknownDocument.path),i=Nd(e.unknownDocument.version);n=br.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Bt(i[0],i[1]);return qt.fromTimestamp(s)}(e.readTime)),n}function vA(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:q1(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:gp(s,o.key),fields:o.data.value.mapValue.fields,updateTime:rf(s,o.version.toTimestamp()),createTime:rf(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:_d(e.version)};else{if(!e.isUnknownDocument())return It();r.unknownDocument={path:n.path.toArray(),version:_d(e.version)}}return r}function q1(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function _d(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Nd(t){const e=new Bt(t.seconds,t.nanoseconds);return qt.fromTimestamp(e)}function zu(t,e){const n=(e.baseMutations||[]).map(s=>Xb(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Xb(t.ct,s)),i=Bt.fromMillis(e.localWriteTimeMs);return new a_(e.batchId,i,n,r)}function u0(t){const e=Nd(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Nd(t.lastLimboFreeSnapshotVersion):qt.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return Vt(s.documents.length===1),So(Jp(sT(s.documents[0])))}(t.query):function(s){return So(cT(s))}(t.query),new Sl(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Jr.fromBase64String(t.resumeToken))}function pT(t,e){const n=_d(e.snapshotVersion),r=_d(e.lastLimboFreeSnapshotVersion);let i;i=V1(e.target)?aT(t.ct,e.target):lT(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:bd(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function mT(t){const e=cT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?z1(e,e.limit,"L"):e}function Nv(t,e){return new c_(e.largestBatchId,Xb(t.ct,e.overlayMutation))}function bA(t,e){const n=e.path.lastSegment();return[t,ds(e.path.popLast()),n]}function wA(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:_d(r.readTime),documentKey:ds(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{getBundleMetadata(e,n){return _A(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Nd(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return _A(e).put(function(i){return{bundleId:i.id,createTime:_d(vi(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return NA(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:mT(s.bundledQuery),readTime:Nd(s.readTime)}}(r)})}saveNamedQuery(e,n){return NA(e).put(function(i){return{name:i.name,readTime:_d(vi(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function _A(t){return li(t,"bundles")}function NA(t){return li(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Wx(e,r)}getOverlay(e,n){return Uf(e).get(bA(this.userId,n)).next(r=>r?Nv(this.serializer,r):null)}getOverlays(e,n){const r=Ia();return Re.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new c_(n,o);i.push(this.ht(e,a))}),Re.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(ds(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Uf(e).j("collectionPathOverlayIndex",a))}),Re.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Ia(),s=ds(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Uf(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Nv(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Ia();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Uf(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const f=Nv(this.serializer,c);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Uf(e).put(function(i,s,o){const[a,l,c]=bA(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:xp(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Uf(t){return li(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{Pt(e){return li(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Jr.fromUint8Array(r):Jr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(yr(e.integerValue));else if("doubleValue"in e){const r=yr(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),cp(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Ml(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(ou(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?Pk(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Vx(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):It()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(yr(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),wt.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}qu.vt=new qu;function cV(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function AA(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=cV(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class uV{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=AA(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=AA(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class dV{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class hV{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class zf{constructor(){this.jt=new uV,this.Ht=new dV(this.jt),this.Jt=new hV(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Hu(this.indexId,this.documentKey,this.arrayValue,r)}}function gc(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=SA(t.arrayValue,e.arrayValue),n!==0?n:(n=SA(t.directionalValue,e.directionalValue),n!==0?n:wt.comparator(t.documentKey,e.documentKey)))}function SA(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e){this.Xt=new er((n,r)=>Nr.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Vt(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Vb(e);if(n!==void 0&&!this.sn(n))return!1;const r=Lu(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new er(Nr.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Gg(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Gg(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Gg(r.field,r.dir==="asc"?0:1)));return new O1(O1.UNKNOWN_ID,this.collectionId,n,lp.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(t){var e,n;if(Vt(t instanceof _n||t instanceof Qn),t instanceof _n){if(t instanceof Mk){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>_n.create(t.field,"==",s)))||[];return Qn.create(i,"or")}return t}const r=t.filters.map(i=>gT(i));return Qn.create(r,t.op)}function fV(t){if(t.getFilters().length===0)return[];const e=e5(gT(t));return Vt(xT(e)),Jb(e)||Zb(e)?[e]:e.getFilters()}function Jb(t){return t instanceof _n}function Zb(t){return t instanceof Qn&&r_(t)}function xT(t){return Jb(t)||Zb(t)||function(n){if(n instanceof Qn&&Hb(n)){for(const r of n.getFilters())if(!Jb(r)&&!Zb(r))return!1;return!0}return!1}(t)}function e5(t){if(Vt(t instanceof _n||t instanceof Qn),t instanceof _n)return t;if(t.filters.length===1)return e5(t.filters[0]);const e=t.filters.map(r=>e5(r));let n=Qn.create(e,t.op);return n=H1(n),xT(n)?n:(Vt(n instanceof Qn),Vt(ef(n)),Vt(n.filters.length>1),n.filters.reduce((r,i)=>h_(r,i)))}function h_(t,e){let n;return Vt(t instanceof _n||t instanceof Qn),Vt(e instanceof _n||e instanceof Qn),n=t instanceof _n?e instanceof _n?function(i,s){return Qn.create([i,s],"and")}(t,e):CA(t,e):e instanceof _n?CA(e,t):function(i,s){if(Vt(i.filters.length>0&&s.filters.length>0),ef(i)&&ef(s))return Rk(i,s.getFilters());const o=Hb(i)?i:s,a=Hb(i)?s:i,l=o.filters.map(c=>h_(c,a));return Qn.create(l,"or")}(t,e),H1(n)}function CA(t,e){if(ef(e))return Rk(e,t.getFilters());{const n=e.filters.map(r=>h_(t,r));return Qn.create(n,"or")}}function H1(t){if(Vt(t instanceof _n||t instanceof Qn),t instanceof _n)return t;const e=t.getFilters();if(e.length===1)return H1(e[0]);if(jk(t))return t;const n=e.map(i=>H1(i)),r=[];return n.forEach(i=>{i instanceof _n?r.push(i):i instanceof Qn&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Qn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(){this.un=new f_}addToCollectionParentIndex(e,n){return this.un.add(n),Re.resolve()}getCollectionParents(e,n){return Re.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Re.resolve()}deleteFieldIndex(e,n){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,n){return Re.resolve()}getDocumentsMatchingTarget(e,n){return Re.resolve(null)}getIndexType(e,n){return Re.resolve(0)}getFieldIndexes(e,n){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,n){return Re.resolve(Xs.min())}getMinOffsetFromCollectionGroup(e,n){return Re.resolve(Xs.min())}updateCollectionGroup(e,n,r){return Re.resolve()}updateIndexEntries(e,n){return Re.resolve()}}class f_{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new er(Dn.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new er(Dn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=new Uint8Array(0);class mV{constructor(e,n){this.databaseId=n,this.cn=new f_,this.ln=new xu(r=>bd(r),(r,i)=>Xp(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:ds(i)};return PA(e).put(s)}return Re.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[xk(n),""],!1,!0);return PA(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Ta(o.parent))}return r})}addFieldIndex(e,n){const r=qf(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Zd(e);return s.next(a=>{o.put(wA(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=qf(e),i=Zd(e),s=Jd(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=qf(e),r=Jd(e),i=Zd(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return Re.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new EA(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Jd(e);let i=!0;const s=new Map;return Re.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=gn();const a=[];return Re.forEach(s,(l,c)=>{lt("IndexedDbIndexManager",`Using index ${function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`}(l)} to execute ${bd(n)}`);const d=function(N,E){const D=Vb(E);if(D===void 0)return null;for(const j of U1(N,D.fieldPath))switch(j.op){case"array-contains-any":return j.value.arrayValue.values||[];case"array-contains":return[j.value]}return null}(c,l),f=function(N,E){const D=new Map;for(const j of Lu(E))for(const C of U1(N,j.fieldPath))switch(C.op){case"==":case"in":D.set(j.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return D.set(j.fieldPath.canonicalString(),C.value),Array.from(D.values())}return null}(c,l),h=function(N,E){const D=[];let j=!0;for(const C of Lu(E)){const v=C.kind===0?oA(N,C.fieldPath,N.startAt):aA(N,C.fieldPath,N.startAt);D.push(v.value),j&&(j=v.inclusive)}return new Zh(D,j)}(c,l),p=function(N,E){const D=[];let j=!0;for(const C of Lu(E)){const v=C.kind===0?aA(N,C.fieldPath,N.endAt):oA(N,C.fieldPath,N.endAt);D.push(v.value),j&&(j=v.inclusive)}return new Zh(D,j)}(c,l),m=this.In(l,c,h),g=this.In(l,c,p),b=this.Tn(l,c,f),x=this.En(l.indexId,d,m,h.inclusive,g,p.inclusive,b);return Re.forEach(x,w=>r.G(w,n.limit).next(N=>{N.forEach(E=>{const D=wt.fromSegments(E.documentKey);o.has(D)||(o=o.add(D),a.push(D))})}))}).next(()=>a)}return Re.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=fV(Qn.create(e.filters,"and")).map(r=>$b(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),d=[];for(let f=0;f<l;++f){const h=n?this.dn(n[f/c]):ng,p=this.An(e,h,r[f%c],i),m=this.Rn(e,h,s[f%c],o),g=a.map(b=>this.An(e,h,b,!0));d.push(...this.createRange(p,m,g))}return d}An(e,n,r,i){const s=new Hu(e,wt.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new Hu(e,wt.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new EA(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return Re.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new er(Nr.comparator),d=!1;for(const f of l.filters)for(const h of f.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?d=!0:c=c.add(h.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new zf;for(const i of Lu(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);qu.vt.It(s,o)}return r.zt()}dn(e){const n=new zf;return qu.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new zf;return qu.vt.It(hp(this.databaseId,n),r.Yt(function(s){const o=Lu(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new zf);let s=0;for(const o of Lu(e)){const a=r[s++];for(const l of i)if(this.fn(n,o.fieldPath)&&fp(a))i=this.gn(i,o,a);else{const c=l.Yt(o.kind);qu.vt.It(a,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new zf;l.seed(a.zt()),qu.vt.It(o,l.Yt(n.kind)),s.push(l)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof _n&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=qf(e),i=Zd(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return Re.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,f){const h=f?new lp(f.sequenceNumber,new Xs(Nd(f.readTime),new wt(Ta(f.documentKey)),f.largestBatchId)):lp.empty(),p=d.fields.map(([m,g])=>new Gg(Nr.fromServerFormat(m),g));return new O1(d.indexId,d.collectionGroup,p,h)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:un(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=qf(e),s=Zd(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>Re.forEach(a,l=>s.put(wA(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return Re.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?Re.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),Re.forEach(a,l=>this.wn(e,i,l).next(c=>{const d=this.Sn(s,l);return c.isEqual(d)?Re.resolve():this.bn(e,s,l,c,d)}))))})}Dn(e,n,r,i){return Jd(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Jd(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Jd(e);let s=new er(gc);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new Hu(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new er(gc);const i=this.Vn(n,e);if(i==null)return r;const s=Vb(n);if(s!=null){const o=e.data.field(s.fieldPath);if(fp(o))for(const a of o.arrayValue.values||[])r=r.add(new Hu(n.indexId,e.key,this.dn(a),i))}else r=r.add(new Hu(n.indexId,e.key,ng,i));return r}bn(e,n,r,i,s){lt("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,c,d,f,h){const p=l.getIterator(),m=c.getIterator();let g=Xd(p),b=Xd(m);for(;g||b;){let x=!1,w=!1;if(g&&b){const N=d(g,b);N<0?w=!0:N>0&&(x=!0)}else g!=null?w=!0:x=!0;x?(f(b),b=Xd(m)):w?(h(g),g=Xd(p)):(g=Xd(p),b=Xd(m))}}(i,s,gc,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),Re.waitFor(o)}yn(e){let n=1;return Zd(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>gc(o,a)).filter((o,a,l)=>!a||gc(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=gc(o,e),l=gc(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,ng,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,ng,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,n){return gc(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(kA)}getMinOffset(e,n){return Re.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||It())).next(kA)}}function PA(t){return li(t,"collectionParents")}function Jd(t){return li(t,"indexEntries")}function qf(t){return li(t,"indexConfiguration")}function Zd(t){return li(t,"indexState")}function kA(t){Vt(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Jw(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Xs(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class _s{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new _s(e,_s.DEFAULT_COLLECTION_PERCENTILE,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yT(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,f,h)=>(a++,h.delete()));s.push(l.next(()=>{Vt(a===1)}));const c=[];for(const d of n.mutations){const f=_k(e,d.key.path,n.batchId);s.push(i.delete(f)),c.push(d.key)}return Re.waitFor(s).next(()=>c)}function W1(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw It();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_s.DEFAULT_COLLECTION_PERCENTILE=10,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_s.DEFAULT=new _s(41943040,_s.DEFAULT_COLLECTION_PERCENTILE,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_s.DISABLED=new _s(-1,0,0);class $x{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){Vt(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new $x(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xc(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=uh(e),o=xc(e);return o.add({}).next(a=>{Vt(typeof a=="number");const l=new a_(a,n,r,i),c=function(p,m,g){const b=g.baseMutations.map(w=>xp(p.ct,w)),x=g.mutations.map(w=>xp(p.ct,w));return{userId:m,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:b,mutations:x}}(this.serializer,this.userId,l),d=[];let f=new er((h,p)=>un(h.canonicalString(),p.canonicalString()));for(const h of i){const p=_k(this.userId,h.key.path,a);f=f.add(h.key.path.popLast()),d.push(o.put(c)),d.push(s.put(p,X9))}return f.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),Re.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return xc(e).get(n).next(r=>r?(Vt(r.userId===this.userId),zu(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?Re.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return xc(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(Vt(a.batchId>=r),s=zu(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return xc(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xc(e).U("userMutationsIndex",n).next(r=>r.map(i=>zu(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Kg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return uh(e).J({range:i},(o,a,l)=>{const[c,d,f]=o,h=Ta(d);if(c===this.userId&&n.path.isEqual(h))return xc(e).get(f).next(p=>{if(!p)throw It();Vt(p.userId===this.userId),s.push(zu(this.serializer,p))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new er(un);const i=[];return n.forEach(s=>{const o=Kg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=uh(e).J({range:a},(c,d,f)=>{const[h,p,m]=c,g=Ta(p);h===this.userId&&s.path.isEqual(g)?r=r.add(m):f.done()});i.push(l)}),Re.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Kg(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new er(un);return uh(e).J({range:o},(l,c,d)=>{const[f,h,p]=l,m=Ta(h);f===this.userId&&r.isPrefixOf(m)?m.length===i&&(a=a.add(p)):d.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(xc(e).get(s).next(o=>{if(o===null)throw It();Vt(o.userId===this.userId),r.push(zu(this.serializer,o))}))}),Re.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return yT(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),Re.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return Re.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return uh(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Ta(s[1]);i.push(l)}else a.done()}).next(()=>{Vt(i.length===0)})})}containsKey(e,n){return vT(e,this.userId,n)}Nn(e){return bT(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function vT(t,e,n){const r=Kg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return uh(t).J({range:s,H:!0},(a,l,c)=>{const[d,f,h]=a;d===e&&f===i&&(o=!0),c.done()}).next(()=>o)}function xc(t){return li(t,"mutations")}function uh(t){return li(t,"documentMutations")}function bT(t){return li(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ad(0)}static kn(){return new Ad(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Ad(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>qt.fromTimestamp(new Bt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>eh(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Vt(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return eh(e).J((o,a)=>{const l=u0(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>Re.waitFor(s)).next(()=>i)}forEachTarget(e,n){return eh(e).J((r,i)=>{const s=u0(i);n(s)})}qn(e){return IA(e).get("targetGlobalKey").next(n=>(Vt(n!==null),n))}Qn(e,n){return IA(e).put("targetGlobalKey",n)}Kn(e,n){return eh(e).put(pT(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=bd(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return eh(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=u0(a);Xp(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Tc(e);return n.forEach(o=>{const a=ds(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),Re.waitFor(i)}removeMatchingKeys(e,n,r){const i=Tc(e);return Re.forEach(n,s=>{const o=ds(s.path);return Re.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Tc(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Tc(e);let s=gn();return i.J({range:r,H:!0},(o,a,l)=>{const c=Ta(o[1]),d=new wt(c);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=ds(n.path),i=IDBKeyRange.bound([r],[xk(r)],!1,!0);let s=0;return Tc(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return eh(e).get(n).next(r=>r?u0(r):null)}}function eh(t){return li(t,"targets")}function IA(t){return li(t,"targetGlobal")}function Tc(t){return li(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA([t,e],[n,r]){const i=un(t,n);return i===0?un(e,r):i}class xV{constructor(e){this.Un=e,this.buffer=new er(jA),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();jA(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class yV{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){lt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){gu(n)?lt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Dd(n)}await this.Hn(3e5)})}}class vV{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return Re.resolve(_o.oe);const r=new xV(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(lt("LruGarbageCollector","Garbage collection skipped; disabled"),Re.resolve(TA)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(lt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),TA):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(lt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),oh()<=wn.DEBUG&&lt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),Re.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function bV(t,e){return new vV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e,n){this.db=e,this.garbageCollector=bV(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return rg(e,r)}removeReference(e,n,r){return rg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return rg(e,n)}nr(e,n){return function(i,s){let o=!1;return bT(i).Y(a=>vT(i,a,s).next(l=>(l&&(o=!0),Re.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,qt.min()),Tc(e).delete(function(f){return[0,ds(f.path)]}(o))))});i.push(l)}}).next(()=>Re.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return rg(e,n)}tr(e,n){const r=Tc(e);let i,s=_o.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==_o.oe&&n(new wt(Ta(i)),s),s=c,i=l):s=_o.oe}).next(()=>{s!==_o.oe&&n(new wt(Ta(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rg(t,e){return Tc(t).put(function(r,i){return{targetId:0,path:ds(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(){this.changes=new xu(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,br.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Re.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ku(e).put(r)}removeEntry(e,n,r){return ku(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],q1(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=br.newInvalidDocument(n);return ku(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Hf(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:br.newInvalidDocument(n)};return ku(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Hf(n))},(i,s)=>{r={document:this.ir(n,s),size:W1(s)}}).next(()=>r)}getEntries(e,n){let r=$s();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=$s(),i=new wr(wt.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,W1(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return Re.resolve();let i=new er(FA);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Hf(i.first()),Hf(i.last())),o=i.getIterator();let a=o.getNext();return ku(e).J({index:"documentKeyIndex",range:s},(l,c,d)=>{const f=wt.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&FA(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Hf(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),q1(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ku(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=$s();for(const f of c){const h=this.ir(wt.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);h.isFoundDocument()&&(Zp(n,h)||i.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=$s();const o=RA(n,r),a=RA(n,Xs.max());return ku(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const f=this.ir(wt.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new NV(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return DA(e).get("remoteDocumentGlobalKey").next(n=>(Vt(!!n),n))}rr(e,n){return DA(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=oV(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(qt.min())))return r}return br.newInvalidDocument(e)}}function _T(t){return new _V(t)}class NV extends wT{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new xu(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new er((s,o)=>un(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=vA(this.cr.serializer,o);i=i.add(s.path.popLast());const c=W1(l);r+=c-a.size,n.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=vA(this.cr.serializer,o.convertToNoDocument(qt.min()));n.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),Re.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function DA(t){return li(t,"remoteDocumentGlobal")}function ku(t){return li(t,"remoteDocumentsV14")}function Hf(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function RA(t,e){const n=e.documentKey.path.toArray();return[t,q1(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function FA(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=un(n[s],r[s]),i)return i;return i=un(n.length,r.length),i||(i=un(n[n.length-2],r[r.length-2]),i||un(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&P0(r.mutation,i,Cs.empty(),Bt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,gn()).next(()=>r))}getLocalViewOfDocuments(e,n,r=gn()){const i=Ia();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=l0();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ia();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,gn()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=$s();const o=C0(),a=function(){return C0()}();return n.forEach((l,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof ql)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),P0(d.mutation,c,d.mutation.getFieldMask(),Bt.now())):o.set(c.key,Cs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var f;return a.set(c,new AV(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=C0();let i=new wr((o,a)=>o-a),s=gn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||Cs.empty();d=a.applyToLocalView(c,d),r.set(l,d);const f=(i.get(a.batchId)||gn()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,f=qk();d.forEach(h=>{if(!s.has(h)){const p=Yk(n.get(h),r.get(h));p!==null&&f.set(h,p),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Re.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return wt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Bk(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):Re.resolve(Ia());let a=-1,l=s;return o.next(c=>Re.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?Re.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{l=l.insert(d,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,gn())).next(d=>({batchId:a,changes:zk(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new wt(n)).next(r=>{let i=l0();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=l0();return this.indexManager.getCollectionParents(e,s).next(a=>Re.forEach(a,l=>{const c=function(f,h){return new gf(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((f,h)=>{o=o.insert(f,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,br.newInvalidDocument(d)))});let a=l0();return o.forEach((l,c)=>{const d=s.get(l);d!==void 0&&P0(d.mutation,c,Cs.empty(),Bt.now()),Zp(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Re.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:vi(i.createTime)}}(n)),Re.resolve()}getNamedQuery(e,n){return Re.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:mT(i.bundledQuery),readTime:vi(i.readTime)}}(n)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EV{constructor(){this.overlays=new wr(wt.comparator),this.Ir=new Map}getOverlay(e,n){return Re.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ia();return Re.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),Re.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),Re.resolve()}getOverlaysForCollection(e,n,r){const i=Ia(),s=n.length+1,o=new wt(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new wr((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=Ia(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Ia(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return Re.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new c_(n,r));let s=this.Ir.get(n);s===void 0&&(s=gn(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(){this.sessionToken=Jr.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.Tr=new er(gi.Er),this.dr=new er(gi.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new gi(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new gi(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new wt(new Dn([])),r=new gi(n,e),i=new gi(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new wt(new Dn([])),r=new gi(n,e),i=new gi(n,e+1);let s=gn();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new gi(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class gi{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return wt.comparator(e.key,n.key)||un(e.wr,n.wr)}static Ar(e,n){return un(e.wr,n.wr)||wt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new er(gi.Er)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new a_(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new gi(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Re.resolve(o)}lookupMutationBatch(e,n){return Re.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return Re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new gi(n,0),i=new gi(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),Re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new er(un);return n.forEach(i=>{const s=new gi(i,0),o=new gi(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),Re.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;wt.isDocumentKey(s)||(s=s.child(""));const o=new gi(new wt(s),0);let a=new er(un);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},o),Re.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Vt(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Re.forEach(n.mutations,i=>{const s=new gi(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new gi(n,0),i=this.br.firstAfterOrEqual(r);return Re.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e){this.Mr=e,this.docs=function(){return new wr(wt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Re.resolve(r?r.document.mutableCopy():br.newInvalidDocument(n))}getEntries(e,n){let r=$s();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():br.newInvalidDocument(i))}),Re.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=$s();const o=n.path,a=new wt(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Jw(yk(d),r)<=0||(i.has(d.key)||Zp(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Re.resolve(s)}getAllFromCollectionGroup(e,n,r,i){It()}Or(e,n){return Re.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new TV(this)}getSize(e){return Re.resolve(this.size)}}class TV extends wT{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),Re.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e){this.persistence=e,this.Nr=new xu(n=>bd(n),Xp),this.lastRemoteSnapshotVersion=qt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new p_,this.targetCount=0,this.kr=Ad.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Re.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ad(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Re.resolve()}updateTargetData(e,n){return this.Kn(n),Re.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Re.waitFor(s).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Re.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Re.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),Re.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Re.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Re.resolve(r)}containsKey(e,n){return Re.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e,n){this.qr={},this.overlays={},this.Qr=new _o(0),this.Kr=!1,this.Kr=!0,this.$r=new CV,this.referenceDelegate=e(this),this.Ur=new IV(this),this.indexManager=new pV,this.remoteDocumentCache=function(i){return new kV(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new fT(n),this.Gr=new SV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new EV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new PV(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){lt("MemoryPersistence","Starting transaction:",e);const i=new jV(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return Re.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class jV extends bk{constructor(e){super(),this.currentSequenceNumber=e}}class Gx{constructor(e){this.persistence=e,this.Jr=new p_,this.Yr=null}static Zr(e){return new Gx(e)}get Xr(){if(this.Yr)return this.Yr;throw It()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Re.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Re.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Re.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.Xr,r=>{const i=wt.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,qt.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Re.or([()=>Re.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Ox("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",QN,{unique:!0}),l.createObjectStore("documentMutations")}(e),LA(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=Re.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),LA(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:qt.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",QN,{unique:!0});const f=c.store("mutations"),h=d.map(p=>f.put(p));return Re.waitFor(h)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:cO});c.createIndex("collectionPathOverlayIndex",uO,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",dO,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:J9});c.createIndex("documentKeyIndex",Z9),c.createIndex("collectionGroupIndex",eO)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:sO}).createIndex("sequenceNumberIndex",oO,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:aO}).createIndex("documentKeyIndex",lO,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=W1(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>Re.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>Re.forEach(a,l=>{Vt(l.userId===s.userId);const c=zu(this.serializer,l);return yT(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new Dn(o),c=function(f){return[0,ds(f)]}(l);s.push(n.get(c).next(d=>d?Re.resolve():(f=>n.put({targetId:0,path:ds(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>Re.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:iO});const r=n.store("collectionParents"),i=new f_,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:ds(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Dn(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Ta(a);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=u0(i),o=pT(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(f){return f.document?new wt(Dn.fromString(f.document.name).popFirst(5)):f.noDocument?wt.fromSegments(f.noDocument.path):f.unknownDocument?wt.fromSegments(f.unknownDocument.path):It()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>Re.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=_T(this.serializer),s=new AT(Gx.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:gn();zu(this.serializer,l).keys().forEach(f=>d=d.add(f)),a.set(l.userId,d)}),Re.forEach(a,(l,c)=>{const d=new ki(c),f=Wx.lt(this.serializer,d),h=s.getIndexManager(d),p=$x.lt(d,this.serializer,h,s.referenceDelegate);return new NT(i,p,f,h).recalculateAndSaveOverlaysForDocumentKeys(new Ub(n,_o.oe),l).next()})})}}function LA(t){t.createObjectStore("targetDocuments",{keyPath:nO}).createIndex("documentTargetsIndex",rO,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",tO,{unique:!0}),t.createObjectStore("targetGlobal")}const Av="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class m_{constructor(e,n,r,i,s,o,a,l,c,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=h=>Promise.resolve(),!m_.D())throw new ft(Ue.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wV(this,i),this.Ai=n+"main",this.serializer=new fT(l),this.Ri=new Jc(this.Ai,this.hi,new DV(this.serializer)),this.$r=new lV,this.Ur=new gV(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_T(this.serializer),this.Gr=new aV,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&cs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ft(Ue.FAILED_PRECONDITION,Av);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new _o(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ig(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(gu(e))return lt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return lt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Wf(e).get("owner").next(n=>Re.resolve(this.vi(n)))}Ci(e){return ig(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=li(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return Re.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Re.resolve(!0):Wf(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ft(Ue.FAILED_PRECONDITION,Av);return!1}}return!(!this.networkEnabled||!this.inForeground)||ig(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&lt("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Ub(e,_o.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ig(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return $x.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mV(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Wx.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){lt("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?pO:l===16?fO:l===15?e_:l===14?Sk:l===13?Ak:l===12?hO:l===11?Nk:void It()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new Ub(a,this.Qr?this.Qr.next():_o.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw cs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ft(Ue.FAILED_PRECONDITION,vk);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Wf(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ft(Ue.FAILED_PRECONDITION,Av)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wf(e).put("owner",n)}static D(){return Jc.D()}bi(e){const n=Wf(e);return n.get("owner").next(r=>this.vi(r)?(lt("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Re.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(cs(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;bP()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return lt("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return cs("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){cs("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wf(t){return li(t,"owner")}function ig(t){return li(t,"clientMetadata")}function RV(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=gn(),i=gn();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new g_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return bP()?8:wk(ai())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new FV;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(oh()<=wn.DEBUG&&lt("QueryEngine","SDK will not create cache indexes for query:",ah(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Re.resolve()):(oh()<=wn.DEBUG&&lt("QueryEngine","Query:",ah(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(oh()<=wn.DEBUG&&lt("QueryEngine","The SDK decides to create cache indexes for query:",ah(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,So(n))):Re.resolve())}Yi(e,n){if(lA(n))return Re.resolve(null);let r=So(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=z1(n,null,"F"),r=So(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=gn(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,z1(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,r,i){return lA(n)||i.isEqual(qt.min())?Re.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?Re.resolve(null):(oh()<=wn.DEBUG&&lt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ah(n)),this.rs(e,o,n,H9(i,-1)).next(a=>a))})}ts(e,n){let r=new er(Vk(e));return n.forEach((i,s)=>{Zp(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return oh()<=wn.DEBUG&&lt("QueryEngine","Using full collection scan to execute query:",ah(n)),this.Ji.getDocumentsMatchingQuery(e,n,Xs.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new wr(un),this._s=new xu(s=>bd(s),Xp),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new NT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function ET(t,e,n,r){return new LV(t,e,n,r)}async function CT(t,e){const n=tn(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=gn();for(const c of i){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function MV(t,e){const n=tn(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const f=c.batch,h=f.keys();let p=Re.resolve();return h.forEach(m=>{p=p.next(()=>d.getEntry(l,m)).next(g=>{const b=c.docVersions.get(m);Vt(b!==null),g.version.compareTo(b)<0&&(f.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),d.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=gn();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function PT(t){const e=tn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function BV(t,e){const n=tn(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,f)=>{const h=i.get(f);if(!h)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,f)));let p=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(Jr.EMPTY_BYTE_STRING,qt.min()).withLastLimboFreeSnapshotVersion(qt.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),i=i.insert(f,p),function(g,b,x){return g.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(h,p,d)&&a.push(n.Ur.updateTargetData(s,p))});let l=$s(),c=gn();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(OV(s,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(qt.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(f=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return Re.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.os=i,s))}function OV(t,e,n){let r=gn(),i=gn();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=$s();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(qt.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):lt("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function VV(t,e){const n=tn(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function UV(t,e){const n=tn(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,Re.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new Sl(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function t5(t,e,n){const r=tn(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!gu(o))throw o;lt("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function MA(t,e,n){const r=tn(t);let i=qt.min(),s=gn();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const f=tn(l),h=f._s.get(d);return h!==void 0?Re.resolve(f.os.get(h)):f.Ur.getTargetData(c,d)}(r,o,So(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:qt.min(),n?s:gn())).next(a=>(zV(r,kO(e),a),{documents:a,Ts:s})))}function zV(t,e,n){let r=t.us.get(e)||qt.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class BA{constructor(){this.activeTargetIds=FO()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kT{constructor(){this.so=new BA,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new BA,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){lt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){lt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sg=null;function Sv(){return sg===null?sg=function(){return 268435456+Math.round(2147483648*Math.random())}():sg++,"0x"+sg.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi="WebChannelConnection";class $V extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=Sv(),l=this.xo(n,r.toUriEncodedString());lt("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,l,c,i).then(d=>(lt("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw xd("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mf}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=HV[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Sv();return new Promise((o,a)=>{const l=new uk;l.setWithCredentials(!0),l.listenOnce(dk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case $g.NO_ERROR:const d=l.getResponseJson();lt(qi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case $g.TIMEOUT:lt(qi,`RPC '${e}' ${s} timed out`),a(new ft(Ue.DEADLINE_EXCEEDED,"Request time out"));break;case $g.HTTP_ERROR:const f=l.getStatus();if(lt(qi,`RPC '${e}' ${s} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const m=function(b){const x=b.toLowerCase().replace(/_/g,"-");return Object.values(Ue).indexOf(x)>=0?x:Ue.UNKNOWN}(p.status);a(new ft(m,p.message))}else a(new ft(Ue.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ft(Ue.UNAVAILABLE,"Connection failed."));break;default:It()}}finally{lt(qi,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);lt(qi,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=Sv(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=pk(),a=fk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");lt(qi,`Creating RPC '${e}' stream ${i}: ${d}`,l);const f=o.createWebChannel(d,l);let h=!1,p=!1;const m=new WV({Io:b=>{p?lt(qi,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(h||(lt(qi,`Opening RPC '${e}' stream ${i} transport.`),f.open(),h=!0),lt(qi,`RPC '${e}' stream ${i} sending:`,b),f.send(b))},To:()=>f.close()}),g=(b,x,w)=>{b.listen(x,N=>{try{w(N)}catch(E){setTimeout(()=>{throw E},0)}})};return g(f,a0.EventType.OPEN,()=>{p||(lt(qi,`RPC '${e}' stream ${i} transport opened.`),m.yo())}),g(f,a0.EventType.CLOSE,()=>{p||(p=!0,lt(qi,`RPC '${e}' stream ${i} transport closed`),m.So())}),g(f,a0.EventType.ERROR,b=>{p||(p=!0,xd(qi,`RPC '${e}' stream ${i} transport errored:`,b),m.So(new ft(Ue.UNAVAILABLE,"The operation could not be completed")))}),g(f,a0.EventType.MESSAGE,b=>{var x;if(!p){const w=b.data[0];Vt(!!w);const N=w,E=N.error||((x=N[0])===null||x===void 0?void 0:x.error);if(E){lt(qi,`RPC '${e}' stream ${i} received error:`,E);const D=E.status;let j=function(A){const I=Qr[A];if(I!==void 0)return Zk(I)}(D),C=E.message;j===void 0&&(j=Ue.INTERNAL,C="Unknown error status: "+D+" with message "+E.message),p=!0,m.So(new ft(j,C)),f.close()}else lt(qi,`RPC '${e}' stream ${i} received:`,w),m.bo(w)}}),g(a,hk.STAT_EVENT,b=>{b.stat===Ob.PROXY?lt(qi,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===Ob.NOPROXY&&lt(qi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(){return typeof window<"u"?window:null}function Zg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t){return new QO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&lt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new x_(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Ue.RESOURCE_EXHAUSTED?(cs(n.toString()),cs("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ft(Ue.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return lt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(lt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class KV extends TT{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=ZO(this.serializer,e),r=function(s){if(!("targetChange"in s))return qt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?qt.min():o.readTime?vi(o.readTime):qt.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Yb(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=V1(l)?{documents:aT(s,l)}:{query:lT(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=nT(s,o.resumeToken);const c=Kb(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(qt.min())>0){a.readTime=rf(s,o.snapshotVersion.toTimestamp());const c=Kb(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=tV(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Yb(this.serializer),n.removeTarget=e,this.a_(n)}}class QV extends TT{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Vt(!!e.streamToken),this.lastStreamToken=e.streamToken,Vt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Vt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=eV(e.writeResults,e.commitTime),r=vi(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Yb(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>xp(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ft(Ue.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Qb(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ft(Ue.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Qb(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ft(Ue.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class XV{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(cs(n),this.D_=!1):lt("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Fd(this)&&(lt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=tn(l);c.L_.add(4),await nm(c),c.q_.set("Unknown"),c.L_.delete(4),await Qx(c)}(this))})}),this.q_=new XV(r,i)}}async function Qx(t){if(Fd(t))for(const e of t.B_)await e(!0)}async function nm(t){for(const e of t.B_)await e(!1)}function IT(t,e){const n=tn(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),w_(n)?b_(n):yf(n).r_()&&v_(n,e))}function y_(t,e){const n=tn(t),r=yf(n);n.N_.delete(e),r.r_()&&jT(n,e),n.N_.size===0&&(r.r_()?r.o_():Fd(n)&&n.q_.set("Unknown"))}function v_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(qt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}yf(t).A_(e)}function jT(t,e){t.Q_.xe(e),yf(t).R_(e)}function b_(t){t.Q_=new WO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),yf(t).start(),t.q_.v_()}function w_(t){return Fd(t)&&!yf(t).n_()&&t.N_.size>0}function Fd(t){return tn(t).L_.size===0}function DT(t){t.Q_=void 0}async function ZV(t){t.q_.set("Online")}async function eU(t){t.N_.forEach((e,n)=>{v_(t,e)})}async function tU(t,e){DT(t),w_(t)?(t.q_.M_(e),b_(t)):t.q_.set("Unknown")}async function nU(t,e,n){if(t.q_.set("Online"),e instanceof tT&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){lt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $1(t,r)}else if(e instanceof Jg?t.Q_.Ke(e):e instanceof eT?t.Q_.He(e):t.Q_.We(e),!n.isEqual(qt.min()))try{const r=await PT(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(Jr.EMPTY_BYTE_STRING,d.snapshotVersion)),jT(s,l);const f=new Sl(d.target,l,c,d.sequenceNumber);v_(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){lt("RemoteStore","Failed to raise snapshot:",r),await $1(t,r)}}async function $1(t,e,n){if(!gu(e))throw e;t.L_.add(1),await nm(t),t.q_.set("Offline"),n||(n=()=>PT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{lt("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Qx(t)})}function RT(t,e){return e().catch(n=>$1(t,n,e))}async function rm(t){const e=tn(t),n=lu(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rU(e);)try{const i=await VV(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,iU(e,i)}catch(i){await $1(e,i)}FT(e)&&LT(e)}function rU(t){return Fd(t)&&t.O_.length<10}function iU(t,e){t.O_.push(e);const n=lu(t);n.r_()&&n.V_&&n.m_(e.mutations)}function FT(t){return Fd(t)&&!lu(t).n_()&&t.O_.length>0}function LT(t){lu(t).start()}async function sU(t){lu(t).p_()}async function oU(t){const e=lu(t);for(const n of t.O_)e.m_(n.mutations)}async function aU(t,e,n){const r=t.O_.shift(),i=l_.from(r,e,n);await RT(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await rm(t)}async function lU(t,e){e&&lu(t).V_&&await async function(r,i){if(function(o){return Jk(o)&&o!==Ue.ABORTED}(i.code)){const s=r.O_.shift();lu(r).s_(),await RT(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await rm(r)}}(t,e),FT(t)&&LT(t)}async function VA(t,e){const n=tn(t);n.asyncQueue.verifyOperationInProgress(),lt("RemoteStore","RemoteStore received new credentials");const r=Fd(n);n.L_.add(3),await nm(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Qx(n)}async function cU(t,e){const n=tn(t);e?(n.L_.delete(2),await Qx(n)):e||(n.L_.add(2),await nm(n),n.q_.set("Unknown"))}function yf(t){return t.K_||(t.K_=function(n,r,i){const s=tn(n);return s.w_(),new KV(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:ZV.bind(null,t),Ro:eU.bind(null,t),mo:tU.bind(null,t),d_:nU.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),w_(t)?b_(t):t.q_.set("Unknown")):(await t.K_.stop(),DT(t))})),t.K_}function lu(t){return t.U_||(t.U_=function(n,r,i){const s=tn(n);return s.w_(),new QV(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:sU.bind(null,t),mo:lU.bind(null,t),f_:oU.bind(null,t),g_:aU.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await rm(t)):(await t.U_.stop(),t.O_.length>0&&(lt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Xo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new __(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ft(Ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N_(t,e){if(cs("AsyncQueue",`${e}: ${t}`),gu(t))return new ft(Ue.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.comparator=e?(n,r)=>e(n,r)||wt.comparator(n.key,r.key):(n,r)=>wt.comparator(n.key,r.key),this.keyedMap=l0(),this.sortedSet=new wr(this.comparator)}static emptySet(e){return new Oh(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Oh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Oh;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(){this.W_=new wr(wt.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):It():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class sf{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new sf(e,n,Oh.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ux(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class dU{constructor(){this.queries=zA(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=tn(n),s=i.queries;i.queries=zA(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new ft(Ue.ABORTED,"Firestore shutting down"))}}function zA(){return new xu(t=>Ok(t),Ux)}async function A_(t,e){const n=tn(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new uU,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=N_(o,`Initialization of query '${ah(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&E_(n)}async function S_(t,e){const n=tn(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function hU(t,e){const n=tn(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&E_(n)}function fU(t,e,n){const r=tn(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function E_(t){t.Y_.forEach(e=>{e.next()})}var n5,qA;(qA=n5||(n5={})).ea="default",qA.Cache="cache";class C_{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new sf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=sf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==n5.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e){this.key=e}}class BT{constructor(e){this.key=e}}class pU{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=gn(),this.mutatedKeys=gn(),this.Aa=Vk(e),this.Ra=new Oh(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new UA,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const h=i.get(d),p=Zp(this.query,f)?f:null,m=!!h&&this.mutatedKeys.has(h.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let b=!1;h&&p?h.data.isEqual(p.data)?m!==g&&(r.track({type:3,doc:p}),b=!0):this.ga(h,p)||(r.track({type:2,doc:p}),b=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(a=!0)):!h&&p?(r.track({type:0,doc:p}),b=!0):h&&!p&&(r.track({type:1,doc:h}),b=!0,(l||c)&&(a=!0)),b&&(p?(o=o.add(p),s=g?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(p,m){const g=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return It()}};return g(p)-g(m)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new sf(this.query,e.Ra,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new UA,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=gn(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new BT(r))}),this.da.forEach(r=>{e.has(r)||n.push(new MT(r))}),n}ba(e){this.Ta=e.Ts,this.da=gn();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return sf.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class mU{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class gU{constructor(e){this.key=e,this.va=!1}}class xU{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new xu(a=>Ok(a),Ux),this.Ma=new Map,this.xa=new Set,this.Oa=new wr(wt.comparator),this.Na=new Map,this.La=new p_,this.Ba={},this.ka=new Map,this.qa=Ad.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function yU(t,e,n=!0){const r=HT(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await OT(r,e,n,!0),i}async function vU(t,e){const n=HT(t);await OT(n,e,!0,!1)}async function OT(t,e,n,r){const i=await UV(t.localStore,So(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await bU(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&IT(t.remoteStore,i),a}async function bU(t,e,n,r,i){t.Ka=(f,h,p)=>async function(g,b,x,w){let N=b.view.ma(x);N.ns&&(N=await MA(g.localStore,b.query,!1).then(({documents:C})=>b.view.ma(C,N)));const E=w&&w.targetChanges.get(b.targetId),D=w&&w.targetMismatches.get(b.targetId)!=null,j=b.view.applyChanges(N,g.isPrimaryClient,E,D);return WA(g,b.targetId,j.wa),j.snapshot}(t,f,h,p);const s=await MA(t.localStore,e,!0),o=new pU(e,s.Ts),a=o.ma(s.documents),l=tm.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);WA(t,n,c.wa);const d=new mU(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function wU(t,e,n){const r=tn(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Ux(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await t5(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&y_(r.remoteStore,i.targetId),r5(r,i.targetId)}).catch(Dd)):(r5(r,i.targetId),await t5(r.localStore,i.targetId,!0))}async function _U(t,e){const n=tn(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),y_(n.remoteStore,r.targetId))}async function NU(t,e,n){const r=WT(t);try{const i=await function(o,a){const l=tn(o),c=Bt.now(),d=a.reduce((p,m)=>p.add(m.key),gn());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=$s(),g=gn();return l.cs.getEntries(p,d).next(b=>{m=b,m.forEach((x,w)=>{w.isValidDocument()||(g=g.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,m)).next(b=>{f=b;const x=[];for(const w of a){const N=UO(w,f.get(w.key).overlayedDocument);N!=null&&x.push(new ql(w.key,N,Tk(N.value.mapValue),zr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,x,a)}).next(b=>{h=b;const x=b.applyToLocalDocumentSet(f,g);return l.documentOverlayCache.saveOverlays(p,b.batchId,x)})}).then(()=>({batchId:h.batchId,changes:zk(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new wr(un)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await im(r,i.changes),await rm(r.remoteStore)}catch(i){const s=N_(i,"Failed to persist write");n.reject(s)}}async function VT(t,e){const n=tn(t);try{const r=await BV(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(Vt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Vt(o.va):i.removedDocuments.size>0&&(Vt(o.va),o.va=!1))}),await im(n,r,e)}catch(r){await Dd(r)}}function HA(t,e,n){const r=tn(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=tn(o);l.onlineState=a;let c=!1;l.queries.forEach((d,f)=>{for(const h of f.j_)h.Z_(a)&&(c=!0)}),c&&E_(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function AU(t,e,n){const r=tn(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new wr(wt.comparator);o=o.insert(s,br.newNoDocument(s,qt.min()));const a=gn().add(s),l=new Hx(qt.min(),new Map,new wr(un),o,a);await VT(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),P_(r)}else await t5(r.localStore,e,!1).then(()=>r5(r,e,n)).catch(Dd)}async function SU(t,e){const n=tn(t),r=e.batch.batchId;try{const i=await MV(n.localStore,e);zT(n,r,null),UT(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await im(n,i)}catch(i){await Dd(i)}}async function EU(t,e,n){const r=tn(t);try{const i=await function(o,a){const l=tn(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Vt(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);zT(r,e,n),UT(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await im(r,i)}catch(i){await Dd(i)}}function UT(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function zT(t,e,n){const r=tn(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function r5(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||qT(t,r)})}function qT(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(y_(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),P_(t))}function WA(t,e,n){for(const r of n)r instanceof MT?(t.La.addReference(r.key,e),CU(t,r)):r instanceof BT?(lt("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||qT(t,r.key)):It()}function CU(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(lt("SyncEngine","New document in limbo: "+n),t.xa.add(r),P_(t))}function P_(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new wt(Dn.fromString(e)),r=t.qa.next();t.Na.set(r,new gU(n)),t.Oa=t.Oa.insert(n,r),IT(t.remoteStore,new Sl(So(Jp(n.path)),r,"TargetPurposeLimboResolution",_o.oe))}}async function im(t,e,n){const r=tn(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){i.push(c);const f=g_.Wi(l.targetId,c);s.push(f)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,c){const d=tn(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Re.forEach(c,h=>Re.forEach(h.$i,p=>d.persistence.referenceDelegate.addReference(f,h.targetId,p)).next(()=>Re.forEach(h.Ui,p=>d.persistence.referenceDelegate.removeReference(f,h.targetId,p)))))}catch(f){if(!gu(f))throw f;lt("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const p=d.os.get(h),m=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(m);d.os=d.os.insert(h,g)}}}(r.localStore,s))}async function PU(t,e){const n=tn(t);if(!n.currentUser.isEqual(e)){lt("SyncEngine","User change. New user:",e.toKey());const r=await CT(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new ft(Ue.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await im(n,r.hs)}}function kU(t,e){const n=tn(t),r=n.Na.get(e);if(r&&r.va)return gn().add(r.key);{let i=gn();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function HT(t){const e=tn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=VT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AU.bind(null,e),e.Ca.d_=hU.bind(null,e.eventManager),e.Ca.$a=fU.bind(null,e.eventManager),e}function WT(t){const e=tn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EU.bind(null,e),e}class yp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Kx(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return ET(this.persistence,new ST,e.initialUser,this.serializer)}Ga(e){return new AT(Gx.Zr,this.serializer)}Wa(e){return new kT}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yp.provider={build:()=>new yp};class TU extends yp{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await WT(this.Ja.syncEngine),await rm(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return ET(this.persistence,new ST,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new yV(r,e.asyncQueue,n)}Ha(e,n){const r=new K9(n,this.persistence);return new G9(e.asyncQueue,r)}Ga(e){const n=RV(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?_s.withCacheSize(this.cacheSizeBytes):_s.DEFAULT;return new m_(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,GV(),Zg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new kT}}class G1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>HA(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=PU.bind(null,this.syncEngine),await cU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dU}()}createDatastore(e){const n=Kx(e.databaseInfo.databaseId),r=function(s){return new $V(s)}(e.databaseInfo);return function(s,o,a,l){return new YV(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new JV(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>HA(this.syncEngine,n,0),function(){return OA.D()?new OA:new qV}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,d){const f=new xU(i,s,o,a,l,c);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=tn(i);lt("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await nm(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}G1.provider={build:()=>new G1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):cs("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ft(Ue.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const o=tn(i),a={documents:s.map(f=>gp(o.serializer,f))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Dn.emptyPath(),a,s.length),c=new Map;l.forEach(f=>{const h=JO(o.serializer,f);c.set(h.key.toString(),h)});const d=[];return s.forEach(f=>{const h=c.get(f.toString());Vt(!!h),d.push(h)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new em(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=wt.fromPath(r);this.mutations.push(new o_(i,this.precondition(i)))}),await async function(r,i){const s=tn(r),o={writes:i.map(a=>xp(s.serializer,a))};await s.Mo("Commit",s.serializer.databaseId,Dn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw It();n=qt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new ft(Ue.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(qt.min())?zr.exists(!1):zr.updateTime(n):zr.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(qt.min()))throw new ft(Ue.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return zr.updateTime(n)}return zr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new x_(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new IU(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!Yp(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!Jk(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ki.UNAUTHENTICATED,this.clientId=gk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{lt("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(lt("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=N_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ev(t,e){t.asyncQueue.verifyOperationInProgress(),lt("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await CT(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $A(t,e){t.asyncQueue.verifyOperationInProgress();const n=await RU(t);lt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>VA(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>VA(e.remoteStore,i)),t._onlineComponents=e}async function RU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){lt("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ev(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ue.FAILED_PRECONDITION||i.code===Ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;xd("Error using user provided cache. Falling back to memory cache: "+n),await Ev(t,new yp)}}else lt("FirestoreClient","Using default OfflineComponentProvider"),await Ev(t,new yp);return t._offlineComponents}async function T_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(lt("FirestoreClient","Using user provided OnlineComponentProvider"),await $A(t,t._uninitializedComponentsProvider._online)):(lt("FirestoreClient","Using default OnlineComponentProvider"),await $A(t,new G1))),t._onlineComponents}function FU(t){return T_(t).then(e=>e.syncEngine)}function LU(t){return T_(t).then(e=>e.datastore)}async function K1(t){const e=await T_(t),n=e.eventManager;return n.onListen=yU.bind(null,e.syncEngine),n.onUnlisten=wU.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=vU.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=_U.bind(null,e.syncEngine),n}function MU(t,e,n={}){const r=new Xo;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new k_({next:h=>{d.Za(),o.enqueueAndForget(()=>S_(s,f));const p=h.docs.has(a);!p&&h.fromCache?c.reject(new ft(Ue.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?c.reject(new ft(Ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new C_(Jp(a.path),d,{includeMetadataChanges:!0,_a:!0});return A_(s,f)}(await K1(t),t.asyncQueue,e,n,r)),r.promise}function BU(t,e,n={}){const r=new Xo;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new k_({next:h=>{d.Za(),o.enqueueAndForget(()=>S_(s,f)),h.fromCache&&l.source==="server"?c.reject(new ft(Ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new C_(a,d,{includeMetadataChanges:!0,_a:!0});return A_(s,f)}(await K1(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(t,e,n){if(!n)throw new ft(Ue.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function OU(t,e,n,r){if(e===!0&&r===!0)throw new ft(Ue.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function KA(t){if(!wt.isDocumentKey(t))throw new ft(Ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function QA(t){if(wt.isDocumentKey(t))throw new ft(Ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Yx(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":It()}function Zi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ft(Ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Yx(t);throw new ft(Ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function VU(t,e){if(e<=0)throw new ft(Ue.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ft(Ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ft(Ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$T((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ft(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ft(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ft(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xx{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new YA({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ft(Ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ft(Ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new YA(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new F9;switch(r.type){case"firstParty":return new O9(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ft(Ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=GA.get(n);r&&(lt("ComponentProvider","Removing Datastore"),GA.delete(n),r.terminate())}(this),Promise.resolve()}}function UU(t,e,n,r={}){var i;const s=(t=Zi(t,Xx))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&xd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=ki.MOCK_USER;else{a=vP(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new ft(Ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ki(c)}t._authCredentials=new L9(new mk(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Hl(this.firestore,e,this._query)}}class Ri{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ri(this.firestore,e,this._key)}}class Zc extends Hl{constructor(e,n,r){super(e,n,Jp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ri(this.firestore,null,new wt(e))}withConverter(e){return new Zc(this.firestore,e,this._path)}}function en(t,e,...n){if(t=ur(t),GT("collection","path",e),t instanceof Xx){const r=Dn.fromString(e,...n);return QA(r),new Zc(t,null,r)}{if(!(t instanceof Ri||t instanceof Zc))throw new ft(Ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Dn.fromString(e,...n));return QA(r),new Zc(t.firestore,null,r)}}function ln(t,e,...n){if(t=ur(t),arguments.length===1&&(e=gk.newId()),GT("doc","path",e),t instanceof Xx){const r=Dn.fromString(e,...n);return KA(r),new Ri(t,null,new wt(r))}{if(!(t instanceof Ri||t instanceof Zc))throw new ft(Ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Dn.fromString(e,...n));return KA(r),new Ri(t.firestore,t instanceof Zc?t.converter:null,new wt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new x_(this,"async_queue_retry"),this.Vu=()=>{const r=Zg();r&&lt("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Zg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Zg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Xo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!gu(e))throw e;lt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw cs("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=__.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&It()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function JA(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class ea extends Xx{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new XA,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new XA(e),this._firestoreClient=void 0,await e}}}function zU(t,e){const n=typeof t=="object"?t:Uw(),r=typeof t=="string"?t:"(default)",i=Fx(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=gP("firestore");s&&UU(i,...s)}return i}function sm(t){if(t._terminated)throw new ft(Ue.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||KT(t),t._firestoreClient}function KT(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,c,d){return new gO(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,$T(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new DU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function qU(t,e){xd("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return HU(t,G1.provider,{build:r=>new TU(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function HU(t,e,n){if((t=Zi(t,ea))._firestoreClient||t._terminated)throw new ft(Ue.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ft(Ue.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},KT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Sd(Jr.fromBase64String(e))}catch(n){throw new ft(Ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Sd(Jr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ft(Ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ft(Ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ft(Ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return un(this._lat,e._lat)||un(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU=/^__.*__$/;class $U{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ql(e,this.data,this.fieldMask,n,this.fieldTransforms):new xf(e,this.data,n,this.fieldTransforms)}}class QT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ql(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function YT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw It()}}class Jx{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Jx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Q1(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(YT(this.Cu)&&WU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Kx(e)}Qu(e,n,r,i=!1){return new Jx({Cu:e,methodName:n,qu:r,path:Nr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lm(t){const e=t._freezeSettings(),n=Kx(t._databaseId);return new GU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function D_(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);L_("Data must be an object, but it was:",o,r);const a=ZT(r,o);let l,c;if(s.merge)l=new Cs(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const h=i5(e,f,n);if(!o.contains(h))throw new ft(Ue.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);tI(d,h)||d.push(h)}l=new Cs(d),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new $U(new Ii(a),l,c)}class Zx extends am{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zx}}function KU(t,e,n){return new Jx({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class R_ extends am{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=KU(this,e,!0),r=this.Ku.map(s=>vf(s,n)),i=new wd(r);return new s_(e.path,i)}isEqual(e){return e instanceof R_&&rp(this.Ku,e.Ku)}}class F_ extends am{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new nf(e.serializer,Wk(e.serializer,this.$u));return new s_(e.path,n)}isEqual(e){return e instanceof F_&&this.$u===e.$u}}function XT(t,e,n,r){const i=t.Qu(1,e,n);L_("Data must be an object, but it was:",i,r);const s=[],o=Ii.empty();Rd(r,(l,c)=>{const d=M_(e,l,n);c=ur(c);const f=i.Nu(d);if(c instanceof Zx)s.push(d);else{const h=vf(c,f);h!=null&&(s.push(d),o.set(d,h))}});const a=new Cs(s);return new QT(o,a,i.fieldTransforms)}function JT(t,e,n,r,i,s){const o=t.Qu(1,e,n),a=[i5(e,r,n)],l=[i];if(s.length%2!=0)throw new ft(Ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(i5(e,s[h])),l.push(s[h+1]);const c=[],d=Ii.empty();for(let h=a.length-1;h>=0;--h)if(!tI(c,a[h])){const p=a[h];let m=l[h];m=ur(m);const g=o.Nu(p);if(m instanceof Zx)c.push(p);else{const b=vf(m,g);b!=null&&(c.push(p),d.set(p,b))}}const f=new Cs(c);return new QT(d,f,o.fieldTransforms)}function QU(t,e,n,r=!1){return vf(n,t.Qu(r?4:3,e))}function vf(t,e){if(eI(t=ur(t)))return L_("Unsupported field value:",e,t),ZT(t,e);if(t instanceof am)return function(r,i){if(!YT(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=vf(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ur(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Wk(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Bt.fromDate(r);return{timestampValue:rf(i.serializer,s)}}if(r instanceof Bt){const s=new Bt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:rf(i.serializer,s)}}if(r instanceof I_)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Sd)return{bytesValue:nT(i.serializer,r._byteString)};if(r instanceof Ri){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:d_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof j_)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return i_(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Yx(r)}`)}(t,e)}function ZT(t,e){const n={};return Ek(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rd(t,(r,i)=>{const s=vf(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function eI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Bt||t instanceof I_||t instanceof Sd||t instanceof Ri||t instanceof am||t instanceof j_)}function L_(t,e,n){if(!eI(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Yx(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function i5(t,e,n){if((e=ur(e))instanceof om)return e._internalPath;if(typeof e=="string")return M_(t,e);throw Q1("Field path arguments must be of type string or ",t,!1,void 0,n)}const YU=new RegExp("[~\\*/\\[\\]]");function M_(t,e,n){if(e.search(YU)>=0)throw Q1(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new om(...e.split("."))._internalPath}catch{throw Q1(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Q1(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ft(Ue.INVALID_ARGUMENT,a+t+l)}function tI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ri(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ey("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class XU extends Y1{data(){return super.data()}}function ey(t,e){return typeof e=="string"?M_(t,e):e instanceof om?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ft(Ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class B_{}class O_ extends B_{}function mn(t,e,...n){let r=[];e instanceof B_&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof V_).length,a=s.filter(l=>l instanceof ty).length;if(o>1||o>0&&a>0)throw new ft(Ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class ty extends O_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ty(e,n,r)}_apply(e){const n=this._parse(e);return rI(e._query,n),new Hl(e.firestore,e.converter,Gb(e._query,n))}_parse(e){const n=lm(e.firestore);return function(s,o,a,l,c,d,f){let h;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ft(Ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){eS(f,d);const p=[];for(const m of f)p.push(ZA(l,s,m));h={arrayValue:{values:p}}}else h=ZA(l,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||eS(f,d),h=QU(a,o,f,d==="in"||d==="not-in");return _n.create(c,d,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function pt(t,e,n){const r=e,i=ey("where",t);return ty._create(i,r,n)}class V_ extends B_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new V_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Qn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)rI(o,l),o=Gb(o,l)}(e._query,n),new Hl(e.firestore,e.converter,Gb(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class U_ extends O_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new U_(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new ft(Ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ft(Ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pp(s,o)}(e._query,this._field,this._direction);return new Hl(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new gf(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function oi(t,e="asc"){const n=e,r=ey("orderBy",t);return U_._create(r,n)}class z_ extends O_{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new z_(e,n,r)}_apply(e){return new Hl(e.firestore,e.converter,z1(e._query,this._limit,this._limitType))}}function Cv(t){return VU("limit",t),z_._create("limit",t,"F")}function ZA(t,e,n){if(typeof(n=ur(n))=="string"){if(n==="")throw new ft(Ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bk(e)&&n.indexOf("/")!==-1)throw new ft(Ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Dn.fromString(n));if(!wt.isDocumentKey(r))throw new ft(Ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hp(t,new wt(r))}if(n instanceof Ri)return hp(t,n._key);throw new ft(Ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yx(n)}.`)}function eS(t,e){if(!Array.isArray(t)||t.length===0)throw new ft(Ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rI(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ft(Ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ft(Ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class iI{convertValue(e,n="none"){switch(vd(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ou(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw It()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Rd(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>yr(o.doubleValue));return new j_(s)}convertGeoPoint(e){return new I_(yr(e.latitude),yr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=n_(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(up(e));default:return null}}convertTimestamp(e){const n=Ml(e);return new Bt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Dn.fromString(e);Vt(hT(r));const i=new yd(r.get(1),r.get(3)),s=new wt(r.popFirst(5));return i.isEqual(n)||cs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class JU extends iI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sd(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ri(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class H_ extends Y1{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new e1(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ey("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class e1 extends H_{data(e={}){return super.data(e)}}class sI{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Eh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new e1(this._firestore,this._userDataWriter,r.key,r,new Eh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ft(Ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new e1(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Eh(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new e1(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Eh(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:ZU(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function ZU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return It()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(t){t=Zi(t,Ri);const e=Zi(t.firestore,ea);return MU(sm(e),t._key).then(n=>aI(e,t,n))}class ny extends iI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sd(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ri(this.firestore,null,n)}}function On(t){t=Zi(t,Hl);const e=Zi(t.firestore,ea),n=sm(e),r=new ny(e);return nI(t._query),BU(n,t._query).then(i=>new sI(e,r,t,i))}function oI(t,e,n){t=Zi(t,Ri);const r=Zi(t.firestore,ea),i=q_(t.converter,e,n);return iy(r,[D_(lm(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,zr.none())])}function na(t,e,n,...r){t=Zi(t,Ri);const i=Zi(t.firestore,ea),s=lm(i);let o;return o=typeof(e=ur(e))=="string"||e instanceof om?JT(s,"updateDoc",t._key,e,n,r):XT(s,"updateDoc",t._key,e),iy(i,[o.toMutation(t._key,zr.exists(!0))])}function ry(t){return iy(Zi(t.firestore,ea),[new em(t._key,zr.none())])}function Ld(t,e){const n=Zi(t.firestore,ea),r=ln(t),i=q_(t.converter,e);return iy(n,[D_(lm(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,zr.exists(!1))]).then(()=>r)}function Ic(t,...e){var n,r,i;t=ur(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||JA(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(JA(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,c,d;if(t instanceof Ri)c=Zi(t.firestore,ea),d=Jp(t._key.path),l={next:f=>{e[o]&&e[o](aI(c,t,f))},error:e[o+1],complete:e[o+2]};else{const f=Zi(t,Hl);c=Zi(f.firestore,ea),d=f._query;const h=new ny(c);l={next:p=>{e[o]&&e[o](new sI(c,h,f,p))},error:e[o+1],complete:e[o+2]},nI(t._query)}return function(h,p,m,g){const b=new k_(g),x=new C_(p,b,m);return h.asyncQueue.enqueueAndForget(async()=>A_(await K1(h),x)),()=>{b.Za(),h.asyncQueue.enqueueAndForget(async()=>S_(await K1(h),x))}}(sm(c),d,a,l)}function iy(t,e){return function(r,i){const s=new Xo;return r.asyncQueue.enqueueAndForget(async()=>NU(await FU(r),i,s)),s.promise}(sm(t),e)}function aI(t,e,n){const r=n.docs.get(e._key),i=new ny(t);return new H_(t,i,e._key,r,new Eh(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ez={maxAttempts:5};function $f(t,e){if((t=ur(t)).firestore!==e)throw new ft(Ue.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=lm(n)}get(n){const r=$f(n,this._firestore),i=new JU(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return It();const o=s[0];if(o.isFoundDocument())return new Y1(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Y1(this._firestore,i,r._key,null,r.converter);throw It()})}set(n,r,i){const s=$f(n,this._firestore),o=q_(s.converter,r,i),a=D_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=$f(n,this._firestore);let a;return a=typeof(r=ur(r))=="string"||r instanceof om?JT(this._dataReader,"Transaction.update",o._key,r,i,s):XT(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=$f(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=$f(e,this._firestore),r=new ny(this._firestore);return super.get(e).then(i=>new H_(this._firestore,r,n._key,i._document,new Eh(!1,!1),n.converter))}}function cm(t,e,n){t=Zi(t,ea);const r=Object.assign(Object.assign({},ez),n);return function(s){if(s.maxAttempts<1)throw new ft(Ue.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new Xo;return s.asyncQueue.enqueueAndForget(async()=>{const c=await LU(s);new jU(s.asyncQueue,c,a,o,l).au()}),l.promise}(sm(t),i=>e(new tz(t,i)),r)}function lI(...t){return new R_("arrayUnion",t)}function jc(t){return new F_("increment",t)}(function(e,n=!0){(function(i){mf=i})(jd),fd(new su("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new ea(new M9(r.getProvider("auth-internal")),new U9(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ft(Ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yd(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ma($N,"4.7.3",e),Ma($N,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="firebasestorage.googleapis.com",uI="storageBucket",nz=2*60*1e3,rz=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends qa{constructor(e,n,r=0){super(Pv(e),`Firebase Storage: ${n} (${Pv(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rr||(Rr={}));function Pv(t){return"storage/"+t}function W_(){const t="An unknown error occurred, please check the error payload for server response.";return new Fr(Rr.UNKNOWN,t)}function iz(t){return new Fr(Rr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function sz(t){return new Fr(Rr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function oz(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Fr(Rr.UNAUTHENTICATED,t)}function az(){return new Fr(Rr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function lz(t){return new Fr(Rr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function cz(){return new Fr(Rr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function uz(){return new Fr(Rr.CANCELED,"User canceled the upload/download.")}function dz(t){return new Fr(Rr.INVALID_URL,"Invalid URL '"+t+"'.")}function hz(t){return new Fr(Rr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function fz(){return new Fr(Rr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uI+"' property when initializing the app?")}function pz(){return new Fr(Rr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function mz(){return new Fr(Rr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function gz(t){return new Fr(Rr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function s5(t){return new Fr(Rr.INVALID_ARGUMENT,t)}function dI(){return new Fr(Rr.APP_DELETED,"The Firebase app was deleted.")}function xz(t){return new Fr(Rr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function k0(t,e){return new Fr(Rr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Gf(t){throw new Fr(Rr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Gs.makeFromUrl(e,n)}catch{return new Gs(e,"")}if(r.path==="")return r;throw hz(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(E){E.path_=decodeURIComponent(E.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${d}/b/${i}/o${h}`,"i"),m={bucket:1,path:3},g=n===cI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",x=new RegExp(`^https?://${g}/${i}/${b}`,"i"),N=[{regex:a,indices:l,postModify:s},{regex:p,indices:m,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let E=0;E<N.length;E++){const D=N[E],j=D.regex.exec(e);if(j){const C=j[D.indices.bucket];let v=j[D.indices.path];v||(v=""),r=new Gs(C,v),D.postModify(r);break}}if(r==null)throw dz(e);return r}}class yz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...b){c||(c=!0,e.apply(null,b))}function f(b){i=setTimeout(()=>{i=null,t(p,l())},b)}function h(){s&&clearTimeout(s)}function p(b,...x){if(c){h();return}if(b){h(),d.call(null,b,...x);return}if(l()||o){h(),d.call(null,b,...x);return}r<64&&(r*=2);let N;a===1?(a=2,N=0):N=(r+Math.random())*1e3,f(N)}let m=!1;function g(b){m||(m=!0,h(),!c&&(i!==null?(b||(a=2),clearTimeout(i),f(0)):b||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function bz(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(t){return t!==void 0}function _z(t){return typeof t=="object"&&!Array.isArray(t)}function $_(t){return typeof t=="string"||t instanceof String}function tS(t){return G_()&&t instanceof Blob}function G_(){return typeof Blob<"u"}function nS(t,e,n,r){if(r<e)throw s5(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw s5(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function hI(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var ed;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ed||(ed={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Az{constructor(e,n,r,i,s,o,a,l,c,d,f,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,m)=>{this.resolve_=p,this.reject_=m,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new og(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===ed.NO_ERROR,l=s.getStatus();if(!a||Nz(l,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===ed.ABORT;r(!1,new og(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new og(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());wz(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=W_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?dI():uz();o(l)}else{const l=cz();o(l)}};this.canceled_?n(!1,new og(!1,null,!0)):this.backoffId_=vz(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&bz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class og{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Sz(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Ez(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Cz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Pz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function kz(t,e,n,r,i,s,o=!0){const a=hI(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return Cz(c,e),Sz(c,n),Ez(c,s),Pz(c,r),new Az(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Iz(...t){const e=Tz();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(G_())return new Blob(t);throw new Fr(Rr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function jz(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dz(t){if(typeof atob>"u")throw gz("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kv{constructor(e,n){this.data=e,this.contentType=n||null}}function Rz(t,e){switch(t){case ja.RAW:return new kv(fI(e));case ja.BASE64:case ja.BASE64URL:return new kv(pI(t,e));case ja.DATA_URL:return new kv(Lz(e),Mz(e))}throw W_()}function fI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Fz(t){let e;try{e=decodeURIComponent(t)}catch{throw k0(ja.DATA_URL,"Malformed data URL.")}return fI(e)}function pI(t,e){switch(t){case ja.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw k0(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ja.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw k0(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Dz(e)}catch(i){throw i.message.includes("polyfill")?i:k0(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class mI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw k0(ja.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=Bz(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Lz(t){const e=new mI(t);return e.base64?pI(ja.BASE64,e.rest):Fz(e.rest)}function Mz(t){return new mI(t).contentType}function Bz(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n){let r=0,i="";tS(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(tS(this.data_)){const r=this.data_,i=jz(r,e,n);return i===null?null:new Dc(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Dc(r,!0)}}static getBlob(...e){if(G_()){const n=e.map(r=>r instanceof Dc?r.data_:r);return new Dc(Iz.apply(null,n))}else{const n=e.map(o=>$_(o)?Rz(ja.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Dc(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){let e;try{e=JSON.parse(t)}catch{return null}return _z(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Vz(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function xI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(t,e){return e}class as{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||Uz}}let ag=null;function zz(t){return!$_(t)||t.length<2?t:xI(t)}function yI(){if(ag)return ag;const t=[];t.push(new as("bucket")),t.push(new as("generation")),t.push(new as("metageneration")),t.push(new as("name","fullPath",!0));function e(s,o){return zz(o)}const n=new as("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new as("size");return i.xform=r,t.push(i),t.push(new as("timeCreated")),t.push(new as("updated")),t.push(new as("md5Hash",null,!0)),t.push(new as("cacheControl",null,!0)),t.push(new as("contentDisposition",null,!0)),t.push(new as("contentEncoding",null,!0)),t.push(new as("contentLanguage",null,!0)),t.push(new as("contentType",null,!0)),t.push(new as("metadata","customMetadata",!0)),ag=t,ag}function qz(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Gs(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function Hz(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return qz(r,t),r}function vI(t,e,n){const r=gI(e);return r===null?null:Hz(t,r,n)}function Wz(t,e,n,r){const i=gI(e);if(i===null||!$_(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const d=t.bucket,f=t.fullPath,h="/b/"+o(d)+"/o/"+o(f),p=sy(h,n,r),m=hI({alt:"media",token:c});return p+m})[0]}function $z(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class K_{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(t){if(!t)throw W_()}function Gz(t,e){function n(r,i){const s=vI(t,i,e);return bI(s!==null),s}return n}function Kz(t,e){function n(r,i){const s=vI(t,i,e);return bI(s!==null),Wz(s,i,t.host,t._protocol)}return n}function wI(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=az():i=oz():n.getStatus()===402?i=sz(t.bucket):n.getStatus()===403?i=lz(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function _I(t){const e=wI(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=iz(t.path)),s.serverResponse=i.serverResponse,s}return n}function Qz(t,e,n){const r=e.fullServerUrl(),i=sy(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new K_(i,s,Kz(t,n),o);return a.errorHandler=_I(e),a}function Yz(t,e){const n=e.fullServerUrl(),r=sy(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(l,c){}const a=new K_(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=_I(e),a}function Xz(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Jz(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Xz(null,e)),r}function Zz(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let N="";for(let E=0;E<2;E++)N=N+Math.random().toString().slice(2);return N}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=Jz(e,r,i),d=$z(c,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",p=Dc.getBlob(f,r,h);if(p===null)throw pz();const m={name:c.fullPath},g=sy(s,t.host,t._protocol),b="POST",x=t.maxUploadRetryTime,w=new K_(g,b,Gz(t,n),x);return w.urlParams=m,w.headers=o,w.body=p.uploadData(),w.errorHandler=wI(e),w}class eq{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ed.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ed.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ed.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Gf("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Gf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Gf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Gf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Gf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class tq extends eq{initXhr(){this.xhr_.responseType="text"}}function Q_(){return new tq}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,n){this._service=e,n instanceof Gs?this._location=n:this._location=Gs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ed(e,n)}get root(){const e=new Gs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xI(this._location.path)}get storage(){return this._service}get parent(){const e=Oz(this._location.path);if(e===null)return null;const n=new Gs(this._location.bucket,e);return new Ed(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw xz(e)}}function nq(t,e,n){t._throwIfRoot("uploadBytes");const r=Zz(t.storage,t._location,yI(),new Dc(e,!0),n);return t.storage.makeRequestWithTokens(r,Q_).then(i=>({metadata:i,ref:t}))}function rq(t){t._throwIfRoot("getDownloadURL");const e=Qz(t.storage,t._location,yI());return t.storage.makeRequestWithTokens(e,Q_).then(n=>{if(n===null)throw mz();return n})}function iq(t){t._throwIfRoot("deleteObject");const e=Yz(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Q_)}function sq(t,e){const n=Vz(t._location.path,e),r=new Gs(t._location.bucket,n);return new Ed(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oq(t){return/^[A-Za-z]+:\/\//.test(t)}function aq(t,e){return new Ed(t,e)}function NI(t,e){if(t instanceof Y_){const n=t;if(n._bucket==null)throw fz();const r=new Ed(n,n._bucket);return e!=null?NI(r,e):r}else return e!==void 0?sq(t,e):t}function lq(t,e){if(e&&oq(e)){if(t instanceof Y_)return aq(t,e);throw s5("To use ref(service, url), the first argument must be a Storage instance.")}else return NI(t,e)}function rS(t,e){const n=e==null?void 0:e[uI];return n==null?null:Gs.makeFromBucketSpec(n,t)}function cq(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:vP(i,t.app.options.projectId))}class Y_{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=cI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=nz,this._maxUploadRetryTime=rz,this._requests=new Set,i!=null?this._bucket=Gs.makeFromBucketSpec(i,this._host):this._bucket=rS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Gs.makeFromBucketSpec(this._url,e):this._bucket=rS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ed(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new yz(dI());{const o=kz(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const iS="@firebase/storage",sS="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="storage";function X_(t,e,n){return t=ur(t),nq(t,e,n)}function J_(t){return t=ur(t),rq(t)}function SI(t){return t=ur(t),iq(t)}function vp(t,e){return t=ur(t),lq(t,e)}function uq(t=Uw(),e){t=ur(t);const r=Fx(t,AI).getImmediate({identifier:e}),i=gP("storage");return i&&dq(r,...i),r}function dq(t,e,n,r={}){cq(t,e,n,r)}function hq(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Y_(n,r,i,e,jd)}function fq(){fd(new su(AI,hq,"PUBLIC").setMultipleInstances(!0)),Ma(iS,sS,""),Ma(iS,sS,"esm2017")}fq();const pq={apiKey:"AIzaSyCaMvnjmBFr3vM_Q4VVR3yZtVmM_tT_B_0",authDomain:"egrec-bd-gestion.firebaseapp.com",projectId:"egrec-bd-gestion",storageBucket:"egrec-bd-gestion.appspot.com",messagingSenderId:"893867947081",appId:"1:893867947081:web:5d1b6c3ae8d14ca8a13b98"},Z_=AP(pq),fn=I9(Z_),ot=zU(Z_),bp=uq(Z_);vB(fn,ek).catch(t=>{console.error("Error enabling auth persistence:",t)});qU(ot).catch(t=>{console.error("Error enabling Firestore persistence:",t),t.code==="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):t.code==="unimplemented"&&console.warn("The current browser does not support offline persistence.")});const EI=he.createContext(void 0),mq=({children:t})=>{const[e,n]=he.useState([]),r=(h,p=1)=>{n(m=>m.find(b=>b.product.id===h.id)?m.map(b=>b.product.id===h.id?{...b,quantity:b.quantity+p}:b):[...m,{product:h,quantity:p}])},i=h=>{n(p=>p.filter(m=>m.product.id!==h))},s=(h,p)=>{if(p<=0){i(h);return}n(m=>m.map(g=>g.product.id===h?{...g,quantity:p}:g))},o=()=>{n([])},a=e.reduce((h,p)=>h+p.quantity,0),l=e.reduce((h,p)=>h+p.product.price*p.quantity,0),c=l/(1+.1925),d=l-c,f={items:e,addToCart:r,removeFromCart:i,updateQuantity:s,clearCart:o,totalItems:a,subtotal:c,tax:d,total:l};return u.jsx(EI.Provider,{value:f,children:t})},oy=()=>{const t=he.useContext(EI);if(t===void 0)throw new Error("useCart must be used within a CartProvider");return t};let gq={data:""},xq=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||gq,yq=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,vq=/\/\*[^]*?\*\/|  +/g,oS=/\n+/g,Rc=(t,e)=>{let n="",r="",i="";for(let s in t){let o=t[s];s[0]=="@"?s[1]=="i"?n=s+" "+o+";":r+=s[1]=="f"?Rc(o,s):s+"{"+Rc(o,s[1]=="k"?"":e)+"}":typeof o=="object"?r+=Rc(o,e?e.replace(/([^,])+/g,a=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Rc.p?Rc.p(s,o):s+":"+o+";")}return n+(e&&i?e+"{"+i+"}":i)+r},hl={},CI=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+CI(t[n]);return e}return t},bq=(t,e,n,r,i)=>{let s=CI(t),o=hl[s]||(hl[s]=(l=>{let c=0,d=11;for(;c<l.length;)d=101*d+l.charCodeAt(c++)>>>0;return"go"+d})(s));if(!hl[o]){let l=s!==t?t:(c=>{let d,f,h=[{}];for(;d=yq.exec(c.replace(vq,""));)d[4]?h.shift():d[3]?(f=d[3].replace(oS," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(oS," ").trim();return h[0]})(t);hl[o]=Rc(i?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&hl.g?hl.g:null;return n&&(hl.g=hl[o]),((l,c,d,f)=>{f?c.data=c.data.replace(f,l):c.data.indexOf(l)===-1&&(c.data=d?l+c.data:c.data+l)})(hl[o],e,r,a),o},wq=(t,e,n)=>t.reduce((r,i,s)=>{let o=e[s];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Rc(a,""):a===!1?"":a}return r+i+(o??"")},"");function ay(t){let e=this||{},n=t.call?t(e.p):t;return bq(n.unshift?n.raw?wq(n,[].slice.call(arguments,1),e.p):n.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):n,xq(e.target),e.g,e.o,e.k)}let PI,o5,a5;ay.bind({g:1});let Bl=ay.bind({k:1});function _q(t,e,n,r){Rc.p=e,PI=t,o5=n,a5=r}function yu(t,e){let n=this||{};return function(){let r=arguments;function i(s,o){let a=Object.assign({},s),l=a.className||i.className;n.p=Object.assign({theme:o5&&o5()},a),n.o=/ *go\d+/.test(l),a.className=ay.apply(n,r)+(l?" "+l:"");let c=t;return t[0]&&(c=a.as||t,delete a.as),a5&&c[0]&&a5(a),PI(c,a)}return i}}var Nq=t=>typeof t=="function",l5=(t,e)=>Nq(t)?t(e):t,Aq=(()=>{let t=0;return()=>(++t).toString()})(),Sq=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),Eq=20,kI=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,Eq)};case 1:return{...t,toasts:t.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case 2:let{toast:n}=e;return kI(t,{type:t.toasts.find(s=>s.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...t,toasts:t.toasts.map(s=>s.id===r||r===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},Cq=[],Tv={toasts:[],pausedAt:void 0},e4=t=>{Tv=kI(Tv,t),Cq.forEach(e=>{e(Tv)})},Pq=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||Aq()}),um=t=>(e,n)=>{let r=Pq(e,t,n);return e4({type:2,toast:r}),r.id},ke=(t,e)=>um("blank")(t,e);ke.error=um("error");ke.success=um("success");ke.loading=um("loading");ke.custom=um("custom");ke.dismiss=t=>{e4({type:3,toastId:t})};ke.remove=t=>e4({type:4,toastId:t});ke.promise=(t,e,n)=>{let r=ke.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let s=e.success?l5(e.success,i):void 0;return s?ke.success(s,{id:r,...n,...n==null?void 0:n.success}):ke.dismiss(r),i}).catch(i=>{let s=e.error?l5(e.error,i):void 0;s?ke.error(s,{id:r,...n,...n==null?void 0:n.error}):ke.dismiss(r)}),t};var kq=Bl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Tq=Bl`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Iq=Bl`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,jq=yu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${kq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Tq} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Iq} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Dq=Bl`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Rq=yu("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${Dq} 1s linear infinite;
`,Fq=Bl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Lq=Bl`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Mq=yu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Fq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Lq} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Bq=yu("div")`
  position: absolute;
`,Oq=yu("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Vq=Bl`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Uq=yu("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Vq} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,zq=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?he.createElement(Uq,null,e):e:n==="blank"?null:he.createElement(Oq,null,he.createElement(Rq,{...r}),n!=="loading"&&he.createElement(Bq,null,n==="error"?he.createElement(jq,{...r}):he.createElement(Mq,{...r})))},qq=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Hq=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Wq="0%{opacity:0;} 100%{opacity:1;}",$q="0%{opacity:1;} 100%{opacity:0;}",Gq=yu("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Kq=yu("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Qq=(t,e)=>{let n=t.includes("top")?1:-1,[r,i]=Sq()?[Wq,$q]:[qq(n),Hq(n)];return{animation:e?`${Bl(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Bl(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};he.memo(({toast:t,position:e,style:n,children:r})=>{let i=t.height?Qq(t.position||e||"top-center",t.visible):{opacity:0},s=he.createElement(zq,{toast:t}),o=he.createElement(Kq,{...t.ariaProps},l5(t.message,t));return he.createElement(Gq,{className:t.className,style:{...i,...n,...t.style}},typeof r=="function"?r({icon:s,message:o}):he.createElement(he.Fragment,null,s,o))});_q(he.createElement);ay`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const X1="cached_user_data",Yq=24*60*60*1e3,TI=he.createContext(void 0),Iv=()=>{try{const t=localStorage.getItem(X1);if(!t)return null;const{data:e,timestamp:n}=JSON.parse(t);return Date.now()-n>Yq?(localStorage.removeItem(X1),null):{data:e,timestamp:n}}catch(t){return console.error("Error reading cached user data:",t),null}},Xq=t=>{try{localStorage.setItem(X1,JSON.stringify({data:t,timestamp:Date.now()}))}catch(e){console.error("Error caching user data:",e)}},Jq=({children:t})=>{const[e,n]=he.useState(()=>{const c=Iv();return c?c.data:null}),[r,i]=he.useState(!0),[s,o]=he.useState(null),[a,l]=he.useState(!navigator.onLine);return he.useEffect(()=>{const c=()=>{l(!1),ke.success("Connexion rétablie")},d=()=>{l(!0),ke("Mode hors-ligne activé",{icon:"🔌",duration:4e3})};return window.addEventListener("online",c),window.addEventListener("offline",d),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",d)}},[]),he.useEffect(()=>{const c=XP(fn,async d=>{try{if(d){if(!navigator.onLine){const f=Iv();if(f&&f.data&&f.data.id===d.uid){n(f.data),o(null),i(!1);return}}try{const f=await ps(ln(ot,"users",d.uid));if(!f.exists()){o("User data not found"),n(null);return}const h=f.data();if(!h.company||!h.agencyName){o("Company or agency information missing"),n(null);return}const p={id:d.uid,email:d.email||"",firstName:h.firstName||"",lastName:h.lastName||"",company:h.company,agencyName:h.agencyName,role:h.role||""};n(p),Xq(p),o(null)}catch(f){if(console.error("Error fetching user data:",f),!navigator.onLine){const h=Iv();if(h&&h.data&&h.data.id===d.uid){n(h.data),o(null);return}}throw f}}else n(null),localStorage.removeItem(X1),o(null)}catch(f){console.error("Error in auth state change:",f),o("Error loading user data"),n(null)}finally{i(!1)}});return()=>c()},[]),u.jsx(TI.Provider,{value:{user:e,loading:r,error:s,isOffline:a},children:t})},Li=()=>{const t=he.useContext(TI);if(t===void 0)throw new Error("useUser must be used within a UserProvider");return t};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zq={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eH=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),jt=(t,e)=>{const n=he.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:l,...c},d)=>he.createElement("svg",{ref:d,...Zq,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${eH(t)}`,a].join(" "),...c},[...e.map(([f,h])=>he.createElement(f,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tH=jt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=jt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=jt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=jt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=jt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=jt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=jt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=jt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nH=jt("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h0.01",key:"hsw7lv"}],["path",{d:"M12 4h0.01",key:"1e3d8f"}],["path",{d:"M17 4h0.01",key:"p7cxgy"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=jt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=jt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=jt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rH=jt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iH=jt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=jt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sH=jt("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oH=jt("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=jt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aH=jt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=jt("Croissant",[["path",{d:"m4.6 13.11 5.79-3.21c1.89-1.05 4.79 1.78 3.71 3.71l-3.22 5.81C8.8 23.16.79 15.23 4.6 13.11Z",key:"1ozxlb"}],["path",{d:"m10.5 9.5-1-2.29C9.2 6.48 8.8 6 8 6H4.5C2.79 6 2 6.5 2 8.5a7.71 7.71 0 0 0 2 4.83",key:"ffuyb5"}],["path",{d:"M8 6c0-1.55.24-4-2-4-2 0-2.5 2.17-2.5 4",key:"osnpzi"}],["path",{d:"m14.5 13.5 2.29 1c.73.3 1.21.7 1.21 1.5v3.5c0 1.71-.5 2.5-2.5 2.5a7.71 7.71 0 0 1-4.83-2",key:"1vubaw"}],["path",{d:"M18 16c1.55 0 4-.24 4 2 0 2-2.17 2.5-4 2.5",key:"wxr772"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J1=jt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=jt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=jt("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=jt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=jt("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=jt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lH=jt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=jt("Heading",[["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M6 20V4",key:"1w1bmo"}],["path",{d:"M18 20V4",key:"o2hl4u"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=jt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uH=jt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=jt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=jt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hH=jt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fH=jt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pH=jt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=jt("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=jt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=jt("Package2",[["path",{d:"M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z",key:"1ront0"}],["path",{d:"m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9",key:"19h2x1"}],["path",{d:"M12 3v6",key:"1holv5"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=jt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mH=jt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=jt("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=jt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=jt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gH=jt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=jt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xH=jt("ScanBarcode",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=jt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=jt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yH=jt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=jt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=jt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=jt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=jt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=jt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=jt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=jt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=jt("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=jt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=jt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vH=jt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bH=jt("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=jt("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=jt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wH=jt("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=jt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),_H=async(t,e)=>{try{const n=ln(ot,"users",t);if(!(await ps(n)).exists()){const i={...e,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString(),isActive:!0,role:"CAISSIERE"};return await oI(n,i),{success:!0,data:i}}return{success:!1,error:"User already exists"}}catch(n){return console.error("Error creating user document:",n),{success:!1,error:n}}},NH=async t=>{try{const e=ln(ot,"users",t);return await na(e,{lastLoginAt:new Date().toISOString()}),{success:!0}}catch(e){return console.error("Error updating login timestamp:",e),{success:!1,error:e}}},zI=({onClose:t})=>{const[e,n]=he.useState(!0),[r,i]=he.useState(""),[s,o]=he.useState(""),[a,l]=he.useState(""),[c,d]=he.useState(""),[f,h]=he.useState(""),[p,m]=he.useState(""),[g,b]=he.useState(""),[x,w]=he.useState(!1),N=async E=>{E.preventDefault(),b(""),w(!0);try{if(e){const{user:D}=await yB(fn,r,s);await NH(D.uid)}else{if(p.trim().length<3)throw new Error("Le nom de l'agence doit contenir au moins 3 caractères");const{user:D}=await xB(fn,r,s);await _H(D.uid,{email:r,firstName:a,lastName:c,company:f,agencyName:p,createdAt:new Date().toISOString()})}t()}catch(D){let j="Une erreur est survenue";if(D instanceof Error)switch(D.message){case"Firebase: Error (auth/invalid-email).":j="Email invalide";break;case"Firebase: Error (auth/user-not-found).":j="Utilisateur non trouvé";break;case"Firebase: Error (auth/wrong-password).":j="Mot de passe incorrect";break;case"Firebase: Error (auth/email-already-in-use).":j="Cet email est déjà utilisé";break;case"Firebase: Password should be at least 6 characters (auth/weak-password).":j="Le mot de passe doit contenir au moins 6 caractères";break;default:j=D.message}b(j)}finally{w(!1)}};return u.jsx("div",{className:`${fn.currentUser?"fixed inset-0 bg-black/70":""} flex items-center justify-center z-50`,children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center rounded-t-lg",children:[u.jsx("h2",{className:"font-bold text-xl",children:e?"Connexion":"Inscription"}),fn.currentUser&&u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:N,className:"p-6",children:[!e&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Prénom"}),u.jsx("input",{type:"text",value:a,onChange:E=>l(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Entrez votre prénom"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nom"}),u.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Entrez votre nom"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Entreprise"}),u.jsx("input",{type:"text",value:f,onChange:E=>h(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,maxLength:100,placeholder:"Entrez le nom de votre entreprise"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nom de votre agence"}),u.jsx("input",{type:"text",value:p,onChange:E=>m(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,minLength:3,placeholder:"Entrez le nom de votre agence"}),p.length>0&&p.length<3&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Le nom doit contenir au moins 3 caractères"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email"}),u.jsx("input",{type:"email",value:r,onChange:E=>i(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"exemple@email.com"})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Mot de passe"}),u.jsx("input",{type:"password",value:s,onChange:E=>o(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"••••••••",minLength:6})]}),g&&u.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:g}),u.jsx("button",{type:"submit",disabled:x,className:"w-full bg-[#8B4513] text-white py-3 rounded-lg font-bold text-lg transition-colors hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed",children:x?"Chargement...":e?"Se connecter":"S'inscrire"}),u.jsx("div",{className:"mt-4 text-center",children:u.jsx("button",{type:"button",onClick:()=>n(!e),className:"text-[#8B4513] hover:underline",children:e?"Pas encore de compte ? S'inscrire":"Déjà un compte ? Se connecter"})})]})]})})};let cg;const AH=new Uint8Array(16);function SH(){if(!cg&&(cg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!cg))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return cg(AH)}const Ei=[];for(let t=0;t<256;++t)Ei.push((t+256).toString(16).slice(1));function EH(t,e=0){return Ei[t[e+0]]+Ei[t[e+1]]+Ei[t[e+2]]+Ei[t[e+3]]+"-"+Ei[t[e+4]]+Ei[t[e+5]]+"-"+Ei[t[e+6]]+Ei[t[e+7]]+"-"+Ei[t[e+8]]+Ei[t[e+9]]+"-"+Ei[t[e+10]]+Ei[t[e+11]]+Ei[t[e+12]]+Ei[t[e+13]]+Ei[t[e+14]]+Ei[t[e+15]]}const CH=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),dS={randomUUID:CH};function lf(t,e,n){if(dS.randomUUID&&!e&&!t)return dS.randomUUID();t=t||{};const r=t.random||(t.rng||SH)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,EH(r)}function PH(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}function qI(t,e){return new Promise(function(n,r){let i;return kH(t).then(function(s){try{return i=s,n(new Blob([e.slice(0,2),i,e.slice(2)],{type:"image/jpeg"}))}catch(o){return r(o)}},r)})}const kH=t=>new Promise((e,n)=>{const r=new FileReader;r.addEventListener("load",({target:{result:i}})=>{const s=new DataView(i);let o=0;if(s.getUint16(o)!==65496)return n("not a valid JPEG");for(o+=2;;){const a=s.getUint16(o);if(a===65498)break;const l=s.getUint16(o+2);if(a===65505&&s.getUint32(o+4)===1165519206){const c=o+10;let d;switch(s.getUint16(c)){case 18761:d=!0;break;case 19789:d=!1;break;default:return n("TIFF header contains invalid endian")}if(s.getUint16(c+2,d)!==42)return n("TIFF header contains invalid version");const f=s.getUint32(c+4,d),h=c+f+2+12*s.getUint16(c+f,d);for(let p=c+f+2;p<h;p+=12)if(s.getUint16(p,d)==274){if(s.getUint16(p+2,d)!==3)return n("Orientation data type is invalid");if(s.getUint32(p+4,d)!==1)return n("Orientation data count is invalid");s.setUint16(p+8,1,d);break}return e(i.slice(o,o+2+l))}o+=2+l}return e(new Blob)}),r.readAsArrayBuffer(t)});var ex={},TH={get exports(){return ex},set exports(t){ex=t}};(function(t){var e,n,r={};TH.exports=r,r.parse=function(i,s){for(var o=r.bin.readUshort,a=r.bin.readUint,l=0,c={},d=new Uint8Array(i),f=d.length-4;a(d,f)!=101010256;)f--;l=f,l+=4;var h=o(d,l+=4);o(d,l+=2);var p=a(d,l+=2),m=a(d,l+=4);l+=4,l=m;for(var g=0;g<h;g++){a(d,l),l+=4,l+=4,l+=4,a(d,l+=4),p=a(d,l+=4);var b=a(d,l+=4),x=o(d,l+=4),w=o(d,l+2),N=o(d,l+4);l+=6;var E=a(d,l+=8);l+=4,l+=x+w+N,r._readLocal(d,E,c,p,b,s)}return c},r._readLocal=function(i,s,o,a,l,c){var d=r.bin.readUshort,f=r.bin.readUint;f(i,s),d(i,s+=4),d(i,s+=2);var h=d(i,s+=2);f(i,s+=2),f(i,s+=4),s+=4;var p=d(i,s+=8),m=d(i,s+=2);s+=2;var g=r.bin.readUTF8(i,s,p);if(s+=p,s+=m,c)o[g]={size:l,csize:a};else{var b=new Uint8Array(i.buffer,s);if(h==0)o[g]=new Uint8Array(b.buffer.slice(s,s+a));else{if(h!=8)throw"unknown compression method: "+h;var x=new Uint8Array(l);r.inflateRaw(b,x),o[g]=x}}},r.inflateRaw=function(i,s){return r.F.inflate(i,s)},r.inflate=function(i,s){return i[0],i[1],r.inflateRaw(new Uint8Array(i.buffer,i.byteOffset+2,i.length-6),s)},r.deflate=function(i,s){s==null&&(s={level:6});var o=0,a=new Uint8Array(50+Math.floor(1.1*i.length));a[o]=120,a[o+1]=156,o+=2,o=r.F.deflateRaw(i,a,o,s.level);var l=r.adler(i,0,i.length);return a[o+0]=l>>>24&255,a[o+1]=l>>>16&255,a[o+2]=l>>>8&255,a[o+3]=l>>>0&255,new Uint8Array(a.buffer,0,o+4)},r.deflateRaw=function(i,s){s==null&&(s={level:6});var o=new Uint8Array(50+Math.floor(1.1*i.length)),a=r.F.deflateRaw(i,o,a,s.level);return new Uint8Array(o.buffer,0,a)},r.encode=function(i,s){s==null&&(s=!1);var o=0,a=r.bin.writeUint,l=r.bin.writeUshort,c={};for(var d in i){var f=!r._noNeed(d)&&!s,h=i[d],p=r.crc.crc(h,0,h.length);c[d]={cpr:f,usize:h.length,crc:p,file:f?r.deflateRaw(h):h}}for(var d in c)o+=c[d].file.length+30+46+2*r.bin.sizeUTF8(d);o+=22;var m=new Uint8Array(o),g=0,b=[];for(var d in c){var x=c[d];b.push(g),g=r._writeHeader(m,g,d,x,0)}var w=0,N=g;for(var d in c)x=c[d],b.push(g),g=r._writeHeader(m,g,d,x,1,b[w++]);var E=g-N;return a(m,g,101010256),g+=4,l(m,g+=4,w),l(m,g+=2,w),a(m,g+=2,E),a(m,g+=4,N),g+=4,g+=2,m.buffer},r._noNeed=function(i){var s=i.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(s)!=-1},r._writeHeader=function(i,s,o,a,l,c){var d=r.bin.writeUint,f=r.bin.writeUshort,h=a.file;return d(i,s,l==0?67324752:33639248),s+=4,l==1&&(s+=2),f(i,s,20),f(i,s+=2,0),f(i,s+=2,a.cpr?8:0),d(i,s+=2,0),d(i,s+=4,a.crc),d(i,s+=4,h.length),d(i,s+=4,a.usize),f(i,s+=4,r.bin.sizeUTF8(o)),f(i,s+=2,0),s+=2,l==1&&(s+=2,s+=2,d(i,s+=6,c),s+=4),s+=r.bin.writeUTF8(i,s,o),l==0&&(i.set(h,s),s+=h.length),s},r.crc={table:function(){for(var i=new Uint32Array(256),s=0;s<256;s++){for(var o=s,a=0;a<8;a++)1&o?o=3988292384^o>>>1:o>>>=1;i[s]=o}return i}(),update:function(i,s,o,a){for(var l=0;l<a;l++)i=r.crc.table[255&(i^s[o+l])]^i>>>8;return i},crc:function(i,s,o){return 4294967295^r.crc.update(4294967295,i,s,o)}},r.adler=function(i,s,o){for(var a=1,l=0,c=s,d=s+o;c<d;){for(var f=Math.min(c+5552,d);c<f;)l+=a+=i[c++];a%=65521,l%=65521}return l<<16|a},r.bin={readUshort:function(i,s){return i[s]|i[s+1]<<8},writeUshort:function(i,s,o){i[s]=255&o,i[s+1]=o>>8&255},readUint:function(i,s){return 16777216*i[s+3]+(i[s+2]<<16|i[s+1]<<8|i[s])},writeUint:function(i,s,o){i[s]=255&o,i[s+1]=o>>8&255,i[s+2]=o>>16&255,i[s+3]=o>>24&255},readASCII:function(i,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(i[s+l]);return a},writeASCII:function(i,s,o){for(var a=0;a<o.length;a++)i[s+a]=o.charCodeAt(a)},pad:function(i){return i.length<2?"0"+i:i},readUTF8:function(i,s,o){for(var a,l="",c=0;c<o;c++)l+="%"+r.bin.pad(i[s+c].toString(16));try{a=decodeURIComponent(l)}catch{return r.bin.readASCII(i,s,o)}return a},writeUTF8:function(i,s,o){for(var a=o.length,l=0,c=0;c<a;c++){var d=o.charCodeAt(c);if(!(4294967168&d))i[s+l]=d,l++;else if(!(4294965248&d))i[s+l]=192|d>>6,i[s+l+1]=128|d>>0&63,l+=2;else if(!(4294901760&d))i[s+l]=224|d>>12,i[s+l+1]=128|d>>6&63,i[s+l+2]=128|d>>0&63,l+=3;else{if(4292870144&d)throw"e";i[s+l]=240|d>>18,i[s+l+1]=128|d>>12&63,i[s+l+2]=128|d>>6&63,i[s+l+3]=128|d>>0&63,l+=4}}return l},sizeUTF8:function(i){for(var s=i.length,o=0,a=0;a<s;a++){var l=i.charCodeAt(a);if(!(4294967168&l))o++;else if(!(4294965248&l))o+=2;else if(!(4294901760&l))o+=3;else{if(4292870144&l)throw"e";o+=4}}return o}},r.F={},r.F.deflateRaw=function(i,s,o,a){var l=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],c=r.F.U,d=r.F._goodIndex;r.F._hash;var f=r.F._putsE,h=0,p=o<<3,m=0,g=i.length;if(a==0){for(;h<g;)f(s,p,h+(S=Math.min(65535,g-h))==g?1:0),p=r.F._copyExact(i,h,S,s,p+8),h+=S;return p>>>3}var b=c.lits,x=c.strt,w=c.prev,N=0,E=0,D=0,j=0,C=0,v=0;for(g>2&&(x[v=r.F._hash(i,0)]=0),h=0;h<g;h++){if(C=v,h+1<g-2){v=r.F._hash(i,h+1);var A=h+1&32767;w[A]=x[v],x[v]=A}if(m<=h){(N>14e3||E>26697)&&g-h>100&&(m<h&&(b[N]=h-m,N+=2,m=h),p=r.F._writeBlock(h==g-1||m==g?1:0,b,N,j,i,D,h-D,s,p),N=E=j=0,D=h);var I=0;h<g-2&&(I=r.F._bestMatch(i,h,w,C,Math.min(l[2],g-h),l[3]));var S=I>>>16,P=65535&I;if(I!=0){P=65535&I;var k=d(S=I>>>16,c.of0);c.lhst[257+k]++;var F=d(P,c.df0);c.dhst[F]++,j+=c.exb[k]+c.dxb[F],b[N]=S<<23|h-m,b[N+1]=P<<16|k<<8|F,N+=2,m=h+S}else c.lhst[i[h]]++;E++}}for(D==h&&i.length!=0||(m<h&&(b[N]=h-m,N+=2,m=h),p=r.F._writeBlock(1,b,N,j,i,D,h-D,s,p),N=0,E=0,N=E=j=0,D=h);7&p;)p++;return p>>>3},r.F._bestMatch=function(i,s,o,a,l,c){var d=32767&s,f=o[d],h=d-f+32768&32767;if(f==d||a!=r.F._hash(i,s-h))return 0;for(var p=0,m=0,g=Math.min(32767,s);h<=g&&--c!=0&&f!=d;){if(p==0||i[s+p]==i[s+p-h]){var b=r.F._howLong(i,s,h);if(b>p){if(m=h,(p=b)>=l)break;h+2<b&&(b=h+2);for(var x=0,w=0;w<b-2;w++){var N=s-h+w+32768&32767,E=N-o[N]+32768&32767;E>x&&(x=E,f=N)}}}h+=(d=f)-(f=o[d])+32768&32767}return p<<16|m},r.F._howLong=function(i,s,o){if(i[s]!=i[s-o]||i[s+1]!=i[s+1-o]||i[s+2]!=i[s+2-o])return 0;var a=s,l=Math.min(i.length,s+258);for(s+=3;s<l&&i[s]==i[s-o];)s++;return s-a},r.F._hash=function(i,s){return(i[s]<<8|i[s+1])+(i[s+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(i,s,o,a,l,c,d,f,h){var p,m,g,b,x,w,N,E,D,j=r.F.U,C=r.F._putsF,v=r.F._putsE;j.lhst[256]++,m=(p=r.F.getTrees())[0],g=p[1],b=p[2],x=p[3],w=p[4],N=p[5],E=p[6],D=p[7];var A=32+(h+3&7?8-(h+3&7):0)+(d<<3),I=a+r.F.contSize(j.fltree,j.lhst)+r.F.contSize(j.fdtree,j.dhst),S=a+r.F.contSize(j.ltree,j.lhst)+r.F.contSize(j.dtree,j.dhst);S+=14+3*N+r.F.contSize(j.itree,j.ihst)+(2*j.ihst[16]+3*j.ihst[17]+7*j.ihst[18]);for(var P=0;P<286;P++)j.lhst[P]=0;for(P=0;P<30;P++)j.dhst[P]=0;for(P=0;P<19;P++)j.ihst[P]=0;var k=A<I&&A<S?0:I<S?1:2;if(C(f,h,i),C(f,h+1,k),h+=3,k==0){for(;7&h;)h++;h=r.F._copyExact(l,c,d,f,h)}else{var F,q;if(k==1&&(F=j.fltree,q=j.fdtree),k==2){r.F.makeCodes(j.ltree,m),r.F.revCodes(j.ltree,m),r.F.makeCodes(j.dtree,g),r.F.revCodes(j.dtree,g),r.F.makeCodes(j.itree,b),r.F.revCodes(j.itree,b),F=j.ltree,q=j.dtree,v(f,h,x-257),v(f,h+=5,w-1),v(f,h+=5,N-4),h+=4;for(var O=0;O<N;O++)v(f,h+3*O,j.itree[1+(j.ordr[O]<<1)]);h+=3*N,h=r.F._codeTiny(E,j.itree,f,h),h=r.F._codeTiny(D,j.itree,f,h)}for(var M=c,W=0;W<o;W+=2){for(var z=s[W],J=z>>>23,ne=M+(8388607&z);M<ne;)h=r.F._writeLit(l[M++],F,f,h);if(J!=0){var V=s[W+1],$=V>>16,K=V>>8&255,X=255&V;v(f,h=r.F._writeLit(257+K,F,f,h),J-j.of0[K]),h+=j.exb[K],C(f,h=r.F._writeLit(X,q,f,h),$-j.df0[X]),h+=j.dxb[X],M+=J}}h=r.F._writeLit(256,F,f,h)}return h},r.F._copyExact=function(i,s,o,a,l){var c=l>>>3;return a[c]=o,a[c+1]=o>>>8,a[c+2]=255-a[c],a[c+3]=255-a[c+1],c+=4,a.set(new Uint8Array(i.buffer,s,o),c),l+(o+4<<3)},r.F.getTrees=function(){for(var i=r.F.U,s=r.F._hufTree(i.lhst,i.ltree,15),o=r.F._hufTree(i.dhst,i.dtree,15),a=[],l=r.F._lenCodes(i.ltree,a),c=[],d=r.F._lenCodes(i.dtree,c),f=0;f<a.length;f+=2)i.ihst[a[f]]++;for(f=0;f<c.length;f+=2)i.ihst[c[f]]++;for(var h=r.F._hufTree(i.ihst,i.itree,7),p=19;p>4&&i.itree[1+(i.ordr[p-1]<<1)]==0;)p--;return[s,o,h,l,d,p,a,c]},r.F.getSecond=function(i){for(var s=[],o=0;o<i.length;o+=2)s.push(i[o+1]);return s},r.F.nonZero=function(i){for(var s="",o=0;o<i.length;o+=2)i[o+1]!=0&&(s+=(o>>1)+",");return s},r.F.contSize=function(i,s){for(var o=0,a=0;a<s.length;a++)o+=s[a]*i[1+(a<<1)];return o},r.F._codeTiny=function(i,s,o,a){for(var l=0;l<i.length;l+=2){var c=i[l],d=i[l+1];a=r.F._writeLit(c,s,o,a);var f=c==16?2:c==17?3:7;c>15&&(r.F._putsE(o,a,d,f),a+=f)}return a},r.F._lenCodes=function(i,s){for(var o=i.length;o!=2&&i[o-1]==0;)o-=2;for(var a=0;a<o;a+=2){var l=i[a+1],c=a+3<o?i[a+3]:-1,d=a+5<o?i[a+5]:-1,f=a==0?-1:i[a-1];if(l==0&&c==l&&d==l){for(var h=a+5;h+2<o&&i[h+2]==l;)h+=2;(p=Math.min(h+1-a>>>1,138))<11?s.push(17,p-3):s.push(18,p-11),a+=2*p-2}else if(l==f&&c==l&&d==l){for(h=a+5;h+2<o&&i[h+2]==l;)h+=2;var p=Math.min(h+1-a>>>1,6);s.push(16,p-3),a+=2*p-2}else s.push(l,0)}return o>>>1},r.F._hufTree=function(i,s,o){var a=[],l=i.length,c=s.length,d=0;for(d=0;d<c;d+=2)s[d]=0,s[d+1]=0;for(d=0;d<l;d++)i[d]!=0&&a.push({lit:d,f:i[d]});var f=a.length,h=a.slice(0);if(f==0)return 0;if(f==1){var p=a[0].lit;return h=p==0?1:0,s[1+(p<<1)]=1,s[1+(h<<1)]=1,1}a.sort(function(E,D){return E.f-D.f});var m=a[0],g=a[1],b=0,x=1,w=2;for(a[0]={lit:-1,f:m.f+g.f,l:m,r:g,d:0};x!=f-1;)m=b!=x&&(w==f||a[b].f<a[w].f)?a[b++]:a[w++],g=b!=x&&(w==f||a[b].f<a[w].f)?a[b++]:a[w++],a[x++]={lit:-1,f:m.f+g.f,l:m,r:g};var N=r.F.setDepth(a[x-1],0);for(N>o&&(r.F.restrictDepth(h,o,N),N=o),d=0;d<f;d++)s[1+(h[d].lit<<1)]=h[d].d;return N},r.F.setDepth=function(i,s){return i.lit!=-1?(i.d=s,s):Math.max(r.F.setDepth(i.l,s+1),r.F.setDepth(i.r,s+1))},r.F.restrictDepth=function(i,s,o){var a=0,l=1<<o-s,c=0;for(i.sort(function(f,h){return h.d==f.d?f.f-h.f:h.d-f.d}),a=0;a<i.length&&i[a].d>s;a++){var d=i[a].d;i[a].d=s,c+=l-(1<<o-d)}for(c>>>=o-s;c>0;)(d=i[a].d)<s?(i[a].d++,c-=1<<s-d-1):a++;for(;a>=0;a--)i[a].d==s&&c<0&&(i[a].d--,c++);c!=0&&console.log("debt left")},r.F._goodIndex=function(i,s){var o=0;return s[16|o]<=i&&(o|=16),s[8|o]<=i&&(o|=8),s[4|o]<=i&&(o|=4),s[2|o]<=i&&(o|=2),s[1|o]<=i&&(o|=1),o},r.F._writeLit=function(i,s,o,a){return r.F._putsF(o,a,s[i<<1]),a+s[1+(i<<1)]},r.F.inflate=function(i,s){var o=Uint8Array;if(i[0]==3&&i[1]==0)return s||new o(0);var a=r.F,l=a._bitsF,c=a._bitsE,d=a._decodeTiny,f=a.makeCodes,h=a.codes2map,p=a._get17,m=a.U,g=s==null;g&&(s=new o(i.length>>>2<<3));for(var b,x,w=0,N=0,E=0,D=0,j=0,C=0,v=0,A=0,I=0;w==0;)if(w=l(i,I,1),N=l(i,I+1,2),I+=3,N!=0){if(g&&(s=r.F._check(s,A+(1<<17))),N==1&&(b=m.flmap,x=m.fdmap,C=511,v=31),N==2){E=c(i,I,5)+257,D=c(i,I+5,5)+1,j=c(i,I+10,4)+4,I+=14;for(var S=0;S<38;S+=2)m.itree[S]=0,m.itree[S+1]=0;var P=1;for(S=0;S<j;S++){var k=c(i,I+3*S,3);m.itree[1+(m.ordr[S]<<1)]=k,k>P&&(P=k)}I+=3*j,f(m.itree,P),h(m.itree,P,m.imap),b=m.lmap,x=m.dmap,I=d(m.imap,(1<<P)-1,E+D,i,I,m.ttree);var F=a._copyOut(m.ttree,0,E,m.ltree);C=(1<<F)-1;var q=a._copyOut(m.ttree,E,D,m.dtree);v=(1<<q)-1,f(m.ltree,F),h(m.ltree,F,b),f(m.dtree,q),h(m.dtree,q,x)}for(;;){var O=b[p(i,I)&C];I+=15&O;var M=O>>>4;if(!(M>>>8))s[A++]=M;else{if(M==256)break;var W=A+M-254;if(M>264){var z=m.ldef[M-257];W=A+(z>>>3)+c(i,I,7&z),I+=7&z}var J=x[p(i,I)&v];I+=15&J;var ne=J>>>4,V=m.ddef[ne],$=(V>>>4)+l(i,I,15&V);for(I+=15&V,g&&(s=r.F._check(s,A+(1<<17)));A<W;)s[A]=s[A++-$],s[A]=s[A++-$],s[A]=s[A++-$],s[A]=s[A++-$];A=W}}}else{7&I&&(I+=8-(7&I));var K=4+(I>>>3),X=i[K-4]|i[K-3]<<8;g&&(s=r.F._check(s,A+X)),s.set(new o(i.buffer,i.byteOffset+K,X),A),I=K+X<<3,A+=X}return s.length==A?s:s.slice(0,A)},r.F._check=function(i,s){var o=i.length;if(s<=o)return i;var a=new Uint8Array(Math.max(o<<1,s));return a.set(i,0),a},r.F._decodeTiny=function(i,s,o,a,l,c){for(var d=r.F._bitsE,f=r.F._get17,h=0;h<o;){var p=i[f(a,l)&s];l+=15&p;var m=p>>>4;if(m<=15)c[h]=m,h++;else{var g=0,b=0;m==16?(b=3+d(a,l,2),l+=2,g=c[h-1]):m==17?(b=3+d(a,l,3),l+=3):m==18&&(b=11+d(a,l,7),l+=7);for(var x=h+b;h<x;)c[h]=g,h++}}return l},r.F._copyOut=function(i,s,o,a){for(var l=0,c=0,d=a.length>>>1;c<o;){var f=i[c+s];a[c<<1]=0,a[1+(c<<1)]=f,f>l&&(l=f),c++}for(;c<d;)a[c<<1]=0,a[1+(c<<1)]=0,c++;return l},r.F.makeCodes=function(i,s){for(var o,a,l,c,d=r.F.U,f=i.length,h=d.bl_count,p=0;p<=s;p++)h[p]=0;for(p=1;p<f;p+=2)h[i[p]]++;var m=d.next_code;for(o=0,h[0]=0,a=1;a<=s;a++)o=o+h[a-1]<<1,m[a]=o;for(l=0;l<f;l+=2)(c=i[l+1])!=0&&(i[l]=m[c],m[c]++)},r.F.codes2map=function(i,s,o){for(var a=i.length,l=r.F.U.rev15,c=0;c<a;c+=2)if(i[c+1]!=0)for(var d=c>>1,f=i[c+1],h=d<<4|f,p=s-f,m=i[c]<<p,g=m+(1<<p);m!=g;)o[l[m]>>>15-s]=h,m++},r.F.revCodes=function(i,s){for(var o=r.F.U.rev15,a=15-s,l=0;l<i.length;l+=2){var c=i[l]<<s-i[l+1];i[l]=o[c]>>>a}},r.F._putsE=function(i,s,o){o<<=7&s;var a=s>>>3;i[a]|=o,i[a+1]|=o>>>8},r.F._putsF=function(i,s,o){o<<=7&s;var a=s>>>3;i[a]|=o,i[a+1]|=o>>>8,i[a+2]|=o>>>16},r.F._bitsE=function(i,s,o){return(i[s>>>3]|i[1+(s>>>3)]<<8)>>>(7&s)&(1<<o)-1},r.F._bitsF=function(i,s,o){return(i[s>>>3]|i[1+(s>>>3)]<<8|i[2+(s>>>3)]<<16)>>>(7&s)&(1<<o)-1},r.F._get17=function(i,s){return(i[s>>>3]|i[1+(s>>>3)]<<8|i[2+(s>>>3)]<<16)>>>(7&s)},r.F._get25=function(i,s){return(i[s>>>3]|i[1+(s>>>3)]<<8|i[2+(s>>>3)]<<16|i[3+(s>>>3)]<<24)>>>(7&s)},r.F.U=(e=Uint16Array,n=Uint32Array,{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new n(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new n(286),dhst:new n(30),ihst:new n(19),lits:new n(15e3),strt:new e(65536),prev:new e(32768)}),function(){for(var i=r.F.U,s=0;s<32768;s++){var o=s;o=(4278255360&(o=(4042322160&(o=(3435973836&(o=(2863311530&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,i.rev15[s]=(o>>>16|o<<16)>>>17}function a(l,c,d){for(;c--!=0;)l.push(0,d)}for(s=0;s<32;s++)i.ldef[s]=i.of0[s]<<3|i.exb[s],i.ddef[s]=i.df0[s]<<4|i.dxb[s];a(i.fltree,144,8),a(i.fltree,112,9),a(i.fltree,24,7),a(i.fltree,8,8),r.F.makeCodes(i.fltree,9),r.F.codes2map(i.fltree,9,i.flmap),r.F.revCodes(i.fltree,9),a(i.fdtree,32,5),r.F.makeCodes(i.fdtree,5),r.F.codes2map(i.fdtree,5,i.fdmap),r.F.revCodes(i.fdtree,5),a(i.itree,19,0),a(i.ltree,286,0),a(i.dtree,30,0),a(i.ttree,320,0)}()})();var IH=PH({__proto__:null,default:ex},[ex]);const qo=function(){var t={nextZero(d,f){for(;d[f]!=0;)f++;return f},readUshort:(d,f)=>d[f]<<8|d[f+1],writeUshort(d,f,h){d[f]=h>>8&255,d[f+1]=255&h},readUint:(d,f)=>16777216*d[f]+(d[f+1]<<16|d[f+2]<<8|d[f+3]),writeUint(d,f,h){d[f]=h>>24&255,d[f+1]=h>>16&255,d[f+2]=h>>8&255,d[f+3]=255&h},readASCII(d,f,h){let p="";for(let m=0;m<h;m++)p+=String.fromCharCode(d[f+m]);return p},writeASCII(d,f,h){for(let p=0;p<h.length;p++)d[f+p]=h.charCodeAt(p)},readBytes(d,f,h){const p=[];for(let m=0;m<h;m++)p.push(d[f+m]);return p},pad:d=>d.length<2?`0${d}`:d,readUTF8(d,f,h){let p,m="";for(let g=0;g<h;g++)m+=`%${t.pad(d[f+g].toString(16))}`;try{p=decodeURIComponent(m)}catch{return t.readASCII(d,f,h)}return p}};function e(d,f,h,p){const m=f*h,g=s(p),b=Math.ceil(f*g/8),x=new Uint8Array(4*m),w=new Uint32Array(x.buffer),{ctype:N}=p,{depth:E}=p,D=t.readUshort;if(N==6){const z=m<<2;if(E==8)for(var j=0;j<z;j+=4)x[j]=d[j],x[j+1]=d[j+1],x[j+2]=d[j+2],x[j+3]=d[j+3];if(E==16)for(j=0;j<z;j++)x[j]=d[j<<1]}else if(N==2){const z=p.tabs.tRNS;if(z==null){if(E==8)for(j=0;j<m;j++){var C=3*j;w[j]=255<<24|d[C+2]<<16|d[C+1]<<8|d[C]}if(E==16)for(j=0;j<m;j++)C=6*j,w[j]=255<<24|d[C+4]<<16|d[C+2]<<8|d[C]}else{var v=z[0];const J=z[1],ne=z[2];if(E==8)for(j=0;j<m;j++){var A=j<<2;C=3*j,w[j]=255<<24|d[C+2]<<16|d[C+1]<<8|d[C],d[C]==v&&d[C+1]==J&&d[C+2]==ne&&(x[A+3]=0)}if(E==16)for(j=0;j<m;j++)A=j<<2,C=6*j,w[j]=255<<24|d[C+4]<<16|d[C+2]<<8|d[C],D(d,C)==v&&D(d,C+2)==J&&D(d,C+4)==ne&&(x[A+3]=0)}}else if(N==3){const z=p.tabs.PLTE,J=p.tabs.tRNS,ne=J?J.length:0;if(E==1)for(var I=0;I<h;I++){var S=I*b,P=I*f;for(j=0;j<f;j++){A=P+j<<2;var k=3*(F=d[S+(j>>3)]>>7-((7&j)<<0)&1);x[A]=z[k],x[A+1]=z[k+1],x[A+2]=z[k+2],x[A+3]=F<ne?J[F]:255}}if(E==2)for(I=0;I<h;I++)for(S=I*b,P=I*f,j=0;j<f;j++)A=P+j<<2,k=3*(F=d[S+(j>>2)]>>6-((3&j)<<1)&3),x[A]=z[k],x[A+1]=z[k+1],x[A+2]=z[k+2],x[A+3]=F<ne?J[F]:255;if(E==4)for(I=0;I<h;I++)for(S=I*b,P=I*f,j=0;j<f;j++)A=P+j<<2,k=3*(F=d[S+(j>>1)]>>4-((1&j)<<2)&15),x[A]=z[k],x[A+1]=z[k+1],x[A+2]=z[k+2],x[A+3]=F<ne?J[F]:255;if(E==8)for(j=0;j<m;j++){var F;A=j<<2,k=3*(F=d[j]),x[A]=z[k],x[A+1]=z[k+1],x[A+2]=z[k+2],x[A+3]=F<ne?J[F]:255}}else if(N==4){if(E==8)for(j=0;j<m;j++){A=j<<2;var q=d[O=j<<1];x[A]=q,x[A+1]=q,x[A+2]=q,x[A+3]=d[O+1]}if(E==16)for(j=0;j<m;j++){var O;A=j<<2,q=d[O=j<<2],x[A]=q,x[A+1]=q,x[A+2]=q,x[A+3]=d[O+2]}}else if(N==0)for(v=p.tabs.tRNS?p.tabs.tRNS:-1,I=0;I<h;I++){const z=I*b,J=I*f;if(E==1)for(var M=0;M<f;M++){var W=(q=255*(d[z+(M>>>3)]>>>7-(7&M)&1))==255*v?0:255;w[J+M]=W<<24|q<<16|q<<8|q}else if(E==2)for(M=0;M<f;M++)W=(q=85*(d[z+(M>>>2)]>>>6-((3&M)<<1)&3))==85*v?0:255,w[J+M]=W<<24|q<<16|q<<8|q;else if(E==4)for(M=0;M<f;M++)W=(q=17*(d[z+(M>>>1)]>>>4-((1&M)<<2)&15))==17*v?0:255,w[J+M]=W<<24|q<<16|q<<8|q;else if(E==8)for(M=0;M<f;M++)W=(q=d[z+M])==v?0:255,w[J+M]=W<<24|q<<16|q<<8|q;else if(E==16)for(M=0;M<f;M++)q=d[z+(M<<1)],W=D(d,z+(M<<1))==v?0:255,w[J+M]=W<<24|q<<16|q<<8|q}return x}function n(d,f,h,p){const m=s(d),g=Math.ceil(h*m/8),b=new Uint8Array((g+1+d.interlace)*p);return f=d.tabs.CgBI?i(f,b):r(f,b),d.interlace==0?f=o(f,d,0,h,p):d.interlace==1&&(f=function(w,N){const E=N.width,D=N.height,j=s(N),C=j>>3,v=Math.ceil(E*j/8),A=new Uint8Array(D*v);let I=0;const S=[0,0,4,0,2,0,1],P=[0,4,0,2,0,1,0],k=[8,8,8,4,4,2,2],F=[8,8,4,4,2,2,1];let q=0;for(;q<7;){const M=k[q],W=F[q];let z=0,J=0,ne=S[q];for(;ne<D;)ne+=M,J++;let V=P[q];for(;V<E;)V+=W,z++;const $=Math.ceil(z*j/8);o(w,N,I,z,J);let K=0,X=S[q];for(;X<D;){let ae=P[q],ye=I+K*$<<3;for(;ae<E;){var O;if(j==1&&(O=(O=w[ye>>3])>>7-(7&ye)&1,A[X*v+(ae>>3)]|=O<<7-((7&ae)<<0)),j==2&&(O=(O=w[ye>>3])>>6-(7&ye)&3,A[X*v+(ae>>2)]|=O<<6-((3&ae)<<1)),j==4&&(O=(O=w[ye>>3])>>4-(7&ye)&15,A[X*v+(ae>>1)]|=O<<4-((1&ae)<<2)),j>=8){const me=X*v+ae*C;for(let _e=0;_e<C;_e++)A[me+_e]=w[(ye>>3)+_e]}ye+=j,ae+=W}K++,X+=M}z*J!=0&&(I+=J*(1+$)),q+=1}return A}(f,d)),f}function r(d,f){return i(new Uint8Array(d.buffer,2,d.length-6),f)}var i=function(){const d={H:{}};return d.H.N=function(f,h){const p=Uint8Array;let m,g,b=0,x=0,w=0,N=0,E=0,D=0,j=0,C=0,v=0;if(f[0]==3&&f[1]==0)return h||new p(0);const A=d.H,I=A.b,S=A.e,P=A.R,k=A.n,F=A.A,q=A.Z,O=A.m,M=h==null;for(M&&(h=new p(f.length>>>2<<5));b==0;)if(b=I(f,v,1),x=I(f,v+1,2),v+=3,x!=0){if(M&&(h=d.H.W(h,C+(1<<17))),x==1&&(m=O.J,g=O.h,D=511,j=31),x==2){w=S(f,v,5)+257,N=S(f,v+5,5)+1,E=S(f,v+10,4)+4,v+=14;let z=1;for(var W=0;W<38;W+=2)O.Q[W]=0,O.Q[W+1]=0;for(W=0;W<E;W++){const V=S(f,v+3*W,3);O.Q[1+(O.X[W]<<1)]=V,V>z&&(z=V)}v+=3*E,k(O.Q,z),F(O.Q,z,O.u),m=O.w,g=O.d,v=P(O.u,(1<<z)-1,w+N,f,v,O.v);const J=A.V(O.v,0,w,O.C);D=(1<<J)-1;const ne=A.V(O.v,w,N,O.D);j=(1<<ne)-1,k(O.C,J),F(O.C,J,m),k(O.D,ne),F(O.D,ne,g)}for(;;){const z=m[q(f,v)&D];v+=15&z;const J=z>>>4;if(!(J>>>8))h[C++]=J;else{if(J==256)break;{let ne=C+J-254;if(J>264){const ae=O.q[J-257];ne=C+(ae>>>3)+S(f,v,7&ae),v+=7&ae}const V=g[q(f,v)&j];v+=15&V;const $=V>>>4,K=O.c[$],X=(K>>>4)+I(f,v,15&K);for(v+=15&K;C<ne;)h[C]=h[C++-X],h[C]=h[C++-X],h[C]=h[C++-X],h[C]=h[C++-X];C=ne}}}}else{7&v&&(v+=8-(7&v));const z=4+(v>>>3),J=f[z-4]|f[z-3]<<8;M&&(h=d.H.W(h,C+J)),h.set(new p(f.buffer,f.byteOffset+z,J),C),v=z+J<<3,C+=J}return h.length==C?h:h.slice(0,C)},d.H.W=function(f,h){const p=f.length;if(h<=p)return f;const m=new Uint8Array(p<<1);return m.set(f,0),m},d.H.R=function(f,h,p,m,g,b){const x=d.H.e,w=d.H.Z;let N=0;for(;N<p;){const E=f[w(m,g)&h];g+=15&E;const D=E>>>4;if(D<=15)b[N]=D,N++;else{let j=0,C=0;D==16?(C=3+x(m,g,2),g+=2,j=b[N-1]):D==17?(C=3+x(m,g,3),g+=3):D==18&&(C=11+x(m,g,7),g+=7);const v=N+C;for(;N<v;)b[N]=j,N++}}return g},d.H.V=function(f,h,p,m){let g=0,b=0;const x=m.length>>>1;for(;b<p;){const w=f[b+h];m[b<<1]=0,m[1+(b<<1)]=w,w>g&&(g=w),b++}for(;b<x;)m[b<<1]=0,m[1+(b<<1)]=0,b++;return g},d.H.n=function(f,h){const p=d.H.m,m=f.length;let g,b,x,w;const N=p.j;for(var E=0;E<=h;E++)N[E]=0;for(E=1;E<m;E+=2)N[f[E]]++;const D=p.K;for(g=0,N[0]=0,b=1;b<=h;b++)g=g+N[b-1]<<1,D[b]=g;for(x=0;x<m;x+=2)w=f[x+1],w!=0&&(f[x]=D[w],D[w]++)},d.H.A=function(f,h,p){const m=f.length,g=d.H.m.r;for(let b=0;b<m;b+=2)if(f[b+1]!=0){const x=b>>1,w=f[b+1],N=x<<4|w,E=h-w;let D=f[b]<<E;const j=D+(1<<E);for(;D!=j;)p[g[D]>>>15-h]=N,D++}},d.H.l=function(f,h){const p=d.H.m.r,m=15-h;for(let g=0;g<f.length;g+=2){const b=f[g]<<h-f[g+1];f[g]=p[b]>>>m}},d.H.M=function(f,h,p){p<<=7&h;const m=h>>>3;f[m]|=p,f[m+1]|=p>>>8},d.H.I=function(f,h,p){p<<=7&h;const m=h>>>3;f[m]|=p,f[m+1]|=p>>>8,f[m+2]|=p>>>16},d.H.e=function(f,h,p){return(f[h>>>3]|f[1+(h>>>3)]<<8)>>>(7&h)&(1<<p)-1},d.H.b=function(f,h,p){return(f[h>>>3]|f[1+(h>>>3)]<<8|f[2+(h>>>3)]<<16)>>>(7&h)&(1<<p)-1},d.H.Z=function(f,h){return(f[h>>>3]|f[1+(h>>>3)]<<8|f[2+(h>>>3)]<<16)>>>(7&h)},d.H.i=function(f,h){return(f[h>>>3]|f[1+(h>>>3)]<<8|f[2+(h>>>3)]<<16|f[3+(h>>>3)]<<24)>>>(7&h)},d.H.m=function(){const f=Uint16Array,h=Uint32Array;return{K:new f(16),j:new f(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new f(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new h(32),J:new f(512),_:[],h:new f(32),$:[],w:new f(32768),C:[],v:[],d:new f(32768),D:[],u:new f(512),Q:[],r:new f(32768),s:new h(286),Y:new h(30),a:new h(19),t:new h(15e3),k:new f(65536),g:new f(32768)}}(),function(){const f=d.H.m;for(var h=0;h<32768;h++){let m=h;m=(2863311530&m)>>>1|(1431655765&m)<<1,m=(3435973836&m)>>>2|(858993459&m)<<2,m=(4042322160&m)>>>4|(252645135&m)<<4,m=(4278255360&m)>>>8|(16711935&m)<<8,f.r[h]=(m>>>16|m<<16)>>>17}function p(m,g,b){for(;g--!=0;)m.push(0,b)}for(h=0;h<32;h++)f.q[h]=f.S[h]<<3|f.T[h],f.c[h]=f.p[h]<<4|f.z[h];p(f._,144,8),p(f._,112,9),p(f._,24,7),p(f._,8,8),d.H.n(f._,9),d.H.A(f._,9,f.J),d.H.l(f._,9),p(f.$,32,5),d.H.n(f.$,5),d.H.A(f.$,5,f.h),d.H.l(f.$,5),p(f.Q,19,0),p(f.C,286,0),p(f.D,30,0),p(f.v,320,0)}(),d.H.N}();function s(d){return[1,null,3,1,2,null,4][d.ctype]*d.depth}function o(d,f,h,p,m){let g=s(f);const b=Math.ceil(p*g/8);let x,w;g=Math.ceil(g/8);let N=d[h],E=0;if(N>1&&(d[h]=[0,0,1][N-2]),N==3)for(E=g;E<b;E++)d[E+1]=d[E+1]+(d[E+1-g]>>>1)&255;for(let D=0;D<m;D++)if(x=h+D*b,w=x+D+1,N=d[w-1],E=0,N==0)for(;E<b;E++)d[x+E]=d[w+E];else if(N==1){for(;E<g;E++)d[x+E]=d[w+E];for(;E<b;E++)d[x+E]=d[w+E]+d[x+E-g]}else if(N==2)for(;E<b;E++)d[x+E]=d[w+E]+d[x+E-b];else if(N==3){for(;E<g;E++)d[x+E]=d[w+E]+(d[x+E-b]>>>1);for(;E<b;E++)d[x+E]=d[w+E]+(d[x+E-b]+d[x+E-g]>>>1)}else{for(;E<g;E++)d[x+E]=d[w+E]+a(0,d[x+E-b],0);for(;E<b;E++)d[x+E]=d[w+E]+a(d[x+E-g],d[x+E-b],d[x+E-g-b])}return d}function a(d,f,h){const p=d+f-h,m=p-d,g=p-f,b=p-h;return m*m<=g*g&&m*m<=b*b?d:g*g<=b*b?f:h}function l(d,f,h){h.width=t.readUint(d,f),f+=4,h.height=t.readUint(d,f),f+=4,h.depth=d[f],f++,h.ctype=d[f],f++,h.compress=d[f],f++,h.filter=d[f],f++,h.interlace=d[f],f++}function c(d,f,h,p,m,g,b,x,w){const N=Math.min(f,m),E=Math.min(h,g);let D=0,j=0;for(let q=0;q<E;q++)for(let O=0;O<N;O++)if(b>=0&&x>=0?(D=q*f+O<<2,j=(x+q)*m+b+O<<2):(D=(-x+q)*f-b+O<<2,j=q*m+O<<2),w==0)p[j]=d[D],p[j+1]=d[D+1],p[j+2]=d[D+2],p[j+3]=d[D+3];else if(w==1){var C=d[D+3]*.00392156862745098,v=d[D]*C,A=d[D+1]*C,I=d[D+2]*C,S=p[j+3]*(1/255),P=p[j]*S,k=p[j+1]*S,F=p[j+2]*S;const M=1-C,W=C+S*M,z=W==0?0:1/W;p[j+3]=255*W,p[j+0]=(v+P*M)*z,p[j+1]=(A+k*M)*z,p[j+2]=(I+F*M)*z}else if(w==2)C=d[D+3],v=d[D],A=d[D+1],I=d[D+2],S=p[j+3],P=p[j],k=p[j+1],F=p[j+2],C==S&&v==P&&A==k&&I==F?(p[j]=0,p[j+1]=0,p[j+2]=0,p[j+3]=0):(p[j]=v,p[j+1]=A,p[j+2]=I,p[j+3]=C);else if(w==3){if(C=d[D+3],v=d[D],A=d[D+1],I=d[D+2],S=p[j+3],P=p[j],k=p[j+1],F=p[j+2],C==S&&v==P&&A==k&&I==F)continue;if(C<220&&S>20)return!1}return!0}return{decode:function(f){const h=new Uint8Array(f);let p=8;const m=t,g=m.readUshort,b=m.readUint,x={tabs:{},frames:[]},w=new Uint8Array(h.length);let N,E=0,D=0;const j=[137,80,78,71,13,10,26,10];for(var C=0;C<8;C++)if(h[C]!=j[C])throw"The input is not a PNG file!";for(;p<h.length;){const q=m.readUint(h,p);p+=4;const O=m.readASCII(h,p,4);if(p+=4,O=="IHDR")l(h,p,x);else if(O=="iCCP"){for(var v=p;h[v]!=0;)v++;m.readASCII(h,p,v-p),h[v+1];const M=h.slice(v+2,p+q);let W=null;try{W=r(M)}catch{W=i(M)}x.tabs[O]=W}else if(O=="CgBI")x.tabs[O]=h.slice(p,p+4);else if(O=="IDAT"){for(C=0;C<q;C++)w[E+C]=h[p+C];E+=q}else if(O=="acTL")x.tabs[O]={num_frames:b(h,p),num_plays:b(h,p+4)},N=new Uint8Array(h.length);else if(O=="fcTL"){D!=0&&((F=x.frames[x.frames.length-1]).data=n(x,N.slice(0,D),F.rect.width,F.rect.height),D=0);const M={x:b(h,p+12),y:b(h,p+16),width:b(h,p+4),height:b(h,p+8)};let W=g(h,p+22);W=g(h,p+20)/(W==0?100:W);const z={rect:M,delay:Math.round(1e3*W),dispose:h[p+24],blend:h[p+25]};x.frames.push(z)}else if(O=="fdAT"){for(C=0;C<q-4;C++)N[D+C]=h[p+C+4];D+=q-4}else if(O=="pHYs")x.tabs[O]=[m.readUint(h,p),m.readUint(h,p+4),h[p+8]];else if(O=="cHRM")for(x.tabs[O]=[],C=0;C<8;C++)x.tabs[O].push(m.readUint(h,p+4*C));else if(O=="tEXt"||O=="zTXt"){x.tabs[O]==null&&(x.tabs[O]={});var A=m.nextZero(h,p),I=m.readASCII(h,p,A-p),S=p+q-A-1;if(O=="tEXt")k=m.readASCII(h,A+1,S);else{var P=r(h.slice(A+2,A+2+S));k=m.readUTF8(P,0,P.length)}x.tabs[O][I]=k}else if(O=="iTXt"){x.tabs[O]==null&&(x.tabs[O]={}),A=0,v=p,A=m.nextZero(h,v),I=m.readASCII(h,v,A-v);const M=h[v=A+1];var k;h[v+1],v+=2,A=m.nextZero(h,v),m.readASCII(h,v,A-v),v=A+1,A=m.nextZero(h,v),m.readUTF8(h,v,A-v),S=q-((v=A+1)-p),M==0?k=m.readUTF8(h,v,S):(P=r(h.slice(v,v+S)),k=m.readUTF8(P,0,P.length)),x.tabs[O][I]=k}else if(O=="PLTE")x.tabs[O]=m.readBytes(h,p,q);else if(O=="hIST"){const M=x.tabs.PLTE.length/3;for(x.tabs[O]=[],C=0;C<M;C++)x.tabs[O].push(g(h,p+2*C))}else if(O=="tRNS")x.ctype==3?x.tabs[O]=m.readBytes(h,p,q):x.ctype==0?x.tabs[O]=g(h,p):x.ctype==2&&(x.tabs[O]=[g(h,p),g(h,p+2),g(h,p+4)]);else if(O=="gAMA")x.tabs[O]=m.readUint(h,p)/1e5;else if(O=="sRGB")x.tabs[O]=h[p];else if(O=="bKGD")x.ctype==0||x.ctype==4?x.tabs[O]=[g(h,p)]:x.ctype==2||x.ctype==6?x.tabs[O]=[g(h,p),g(h,p+2),g(h,p+4)]:x.ctype==3&&(x.tabs[O]=h[p]);else if(O=="IEND")break;p+=q,m.readUint(h,p),p+=4}var F;return D!=0&&((F=x.frames[x.frames.length-1]).data=n(x,N.slice(0,D),F.rect.width,F.rect.height)),x.data=n(x,w,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(f){const h=f.width,p=f.height;if(f.tabs.acTL==null)return[e(f.data,h,p,f).buffer];const m=[];f.frames[0].data==null&&(f.frames[0].data=f.data);const g=h*p*4,b=new Uint8Array(g),x=new Uint8Array(g),w=new Uint8Array(g);for(let E=0;E<f.frames.length;E++){const D=f.frames[E],j=D.rect.x,C=D.rect.y,v=D.rect.width,A=D.rect.height,I=e(D.data,v,A,f);if(E!=0)for(var N=0;N<g;N++)w[N]=b[N];if(D.blend==0?c(I,v,A,b,h,p,j,C,0):D.blend==1&&c(I,v,A,b,h,p,j,C,1),m.push(b.buffer.slice(0)),D.dispose!=0){if(D.dispose==1)c(x,v,A,b,h,p,j,C,0);else if(D.dispose==2)for(N=0;N<g;N++)b[N]=w[N]}}return m},_paeth:a,_copyTile:c,_bin:t}}();(function(){const{_copyTile:t}=qo,{_bin:e}=qo,n=qo._paeth;var r={table:function(){const v=new Uint32Array(256);for(let A=0;A<256;A++){let I=A;for(let S=0;S<8;S++)1&I?I=3988292384^I>>>1:I>>>=1;v[A]=I}return v}(),update(v,A,I,S){for(let P=0;P<S;P++)v=r.table[255&(v^A[I+P])]^v>>>8;return v},crc:(v,A,I)=>4294967295^r.update(4294967295,v,A,I)};function i(v,A,I,S){A[I]+=v[0]*S>>4,A[I+1]+=v[1]*S>>4,A[I+2]+=v[2]*S>>4,A[I+3]+=v[3]*S>>4}function s(v){return Math.max(0,Math.min(255,v))}function o(v,A){const I=v[0]-A[0],S=v[1]-A[1],P=v[2]-A[2],k=v[3]-A[3];return I*I+S*S+P*P+k*k}function a(v,A,I,S,P,k,F){F==null&&(F=1);const q=S.length,O=[];for(var M=0;M<q;M++){const X=S[M];O.push([X>>>0&255,X>>>8&255,X>>>16&255,X>>>24&255])}for(M=0;M<q;M++){let X=4294967295;for(var W=0,z=0;z<q;z++){var J=o(O[M],O[z]);z!=M&&J<X&&(X=J,W=z)}}const ne=new Uint32Array(P.buffer),V=new Int16Array(A*I*4),$=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(M=0;M<$.length;M++)$[M]=255*(($[M]+.5)/16-.5);for(let X=0;X<I;X++)for(let ae=0;ae<A;ae++){var K;M=4*(X*A+ae),F!=2?K=[s(v[M]+V[M]),s(v[M+1]+V[M+1]),s(v[M+2]+V[M+2]),s(v[M+3]+V[M+3])]:(J=$[4*(3&X)+(3&ae)],K=[s(v[M]+J),s(v[M+1]+J),s(v[M+2]+J),s(v[M+3]+J)]),W=0;let ye=16777215;for(z=0;z<q;z++){const Se=o(K,O[z]);Se<ye&&(ye=Se,W=z)}const me=O[W],_e=[K[0]-me[0],K[1]-me[1],K[2]-me[2],K[3]-me[3]];F==1&&(ae!=A-1&&i(_e,V,M+4,7),X!=I-1&&(ae!=0&&i(_e,V,M+4*A-4,3),i(_e,V,M+4*A,5),ae!=A-1&&i(_e,V,M+4*A+4,1))),k[M>>2]=W,ne[M>>2]=S[W]}}function l(v,A,I,S,P){P==null&&(P={});const{crc:k}=r,F=e.writeUint,q=e.writeUshort,O=e.writeASCII;let M=8;const W=v.frames.length>1;let z,J=!1,ne=33+(W?20:0);if(P.sRGB!=null&&(ne+=13),P.pHYs!=null&&(ne+=21),P.iCCP!=null&&(z=pako.deflate(P.iCCP),ne+=21+z.length+4),v.ctype==3){for(var V=v.plte.length,$=0;$<V;$++)v.plte[$]>>>24!=255&&(J=!0);ne+=8+3*V+4+(J?8+1*V+4:0)}for(var K=0;K<v.frames.length;K++)W&&(ne+=38),ne+=(me=v.frames[K]).cimg.length+12,K!=0&&(ne+=4);ne+=12;const X=new Uint8Array(ne),ae=[137,80,78,71,13,10,26,10];for($=0;$<8;$++)X[$]=ae[$];if(F(X,M,13),M+=4,O(X,M,"IHDR"),M+=4,F(X,M,A),M+=4,F(X,M,I),M+=4,X[M]=v.depth,M++,X[M]=v.ctype,M++,X[M]=0,M++,X[M]=0,M++,X[M]=0,M++,F(X,M,k(X,M-17,17)),M+=4,P.sRGB!=null&&(F(X,M,1),M+=4,O(X,M,"sRGB"),M+=4,X[M]=P.sRGB,M++,F(X,M,k(X,M-5,5)),M+=4),P.iCCP!=null){const _e=13+z.length;F(X,M,_e),M+=4,O(X,M,"iCCP"),M+=4,O(X,M,"ICC profile"),M+=11,M+=2,X.set(z,M),M+=z.length,F(X,M,k(X,M-(_e+4),_e+4)),M+=4}if(P.pHYs!=null&&(F(X,M,9),M+=4,O(X,M,"pHYs"),M+=4,F(X,M,P.pHYs[0]),M+=4,F(X,M,P.pHYs[1]),M+=4,X[M]=P.pHYs[2],M++,F(X,M,k(X,M-13,13)),M+=4),W&&(F(X,M,8),M+=4,O(X,M,"acTL"),M+=4,F(X,M,v.frames.length),M+=4,F(X,M,P.loop!=null?P.loop:0),M+=4,F(X,M,k(X,M-12,12)),M+=4),v.ctype==3){for(F(X,M,3*(V=v.plte.length)),M+=4,O(X,M,"PLTE"),M+=4,$=0;$<V;$++){const _e=3*$,Se=v.plte[$],Ce=255&Se,ze=Se>>>8&255,$e=Se>>>16&255;X[M+_e+0]=Ce,X[M+_e+1]=ze,X[M+_e+2]=$e}if(M+=3*V,F(X,M,k(X,M-3*V-4,3*V+4)),M+=4,J){for(F(X,M,V),M+=4,O(X,M,"tRNS"),M+=4,$=0;$<V;$++)X[M+$]=v.plte[$]>>>24&255;M+=V,F(X,M,k(X,M-V-4,V+4)),M+=4}}let ye=0;for(K=0;K<v.frames.length;K++){var me=v.frames[K];W&&(F(X,M,26),M+=4,O(X,M,"fcTL"),M+=4,F(X,M,ye++),M+=4,F(X,M,me.rect.width),M+=4,F(X,M,me.rect.height),M+=4,F(X,M,me.rect.x),M+=4,F(X,M,me.rect.y),M+=4,q(X,M,S[K]),M+=2,q(X,M,1e3),M+=2,X[M]=me.dispose,M++,X[M]=me.blend,M++,F(X,M,k(X,M-30,30)),M+=4);const _e=me.cimg;F(X,M,(V=_e.length)+(K==0?0:4)),M+=4;const Se=M;O(X,M,K==0?"IDAT":"fdAT"),M+=4,K!=0&&(F(X,M,ye++),M+=4),X.set(_e,M),M+=V,F(X,M,k(X,Se,M-Se)),M+=4}return F(X,M,0),M+=4,O(X,M,"IEND"),M+=4,F(X,M,k(X,M-4,4)),M+=4,X.buffer}function c(v,A,I){for(let S=0;S<v.frames.length;S++){const P=v.frames[S];P.rect.width;const k=P.rect.height,F=new Uint8Array(k*P.bpl+k);P.cimg=p(P.img,k,P.bpp,P.bpl,F,A,I)}}function d(v,A,I,S,P){const k=P[0],F=P[1],q=P[2],O=P[3],M=P[4],W=P[5];let z=6,J=8,ne=255;for(var V=0;V<v.length;V++){const fe=new Uint8Array(v[V]);for(var $=fe.length,K=0;K<$;K+=4)ne&=fe[K+3]}const X=ne!=255,ae=function(yt,nt,qe,Xe,Ye,Je){const ut=[];for(var mt=0;mt<yt.length;mt++){const Ot=new Uint8Array(yt[mt]),at=new Uint32Array(Ot.buffer);var Dt;let cn=0,Yt=0,Rn=nt,nn=qe,An=Xe?1:0;if(mt!=0){const Zr=Je||Xe||mt==1||ut[mt-2].dispose!=0?1:2;let sn=0,ui=1e9;for(let yn=0;yn<Zr;yn++){var _t=new Uint8Array(yt[mt-1-yn]);const mr=new Uint32Array(yt[mt-1-yn]);let Xn=nt,pn=qe,Et=-1,on=-1;for(let In=0;In<qe;In++)for(let Hn=0;Hn<nt;Hn++)at[Ht=In*nt+Hn]!=mr[Ht]&&(Hn<Xn&&(Xn=Hn),Hn>Et&&(Et=Hn),In<pn&&(pn=In),In>on&&(on=In));Et==-1&&(Xn=pn=Et=on=0),Ye&&((1&Xn)==1&&Xn--,(1&pn)==1&&pn--);const Hr=(Et-Xn+1)*(on-pn+1);Hr<ui&&(ui=Hr,sn=yn,cn=Xn,Yt=pn,Rn=Et-Xn+1,nn=on-pn+1)}_t=new Uint8Array(yt[mt-1-sn]),sn==1&&(ut[mt-1].dispose=2),Dt=new Uint8Array(Rn*nn*4),t(_t,nt,qe,Dt,Rn,nn,-cn,-Yt,0),An=t(Ot,nt,qe,Dt,Rn,nn,-cn,-Yt,3)?1:0,An==1?h(Ot,nt,qe,Dt,{x:cn,y:Yt,width:Rn,height:nn}):t(Ot,nt,qe,Dt,Rn,nn,-cn,-Yt,0)}else Dt=Ot.slice(0);ut.push({rect:{x:cn,y:Yt,width:Rn,height:nn},img:Dt,blend:An,dispose:0})}if(Xe)for(mt=0;mt<ut.length;mt++){if((Rt=ut[mt]).blend==1)continue;const Ot=Rt.rect,at=ut[mt-1].rect,cn=Math.min(Ot.x,at.x),Yt=Math.min(Ot.y,at.y),Rn={x:cn,y:Yt,width:Math.max(Ot.x+Ot.width,at.x+at.width)-cn,height:Math.max(Ot.y+Ot.height,at.y+at.height)-Yt};ut[mt-1].dispose=1,mt-1!=0&&f(yt,nt,qe,ut,mt-1,Rn,Ye),f(yt,nt,qe,ut,mt,Rn,Ye)}let Mt=0;if(yt.length!=1)for(var Ht=0;Ht<ut.length;Ht++){var Rt;Mt+=(Rt=ut[Ht]).rect.width*Rt.rect.height}return ut}(v,A,I,k,F,q),ye={},me=[],_e=[];if(S!=0){const fe=[];for(K=0;K<ae.length;K++)fe.push(ae[K].img.buffer);const yt=function(Ye){let Je=0;for(var ut=0;ut<Ye.length;ut++)Je+=Ye[ut].byteLength;const mt=new Uint8Array(Je);let Dt=0;for(ut=0;ut<Ye.length;ut++){const _t=new Uint8Array(Ye[ut]),Mt=_t.length;for(let Ht=0;Ht<Mt;Ht+=4){let Rt=_t[Ht],Ot=_t[Ht+1],at=_t[Ht+2];const cn=_t[Ht+3];cn==0&&(Rt=Ot=at=0),mt[Dt+Ht]=Rt,mt[Dt+Ht+1]=Ot,mt[Dt+Ht+2]=at,mt[Dt+Ht+3]=cn}Dt+=Mt}return mt.buffer}(fe),nt=g(yt,S);for(K=0;K<nt.plte.length;K++)me.push(nt.plte[K].est.rgba);let qe=0;for(K=0;K<ae.length;K++){const Xe=(Ce=ae[K]).img.length;var Se=new Uint8Array(nt.inds.buffer,qe>>2,Xe>>2);_e.push(Se);const Ye=new Uint8Array(nt.abuf,qe,Xe);W&&a(Ce.img,Ce.rect.width,Ce.rect.height,me,Ye,Se),Ce.img.set(Ye),qe+=Xe}}else for(V=0;V<ae.length;V++){var Ce=ae[V];const fe=new Uint32Array(Ce.img.buffer);var ze=Ce.rect.width;for($=fe.length,Se=new Uint8Array($),_e.push(Se),K=0;K<$;K++){const yt=fe[K];if(K!=0&&yt==fe[K-1])Se[K]=Se[K-1];else if(K>ze&&yt==fe[K-ze])Se[K]=Se[K-ze];else{let nt=ye[yt];if(nt==null&&(ye[yt]=nt=me.length,me.push(yt),me.length>=300))break;Se[K]=nt}}}const $e=me.length;for($e<=256&&M==0&&(J=$e<=2?1:$e<=4?2:$e<=16?4:8,J=Math.max(J,O)),V=0;V<ae.length;V++){(Ce=ae[V]).rect.x,Ce.rect.y,ze=Ce.rect.width;const fe=Ce.rect.height;let yt=Ce.img;new Uint32Array(yt.buffer);let nt=4*ze,qe=4;if($e<=256&&M==0){nt=Math.ceil(J*ze/8);var dt=new Uint8Array(nt*fe);const Xe=_e[V];for(let Ye=0;Ye<fe;Ye++){K=Ye*nt;const Je=Ye*ze;if(J==8)for(var Ie=0;Ie<ze;Ie++)dt[K+Ie]=Xe[Je+Ie];else if(J==4)for(Ie=0;Ie<ze;Ie++)dt[K+(Ie>>1)]|=Xe[Je+Ie]<<4-4*(1&Ie);else if(J==2)for(Ie=0;Ie<ze;Ie++)dt[K+(Ie>>2)]|=Xe[Je+Ie]<<6-2*(3&Ie);else if(J==1)for(Ie=0;Ie<ze;Ie++)dt[K+(Ie>>3)]|=Xe[Je+Ie]<<7-1*(7&Ie)}yt=dt,z=3,qe=1}else if(X==0&&ae.length==1){dt=new Uint8Array(ze*fe*3);const Xe=ze*fe;for(K=0;K<Xe;K++){const Ye=3*K,Je=4*K;dt[Ye]=yt[Je],dt[Ye+1]=yt[Je+1],dt[Ye+2]=yt[Je+2]}yt=dt,z=2,qe=3,nt=3*ze}Ce.img=yt,Ce.bpl=nt,Ce.bpp=qe}return{ctype:z,depth:J,plte:me,frames:ae}}function f(v,A,I,S,P,k,F){const q=Uint8Array,O=Uint32Array,M=new q(v[P-1]),W=new O(v[P-1]),z=P+1<v.length?new q(v[P+1]):null,J=new q(v[P]),ne=new O(J.buffer);let V=A,$=I,K=-1,X=-1;for(let ye=0;ye<k.height;ye++)for(let me=0;me<k.width;me++){const _e=k.x+me,Se=k.y+ye,Ce=Se*A+_e,ze=ne[Ce];ze==0||S[P-1].dispose==0&&W[Ce]==ze&&(z==null||z[4*Ce+3]!=0)||(_e<V&&(V=_e),_e>K&&(K=_e),Se<$&&($=Se),Se>X&&(X=Se))}K==-1&&(V=$=K=X=0),F&&((1&V)==1&&V--,(1&$)==1&&$--),k={x:V,y:$,width:K-V+1,height:X-$+1};const ae=S[P];ae.rect=k,ae.blend=1,ae.img=new Uint8Array(k.width*k.height*4),S[P-1].dispose==0?(t(M,A,I,ae.img,k.width,k.height,-k.x,-k.y,0),h(J,A,I,ae.img,k)):t(J,A,I,ae.img,k.width,k.height,-k.x,-k.y,0)}function h(v,A,I,S,P){t(v,A,I,S,P.width,P.height,-P.x,-P.y,2)}function p(v,A,I,S,P,k,F){const q=[];let O,M=[0,1,2,3,4];k!=-1?M=[k]:(A*S>5e5||I==1)&&(M=[0]),F&&(O={level:0});const W=IH;for(var z=0;z<M.length;z++){for(let V=0;V<A;V++)m(P,v,V,S,I,M[z]);q.push(W.deflate(P,O))}let J,ne=1e9;for(z=0;z<q.length;z++)q[z].length<ne&&(J=z,ne=q[z].length);return q[J]}function m(v,A,I,S,P,k){const F=I*S;let q=F+I;if(v[q]=k,q++,k==0)if(S<500)for(var O=0;O<S;O++)v[q+O]=A[F+O];else v.set(new Uint8Array(A.buffer,F,S),q);else if(k==1){for(O=0;O<P;O++)v[q+O]=A[F+O];for(O=P;O<S;O++)v[q+O]=A[F+O]-A[F+O-P]+256&255}else if(I==0){for(O=0;O<P;O++)v[q+O]=A[F+O];if(k==2)for(O=P;O<S;O++)v[q+O]=A[F+O];if(k==3)for(O=P;O<S;O++)v[q+O]=A[F+O]-(A[F+O-P]>>1)+256&255;if(k==4)for(O=P;O<S;O++)v[q+O]=A[F+O]-n(A[F+O-P],0,0)+256&255}else{if(k==2)for(O=0;O<S;O++)v[q+O]=A[F+O]+256-A[F+O-S]&255;if(k==3){for(O=0;O<P;O++)v[q+O]=A[F+O]+256-(A[F+O-S]>>1)&255;for(O=P;O<S;O++)v[q+O]=A[F+O]+256-(A[F+O-S]+A[F+O-P]>>1)&255}if(k==4){for(O=0;O<P;O++)v[q+O]=A[F+O]+256-n(0,A[F+O-S],0)&255;for(O=P;O<S;O++)v[q+O]=A[F+O]+256-n(A[F+O-P],A[F+O-S],A[F+O-P-S])&255}}}function g(v,A){const I=new Uint8Array(v),S=I.slice(0),P=new Uint32Array(S.buffer),k=b(S,A),F=k[0],q=k[1],O=I.length,M=new Uint8Array(O>>2);let W;if(I.length<2e7)for(var z=0;z<O;z+=4)W=x(F,J=I[z]*(1/255),ne=I[z+1]*(1/255),V=I[z+2]*(1/255),$=I[z+3]*(1/255)),M[z>>2]=W.ind,P[z>>2]=W.est.rgba;else for(z=0;z<O;z+=4){var J=I[z]*.00392156862745098,ne=I[z+1]*(1/255),V=I[z+2]*(1/255),$=I[z+3]*(1/255);for(W=F;W.left;)W=w(W.est,J,ne,V,$)<=0?W.left:W.right;M[z>>2]=W.ind,P[z>>2]=W.est.rgba}return{abuf:S.buffer,inds:M,plte:q}}function b(v,A,I){I==null&&(I=1e-4);const S=new Uint32Array(v.buffer),P={i0:0,i1:v.length,bst:null,est:null,tdst:0,left:null,right:null};P.bst=D(v,P.i0,P.i1),P.est=j(P.bst);const k=[P];for(;k.length<A;){let q=0,O=0;for(var F=0;F<k.length;F++)k[F].est.L>q&&(q=k[F].est.L,O=F);if(q<I)break;const M=k[O],W=N(v,S,M.i0,M.i1,M.est.e,M.est.eMq255);if(M.i0>=W||M.i1<=W){M.est.L=0;continue}const z={i0:M.i0,i1:W,bst:null,est:null,tdst:0,left:null,right:null};z.bst=D(v,z.i0,z.i1),z.est=j(z.bst);const J={i0:W,i1:M.i1,bst:null,est:null,tdst:0,left:null,right:null};for(J.bst={R:[],m:[],N:M.bst.N-z.bst.N},F=0;F<16;F++)J.bst.R[F]=M.bst.R[F]-z.bst.R[F];for(F=0;F<4;F++)J.bst.m[F]=M.bst.m[F]-z.bst.m[F];J.est=j(J.bst),M.left=z,M.right=J,k[O]=z,k.push(J)}for(k.sort((q,O)=>O.bst.N-q.bst.N),F=0;F<k.length;F++)k[F].ind=F;return[P,k]}function x(v,A,I,S,P){if(v.left==null)return v.tdst=function(z,J,ne,V,$){const K=J-z[0],X=ne-z[1],ae=V-z[2],ye=$-z[3];return K*K+X*X+ae*ae+ye*ye}(v.est.q,A,I,S,P),v;const k=w(v.est,A,I,S,P);let F=v.left,q=v.right;k>0&&(F=v.right,q=v.left);const O=x(F,A,I,S,P);if(O.tdst<=k*k)return O;const M=x(q,A,I,S,P);return M.tdst<O.tdst?M:O}function w(v,A,I,S,P){const{e:k}=v;return k[0]*A+k[1]*I+k[2]*S+k[3]*P-v.eMq}function N(v,A,I,S,P,k){for(S-=4;I<S;){for(;E(v,I,P)<=k;)I+=4;for(;E(v,S,P)>k;)S-=4;if(I>=S)break;const F=A[I>>2];A[I>>2]=A[S>>2],A[S>>2]=F,I+=4,S-=4}for(;E(v,I,P)>k;)I-=4;return I+4}function E(v,A,I){return v[A]*I[0]+v[A+1]*I[1]+v[A+2]*I[2]+v[A+3]*I[3]}function D(v,A,I){const S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],P=[0,0,0,0],k=I-A>>2;for(let F=A;F<I;F+=4){const q=v[F]*.00392156862745098,O=v[F+1]*(1/255),M=v[F+2]*(1/255),W=v[F+3]*(1/255);P[0]+=q,P[1]+=O,P[2]+=M,P[3]+=W,S[0]+=q*q,S[1]+=q*O,S[2]+=q*M,S[3]+=q*W,S[5]+=O*O,S[6]+=O*M,S[7]+=O*W,S[10]+=M*M,S[11]+=M*W,S[15]+=W*W}return S[4]=S[1],S[8]=S[2],S[9]=S[6],S[12]=S[3],S[13]=S[7],S[14]=S[11],{R:S,m:P,N:k}}function j(v){const{R:A}=v,{m:I}=v,{N:S}=v,P=I[0],k=I[1],F=I[2],q=I[3],O=S==0?0:1/S,M=[A[0]-P*P*O,A[1]-P*k*O,A[2]-P*F*O,A[3]-P*q*O,A[4]-k*P*O,A[5]-k*k*O,A[6]-k*F*O,A[7]-k*q*O,A[8]-F*P*O,A[9]-F*k*O,A[10]-F*F*O,A[11]-F*q*O,A[12]-q*P*O,A[13]-q*k*O,A[14]-q*F*O,A[15]-q*q*O],W=M,z=C;let J=[Math.random(),Math.random(),Math.random(),Math.random()],ne=0,V=0;if(S!=0)for(let K=0;K<16&&(J=z.multVec(W,J),V=Math.sqrt(z.dot(J,J)),J=z.sml(1/V,J),!(K!=0&&Math.abs(V-ne)<1e-9));K++)ne=V;const $=[P*O,k*O,F*O,q*O];return{Cov:M,q:$,e:J,L:ne,eMq255:z.dot(z.sml(255,$),J),eMq:z.dot(J,$),rgba:(Math.round(255*$[3])<<24|Math.round(255*$[2])<<16|Math.round(255*$[1])<<8|Math.round(255*$[0])<<0)>>>0}}var C={multVec:(v,A)=>[v[0]*A[0]+v[1]*A[1]+v[2]*A[2]+v[3]*A[3],v[4]*A[0]+v[5]*A[1]+v[6]*A[2]+v[7]*A[3],v[8]*A[0]+v[9]*A[1]+v[10]*A[2]+v[11]*A[3],v[12]*A[0]+v[13]*A[1]+v[14]*A[2]+v[15]*A[3]],dot:(v,A)=>v[0]*A[0]+v[1]*A[1]+v[2]*A[2]+v[3]*A[3],sml:(v,A)=>[v*A[0],v*A[1],v*A[2],v*A[3]]};qo.encode=function(A,I,S,P,k,F,q){P==null&&(P=0),q==null&&(q=!1);const O=d(A,I,S,P,[!1,!1,!1,0,q,!1]);return c(O,-1),l(O,I,S,k,F)},qo.encodeLL=function(A,I,S,P,k,F,q,O){const M={ctype:0+(P==1?0:2)+(k==0?0:4),depth:F,frames:[]},W=(P+k)*F,z=W*I;for(let J=0;J<A.length;J++)M.frames.push({rect:{x:0,y:0,width:I,height:S},img:new Uint8Array(A[J]),blend:0,dispose:1,bpp:Math.ceil(W/8),bpl:Math.ceil(z/8)});return c(M,0,!0),l(M,I,S,q,O)},qo.encode.compress=d,qo.encode.dither=a,qo.quantize=g,qo.quantize.getKDtree=b,qo.quantize.getNearest=x})();const HI={toArrayBuffer(t,e){const n=t.width,r=t.height,i=n<<2,s=t.getContext("2d").getImageData(0,0,n,r),o=new Uint32Array(s.data.buffer),a=(32*n+31)/32<<2,l=a*r,c=122+l,d=new ArrayBuffer(c),f=new DataView(d),h=1<<20;let p,m,g,b,x=h,w=0,N=0,E=0;function D(v){f.setUint16(N,v,!0),N+=2}function j(v){f.setUint32(N,v,!0),N+=4}function C(v){N+=v}D(19778),j(c),C(4),j(122),j(108),j(n),j(-r>>>0),D(1),D(32),j(3),j(l),j(2835),j(2835),C(8),j(16711680),j(65280),j(255),j(4278190080),j(1466527264),function v(){for(;w<r&&x>0;){for(b=122+w*a,p=0;p<i;)x--,m=o[E++],g=m>>>24,f.setUint32(b+p,m<<8|g),p+=4;w++}E<o.length?(x=h,setTimeout(v,HI._dly)):e(d)}()},toBlob(t,e){this.toArrayBuffer(t,n=>{e(new Blob([n],{type:"image/bmp"}))})},_dly:9};var As={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},jH={[As.CHROME]:16384,[As.FIREFOX]:11180,[As.DESKTOP_SAFARI]:16384,[As.IE]:8192,[As.IOS]:4096,[As.ETC]:8192};const r4=typeof window<"u",WI=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,tx=r4&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),DH=(r4||WI)&&(tx&&tx.getOriginalSymbol(window,"File")||typeof File<"u"&&File),$I=(r4||WI)&&(tx&&tx.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function i4(t,e,n=Date.now()){return new Promise(r=>{const i=t.split(","),s=i[0].match(/:(.*?);/)[1],o=globalThis.atob(i[1]);let a=o.length;const l=new Uint8Array(a);for(;a--;)l[a]=o.charCodeAt(a);const c=new Blob([l],{type:s});c.name=e,c.lastModified=n,r(c)})}function GI(t){return new Promise((e,n)=>{const r=new $I;r.onload=()=>e(r.result),r.onerror=i=>n(i),r.readAsDataURL(t)})}function KI(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=i=>n(i),r.src=t})}function Ku(){if(Ku.cachedResult!==void 0)return Ku.cachedResult;let t=As.ETC;const{userAgent:e}=navigator;return/Chrom(e|ium)/i.test(e)?t=As.CHROME:/iP(ad|od|hone)/i.test(e)&&/WebKit/i.test(e)?t=As.IOS:/Safari/i.test(e)?t=As.DESKTOP_SAFARI:/Firefox/i.test(e)?t=As.FIREFOX:(/MSIE/i.test(e)||document.documentMode)&&(t=As.IE),Ku.cachedResult=t,Ku.cachedResult}function QI(t,e){const n=Ku(),r=jH[n];let i=t,s=e,o=i*s;const a=i>s?s/i:i/s;for(;o>r*r;){const l=(r+i)/2,c=(r+s)/2;l<c?(s=c,i=c*a):(s=l*a,i=l),o=i*s}return{width:i,height:s}}function fy(t,e){let n,r;try{if(n=new OffscreenCanvas(t,e),r=n.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{n=document.createElement("canvas"),r=n.getContext("2d")}return n.width=t,n.height=e,[n,r]}function YI(t,e){const{width:n,height:r}=QI(t.width,t.height),[i,s]=fy(n,r);return e&&/jpe?g/.test(e)&&(s.fillStyle="white",s.fillRect(0,0,i.width,i.height)),s.drawImage(t,0,0,i.width,i.height),i}function t1(){return t1.cachedResult!==void 0||(t1.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),t1.cachedResult}function nx(t,e={}){return new Promise(function(n,r){let i,s;var o=function(){try{return s=YI(i,e.fileType||t.type),n([i,s])}catch(l){return r(l)}},a=function(l){try{var c=function(d){try{throw d}catch(f){return r(f)}};try{let d;return GI(t).then(function(f){try{return d=f,KI(d).then(function(h){try{return i=h,function(){try{return o()}catch(p){return r(p)}}()}catch(p){return c(p)}},c)}catch(h){return c(h)}},c)}catch(d){c(d)}}catch(d){return r(d)}};try{if(t1()||[As.DESKTOP_SAFARI,As.MOBILE_SAFARI].includes(Ku()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(t).then(function(l){try{return i=l,o()}catch{return a()}},a)}catch{a()}})}function rx(t,e,n,r,i=1){return new Promise(function(s,o){let a;if(e==="image/png"){let c,d,f;return c=t.getContext("2d"),{data:d}=c.getImageData(0,0,t.width,t.height),f=qo.encode([d.buffer],t.width,t.height,4096*i),a=new Blob([f],{type:e}),a.name=n,a.lastModified=r,l.call(this)}{let c=function(){return l.call(this)};if(e==="image/bmp")return new Promise(d=>HI.toBlob(t,d)).then((function(d){try{return a=d,a.name=n,a.lastModified=r,c.call(this)}catch(f){return o(f)}}).bind(this),o);{let d=function(){return c.call(this)};if(typeof OffscreenCanvas=="function"&&t instanceof OffscreenCanvas)return t.convertToBlob({type:e,quality:i}).then((function(f){try{return a=f,a.name=n,a.lastModified=r,d.call(this)}catch(h){return o(h)}}).bind(this),o);{let f;return f=t.toDataURL(e,i),i4(f,n,r).then((function(h){try{return a=h,d.call(this)}catch(p){return o(p)}}).bind(this),o)}}}function l(){return s(a)}})}function Sa(t){t.width=0,t.height=0}function Ch(){return new Promise(function(t,e){let n,r,i,s;return Ch.cachedResult!==void 0?t(Ch.cachedResult):i4("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(o){try{return n=o,nx(n).then(function(a){try{return r=a[1],rx(r,n.type,n.name,n.lastModified).then(function(l){try{return i=l,Sa(r),nx(i).then(function(c){try{return s=c[0],Ch.cachedResult=s.width===1&&s.height===2,t(Ch.cachedResult)}catch(d){return e(d)}},e)}catch(c){return e(c)}},e)}catch(l){return e(l)}},e)}catch(a){return e(a)}},e)})}function XI(t){return new Promise((e,n)=>{const r=new $I;r.onload=i=>{const s=new DataView(i.target.result);if(s.getUint16(0,!1)!=65496)return e(-2);const o=s.byteLength;let a=2;for(;a<o;){if(s.getUint16(a+2,!1)<=8)return e(-1);const l=s.getUint16(a,!1);if(a+=2,l==65505){if(s.getUint32(a+=2,!1)!=1165519206)return e(-1);const c=s.getUint16(a+=6,!1)==18761;a+=s.getUint32(a+4,c);const d=s.getUint16(a,c);a+=2;for(let f=0;f<d;f++)if(s.getUint16(a+12*f,c)==274)return e(s.getUint16(a+12*f+8,c))}else{if((65280&l)!=65280)break;a+=s.getUint16(a,!1)}}return e(-1)},r.onerror=i=>n(i),r.readAsArrayBuffer(t)})}function JI(t,e){const{width:n}=t,{height:r}=t,{maxWidthOrHeight:i}=e;let s,o=t;return isFinite(i)&&(n>i||r>i)&&([o,s]=fy(n,r),n>r?(o.width=i,o.height=r/n*i):(o.width=n/r*i,o.height=i),s.drawImage(t,0,0,o.width,o.height),Sa(t)),o}function ZI(t,e){const{width:n}=t,{height:r}=t,[i,s]=fy(n,r);switch(e>4&&e<9?(i.width=r,i.height=n):(i.width=n,i.height=r),e){case 2:s.transform(-1,0,0,1,n,0);break;case 3:s.transform(-1,0,0,-1,n,r);break;case 4:s.transform(1,0,0,-1,0,r);break;case 5:s.transform(0,1,1,0,0,0);break;case 6:s.transform(0,1,-1,0,r,0);break;case 7:s.transform(0,-1,-1,0,r,n);break;case 8:s.transform(0,-1,1,0,0,n)}return s.drawImage(t,0,0,n,r),Sa(t),i}function hS(t,e,n=0){return new Promise(function(r,i){let s,o,a,l,c,d,f,h,p,m,g,b,x,w,N,E,D,j,C,v;function A(S=5){if(e.signal&&e.signal.aborted)throw e.signal.reason;s+=S,e.onProgress(Math.min(s,100))}function I(S){if(e.signal&&e.signal.aborted)throw e.signal.reason;s=Math.min(Math.max(S,s),100),e.onProgress(s)}return s=n,o=e.maxIteration||10,a=1024*e.maxSizeMB*1024,A(),nx(t,e).then((function(S){try{return[,l]=S,A(),c=JI(l,e),A(),new Promise(function(P,k){var F;if(!(F=e.exifOrientation))return XI(t).then((function(O){try{return F=O,q.call(this)}catch(M){return k(M)}}).bind(this),k);function q(){return P(F)}return q.call(this)}).then((function(P){try{return d=P,A(),Ch().then((function(k){try{return f=k?c:ZI(c,d),A(),h=e.initialQuality||1,p=e.fileType||t.type,rx(f,p,t.name,t.lastModified,h).then((function(F){try{{let O=function(){if(o--&&(N>a||N>x)){let W,z;return W=v?.95*C.width:C.width,z=v?.95*C.height:C.height,[D,j]=fy(W,z),j.drawImage(C,0,0,W,z),h*=p==="image/png"?.85:.95,rx(D,p,t.name,t.lastModified,h).then(function(J){try{return E=J,Sa(C),C=D,N=E.size,I(Math.min(99,Math.floor((w-N)/(w-a)*100))),O}catch(ne){return i(ne)}},i)}return[1]},M=function(){return Sa(C),Sa(D),Sa(c),Sa(f),Sa(l),I(100),r(E)};if(m=F,A(),g=m.size>a,b=m.size>t.size,!g&&!b)return I(100),r(m);var q;return x=t.size,w=m.size,N=w,C=f,v=!e.alwaysKeepResolution&&g,(q=(function(W){for(;W;){if(W.then)return void W.then(q,i);try{if(W.pop){if(W.length)return W.pop()?M.call(this):W;W=O}else W=W.call(this)}catch(z){return i(z)}}}).bind(this))(O)}}catch(O){return i(O)}}).bind(this),i)}catch(F){return i(F)}}).bind(this),i)}catch(k){return i(k)}}).bind(this),i)}catch(P){return i(P)}}).bind(this),i)})}const RH=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Dv;function FH(t,e){return new Promise((n,r)=>{Dv||(Dv=function(o){const a=[];return a.push(o),URL.createObjectURL(new Blob(a))}(RH));const i=new Worker(Dv);i.addEventListener("message",function(o){if(e.signal&&e.signal.aborted)i.terminate();else if(o.data.progress===void 0){if(o.data.error)return r(new Error(o.data.error)),void i.terminate();n(o.data.file),i.terminate()}else e.onProgress(o.data.progress)}),i.addEventListener("error",r),e.signal&&e.signal.addEventListener("abort",()=>{r(e.signal.reason),i.terminate()}),i.postMessage({file:t,imageCompressionLibUrl:e.libURL,options:{...e,onProgress:void 0,signal:void 0}})})}function Ci(t,e){return new Promise(function(n,r){let i,s,o,a,l,c;if(i={...e},o=0,{onProgress:a}=i,i.maxSizeMB=i.maxSizeMB||Number.POSITIVE_INFINITY,l=typeof i.useWebWorker!="boolean"||i.useWebWorker,delete i.useWebWorker,i.onProgress=p=>{o=p,typeof a=="function"&&a(o)},!(t instanceof Blob||t instanceof DH))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(t.type))return r(new Error("The file given is not an image"));if(c=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!l||typeof Worker!="function"||c)return hS(t,i).then((function(p){try{return s=p,h.call(this)}catch(m){return r(m)}}).bind(this),r);var d=(function(){try{return h.call(this)}catch(p){return r(p)}}).bind(this),f=function(p){try{return hS(t,i).then(function(m){try{return s=m,d()}catch(g){return r(g)}},r)}catch(m){return r(m)}};try{return i.libURL=i.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",FH(t,i).then(function(p){try{return s=p,d()}catch{return f()}},f)}catch{f()}function h(){try{s.name=t.name,s.lastModified=t.lastModified}catch{}try{i.preserveExif&&t.type==="image/jpeg"&&(!i.fileType||i.fileType&&i.fileType===t.type)&&(s=qI(t,s))}catch{}return n(s)}})}Ci.getDataUrlFromFile=GI,Ci.getFilefromDataUrl=i4,Ci.loadImage=KI,Ci.drawImageInCanvas=YI,Ci.drawFileInCanvas=nx,Ci.canvasToFile=rx,Ci.getExifOrientation=XI,Ci.handleMaxWidthOrHeight=JI,Ci.followExifOrientation=ZI,Ci.cleanupCanvasMemory=Sa,Ci.isAutoOrientationInBrowser=Ch,Ci.approximateBelowMaximumCanvasSizeOfBrowser=QI,Ci.copyExifWithoutOrientation=qI,Ci.getBrowserName=Ku,Ci.version="2.0.2";const LH=({onClose:t})=>{const[e,n]=he.useState(!0),[r,i]=he.useState(!1),[s,o]=he.useState(!1),a=he.useRef(null),[l,c]=he.useState({firstName:"",lastName:"",email:"",phone:"",company:"",agency:"",role:"",createdAt:"",photoURL:""}),[d,f]=he.useState({firstName:"",lastName:"",phone:"",company:"",agency:"",photoURL:""});he.useEffect(()=>{(async()=>{if(fn.currentUser)try{const b=await ps(ln(ot,"users",fn.currentUser.uid));if(b.exists()){const x=b.data(),w={firstName:x.firstName||"",lastName:x.lastName||"",email:x.email||"",phone:x.phone||"",company:x.company||"",agency:x.agency||"",role:x.role||"",createdAt:x.createdAt||"",photoURL:x.photoURL||""};c(w),f({firstName:x.firstName||"",lastName:x.lastName||"",phone:x.phone||"",company:x.company||"",agency:x.agency||"",photoURL:x.photoURL||""})}}catch(b){console.error("Error fetching user data:",b),ke.error("Erreur lors du chargement des données")}finally{n(!1)}})()},[]);const h=async g=>{var x,w;const b=(x=g.target.files)==null?void 0:x[0];if(b){if(b.size>2*1024*1024){ke.error("L'image ne doit pas dépasser 2MB");return}try{o(!0);const E=await Ci(b,{maxSizeMB:1,maxWidthOrHeight:800,useWebWorker:!0}),D=vp(bp,`profiles/${(w=fn.currentUser)==null?void 0:w.uid}/${lf()}`);await X_(D,E);const j=await J_(D);if(d.photoURL)try{const C=vp(bp,d.photoURL);await SI(C)}catch(C){console.error("Error deleting old image:",C)}f(C=>({...C,photoURL:j})),ke.success("Photo de profil mise à jour")}catch(N){console.error("Error uploading image:",N),ke.error("Erreur lors du téléchargement de l'image")}finally{o(!1)}}},p=()=>d.firstName.trim()?d.lastName.trim()?d.company.trim()?d.company.length>100?(ke.error("Le nom de l'entreprise ne doit pas dépasser 100 caractères"),!1):!0:(ke.error("L'entreprise est requise"),!1):(ke.error("Le nom est requis"),!1):(ke.error("Le prénom est requis"),!1),m=async g=>{if(g.preventDefault(),!!fn.currentUser&&p()){i(!0);try{await na(ln(ot,"users",fn.currentUser.uid),{firstName:d.firstName.trim(),lastName:d.lastName.trim(),phone:d.phone.trim(),company:d.company.trim(),agency:d.agency.trim(),photoURL:d.photoURL,updatedAt:new Date().toISOString()}),c(b=>({...b,...d})),ke.success("Profil mis à jour avec succès")}catch(b){console.error("Error updating profile:",b),ke.error("Erreur lors de la mise à jour du profil")}finally{i(!1)}}};return e?u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg p-6",children:u.jsx("div",{className:"flex justify-center items-center h-40",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})})})}):u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center rounded-t-lg",children:[u.jsxs("h2",{className:"font-bold text-xl flex items-center",children:[u.jsx(h5,{className:"h-6 w-6 mr-2"}),"Mon Profil"]}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"mb-6",children:u.jsx("div",{className:"flex items-center justify-center mb-4",children:u.jsxs("div",{className:"relative",children:[d.photoURL?u.jsx("img",{src:d.photoURL,alt:"Profile",className:"h-20 w-20 rounded-full object-cover"}):u.jsxs("div",{className:"h-20 w-20 rounded-full bg-[#8B4513] text-white flex items-center justify-center text-2xl font-bold",children:[d.firstName[0],d.lastName[0]]}),u.jsx("button",{onClick:()=>{var g;return(g=a.current)==null?void 0:g.click()},disabled:s,className:"absolute bottom-0 right-0 bg-white rounded-full p-2 shadow-md hover:bg-gray-100",children:s?u.jsx(Un,{className:"h-4 w-4 animate-spin text-[#8B4513]"}):u.jsx(n4,{className:"h-4 w-4 text-[#8B4513]"})}),u.jsx("input",{ref:a,type:"file",className:"hidden",accept:"image/*",onChange:h})]})})}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email"}),u.jsxs("div",{className:"flex items-center bg-gray-100 p-3 rounded-lg",children:[u.jsx(fH,{className:"h-5 w-5 text-gray-400 mr-2"}),u.jsx("span",{className:"text-gray-600",children:l.email})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Prénom"}),u.jsx("input",{type:"text",value:d.firstName,onChange:g=>f({...d,firstName:g.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nom"}),u.jsx("input",{type:"text",value:d.lastName,onChange:g=>f({...d,lastName:g.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Téléphone"}),u.jsxs("div",{className:"relative",children:[u.jsx(mH,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"tel",value:d.phone,onChange:g=>f({...d,phone:g.target.value}),className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",placeholder:"Ex: 06 12 34 56 78"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Entreprise"}),u.jsxs("div",{className:"relative",children:[u.jsx(t4,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",value:d.company,onChange:g=>f({...d,company:g.target.value}),className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",maxLength:100,required:!0,placeholder:"Nom de votre entreprise"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Agence"}),u.jsxs("div",{className:"relative",children:[u.jsx(pH,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",value:d.agency,onChange:g=>f({...d,agency:g.target.value}),className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",placeholder:"Nom de votre agence"})]})]})]}),u.jsx("div",{className:"mt-6",children:u.jsx("button",{type:"submit",disabled:r||s,className:"w-full bg-[#8B4513] text-white py-3 rounded-lg font-bold text-lg transition-colors hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center",children:r?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer les modifications"})})]})]})]})})},MH=({onViewChange:t,currentView:e})=>{const{totalItems:n}=oy(),[r,i]=he.useState(new Date),[s,o]=he.useState(!1),[a,l]=he.useState(!1),[c,d]=he.useState(null);Ko.useEffect(()=>{const g=setInterval(()=>{i(new Date)},6e4);return()=>clearInterval(g)},[]),Ko.useEffect(()=>{if(!fn.currentUser)return;const g=Ic(ln(ot,"users",fn.currentUser.uid),b=>{if(b.exists()){const x=b.data();d({firstName:x.firstName||"",lastName:x.lastName||"",role:x.role||"",agency:x.agency||""})}});return()=>g()},[]);const f=r.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),h=r.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),p=async()=>{try{await fn.signOut()}catch(g){console.error("Erreur lors de la déconnexion:",g)}},m=g=>({CAISSIERE:"Caissière",GESTIONNAIRE:"Gestionnaire",ADMINISTRATEUR:"Administrateur",PRODUCTEUR:"Producteur"})[g]||g;return u.jsxs("header",{className:"bg-[#8B4513] text-white px-6 py-4 shadow-md",children:[u.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("h1",{className:"text-2xl font-bold",children:"EGREC GESTIONNAIRE"}),u.jsxs("div",{className:"text-sm font-medium hidden md:block",children:[h," | ",f]})]}),u.jsxs("div",{className:"flex items-center space-x-6",children:[u.jsxs("button",{className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="pos"?"bg-[#663300] text-white":"text-[#FFFDD0] hover:bg-[#663300]/50"}`,onClick:()=>t("pos"),children:[u.jsx(u5,{className:"mr-2 h-5 w-5"}),u.jsx("span",{children:"Vente"}),n>0&&e==="pos"&&u.jsx("span",{className:"ml-2 bg-[#FFD700] text-[#8B4513] rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold",children:n})]}),u.jsxs("button",{className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="production"?"bg-[#663300] text-white":"text-[#FFFDD0] hover:bg-[#663300]/50"}`,onClick:()=>t("production"),children:[u.jsx(of,{className:"mr-2 h-5 w-5"}),u.jsx("span",{children:"Production"})]}),u.jsxs("button",{className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="admin"?"bg-[#663300] text-white":"text-[#FFFDD0] hover:bg-[#663300]/50"}`,onClick:()=>t("admin"),children:[u.jsx(c5,{className:"mr-2 h-5 w-5"}),u.jsx("span",{children:"Admin"})]}),fn.currentUser?u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("button",{onClick:()=>l(!0),className:"flex items-center text-[#FFFDD0] hover:bg-[#663300]/50 px-4 py-2 rounded-lg",children:[u.jsx(h5,{className:"h-5 w-5 mr-2"}),u.jsx("span",{className:"hidden md:inline",children:c?u.jsx("span",{className:"flex flex-col items-start",children:u.jsxs("span",{className:"font-medium",children:[c.lastName.toUpperCase()," ",c.firstName,c.role&&` - ${m(c.role)}`,c.agency&&` - ${c.agency}`]})}):"Chargement..."})]}),u.jsx("button",{onClick:p,className:"text-[#FFFDD0] hover:bg-[#663300]/50 p-2 rounded-lg",title:"Déconnexion",children:u.jsx(hH,{className:"h-5 w-5"})})]}):u.jsxs("button",{onClick:()=>o(!0),className:"flex items-center text-[#FFFDD0] hover:bg-[#663300]/50 px-4 py-2 rounded-lg",children:[u.jsx(h5,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Connexion"})]})]})]}),s&&u.jsx(zI,{onClose:()=>o(!1)}),a&&u.jsx(LH,{onClose:()=>l(!1)})]})},BH=({selectedDepartment:t,onDepartmentChange:e,bakeryCount:n,storeCount:r})=>u.jsx("div",{className:"bg-[#FFFDD0] p-4 rounded-lg shadow-md mb-6",children:u.jsx("div",{className:"flex items-center justify-center",children:u.jsxs("div",{className:"flex bg-white rounded-lg p-1 shadow-inner",children:[u.jsxs("button",{onClick:()=>e("Boulangerie"),className:`flex items-center px-6 py-3 rounded-md text-sm font-medium transition-all duration-200 ${t==="Boulangerie"?"bg-[#8B4513] text-white shadow-lg transform scale-105":"text-[#8B4513] hover:bg-[#8B4513]/10"}`,children:[u.jsx(dm,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Département Boulangerie"}),u.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-bold ${t==="Boulangerie"?"bg-white text-[#8B4513]":"bg-[#8B4513]/20 text-[#8B4513]"}`,children:n})]}),u.jsxs("button",{onClick:()=>e("Boutique"),className:`flex items-center px-6 py-3 rounded-md text-sm font-medium transition-all duration-200 ${t==="Boutique"?"bg-[#8B4513] text-white shadow-lg transform scale-105":"text-[#8B4513] hover:bg-[#8B4513]/10"}`,children:[u.jsx(dy,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Département Boutique"}),u.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-bold ${t==="Boutique"?"bg-white text-[#8B4513]":"bg-[#8B4513]/20 text-[#8B4513]"}`,children:r})]})]})})}),ej=({activeCategory:t,onCategoryChange:e})=>u.jsx("div",{className:"bg-[#FFFDD0] p-4 rounded-lg shadow-md mb-6",children:u.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[u.jsxs("button",{className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all ${t==="pains"?"bg-[#8B4513] text-white shadow-lg scale-[1.03]":"bg-white text-[#8B4513] hover:bg-[#8B4513]/10"}`,onClick:()=>e("pains"),children:[u.jsx(cH,{className:"h-8 w-8 mb-2"}),u.jsx("span",{className:"font-medium",children:"Pains"})]}),u.jsxs("button",{className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all ${t==="viennoiseries"?"bg-[#8B4513] text-white shadow-lg scale-[1.03]":"bg-white text-[#8B4513] hover:bg-[#8B4513]/10"}`,onClick:()=>e("viennoiseries"),children:[u.jsx(dm,{className:"h-8 w-8 mb-2"}),u.jsx("span",{className:"font-medium",children:"Viennoiseries"})]}),u.jsxs("button",{className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all ${t==="patisseries"?"bg-[#8B4513] text-white shadow-lg scale-[1.03]":"bg-white text-[#8B4513] hover:bg-[#8B4513]/10"}`,onClick:()=>e("patisseries"),children:[u.jsx(nH,{className:"h-8 w-8 mb-2"}),u.jsx("span",{className:"font-medium",children:"Pâtisseries"})]}),u.jsxs("button",{className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all ${t==="favoris"?"bg-[#FFD700] text-[#8B4513] shadow-lg scale-[1.03]":"bg-white text-[#8B4513] hover:bg-[#FFD700]/20"}`,onClick:()=>e("favoris"),children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 mb-2",fill:t==="favoris"?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),u.jsx("span",{className:"font-medium",children:"Favoris"})]})]})}),OH=({activeCategory:t,onCategoryChange:e,categoryCounts:n})=>{const r=[{id:"boisson",name:"Boissons",icon:FI,color:"blue"},{id:"margarine",name:"Margarine",icon:ji,color:"yellow"},{id:"raffinerie",name:"Raffinerie",icon:ji,color:"orange"},{id:"savonnerie",name:"Savonnerie",icon:MI,color:"green"},{id:"cosmetique",name:"Cosmétique",icon:VI,color:"pink"},{id:"champs",name:"Champs",icon:UI,color:"emerald"}],i=(s,o)=>{const a={blue:o?"bg-blue-600 text-white shadow-lg scale-[1.03]":"bg-blue-50 text-blue-700 hover:bg-blue-100",yellow:o?"bg-yellow-600 text-white shadow-lg scale-[1.03]":"bg-yellow-50 text-yellow-700 hover:bg-yellow-100",orange:o?"bg-orange-600 text-white shadow-lg scale-[1.03]":"bg-orange-50 text-orange-700 hover:bg-orange-100",green:o?"bg-green-600 text-white shadow-lg scale-[1.03]":"bg-green-50 text-green-700 hover:bg-green-100",pink:o?"bg-pink-600 text-white shadow-lg scale-[1.03]":"bg-pink-50 text-pink-700 hover:bg-pink-100",emerald:o?"bg-emerald-600 text-white shadow-lg scale-[1.03]":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100"};return a[s]||a.blue};return u.jsx("div",{className:"bg-[#FFFDD0] p-4 rounded-lg shadow-md mb-6",children:u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:r.map(s=>{const o=s.icon,a=t===s.id,l=n[s.id]||0;return u.jsxs("button",{className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all duration-200 transform hover:scale-105 ${i(s.color,a)}`,onClick:()=>e(s.id),children:[u.jsx(o,{className:"h-8 w-8 mb-2"}),u.jsx("span",{className:"font-medium text-sm text-center",children:s.name}),u.jsx("span",{className:`mt-1 px-2 py-1 rounded-full text-xs font-bold ${a?"bg-white/20 text-white":"bg-white text-gray-600"}`,children:l})]},s.id)})})})},VH=({onSearch:t})=>{const[e,n]=he.useState(""),r=i=>{i.preventDefault(),t(e)};return u.jsxs("form",{onSubmit:r,className:"mb-6 bg-white rounded-lg shadow-md p-3 flex items-center",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Wl,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Rechercher un produit...",className:"block w-full py-3 pl-10 pr-4 rounded-lg border-0 ring-1 ring-inset ring-gray-300 placeholder-gray-400 focus:ring-2 focus:ring-[#8B4513]",value:e,onChange:i=>n(i.target.value)})]}),u.jsx("button",{type:"button",className:"ml-4 p-3 bg-[#FFFDD0] text-[#8B4513] rounded-lg flex items-center justify-center transition-colors hover:bg-[#FFD700]/50",title:"Scanner un code-barres",children:u.jsx(xH,{className:"h-5 w-5"})}),u.jsx("button",{type:"button",className:"ml-2 p-3 bg-gray-100 text-gray-700 rounded-lg flex items-center justify-center transition-colors hover:bg-gray-200",title:"Filtres avancés",children:u.jsx(lH,{className:"h-5 w-5"})}),u.jsx("button",{type:"submit",className:"ml-2 p-3 bg-[#8B4513] text-white rounded-lg flex items-center justify-center transition-colors hover:bg-[#663300] px-4",children:"Rechercher"})]})},UH=({product:t,onAddToCart:e,onToggleFavorite:n,isInCart:r,quantity:i=0,onUpdateQuantity:s,agencyStock:o})=>{const a=()=>{e(t)},l=()=>{s&&s(t.id,i+1)},c=()=>{s&&s(t.id,i-1)};return u.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-md transition-transform hover:shadow-lg hover:scale-[1.02]",children:[t.image&&u.jsxs("div",{className:"relative h-40",children:[u.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"}),u.jsx("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),n(t.id)},className:`absolute top-2 right-2 p-1.5 rounded-full transition-colors ${t.isFavorite?"bg-[#FFD700] text-[#8B4513]":"bg-white/80 text-gray-400 hover:text-[#FFD700]"}`,children:u.jsx(uS,{className:"h-5 w-5",fill:t.isFavorite?"currentColor":"none"})}),o<=(t.minStock||5)&&u.jsxs("div",{className:"absolute bottom-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:["Stock: ",o]})]}),u.jsxs("div",{className:`p-4 ${t.image?"":"pt-3"}`,children:[u.jsxs("div",{className:"flex items-start justify-between mb-1",children:[u.jsx("h3",{className:"font-bold text-lg text-[#8B4513]",children:t.name}),!t.image&&u.jsx("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),n(t.id)},className:`p-1.5 rounded-full transition-colors ${t.isFavorite?"bg-[#FFD700] text-[#8B4513]":"text-gray-400 hover:text-[#FFD700]"}`,children:u.jsx(uS,{className:"h-5 w-5",fill:t.isFavorite?"currentColor":"none"})})]}),u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("span",{className:"text-lg font-semibold",children:[Math.round(t.price)," Fcfa"]}),!t.image&&o<=(t.minStock||5)&&u.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:["Stock: ",o]})]}),t.allergens.length>0&&u.jsx("div",{className:"mb-3",children:u.jsxs("span",{className:"text-xs text-gray-500",children:["Allergènes: ",t.allergens.join(", ")]})}),r?u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("button",{className:"bg-[#8B4513] text-white p-2 rounded-full hover:bg-[#663300] transition-colors",onClick:c,disabled:i<=0,children:u.jsx(_p,{size:16})}),u.jsx("span",{className:"font-bold text-lg",children:i}),u.jsx("button",{className:"bg-[#8B4513] text-white p-2 rounded-full hover:bg-[#663300] transition-colors",onClick:l,disabled:i>=o,children:u.jsx(Po,{size:16})})]}):u.jsxs("button",{className:"w-full bg-[#8B4513] text-white py-2 rounded-lg flex items-center justify-center font-medium transition-colors hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed",onClick:a,disabled:o<=0,children:[u.jsx(Po,{size:20,className:"mr-1"}),o<=0?"Stock épuisé":"Ajouter"]})]})]})},zH=({products:t})=>{const{items:e,addToCart:n,updateQuantity:r}=oy(),{user:i}=Li(),s=l=>{var h;const c=i!=null&&i.agencyName?((h=l.stockParAgence)==null?void 0:h[i.agencyName])??0:0;if(c<=0){ke.error("Stock insuffisant pour ce produit");return}const d=e.find(p=>p.product.id===l.id);if((d?d.quantity:0)>=c){ke.error("Quantité maximale atteinte pour ce produit");return}n(l,1),ke.success(`${l.name} ajouté au panier`)},o=async l=>{if(!fn.currentUser){ke.error("Vous devez être connecté pour ajouter des favoris");return}try{const c=ln(ot,"products",l),d=await ps(c);if(!d.exists()){ke.error("Produit non trouvé");return}const h=!d.data().isFavorite;await na(c,{isFavorite:h,lastUpdated:new Date().toISOString()}),ke.success(h?"Ajouté aux favoris":"Retiré des favoris",{icon:"⭐"})}catch(c){console.error("Error toggling favorite:",c),ke.error("Erreur lors de la mise à jour des favoris")}},a=(l,c)=>{var h;const d=t.find(p=>p.id===l);if(!d)return;const f=i!=null&&i.agencyName?((h=d.stockParAgence)==null?void 0:h[i.agencyName])??0:0;if(c>f){ke.error("Quantité supérieure au stock disponible");return}r(l,c)};return u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[t.map(l=>{var p;const c=e.find(m=>m.product.id===l.id),d=!!c,f=c?c.quantity:0,h=i!=null&&i.agencyName?((p=l.stockParAgence)==null?void 0:p[i.agencyName])??0:0;return u.jsx(UH,{product:l,onAddToCart:s,onToggleFavorite:o,isInCart:d,quantity:f,onUpdateQuantity:a,agencyStock:h},l.id)}),t.length===0&&u.jsx("div",{className:"col-span-full text-center p-8 bg-gray-100 rounded-lg",children:u.jsx("p",{className:"text-gray-500",children:"Aucun produit trouvé dans cette catégorie."})})]})},qH=({onCheckout:t})=>{const{items:e,removeFromCart:n,updateQuantity:r,clearCart:i,subtotal:s,tax:o,total:a}=oy(),[l,c]=he.useState(!0);if(e.length===0)return u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[u.jsx(u5,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),u.jsx("h3",{className:"text-lg font-semibold text-gray-500 mb-4",children:"Votre panier est vide"}),u.jsx("p",{className:"text-gray-400 mb-4",children:"Ajoutez des produits pour commencer."})]});const d=(f,h)=>{const p=parseInt(h);!isNaN(p)&&p>=0&&r(f,p)};return u.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsxs("h2",{className:"font-bold text-lg flex items-center",children:[u.jsx(u5,{className:"h-5 w-5 mr-2"}),"Panier (",e.length,")"]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{className:"text-white bg-[#663300] hover:bg-[#552200] p-2 rounded-lg mr-2",onClick:i,title:"Vider le panier",children:u.jsx(hy,{className:"h-5 w-5"})}),u.jsx("button",{className:"text-white bg-transparent hover:bg-[#663300] p-1 rounded-lg",onClick:()=>c(!l),children:l?u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),u.jsx("div",{className:`transition-all duration-300 ${l?"max-h-[calc(100vh-20rem)]":"max-h-0"} overflow-y-auto`,children:u.jsxs("table",{className:"w-full text-sm",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-600",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left",children:"Produit"}),u.jsx("th",{className:"px-4 py-2 text-right",children:"Prix Unit."}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Qté"}),u.jsx("th",{className:"px-4 py-2 text-right",children:"Total"}),u.jsx("th",{className:"px-4 py-2"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map(f=>{const h=Math.round(f.product.price*f.quantity);return u.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:f.product.image,alt:f.product.name,className:"w-12 h-12 object-cover rounded-md mr-3"}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-[#8B4513]",children:f.product.name}),u.jsxs("div",{className:"text-xs text-gray-500",children:["Réf: ",f.product.reference]})]})]})}),u.jsxs("td",{className:"px-4 py-3 text-right",children:[Math.round(f.product.price)," Fcfa"]}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("button",{className:"p-1 text-gray-500 hover:text-[#8B4513]",onClick:()=>r(f.product.id,f.quantity-1),children:u.jsx(_p,{className:"h-4 w-4"})}),u.jsx("input",{type:"number",min:"0",value:f.quantity,onChange:p=>d(f.product.id,p.target.value),className:"mx-2 w-16 text-center border border-gray-300 rounded-md focus:ring-[#8B4513] focus:border-[#8B4513]"}),u.jsx("button",{className:"p-1 text-gray-500 hover:text-[#8B4513]",onClick:()=>r(f.product.id,f.quantity+1),children:u.jsx(Po,{className:"h-4 w-4"})})]})}),u.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:[h," Fcfa"]}),u.jsx("td",{className:"px-4 py-3 text-right",children:u.jsx("button",{className:"p-1 text-gray-400 hover:text-red-500",onClick:()=>n(f.product.id),children:u.jsx(Cr,{className:"h-5 w-5"})})})]},f.product.id)})})]})}),u.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-100",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:"Sous-total HT:"}),u.jsxs("span",{className:"font-medium",children:[Math.round(s)," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:"TVA (19.25%):"}),u.jsxs("span",{className:"font-medium",children:[Math.round(o)," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:"Sous-total TTC:"}),u.jsxs("span",{className:"font-medium",children:[Math.round(a)," Fcfa"]})]}),u.jsx("div",{className:"pt-2 mt-2 border-t border-gray-200",children:u.jsxs("div",{className:"flex justify-between font-bold text-lg text-[#8B4513]",children:[u.jsx("span",{children:"Total à payer:"}),u.jsxs("span",{children:[Math.round(a)," Fcfa"]})]})})]}),u.jsx("button",{className:"w-full mt-4 bg-[#FFD700] text-[#8B4513] py-3 rounded-lg font-bold text-lg transition-transform hover:bg-[#FFD700]/80 hover:scale-[1.02] shadow-md",onClick:t,children:"Paiement"})]})]})},f5=(t,e)=>e.some(n=>t instanceof n);let fS,pS;function HH(){return fS||(fS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WH(){return pS||(pS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p5=new WeakMap,Rv=new WeakMap,py=new WeakMap;function $H(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(td(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return py.set(e,t),e}function GH(t){if(p5.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});p5.set(t,e)}let m5={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return p5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return td(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tj(t){m5=t(m5)}function KH(t){return WH().includes(t)?function(...e){return t.apply(g5(this),e),td(this.request)}:function(...e){return td(t.apply(g5(this),e))}}function QH(t){return typeof t=="function"?KH(t):(t instanceof IDBTransaction&&GH(t),f5(t,HH())?new Proxy(t,m5):t)}function td(t){if(t instanceof IDBRequest)return $H(t);if(Rv.has(t))return Rv.get(t);const e=QH(t);return e!==t&&(Rv.set(t,e),py.set(e,t)),e}const g5=t=>py.get(t);function s4(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=td(o);return r&&o.addEventListener("upgradeneeded",l=>{r(td(o.result),l.oldVersion,l.newVersion,td(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const YH=["get","getKey","getAll","getAllKeys","count"],XH=["put","add","delete","clear"],Fv=new Map;function mS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fv.get(e))return Fv.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=XH.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||YH.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Fv.set(e,s),s}tj(t=>({...t,get:(e,n,r)=>mS(e,n)||t.get(e,n,r),has:(e,n)=>!!mS(e,n)||t.has(e,n)}));const JH=["continue","continuePrimaryKey","advance"],gS={},x5=new WeakMap,nj=new WeakMap,ZH={get(t,e){if(!JH.includes(e))return t[e];let n=gS[e];return n||(n=gS[e]=function(...r){x5.set(this,nj.get(this)[e](...r))}),n}};async function*eW(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,ZH);for(nj.set(n,e),py.set(n,g5(e));e;)yield n,e=await(x5.get(n)||e.continue()),x5.delete(n)}function xS(t,e){return e===Symbol.asyncIterator&&f5(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&f5(t,[IDBIndex,IDBObjectStore])}tj(t=>({...t,get(e,n,r){return xS(e,n)?eW:t.get(e,n,r)},has(e,n){return xS(e,n)||t.has(e,n)}}));var rj={exports:{}};function tW(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Lv={exports:{}};const nW={},rW=Object.freeze(Object.defineProperty({__proto__:null,default:nW},Symbol.toStringTag,{value:"Module"})),iW=J6(rW);var yS;function Sn(){return yS||(yS=1,function(t,e){(function(n,r){t.exports=r()})(dn,function(){var n=n||function(r,i){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof dn<"u"&&dn.crypto&&(s=dn.crypto),!s&&typeof tW=="function")try{s=iW}catch{}var o=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function w(){}return function(N){var E;return w.prototype=N,E=new w,w.prototype=null,E}}(),l={},c=l.lib={},d=c.Base=function(){return{extend:function(w){var N=a(this);return w&&N.mixIn(w),(!N.hasOwnProperty("init")||this.init===N.init)&&(N.init=function(){N.$super.init.apply(this,arguments)}),N.init.prototype=N,N.$super=this,N},create:function(){var w=this.extend();return w.init.apply(w,arguments),w},init:function(){},mixIn:function(w){for(var N in w)w.hasOwnProperty(N)&&(this[N]=w[N]);w.hasOwnProperty("toString")&&(this.toString=w.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=c.WordArray=d.extend({init:function(w,N){w=this.words=w||[],N!=i?this.sigBytes=N:this.sigBytes=w.length*4},toString:function(w){return(w||p).stringify(this)},concat:function(w){var N=this.words,E=w.words,D=this.sigBytes,j=w.sigBytes;if(this.clamp(),D%4)for(var C=0;C<j;C++){var v=E[C>>>2]>>>24-C%4*8&255;N[D+C>>>2]|=v<<24-(D+C)%4*8}else for(var A=0;A<j;A+=4)N[D+A>>>2]=E[A>>>2];return this.sigBytes+=j,this},clamp:function(){var w=this.words,N=this.sigBytes;w[N>>>2]&=4294967295<<32-N%4*8,w.length=r.ceil(N/4)},clone:function(){var w=d.clone.call(this);return w.words=this.words.slice(0),w},random:function(w){for(var N=[],E=0;E<w;E+=4)N.push(o());return new f.init(N,w)}}),h=l.enc={},p=h.Hex={stringify:function(w){for(var N=w.words,E=w.sigBytes,D=[],j=0;j<E;j++){var C=N[j>>>2]>>>24-j%4*8&255;D.push((C>>>4).toString(16)),D.push((C&15).toString(16))}return D.join("")},parse:function(w){for(var N=w.length,E=[],D=0;D<N;D+=2)E[D>>>3]|=parseInt(w.substr(D,2),16)<<24-D%8*4;return new f.init(E,N/2)}},m=h.Latin1={stringify:function(w){for(var N=w.words,E=w.sigBytes,D=[],j=0;j<E;j++){var C=N[j>>>2]>>>24-j%4*8&255;D.push(String.fromCharCode(C))}return D.join("")},parse:function(w){for(var N=w.length,E=[],D=0;D<N;D++)E[D>>>2]|=(w.charCodeAt(D)&255)<<24-D%4*8;return new f.init(E,N)}},g=h.Utf8={stringify:function(w){try{return decodeURIComponent(escape(m.stringify(w)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(w){return m.parse(unescape(encodeURIComponent(w)))}},b=c.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(w){typeof w=="string"&&(w=g.parse(w)),this._data.concat(w),this._nDataBytes+=w.sigBytes},_process:function(w){var N,E=this._data,D=E.words,j=E.sigBytes,C=this.blockSize,v=C*4,A=j/v;w?A=r.ceil(A):A=r.max((A|0)-this._minBufferSize,0);var I=A*C,S=r.min(I*4,j);if(I){for(var P=0;P<I;P+=C)this._doProcessBlock(D,P);N=D.splice(0,I),E.sigBytes-=S}return new f.init(N,S)},clone:function(){var w=d.clone.call(this);return w._data=this._data.clone(),w},_minBufferSize:0});c.Hasher=b.extend({cfg:d.extend(),init:function(w){this.cfg=this.cfg.extend(w),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(w){return this._append(w),this._process(),this},finalize:function(w){w&&this._append(w);var N=this._doFinalize();return N},blockSize:16,_createHelper:function(w){return function(N,E){return new w.init(E).finalize(N)}},_createHmacHelper:function(w){return function(N,E){return new x.HMAC.init(w,E).finalize(N)}}});var x=l.algo={};return l}(Math);return n})}(Lv)),Lv.exports}var Mv={exports:{}},vS;function my(){return vS||(vS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(r){var i=n,s=i.lib,o=s.Base,a=s.WordArray,l=i.x64={};l.Word=o.extend({init:function(c,d){this.high=c,this.low=d}}),l.WordArray=o.extend({init:function(c,d){c=this.words=c||[],d!=r?this.sigBytes=d:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,d=c.length,f=[],h=0;h<d;h++){var p=c[h];f.push(p.high),f.push(p.low)}return a.create(f,this.sigBytes)},clone:function(){for(var c=o.clone.call(this),d=c.words=this.words.slice(0),f=d.length,h=0;h<f;h++)d[h]=d[h].clone();return c}})}(),n})}(Mv)),Mv.exports}var Bv={exports:{}},bS;function sW(){return bS||(bS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(){if(typeof ArrayBuffer=="function"){var r=n,i=r.lib,s=i.WordArray,o=s.init,a=s.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,d=[],f=0;f<c;f++)d[f>>>2]|=l[f]<<24-f%4*8;o.call(this,d,c)}else o.apply(this,arguments)};a.prototype=s}}(),n.lib.WordArray})}(Bv)),Bv.exports}var Ov={exports:{}},wS;function oW(){return wS||(wS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(l){for(var c=l.words,d=l.sigBytes,f=[],h=0;h<d;h+=2){var p=c[h>>>2]>>>16-h%4*8&65535;f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,d=[],f=0;f<c;f++)d[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return s.create(d,c*2)}},o.Utf16LE={stringify:function(l){for(var c=l.words,d=l.sigBytes,f=[],h=0;h<d;h+=2){var p=a(c[h>>>2]>>>16-h%4*8&65535);f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,d=[],f=0;f<c;f++)d[f>>>1]|=a(l.charCodeAt(f)<<16-f%2*16);return s.create(d,c*2)}};function a(l){return l<<8&4278255360|l>>>8&16711935}}(),n.enc.Utf16})}(Ov)),Ov.exports}var Vv={exports:{}},_S;function Md(){return _S||(_S=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.WordArray,o=r.enc;o.Base64={stringify:function(l){var c=l.words,d=l.sigBytes,f=this._map;l.clamp();for(var h=[],p=0;p<d;p+=3)for(var m=c[p>>>2]>>>24-p%4*8&255,g=c[p+1>>>2]>>>24-(p+1)%4*8&255,b=c[p+2>>>2]>>>24-(p+2)%4*8&255,x=m<<16|g<<8|b,w=0;w<4&&p+w*.75<d;w++)h.push(f.charAt(x>>>6*(3-w)&63));var N=f.charAt(64);if(N)for(;h.length%4;)h.push(N);return h.join("")},parse:function(l){var c=l.length,d=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<d.length;h++)f[d.charCodeAt(h)]=h}var p=d.charAt(64);if(p){var m=l.indexOf(p);m!==-1&&(c=m)}return a(l,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(l,c,d){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var m=d[l.charCodeAt(p-1)]<<p%4*2,g=d[l.charCodeAt(p)]>>>6-p%4*2,b=m|g;f[h>>>2]|=b<<24-h%4*8,h++}return s.create(f,h)}}(),n.enc.Base64})}(Vv)),Vv.exports}var Uv={exports:{}},NS;function aW(){return NS||(NS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.WordArray,o=r.enc;o.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var d=l.words,f=l.sigBytes,h=c?this._safe_map:this._map;l.clamp();for(var p=[],m=0;m<f;m+=3)for(var g=d[m>>>2]>>>24-m%4*8&255,b=d[m+1>>>2]>>>24-(m+1)%4*8&255,x=d[m+2>>>2]>>>24-(m+2)%4*8&255,w=g<<16|b<<8|x,N=0;N<4&&m+N*.75<f;N++)p.push(h.charAt(w>>>6*(3-N)&63));var E=h.charAt(64);if(E)for(;p.length%4;)p.push(E);return p.join("")},parse:function(l,c){c===void 0&&(c=!0);var d=l.length,f=c?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var p=0;p<f.length;p++)h[f.charCodeAt(p)]=p}var m=f.charAt(64);if(m){var g=l.indexOf(m);g!==-1&&(d=g)}return a(l,d,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(l,c,d){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var m=d[l.charCodeAt(p-1)]<<p%4*2,g=d[l.charCodeAt(p)]>>>6-p%4*2,b=m|g;f[h>>>2]|=b<<24-h%4*8,h++}return s.create(f,h)}}(),n.enc.Base64url})}(Uv)),Uv.exports}var zv={exports:{}},AS;function Bd(){return AS||(AS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(r){var i=n,s=i.lib,o=s.WordArray,a=s.Hasher,l=i.algo,c=[];(function(){for(var g=0;g<64;g++)c[g]=r.abs(r.sin(g+1))*4294967296|0})();var d=l.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,b){for(var x=0;x<16;x++){var w=b+x,N=g[w];g[w]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var E=this._hash.words,D=g[b+0],j=g[b+1],C=g[b+2],v=g[b+3],A=g[b+4],I=g[b+5],S=g[b+6],P=g[b+7],k=g[b+8],F=g[b+9],q=g[b+10],O=g[b+11],M=g[b+12],W=g[b+13],z=g[b+14],J=g[b+15],ne=E[0],V=E[1],$=E[2],K=E[3];ne=f(ne,V,$,K,D,7,c[0]),K=f(K,ne,V,$,j,12,c[1]),$=f($,K,ne,V,C,17,c[2]),V=f(V,$,K,ne,v,22,c[3]),ne=f(ne,V,$,K,A,7,c[4]),K=f(K,ne,V,$,I,12,c[5]),$=f($,K,ne,V,S,17,c[6]),V=f(V,$,K,ne,P,22,c[7]),ne=f(ne,V,$,K,k,7,c[8]),K=f(K,ne,V,$,F,12,c[9]),$=f($,K,ne,V,q,17,c[10]),V=f(V,$,K,ne,O,22,c[11]),ne=f(ne,V,$,K,M,7,c[12]),K=f(K,ne,V,$,W,12,c[13]),$=f($,K,ne,V,z,17,c[14]),V=f(V,$,K,ne,J,22,c[15]),ne=h(ne,V,$,K,j,5,c[16]),K=h(K,ne,V,$,S,9,c[17]),$=h($,K,ne,V,O,14,c[18]),V=h(V,$,K,ne,D,20,c[19]),ne=h(ne,V,$,K,I,5,c[20]),K=h(K,ne,V,$,q,9,c[21]),$=h($,K,ne,V,J,14,c[22]),V=h(V,$,K,ne,A,20,c[23]),ne=h(ne,V,$,K,F,5,c[24]),K=h(K,ne,V,$,z,9,c[25]),$=h($,K,ne,V,v,14,c[26]),V=h(V,$,K,ne,k,20,c[27]),ne=h(ne,V,$,K,W,5,c[28]),K=h(K,ne,V,$,C,9,c[29]),$=h($,K,ne,V,P,14,c[30]),V=h(V,$,K,ne,M,20,c[31]),ne=p(ne,V,$,K,I,4,c[32]),K=p(K,ne,V,$,k,11,c[33]),$=p($,K,ne,V,O,16,c[34]),V=p(V,$,K,ne,z,23,c[35]),ne=p(ne,V,$,K,j,4,c[36]),K=p(K,ne,V,$,A,11,c[37]),$=p($,K,ne,V,P,16,c[38]),V=p(V,$,K,ne,q,23,c[39]),ne=p(ne,V,$,K,W,4,c[40]),K=p(K,ne,V,$,D,11,c[41]),$=p($,K,ne,V,v,16,c[42]),V=p(V,$,K,ne,S,23,c[43]),ne=p(ne,V,$,K,F,4,c[44]),K=p(K,ne,V,$,M,11,c[45]),$=p($,K,ne,V,J,16,c[46]),V=p(V,$,K,ne,C,23,c[47]),ne=m(ne,V,$,K,D,6,c[48]),K=m(K,ne,V,$,P,10,c[49]),$=m($,K,ne,V,z,15,c[50]),V=m(V,$,K,ne,I,21,c[51]),ne=m(ne,V,$,K,M,6,c[52]),K=m(K,ne,V,$,v,10,c[53]),$=m($,K,ne,V,q,15,c[54]),V=m(V,$,K,ne,j,21,c[55]),ne=m(ne,V,$,K,k,6,c[56]),K=m(K,ne,V,$,J,10,c[57]),$=m($,K,ne,V,S,15,c[58]),V=m(V,$,K,ne,W,21,c[59]),ne=m(ne,V,$,K,A,6,c[60]),K=m(K,ne,V,$,O,10,c[61]),$=m($,K,ne,V,C,15,c[62]),V=m(V,$,K,ne,F,21,c[63]),E[0]=E[0]+ne|0,E[1]=E[1]+V|0,E[2]=E[2]+$|0,E[3]=E[3]+K|0},_doFinalize:function(){var g=this._data,b=g.words,x=this._nDataBytes*8,w=g.sigBytes*8;b[w>>>5]|=128<<24-w%32;var N=r.floor(x/4294967296),E=x;b[(w+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,b[(w+64>>>9<<4)+14]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,g.sigBytes=(b.length+1)*4,this._process();for(var D=this._hash,j=D.words,C=0;C<4;C++){var v=j[C];j[C]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}return D},clone:function(){var g=a.clone.call(this);return g._hash=this._hash.clone(),g}});function f(g,b,x,w,N,E,D){var j=g+(b&x|~b&w)+N+D;return(j<<E|j>>>32-E)+b}function h(g,b,x,w,N,E,D){var j=g+(b&w|x&~w)+N+D;return(j<<E|j>>>32-E)+b}function p(g,b,x,w,N,E,D){var j=g+(b^x^w)+N+D;return(j<<E|j>>>32-E)+b}function m(g,b,x,w,N,E,D){var j=g+(x^(b|~w))+N+D;return(j<<E|j>>>32-E)+b}i.MD5=a._createHelper(d),i.HmacMD5=a._createHmacHelper(d)}(Math),n.MD5})}(zv)),zv.exports}var qv={exports:{}},SS;function ij(){return SS||(SS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.WordArray,o=i.Hasher,a=r.algo,l=[],c=a.SHA1=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,f){for(var h=this._hash.words,p=h[0],m=h[1],g=h[2],b=h[3],x=h[4],w=0;w<80;w++){if(w<16)l[w]=d[f+w]|0;else{var N=l[w-3]^l[w-8]^l[w-14]^l[w-16];l[w]=N<<1|N>>>31}var E=(p<<5|p>>>27)+x+l[w];w<20?E+=(m&g|~m&b)+1518500249:w<40?E+=(m^g^b)+1859775393:w<60?E+=(m&g|m&b|g&b)-1894007588:E+=(m^g^b)-899497514,x=b,b=g,g=m<<30|m>>>2,m=p,p=E}h[0]=h[0]+p|0,h[1]=h[1]+m|0,h[2]=h[2]+g|0,h[3]=h[3]+b|0,h[4]=h[4]+x|0},_doFinalize:function(){var d=this._data,f=d.words,h=this._nDataBytes*8,p=d.sigBytes*8;return f[p>>>5]|=128<<24-p%32,f[(p+64>>>9<<4)+14]=Math.floor(h/4294967296),f[(p+64>>>9<<4)+15]=h,d.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var d=o.clone.call(this);return d._hash=this._hash.clone(),d}});r.SHA1=o._createHelper(c),r.HmacSHA1=o._createHmacHelper(c)}(),n.SHA1})}(qv)),qv.exports}var Hv={exports:{}},ES;function o4(){return ES||(ES=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){return function(r){var i=n,s=i.lib,o=s.WordArray,a=s.Hasher,l=i.algo,c=[],d=[];(function(){function p(x){for(var w=r.sqrt(x),N=2;N<=w;N++)if(!(x%N))return!1;return!0}function m(x){return(x-(x|0))*4294967296|0}for(var g=2,b=0;b<64;)p(g)&&(b<8&&(c[b]=m(r.pow(g,1/2))),d[b]=m(r.pow(g,1/3)),b++),g++})();var f=[],h=l.SHA256=a.extend({_doReset:function(){this._hash=new o.init(c.slice(0))},_doProcessBlock:function(p,m){for(var g=this._hash.words,b=g[0],x=g[1],w=g[2],N=g[3],E=g[4],D=g[5],j=g[6],C=g[7],v=0;v<64;v++){if(v<16)f[v]=p[m+v]|0;else{var A=f[v-15],I=(A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3,S=f[v-2],P=(S<<15|S>>>17)^(S<<13|S>>>19)^S>>>10;f[v]=I+f[v-7]+P+f[v-16]}var k=E&D^~E&j,F=b&x^b&w^x&w,q=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),O=(E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25),M=C+O+k+d[v]+f[v],W=q+F;C=j,j=D,D=E,E=N+M|0,N=w,w=x,x=b,b=M+W|0}g[0]=g[0]+b|0,g[1]=g[1]+x|0,g[2]=g[2]+w|0,g[3]=g[3]+N|0,g[4]=g[4]+E|0,g[5]=g[5]+D|0,g[6]=g[6]+j|0,g[7]=g[7]+C|0},_doFinalize:function(){var p=this._data,m=p.words,g=this._nDataBytes*8,b=p.sigBytes*8;return m[b>>>5]|=128<<24-b%32,m[(b+64>>>9<<4)+14]=r.floor(g/4294967296),m[(b+64>>>9<<4)+15]=g,p.sigBytes=m.length*4,this._process(),this._hash},clone:function(){var p=a.clone.call(this);return p._hash=this._hash.clone(),p}});i.SHA256=a._createHelper(h),i.HmacSHA256=a._createHmacHelper(h)}(Math),n.SHA256})}(Hv)),Hv.exports}var Wv={exports:{}},CS;function lW(){return CS||(CS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),o4())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.WordArray,o=r.algo,a=o.SHA256,l=o.SHA224=a.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(l),r.HmacSHA224=a._createHmacHelper(l)}(),n.SHA224})}(Wv)),Wv.exports}var $v={exports:{}},PS;function sj(){return PS||(PS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),my())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.Hasher,o=r.x64,a=o.Word,l=o.WordArray,c=r.algo;function d(){return a.create.apply(a,arguments)}var f=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],h=[];(function(){for(var m=0;m<80;m++)h[m]=d()})();var p=c.SHA512=s.extend({_doReset:function(){this._hash=new l.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(m,g){for(var b=this._hash.words,x=b[0],w=b[1],N=b[2],E=b[3],D=b[4],j=b[5],C=b[6],v=b[7],A=x.high,I=x.low,S=w.high,P=w.low,k=N.high,F=N.low,q=E.high,O=E.low,M=D.high,W=D.low,z=j.high,J=j.low,ne=C.high,V=C.low,$=v.high,K=v.low,X=A,ae=I,ye=S,me=P,_e=k,Se=F,Ce=q,ze=O,$e=M,dt=W,Ie=z,fe=J,yt=ne,nt=V,qe=$,Xe=K,Ye=0;Ye<80;Ye++){var Je,ut,mt=h[Ye];if(Ye<16)ut=mt.high=m[g+Ye*2]|0,Je=mt.low=m[g+Ye*2+1]|0;else{var Dt=h[Ye-15],_t=Dt.high,Mt=Dt.low,Ht=(_t>>>1|Mt<<31)^(_t>>>8|Mt<<24)^_t>>>7,Rt=(Mt>>>1|_t<<31)^(Mt>>>8|_t<<24)^(Mt>>>7|_t<<25),Ot=h[Ye-2],at=Ot.high,cn=Ot.low,Yt=(at>>>19|cn<<13)^(at<<3|cn>>>29)^at>>>6,Rn=(cn>>>19|at<<13)^(cn<<3|at>>>29)^(cn>>>6|at<<26),nn=h[Ye-7],An=nn.high,Zr=nn.low,sn=h[Ye-16],ui=sn.high,yn=sn.low;Je=Rt+Zr,ut=Ht+An+(Je>>>0<Rt>>>0?1:0),Je=Je+Rn,ut=ut+Yt+(Je>>>0<Rn>>>0?1:0),Je=Je+yn,ut=ut+ui+(Je>>>0<yn>>>0?1:0),mt.high=ut,mt.low=Je}var mr=$e&Ie^~$e&yt,Xn=dt&fe^~dt&nt,pn=X&ye^X&_e^ye&_e,Et=ae&me^ae&Se^me&Se,on=(X>>>28|ae<<4)^(X<<30|ae>>>2)^(X<<25|ae>>>7),Hr=(ae>>>28|X<<4)^(ae<<30|X>>>2)^(ae<<25|X>>>7),In=($e>>>14|dt<<18)^($e>>>18|dt<<14)^($e<<23|dt>>>9),Hn=(dt>>>14|$e<<18)^(dt>>>18|$e<<14)^(dt<<23|$e>>>9),di=f[Ye],Nt=di.high,Wr=di.low,Cn=Xe+Hn,Fn=qe+In+(Cn>>>0<Xe>>>0?1:0),Cn=Cn+Xn,Fn=Fn+mr+(Cn>>>0<Xn>>>0?1:0),Cn=Cn+Wr,Fn=Fn+Nt+(Cn>>>0<Wr>>>0?1:0),Cn=Cn+Je,Fn=Fn+ut+(Cn>>>0<Je>>>0?1:0),sr=Hr+Et,tr=on+pn+(sr>>>0<Hr>>>0?1:0);qe=yt,Xe=nt,yt=Ie,nt=fe,Ie=$e,fe=dt,dt=ze+Cn|0,$e=Ce+Fn+(dt>>>0<ze>>>0?1:0)|0,Ce=_e,ze=Se,_e=ye,Se=me,ye=X,me=ae,ae=Cn+sr|0,X=Fn+tr+(ae>>>0<Cn>>>0?1:0)|0}I=x.low=I+ae,x.high=A+X+(I>>>0<ae>>>0?1:0),P=w.low=P+me,w.high=S+ye+(P>>>0<me>>>0?1:0),F=N.low=F+Se,N.high=k+_e+(F>>>0<Se>>>0?1:0),O=E.low=O+ze,E.high=q+Ce+(O>>>0<ze>>>0?1:0),W=D.low=W+dt,D.high=M+$e+(W>>>0<dt>>>0?1:0),J=j.low=J+fe,j.high=z+Ie+(J>>>0<fe>>>0?1:0),V=C.low=V+nt,C.high=ne+yt+(V>>>0<nt>>>0?1:0),K=v.low=K+Xe,v.high=$+qe+(K>>>0<Xe>>>0?1:0)},_doFinalize:function(){var m=this._data,g=m.words,b=this._nDataBytes*8,x=m.sigBytes*8;g[x>>>5]|=128<<24-x%32,g[(x+128>>>10<<5)+30]=Math.floor(b/4294967296),g[(x+128>>>10<<5)+31]=b,m.sigBytes=g.length*4,this._process();var w=this._hash.toX32();return w},clone:function(){var m=s.clone.call(this);return m._hash=this._hash.clone(),m},blockSize:1024/32});r.SHA512=s._createHelper(p),r.HmacSHA512=s._createHmacHelper(p)}(),n.SHA512})}($v)),$v.exports}var Gv={exports:{}},kS;function cW(){return kS||(kS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),my(),sj())})(dn,function(n){return function(){var r=n,i=r.x64,s=i.Word,o=i.WordArray,a=r.algo,l=a.SHA512,c=a.SHA384=l.extend({_doReset:function(){this._hash=new o.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var d=l._doFinalize.call(this);return d.sigBytes-=16,d}});r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c)}(),n.SHA384})}(Gv)),Gv.exports}var Kv={exports:{}},TS;function uW(){return TS||(TS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),my())})(dn,function(n){return function(r){var i=n,s=i.lib,o=s.WordArray,a=s.Hasher,l=i.x64,c=l.Word,d=i.algo,f=[],h=[],p=[];(function(){for(var b=1,x=0,w=0;w<24;w++){f[b+5*x]=(w+1)*(w+2)/2%64;var N=x%5,E=(2*b+3*x)%5;b=N,x=E}for(var b=0;b<5;b++)for(var x=0;x<5;x++)h[b+5*x]=x+(2*b+3*x)%5*5;for(var D=1,j=0;j<24;j++){for(var C=0,v=0,A=0;A<7;A++){if(D&1){var I=(1<<A)-1;I<32?v^=1<<I:C^=1<<I-32}D&128?D=D<<1^113:D<<=1}p[j]=c.create(C,v)}})();var m=[];(function(){for(var b=0;b<25;b++)m[b]=c.create()})();var g=d.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],x=0;x<25;x++)b[x]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,x){for(var w=this._state,N=this.blockSize/2,E=0;E<N;E++){var D=b[x+2*E],j=b[x+2*E+1];D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,j=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360;var C=w[E];C.high^=j,C.low^=D}for(var v=0;v<24;v++){for(var A=0;A<5;A++){for(var I=0,S=0,P=0;P<5;P++){var C=w[A+5*P];I^=C.high,S^=C.low}var k=m[A];k.high=I,k.low=S}for(var A=0;A<5;A++)for(var F=m[(A+4)%5],q=m[(A+1)%5],O=q.high,M=q.low,I=F.high^(O<<1|M>>>31),S=F.low^(M<<1|O>>>31),P=0;P<5;P++){var C=w[A+5*P];C.high^=I,C.low^=S}for(var W=1;W<25;W++){var I,S,C=w[W],z=C.high,J=C.low,ne=f[W];ne<32?(I=z<<ne|J>>>32-ne,S=J<<ne|z>>>32-ne):(I=J<<ne-32|z>>>64-ne,S=z<<ne-32|J>>>64-ne);var V=m[h[W]];V.high=I,V.low=S}var $=m[0],K=w[0];$.high=K.high,$.low=K.low;for(var A=0;A<5;A++)for(var P=0;P<5;P++){var W=A+5*P,C=w[W],X=m[W],ae=m[(A+1)%5+5*P],ye=m[(A+2)%5+5*P];C.high=X.high^~ae.high&ye.high,C.low=X.low^~ae.low&ye.low}var C=w[0],me=p[v];C.high^=me.high,C.low^=me.low}},_doFinalize:function(){var b=this._data,x=b.words;this._nDataBytes*8;var w=b.sigBytes*8,N=this.blockSize*32;x[w>>>5]|=1<<24-w%32,x[(r.ceil((w+1)/N)*N>>>5)-1]|=128,b.sigBytes=x.length*4,this._process();for(var E=this._state,D=this.cfg.outputLength/8,j=D/8,C=[],v=0;v<j;v++){var A=E[v],I=A.high,S=A.low;I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,C.push(S),C.push(I)}return new o.init(C,D)},clone:function(){for(var b=a.clone.call(this),x=b._state=this._state.slice(0),w=0;w<25;w++)x[w]=x[w].clone();return b}});i.SHA3=a._createHelper(g),i.HmacSHA3=a._createHmacHelper(g)}(Math),n.SHA3})}(Kv)),Kv.exports}var Qv={exports:{}},IS;function dW(){return IS||(IS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var i=n,s=i.lib,o=s.WordArray,a=s.Hasher,l=i.algo,c=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),d=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=o.create([0,1518500249,1859775393,2400959708,2840853838]),m=o.create([1352829926,1548603684,1836072691,2053994217,0]),g=l.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(j,C){for(var v=0;v<16;v++){var A=C+v,I=j[A];j[A]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}var S=this._hash.words,P=p.words,k=m.words,F=c.words,q=d.words,O=f.words,M=h.words,W,z,J,ne,V,$,K,X,ae,ye;$=W=S[0],K=z=S[1],X=J=S[2],ae=ne=S[3],ye=V=S[4];for(var me,v=0;v<80;v+=1)me=W+j[C+F[v]]|0,v<16?me+=b(z,J,ne)+P[0]:v<32?me+=x(z,J,ne)+P[1]:v<48?me+=w(z,J,ne)+P[2]:v<64?me+=N(z,J,ne)+P[3]:me+=E(z,J,ne)+P[4],me=me|0,me=D(me,O[v]),me=me+V|0,W=V,V=ne,ne=D(J,10),J=z,z=me,me=$+j[C+q[v]]|0,v<16?me+=E(K,X,ae)+k[0]:v<32?me+=N(K,X,ae)+k[1]:v<48?me+=w(K,X,ae)+k[2]:v<64?me+=x(K,X,ae)+k[3]:me+=b(K,X,ae)+k[4],me=me|0,me=D(me,M[v]),me=me+ye|0,$=ye,ye=ae,ae=D(X,10),X=K,K=me;me=S[1]+J+ae|0,S[1]=S[2]+ne+ye|0,S[2]=S[3]+V+$|0,S[3]=S[4]+W+K|0,S[4]=S[0]+z+X|0,S[0]=me},_doFinalize:function(){var j=this._data,C=j.words,v=this._nDataBytes*8,A=j.sigBytes*8;C[A>>>5]|=128<<24-A%32,C[(A+64>>>9<<4)+14]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,j.sigBytes=(C.length+1)*4,this._process();for(var I=this._hash,S=I.words,P=0;P<5;P++){var k=S[P];S[P]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return I},clone:function(){var j=a.clone.call(this);return j._hash=this._hash.clone(),j}});function b(j,C,v){return j^C^v}function x(j,C,v){return j&C|~j&v}function w(j,C,v){return(j|~C)^v}function N(j,C,v){return j&v|C&~v}function E(j,C,v){return j^(C|~v)}function D(j,C){return j<<C|j>>>32-C}i.RIPEMD160=a._createHelper(g),i.HmacRIPEMD160=a._createHmacHelper(g)}(),n.RIPEMD160})}(Qv)),Qv.exports}var Yv={exports:{}},jS;function a4(){return jS||(jS=1,function(t,e){(function(n,r){t.exports=r(Sn())})(dn,function(n){(function(){var r=n,i=r.lib,s=i.Base,o=r.enc,a=o.Utf8,l=r.algo;l.HMAC=s.extend({init:function(c,d){c=this._hasher=new c.init,typeof d=="string"&&(d=a.parse(d));var f=c.blockSize,h=f*4;d.sigBytes>h&&(d=c.finalize(d)),d.clamp();for(var p=this._oKey=d.clone(),m=this._iKey=d.clone(),g=p.words,b=m.words,x=0;x<f;x++)g[x]^=1549556828,b[x]^=909522486;p.sigBytes=m.sigBytes=h,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var d=this._hasher,f=d.finalize(c);d.reset();var h=d.finalize(this._oKey.clone().concat(f));return h}})})()})}(Yv)),Yv.exports}var Xv={exports:{}},DS;function hW(){return DS||(DS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),o4(),a4())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.Base,o=i.WordArray,a=r.algo,l=a.SHA256,c=a.HMAC,d=a.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,h){for(var p=this.cfg,m=c.create(p.hasher,f),g=o.create(),b=o.create([1]),x=g.words,w=b.words,N=p.keySize,E=p.iterations;x.length<N;){var D=m.update(h).finalize(b);m.reset();for(var j=D.words,C=j.length,v=D,A=1;A<E;A++){v=m.finalize(v),m.reset();for(var I=v.words,S=0;S<C;S++)j[S]^=I[S]}g.concat(D),w[0]++}return g.sigBytes=N*4,g}});r.PBKDF2=function(f,h,p){return d.create(p).compute(f,h)}}(),n.PBKDF2})}(Xv)),Xv.exports}var Jv={exports:{}},RS;function vu(){return RS||(RS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),ij(),a4())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.Base,o=i.WordArray,a=r.algo,l=a.MD5,c=a.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,f){for(var h,p=this.cfg,m=p.hasher.create(),g=o.create(),b=g.words,x=p.keySize,w=p.iterations;b.length<x;){h&&m.update(h),h=m.update(d).finalize(f),m.reset();for(var N=1;N<w;N++)h=m.finalize(h),m.reset();g.concat(h)}return g.sigBytes=x*4,g}});r.EvpKDF=function(d,f,h){return c.create(h).compute(d,f)}}(),n.EvpKDF})}(Jv)),Jv.exports}var Zv={exports:{}},FS;function bi(){return FS||(FS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),vu())})(dn,function(n){n.lib.Cipher||function(r){var i=n,s=i.lib,o=s.Base,a=s.WordArray,l=s.BufferedBlockAlgorithm,c=i.enc;c.Utf8;var d=c.Base64,f=i.algo,h=f.EvpKDF,p=s.Cipher=l.extend({cfg:o.extend(),createEncryptor:function(I,S){return this.create(this._ENC_XFORM_MODE,I,S)},createDecryptor:function(I,S){return this.create(this._DEC_XFORM_MODE,I,S)},init:function(I,S,P){this.cfg=this.cfg.extend(P),this._xformMode=I,this._key=S,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(I){return this._append(I),this._process()},finalize:function(I){I&&this._append(I);var S=this._doFinalize();return S},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function I(S){return typeof S=="string"?A:j}return function(S){return{encrypt:function(P,k,F){return I(k).encrypt(S,P,k,F)},decrypt:function(P,k,F){return I(k).decrypt(S,P,k,F)}}}}()});s.StreamCipher=p.extend({_doFinalize:function(){var I=this._process(!0);return I},blockSize:1});var m=i.mode={},g=s.BlockCipherMode=o.extend({createEncryptor:function(I,S){return this.Encryptor.create(I,S)},createDecryptor:function(I,S){return this.Decryptor.create(I,S)},init:function(I,S){this._cipher=I,this._iv=S}}),b=m.CBC=function(){var I=g.extend();I.Encryptor=I.extend({processBlock:function(P,k){var F=this._cipher,q=F.blockSize;S.call(this,P,k,q),F.encryptBlock(P,k),this._prevBlock=P.slice(k,k+q)}}),I.Decryptor=I.extend({processBlock:function(P,k){var F=this._cipher,q=F.blockSize,O=P.slice(k,k+q);F.decryptBlock(P,k),S.call(this,P,k,q),this._prevBlock=O}});function S(P,k,F){var q,O=this._iv;O?(q=O,this._iv=r):q=this._prevBlock;for(var M=0;M<F;M++)P[k+M]^=q[M]}return I}(),x=i.pad={},w=x.Pkcs7={pad:function(I,S){for(var P=S*4,k=P-I.sigBytes%P,F=k<<24|k<<16|k<<8|k,q=[],O=0;O<k;O+=4)q.push(F);var M=a.create(q,k);I.concat(M)},unpad:function(I){var S=I.words[I.sigBytes-1>>>2]&255;I.sigBytes-=S}};s.BlockCipher=p.extend({cfg:p.cfg.extend({mode:b,padding:w}),reset:function(){var I;p.reset.call(this);var S=this.cfg,P=S.iv,k=S.mode;this._xformMode==this._ENC_XFORM_MODE?I=k.createEncryptor:(I=k.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==I?this._mode.init(this,P&&P.words):(this._mode=I.call(k,this,P&&P.words),this._mode.__creator=I)},_doProcessBlock:function(I,S){this._mode.processBlock(I,S)},_doFinalize:function(){var I,S=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(S.pad(this._data,this.blockSize),I=this._process(!0)):(I=this._process(!0),S.unpad(I)),I},blockSize:128/32});var N=s.CipherParams=o.extend({init:function(I){this.mixIn(I)},toString:function(I){return(I||this.formatter).stringify(this)}}),E=i.format={},D=E.OpenSSL={stringify:function(I){var S,P=I.ciphertext,k=I.salt;return k?S=a.create([1398893684,1701076831]).concat(k).concat(P):S=P,S.toString(d)},parse:function(I){var S,P=d.parse(I),k=P.words;return k[0]==1398893684&&k[1]==1701076831&&(S=a.create(k.slice(2,4)),k.splice(0,4),P.sigBytes-=16),N.create({ciphertext:P,salt:S})}},j=s.SerializableCipher=o.extend({cfg:o.extend({format:D}),encrypt:function(I,S,P,k){k=this.cfg.extend(k);var F=I.createEncryptor(P,k),q=F.finalize(S),O=F.cfg;return N.create({ciphertext:q,key:P,iv:O.iv,algorithm:I,mode:O.mode,padding:O.padding,blockSize:I.blockSize,formatter:k.format})},decrypt:function(I,S,P,k){k=this.cfg.extend(k),S=this._parse(S,k.format);var F=I.createDecryptor(P,k).finalize(S.ciphertext);return F},_parse:function(I,S){return typeof I=="string"?S.parse(I,this):I}}),C=i.kdf={},v=C.OpenSSL={execute:function(I,S,P,k,F){if(k||(k=a.random(64/8)),F)var q=h.create({keySize:S+P,hasher:F}).compute(I,k);else var q=h.create({keySize:S+P}).compute(I,k);var O=a.create(q.words.slice(S),P*4);return q.sigBytes=S*4,N.create({key:q,iv:O,salt:k})}},A=s.PasswordBasedCipher=j.extend({cfg:j.cfg.extend({kdf:v}),encrypt:function(I,S,P,k){k=this.cfg.extend(k);var F=k.kdf.execute(P,I.keySize,I.ivSize,k.salt,k.hasher);k.iv=F.iv;var q=j.encrypt.call(this,I,S,F.key,k);return q.mixIn(F),q},decrypt:function(I,S,P,k){k=this.cfg.extend(k),S=this._parse(S,k.format);var F=k.kdf.execute(P,I.keySize,I.ivSize,S.salt,k.hasher);k.iv=F.iv;var q=j.decrypt.call(this,I,S,F.key,k);return q}})}()})}(Zv)),Zv.exports}var e2={exports:{}},LS;function fW(){return LS||(LS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.mode.CFB=function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(s,o){var a=this._cipher,l=a.blockSize;i.call(this,s,o,l,a),this._prevBlock=s.slice(o,o+l)}}),r.Decryptor=r.extend({processBlock:function(s,o){var a=this._cipher,l=a.blockSize,c=s.slice(o,o+l);i.call(this,s,o,l,a),this._prevBlock=c}});function i(s,o,a,l){var c,d=this._iv;d?(c=d.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var f=0;f<a;f++)s[o+f]^=c[f]}return r}(),n.mode.CFB})}(e2)),e2.exports}var t2={exports:{}},MS;function pW(){return MS||(MS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.mode.CTR=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,o){var a=this._cipher,l=a.blockSize,c=this._iv,d=this._counter;c&&(d=this._counter=c.slice(0),this._iv=void 0);var f=d.slice(0);a.encryptBlock(f,0),d[l-1]=d[l-1]+1|0;for(var h=0;h<l;h++)s[o+h]^=f[h]}});return r.Decryptor=i,r}(),n.mode.CTR})}(t2)),t2.exports}var n2={exports:{}},BS;function mW(){return BS||(BS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var r=n.lib.BlockCipherMode.extend();function i(a){if((a>>24&255)===255){var l=a>>16&255,c=a>>8&255,d=a&255;l===255?(l=0,c===255?(c=0,d===255?d=0:++d):++c):++l,a=0,a+=l<<16,a+=c<<8,a+=d}else a+=1<<24;return a}function s(a){return(a[0]=i(a[0]))===0&&(a[1]=i(a[1])),a}var o=r.Encryptor=r.extend({processBlock:function(a,l){var c=this._cipher,d=c.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0),s(h);var p=h.slice(0);c.encryptBlock(p,0);for(var m=0;m<d;m++)a[l+m]^=p[m]}});return r.Decryptor=o,r}(),n.mode.CTRGladman})}(n2)),n2.exports}var r2={exports:{}},OS;function gW(){return OS||(OS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.mode.OFB=function(){var r=n.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(s,o){var a=this._cipher,l=a.blockSize,c=this._iv,d=this._keystream;c&&(d=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(d,0);for(var f=0;f<l;f++)s[o+f]^=d[f]}});return r.Decryptor=i,r}(),n.mode.OFB})}(r2)),r2.exports}var i2={exports:{}},VS;function xW(){return VS||(VS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.mode.ECB=function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(i,s){this._cipher.encryptBlock(i,s)}}),r.Decryptor=r.extend({processBlock:function(i,s){this._cipher.decryptBlock(i,s)}}),r}(),n.mode.ECB})}(i2)),i2.exports}var s2={exports:{}},US;function yW(){return US||(US=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.pad.AnsiX923={pad:function(r,i){var s=r.sigBytes,o=i*4,a=o-s%o,l=s+a-1;r.clamp(),r.words[l>>>2]|=a<<24-l%4*8,r.sigBytes+=a},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Ansix923})}(s2)),s2.exports}var o2={exports:{}},zS;function vW(){return zS||(zS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.pad.Iso10126={pad:function(r,i){var s=i*4,o=s-r.sigBytes%s;r.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(r){var i=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=i}},n.pad.Iso10126})}(o2)),o2.exports}var a2={exports:{}},qS;function bW(){return qS||(qS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.pad.Iso97971={pad:function(r,i){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,i)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})}(a2)),a2.exports}var l2={exports:{}},HS;function wW(){return HS||(HS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.pad.ZeroPadding={pad:function(r,i){var s=i*4;r.clamp(),r.sigBytes+=s-(r.sigBytes%s||s)},unpad:function(r){for(var i=r.words,s=r.sigBytes-1,s=r.sigBytes-1;s>=0;s--)if(i[s>>>2]>>>24-s%4*8&255){r.sigBytes=s+1;break}}},n.pad.ZeroPadding})}(l2)),l2.exports}var c2={exports:{}},WS;function _W(){return WS||(WS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(c2)),c2.exports}var u2={exports:{}},$S;function NW(){return $S||($S=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),bi())})(dn,function(n){return function(r){var i=n,s=i.lib,o=s.CipherParams,a=i.enc,l=a.Hex,c=i.format;c.Hex={stringify:function(d){return d.ciphertext.toString(l)},parse:function(d){var f=l.parse(d);return o.create({ciphertext:f})}}}(),n.format.Hex})}(u2)),u2.exports}var d2={exports:{}},GS;function AW(){return GS||(GS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),Md(),Bd(),vu(),bi())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.BlockCipher,o=r.algo,a=[],l=[],c=[],d=[],f=[],h=[],p=[],m=[],g=[],b=[];(function(){for(var N=[],E=0;E<256;E++)E<128?N[E]=E<<1:N[E]=E<<1^283;for(var D=0,j=0,E=0;E<256;E++){var C=j^j<<1^j<<2^j<<3^j<<4;C=C>>>8^C&255^99,a[D]=C,l[C]=D;var v=N[D],A=N[v],I=N[A],S=N[C]*257^C*16843008;c[D]=S<<24|S>>>8,d[D]=S<<16|S>>>16,f[D]=S<<8|S>>>24,h[D]=S;var S=I*16843009^A*65537^v*257^D*16843008;p[C]=S<<24|S>>>8,m[C]=S<<16|S>>>16,g[C]=S<<8|S>>>24,b[C]=S,D?(D=v^N[N[N[I^v]]],j^=N[N[j]]):D=j=1}})();var x=[0,1,2,4,8,16,32,64,128,27,54],w=o.AES=s.extend({_doReset:function(){var N;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var E=this._keyPriorReset=this._key,D=E.words,j=E.sigBytes/4,C=this._nRounds=j+6,v=(C+1)*4,A=this._keySchedule=[],I=0;I<v;I++)I<j?A[I]=D[I]:(N=A[I-1],I%j?j>6&&I%j==4&&(N=a[N>>>24]<<24|a[N>>>16&255]<<16|a[N>>>8&255]<<8|a[N&255]):(N=N<<8|N>>>24,N=a[N>>>24]<<24|a[N>>>16&255]<<16|a[N>>>8&255]<<8|a[N&255],N^=x[I/j|0]<<24),A[I]=A[I-j]^N);for(var S=this._invKeySchedule=[],P=0;P<v;P++){var I=v-P;if(P%4)var N=A[I];else var N=A[I-4];P<4||I<=4?S[P]=N:S[P]=p[a[N>>>24]]^m[a[N>>>16&255]]^g[a[N>>>8&255]]^b[a[N&255]]}}},encryptBlock:function(N,E){this._doCryptBlock(N,E,this._keySchedule,c,d,f,h,a)},decryptBlock:function(N,E){var D=N[E+1];N[E+1]=N[E+3],N[E+3]=D,this._doCryptBlock(N,E,this._invKeySchedule,p,m,g,b,l);var D=N[E+1];N[E+1]=N[E+3],N[E+3]=D},_doCryptBlock:function(N,E,D,j,C,v,A,I){for(var S=this._nRounds,P=N[E]^D[0],k=N[E+1]^D[1],F=N[E+2]^D[2],q=N[E+3]^D[3],O=4,M=1;M<S;M++){var W=j[P>>>24]^C[k>>>16&255]^v[F>>>8&255]^A[q&255]^D[O++],z=j[k>>>24]^C[F>>>16&255]^v[q>>>8&255]^A[P&255]^D[O++],J=j[F>>>24]^C[q>>>16&255]^v[P>>>8&255]^A[k&255]^D[O++],ne=j[q>>>24]^C[P>>>16&255]^v[k>>>8&255]^A[F&255]^D[O++];P=W,k=z,F=J,q=ne}var W=(I[P>>>24]<<24|I[k>>>16&255]<<16|I[F>>>8&255]<<8|I[q&255])^D[O++],z=(I[k>>>24]<<24|I[F>>>16&255]<<16|I[q>>>8&255]<<8|I[P&255])^D[O++],J=(I[F>>>24]<<24|I[q>>>16&255]<<16|I[P>>>8&255]<<8|I[k&255])^D[O++],ne=(I[q>>>24]<<24|I[P>>>16&255]<<16|I[k>>>8&255]<<8|I[F&255])^D[O++];N[E]=W,N[E+1]=z,N[E+2]=J,N[E+3]=ne},keySize:256/32});r.AES=s._createHelper(w)}(),n.AES})}(d2)),d2.exports}var h2={exports:{}},KS;function SW(){return KS||(KS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),Md(),Bd(),vu(),bi())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.WordArray,o=i.BlockCipher,a=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],d=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=a.DES=o.extend({_doReset:function(){for(var x=this._key,w=x.words,N=[],E=0;E<56;E++){var D=l[E]-1;N[E]=w[D>>>5]>>>31-D%32&1}for(var j=this._subKeys=[],C=0;C<16;C++){for(var v=j[C]=[],A=d[C],E=0;E<24;E++)v[E/6|0]|=N[(c[E]-1+A)%28]<<31-E%6,v[4+(E/6|0)]|=N[28+(c[E+24]-1+A)%28]<<31-E%6;v[0]=v[0]<<1|v[0]>>>31;for(var E=1;E<7;E++)v[E]=v[E]>>>(E-1)*4+3;v[7]=v[7]<<5|v[7]>>>27}for(var I=this._invSubKeys=[],E=0;E<16;E++)I[E]=j[15-E]},encryptBlock:function(x,w){this._doCryptBlock(x,w,this._subKeys)},decryptBlock:function(x,w){this._doCryptBlock(x,w,this._invSubKeys)},_doCryptBlock:function(x,w,N){this._lBlock=x[w],this._rBlock=x[w+1],m.call(this,4,252645135),m.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),m.call(this,1,1431655765);for(var E=0;E<16;E++){for(var D=N[E],j=this._lBlock,C=this._rBlock,v=0,A=0;A<8;A++)v|=f[A][((C^D[A])&h[A])>>>0];this._lBlock=C,this._rBlock=j^v}var I=this._lBlock;this._lBlock=this._rBlock,this._rBlock=I,m.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),m.call(this,16,65535),m.call(this,4,252645135),x[w]=this._lBlock,x[w+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function m(x,w){var N=(this._lBlock>>>x^this._rBlock)&w;this._rBlock^=N,this._lBlock^=N<<x}function g(x,w){var N=(this._rBlock>>>x^this._lBlock)&w;this._lBlock^=N,this._rBlock^=N<<x}r.DES=o._createHelper(p);var b=a.TripleDES=o.extend({_doReset:function(){var x=this._key,w=x.words;if(w.length!==2&&w.length!==4&&w.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var N=w.slice(0,2),E=w.length<4?w.slice(0,2):w.slice(2,4),D=w.length<6?w.slice(0,2):w.slice(4,6);this._des1=p.createEncryptor(s.create(N)),this._des2=p.createEncryptor(s.create(E)),this._des3=p.createEncryptor(s.create(D))},encryptBlock:function(x,w){this._des1.encryptBlock(x,w),this._des2.decryptBlock(x,w),this._des3.encryptBlock(x,w)},decryptBlock:function(x,w){this._des3.decryptBlock(x,w),this._des2.encryptBlock(x,w),this._des1.decryptBlock(x,w)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(b)}(),n.TripleDES})}(h2)),h2.exports}var f2={exports:{}},QS;function EW(){return QS||(QS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),Md(),Bd(),vu(),bi())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.StreamCipher,o=r.algo,a=o.RC4=s.extend({_doReset:function(){for(var d=this._key,f=d.words,h=d.sigBytes,p=this._S=[],m=0;m<256;m++)p[m]=m;for(var m=0,g=0;m<256;m++){var b=m%h,x=f[b>>>2]>>>24-b%4*8&255;g=(g+p[m]+x)%256;var w=p[m];p[m]=p[g],p[g]=w}this._i=this._j=0},_doProcessBlock:function(d,f){d[f]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var d=this._S,f=this._i,h=this._j,p=0,m=0;m<4;m++){f=(f+1)%256,h=(h+d[f])%256;var g=d[f];d[f]=d[h],d[h]=g,p|=d[(d[f]+d[h])%256]<<24-m*8}return this._i=f,this._j=h,p}r.RC4=s._createHelper(a);var c=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var d=this.cfg.drop;d>0;d--)l.call(this)}});r.RC4Drop=s._createHelper(c)}(),n.RC4})}(f2)),f2.exports}var p2={exports:{}},YS;function CW(){return YS||(YS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),Md(),Bd(),vu(),bi())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.StreamCipher,o=r.algo,a=[],l=[],c=[],d=o.Rabbit=s.extend({_doReset:function(){for(var h=this._key.words,p=this.cfg.iv,m=0;m<4;m++)h[m]=(h[m]<<8|h[m]>>>24)&16711935|(h[m]<<24|h[m]>>>8)&4278255360;var g=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],b=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var m=0;m<4;m++)f.call(this);for(var m=0;m<8;m++)b[m]^=g[m+4&7];if(p){var x=p.words,w=x[0],N=x[1],E=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,D=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,j=E>>>16|D&4294901760,C=D<<16|E&65535;b[0]^=E,b[1]^=j,b[2]^=D,b[3]^=C,b[4]^=E,b[5]^=j,b[6]^=D,b[7]^=C;for(var m=0;m<4;m++)f.call(this)}},_doProcessBlock:function(h,p){var m=this._X;f.call(this),a[0]=m[0]^m[5]>>>16^m[3]<<16,a[1]=m[2]^m[7]>>>16^m[5]<<16,a[2]=m[4]^m[1]>>>16^m[7]<<16,a[3]=m[6]^m[3]>>>16^m[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,h[p+g]^=a[g]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,m=0;m<8;m++)l[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var m=0;m<8;m++){var g=h[m]+p[m],b=g&65535,x=g>>>16,w=((b*b>>>17)+b*x>>>15)+x*x,N=((g&4294901760)*g|0)+((g&65535)*g|0);c[m]=w^N}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=s._createHelper(d)}(),n.Rabbit})}(p2)),p2.exports}var m2={exports:{}},XS;function PW(){return XS||(XS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),Md(),Bd(),vu(),bi())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.StreamCipher,o=r.algo,a=[],l=[],c=[],d=o.RabbitLegacy=s.extend({_doReset:function(){var h=this._key.words,p=this.cfg.iv,m=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],g=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var b=0;b<4;b++)f.call(this);for(var b=0;b<8;b++)g[b]^=m[b+4&7];if(p){var x=p.words,w=x[0],N=x[1],E=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,D=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,j=E>>>16|D&4294901760,C=D<<16|E&65535;g[0]^=E,g[1]^=j,g[2]^=D,g[3]^=C,g[4]^=E,g[5]^=j,g[6]^=D,g[7]^=C;for(var b=0;b<4;b++)f.call(this)}},_doProcessBlock:function(h,p){var m=this._X;f.call(this),a[0]=m[0]^m[5]>>>16^m[3]<<16,a[1]=m[2]^m[7]>>>16^m[5]<<16,a[2]=m[4]^m[1]>>>16^m[7]<<16,a[3]=m[6]^m[3]>>>16^m[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,h[p+g]^=a[g]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,m=0;m<8;m++)l[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var m=0;m<8;m++){var g=h[m]+p[m],b=g&65535,x=g>>>16,w=((b*b>>>17)+b*x>>>15)+x*x,N=((g&4294901760)*g|0)+((g&65535)*g|0);c[m]=w^N}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=s._createHelper(d)}(),n.RabbitLegacy})}(m2)),m2.exports}var g2={exports:{}},JS;function kW(){return JS||(JS=1,function(t,e){(function(n,r,i){t.exports=r(Sn(),Md(),Bd(),vu(),bi())})(dn,function(n){return function(){var r=n,i=r.lib,s=i.BlockCipher,o=r.algo;const a=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var d={pbox:[],sbox:[]};function f(b,x){let w=x>>24&255,N=x>>16&255,E=x>>8&255,D=x&255,j=b.sbox[0][w]+b.sbox[1][N];return j=j^b.sbox[2][E],j=j+b.sbox[3][D],j}function h(b,x,w){let N=x,E=w,D;for(let j=0;j<a;++j)N=N^b.pbox[j],E=f(b,N)^E,D=N,N=E,E=D;return D=N,N=E,E=D,E=E^b.pbox[a],N=N^b.pbox[a+1],{left:N,right:E}}function p(b,x,w){let N=x,E=w,D;for(let j=a+1;j>1;--j)N=N^b.pbox[j],E=f(b,N)^E,D=N,N=E,E=D;return D=N,N=E,E=D,E=E^b.pbox[1],N=N^b.pbox[0],{left:N,right:E}}function m(b,x,w){for(let C=0;C<4;C++){b.sbox[C]=[];for(let v=0;v<256;v++)b.sbox[C][v]=c[C][v]}let N=0;for(let C=0;C<a+2;C++)b.pbox[C]=l[C]^x[N],N++,N>=w&&(N=0);let E=0,D=0,j=0;for(let C=0;C<a+2;C+=2)j=h(b,E,D),E=j.left,D=j.right,b.pbox[C]=E,b.pbox[C+1]=D;for(let C=0;C<4;C++)for(let v=0;v<256;v+=2)j=h(b,E,D),E=j.left,D=j.right,b.sbox[C][v]=E,b.sbox[C][v+1]=D;return!0}var g=o.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var b=this._keyPriorReset=this._key,x=b.words,w=b.sigBytes/4;m(d,x,w)}},encryptBlock:function(b,x){var w=h(d,b[x],b[x+1]);b[x]=w.left,b[x+1]=w.right},decryptBlock:function(b,x){var w=p(d,b[x],b[x+1]);b[x]=w.left,b[x+1]=w.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=s._createHelper(g)}(),n.Blowfish})}(g2)),g2.exports}(function(t,e){(function(n,r,i){t.exports=r(Sn(),my(),sW(),oW(),Md(),aW(),Bd(),ij(),o4(),lW(),sj(),cW(),uW(),dW(),a4(),hW(),vu(),bi(),fW(),pW(),mW(),gW(),xW(),yW(),vW(),bW(),wW(),_W(),NW(),AW(),SW(),EW(),CW(),PW(),kW())})(dn,function(n){return n})})(rj);var TW=rj.exports;const ix=H5(TW),oj="your-secure-key-here";let Is;const l4=t=>{try{if(t==null)throw new Error("Cannot encrypt null or undefined data");if(!t.id||!t.syncId)throw new Error("Data must have id and syncId properties");const e=JSON.stringify(t);if(!e)throw new Error("Failed to stringify data for encryption");const n=ix.AES.encrypt(e,oj);if(!n)throw new Error("Encryption operation failed");return n.toString()}catch(e){throw console.error("Encryption error:",e),new Error(`Failed to encrypt data: ${e.message}`)}},gy=t=>{try{if(!t)return console.warn("Attempted to decrypt empty or null data"),null;const e=ix.AES.decrypt(t,oj);if(!e)throw new Error("Decryption operation failed");const n=e.toString(ix.enc.Utf8);if(!n)return console.warn("Decryption resulted in empty string"),null;try{const r=JSON.parse(n);if(!r||typeof r!="object"||!r.id||!r.syncId)throw new Error("Decrypted data is not a valid object or missing required fields");return r}catch(r){return console.error("Failed to parse decrypted JSON:",r),null}}catch(e){return console.error("Decryption error:",e),null}},Od=async()=>{Is=await s4("egrec-pos",11,{upgrade(t,e,n,r){t.objectStoreNames.contains("offline-sales")&&t.deleteObjectStore("offline-sales");const i=t.createObjectStore("offline-sales",{keyPath:"id"});i.createIndex("by-sync-status","synced"),i.createIndex("by-timestamp","timestamp"),i.createIndex("by-sync-id","syncId",{unique:!0})}}),await DW()},aj=async t=>{Is||await Od();const e=lf(),n=t.syncId||lf();if(!e||!n)throw new Error("Failed to generate valid IDs for offline sale");const r={...t,id:e,syncId:n,synced:0,syncAttempts:0,lastSyncAttempt:Date.now(),timestamp:Date.now()};try{if(!r.id||!r.timestamp||!r.productName)throw new Error("Invalid sale data: missing required properties");if(await Is.getFromIndex("offline-sales","by-sync-id",n))throw new Error("Sale with this syncId already exists");const s=l4(r),o={id:r.id,syncId:r.syncId,data:s,synced:r.synced,timestamp:Date.now()},a=gy(s);if(!a||!a.id||!a.syncId)throw new Error("Encryption validation failed");return await Is.put("offline-sales",o),r}catch(i){throw console.error("Error saving offline sale:",i),new Error(`Failed to save offline sale: ${i.message}`)}},IW=async()=>{Is||await Od();try{return(await Is.transaction("offline-sales","readonly").objectStore("offline-sales").index("by-sync-status").getAll(0)).map(i=>{try{const s=gy(i.data);return s&&s.synced===0?s:null}catch(s){return console.error("Error decrypting sale:",s),null}}).filter(i=>i!==null)}catch(t){return console.error("Error getting unsynced sales:",t),[]}},ZS=async(t,e)=>{Is||await Od();const n=Is.transaction("offline-sales","readwrite"),r=n.objectStore("offline-sales");try{const i=await r.get(t);if(!i||i.syncId!==e)throw new Error("Sale not found or syncId mismatch");const s=gy(i.data);if(!s)throw new Error("Failed to decrypt sale data");s.synced=1,s.lastSyncAttempt=Date.now();const o={id:s.id,syncId:s.syncId,data:l4(s),synced:1,timestamp:i.timestamp};await r.put(o),await n.done}catch(i){throw console.error("Error marking sale as synced:",i),i}},jW=async t=>{Is||await Od();const e=Is.transaction("offline-sales","readwrite"),n=e.objectStore("offline-sales");try{const r=await n.get(t);if(!r)throw new Error("Sale not found");const i=gy(r.data);if(!i)throw new Error("Failed to decrypt sale data");i.syncAttempts=(i.syncAttempts||0)+1,i.lastSyncAttempt=Date.now();const s={id:i.id,syncId:i.syncId,data:l4(i),synced:i.synced,timestamp:r.timestamp};await n.put(s),await e.done}catch(r){throw console.error("Error updating sync attempts:",r),r}},DW=async()=>{Is||await Od();try{const t=Is.transaction("offline-sales","readwrite"),e=t.objectStore("offline-sales"),n=e.index("by-timestamp"),r=Date.now()-24*60*60*1e3,i=await n.getAllKeys(IDBKeyRange.upperBound(r));await Promise.all(i.map(s=>e.delete(s))),await t.done,console.log(`Cleaned up ${i.length} old sales`)}catch(t){console.error("Error cleaning up old sales:",t)}},RW=async()=>{Is||await Od();try{const t=Is.transaction("offline-sales","readwrite"),e=t.objectStore("offline-sales"),r=await e.index("by-sync-status").getAllKeys(1);await Promise.all(r.map(i=>e.delete(i))),await t.done}catch(t){console.error("Error clearing synced data:",t)}};var lj={exports:{}};(function(t,e){(function(r,i){t.exports=i()})(window,function(){return function(n){var r={};function i(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return n[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:a})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,o){if(o&1&&(s=i(s)),o&8||o&4&&typeof s=="object"&&s&&s.__esModule)return s;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:s}),o&2&&typeof s!="string")for(var l in s)i.d(a,l,(function(c){return s[c]}).bind(null,l));return a},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=0)}({"./src/index.js":function(n,r,i){i.r(r),i("./src/sass/index.scss");var s=i("./src/js/init.js"),o=s.default.init;typeof window<"u"&&(window.printJS=o),r.default=o},"./src/js/browser.js":function(n,r,i){i.r(r);var s={isFirefox:function(){return typeof InstallTrigger<"u"},isIE:function(){return navigator.userAgent.indexOf("MSIE")!==-1||!!document.documentMode},isEdge:function(){return!s.isIE()&&!!window.StyleMedia},isChrome:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;return!!a.chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||navigator.userAgent.toLowerCase().indexOf("safari")!==-1},isIOSChrome:function(){return navigator.userAgent.toLowerCase().indexOf("crios")!==-1}};r.default=s},"./src/js/functions.js":function(n,r,i){i.r(r),i.d(r,"addWrapper",function(){return l}),i.d(r,"capitalizePrint",function(){return c}),i.d(r,"collectStyles",function(){return d}),i.d(r,"addHeader",function(){return h}),i.d(r,"cleanUp",function(){return p}),i.d(r,"isRawHTML",function(){return m});var s=i("./src/js/modal.js"),o=i("./src/js/browser.js");function a(g){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(x){return typeof x}:a=function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},a(g)}function l(g,b){var x="font-family:"+b.font+" !important; font-size: "+b.font_size+" !important; width:100%;";return'<div style="'+x+'">'+g+"</div>"}function c(g){return g.charAt(0).toUpperCase()+g.slice(1)}function d(g,b){for(var x=document.defaultView||window,w="",N=x.getComputedStyle(g,""),E=0;E<N.length;E++)(b.targetStyles.indexOf("*")!==-1||b.targetStyle.indexOf(N[E])!==-1||f(b.targetStyles,N[E]))&&N.getPropertyValue(N[E])&&(w+=N[E]+":"+N.getPropertyValue(N[E])+";");return w+="max-width: "+b.maxWidth+"px !important; font-size: "+b.font_size+" !important;",w}function f(g,b){for(var x=0;x<g.length;x++)if(a(b)==="object"&&b.indexOf(g[x])!==-1)return!0;return!1}function h(g,b){var x=document.createElement("div");if(m(b.header))x.innerHTML=b.header;else{var w=document.createElement("h1"),N=document.createTextNode(b.header);w.appendChild(N),w.setAttribute("style",b.headerStyle),x.appendChild(w)}g.insertBefore(x,g.childNodes[0])}function p(g){g.showModal&&s.default.close(),g.onLoadingEnd&&g.onLoadingEnd(),(g.showModal||g.onLoadingStart)&&window.URL.revokeObjectURL(g.printable);var b="mouseover";(o.default.isChrome()||o.default.isFirefox())&&(b="focus");var x=function w(){window.removeEventListener(b,w),g.onPrintDialogClose();var N=document.getElementById(g.frameId);N&&N.remove()};window.addEventListener(b,x)}function m(g){var b=new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>");return b.test(g)}},"./src/js/html.js":function(n,r,i){i.r(r);var s=i("./src/js/functions.js"),o=i("./src/js/print.js");function a(d){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(h){return typeof h}:a=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},a(d)}r.default={print:function(f,h){var p=c(f.printable)?f.printable:document.getElementById(f.printable);if(!p){window.console.error("Invalid HTML element id: "+f.printable);return}f.printableElement=l(p,f),f.header&&Object(s.addHeader)(f.printableElement,f),o.default.send(f,h)}};function l(d,f){for(var h=d.cloneNode(),p=Array.prototype.slice.call(d.childNodes),m=0;m<p.length;m++)if(f.ignoreElements.indexOf(p[m].id)===-1){var g=l(p[m],f);h.appendChild(g)}switch(f.scanStyles&&d.nodeType===1&&h.setAttribute("style",Object(s.collectStyles)(d,f)),d.tagName){case"SELECT":h.value=d.value;break;case"CANVAS":h.getContext("2d").drawImage(d,0,0);break}return h}function c(d){return a(d)==="object"&&d&&(d instanceof HTMLElement||d.nodeType===1)}},"./src/js/image.js":function(n,r,i){i.r(r);var s=i("./src/js/functions.js"),o=i("./src/js/print.js"),a=i("./src/js/browser.js");r.default={print:function(c,d){c.printable.constructor!==Array&&(c.printable=[c.printable]),c.printableElement=document.createElement("div"),c.printable.forEach(function(f){var h=document.createElement("img");if(h.setAttribute("style",c.imageStyle),h.src=f,a.default.isFirefox()){var p=h.src;h.src=p}var m=document.createElement("div");m.appendChild(h),c.printableElement.appendChild(m)}),c.header&&Object(s.addHeader)(c.printableElement,c),o.default.send(c,d)}}},"./src/js/init.js":function(n,r,i){i.r(r);var s=i("./src/js/browser.js"),o=i("./src/js/modal.js"),a=i("./src/js/pdf.js"),l=i("./src/js/html.js"),c=i("./src/js/raw-html.js"),d=i("./src/js/image.js"),f=i("./src/js/json.js");function h(m){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(b){return typeof b}:h=function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},h(m)}var p=["pdf","html","image","json","raw-html"];r.default={init:function(){var g={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(j){throw j},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},b=arguments[0];if(b===void 0)throw new Error("printJS expects at least 1 attribute.");switch(h(b)){case"string":g.printable=encodeURI(b),g.fallbackPrintable=g.printable,g.type=arguments[1]||g.type;break;case"object":g.printable=b.printable,g.fallbackPrintable=typeof b.fallbackPrintable<"u"?b.fallbackPrintable:g.printable,g.fallbackPrintable=g.base64?"data:application/pdf;base64,".concat(g.fallbackPrintable):g.fallbackPrintable;for(var x in g)x==="printable"||x==="fallbackPrintable"||(g[x]=typeof b[x]<"u"?b[x]:g[x]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+h(b))}if(!g.printable)throw new Error("Missing printable information.");if(!g.type||typeof g.type!="string"||p.indexOf(g.type.toLowerCase())===-1)throw new Error("Invalid print type. Available types are: pdf, html, image and json.");g.showModal&&o.default.show(g),g.onLoadingStart&&g.onLoadingStart();var w=document.getElementById(g.frameId);w&&w.parentNode.removeChild(w);var N=document.createElement("iframe");switch(s.default.isFirefox()?N.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):N.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),N.setAttribute("id",g.frameId),g.type!=="pdf"&&(N.srcdoc="<html><head><title>"+g.documentTitle+"</title>",g.css&&(Array.isArray(g.css)||(g.css=[g.css]),g.css.forEach(function(D){N.srcdoc+='<link rel="stylesheet" href="'+D+'">'})),N.srcdoc+="</head><body></body></html>"),g.type){case"pdf":if(s.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer.");var E=window.open(g.fallbackPrintable,"_blank");E.focus(),g.onIncompatibleBrowser()}catch(D){g.onError(D)}finally{g.showModal&&o.default.close(),g.onLoadingEnd&&g.onLoadingEnd()}else a.default.print(g,N);break;case"image":d.default.print(g,N);break;case"html":l.default.print(g,N);break;case"raw-html":c.default.print(g,N);break;case"json":f.default.print(g,N);break}}}},"./src/js/json.js":function(n,r,i){i.r(r);var s=i("./src/js/functions.js"),o=i("./src/js/print.js");function a(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(f){return typeof f}:a=function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},a(c)}r.default={print:function(d,f){if(a(d.printable)!=="object")throw new Error("Invalid javascript data object (JSON).");if(typeof d.repeatTableHeader!="boolean")throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!d.properties||!Array.isArray(d.properties))throw new Error("Invalid properties array for your JSON data.");d.properties=d.properties.map(function(h){return{field:a(h)==="object"?h.field:h,displayName:a(h)==="object"?h.displayName:h,columnSize:a(h)==="object"&&h.columnSize?h.columnSize+";":100/d.properties.length+"%;"}}),d.printableElement=document.createElement("div"),d.header&&Object(s.addHeader)(d.printableElement,d),d.printableElement.innerHTML+=l(d),o.default.send(d,f)}};function l(c){var d=c.printable,f=c.properties,h='<table style="border-collapse: collapse; width: 100%;">';c.repeatTableHeader&&(h+="<thead>"),h+="<tr>";for(var p=0;p<f.length;p++)h+='<th style="width:'+f[p].columnSize+";"+c.gridHeaderStyle+'">'+Object(s.capitalizePrint)(f[p].displayName)+"</th>";h+="</tr>",c.repeatTableHeader&&(h+="</thead>"),h+="<tbody>";for(var m=0;m<d.length;m++){h+="<tr>";for(var g=0;g<f.length;g++){var b=d[m],x=f[g].field.split(".");if(x.length>1)for(var w=0;w<x.length;w++)b=b[x[w]];else b=b[f[g].field];h+='<td style="width:'+f[g].columnSize+c.gridStyle+'">'+b+"</td>"}h+="</tr>"}return h+="</tbody></table>",h}},"./src/js/modal.js":function(n,r,i){i.r(r);var s={show:function(a){var l="font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;",c=document.createElement("div");c.setAttribute("style",l),c.setAttribute("id","printJS-Modal");var d=document.createElement("div");d.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var f=document.createElement("div");f.setAttribute("class","printClose"),f.setAttribute("id","printClose"),d.appendChild(f);var h=document.createElement("span");h.setAttribute("class","printSpinner"),d.appendChild(h);var p=document.createTextNode(a.modalMessage);d.appendChild(p),c.appendChild(d),document.getElementsByTagName("body")[0].appendChild(c),document.getElementById("printClose").addEventListener("click",function(){s.close()})},close:function(){var a=document.getElementById("printJS-Modal");a&&a.parentNode.removeChild(a)}};r.default=s},"./src/js/pdf.js":function(n,r,i){i.r(r);var s=i("./src/js/print.js"),o=i("./src/js/functions.js");r.default={print:function(c,d){if(c.base64){var f=Uint8Array.from(atob(c.printable),function(p){return p.charCodeAt(0)});a(c,d,f);return}c.printable=/^(blob|http|\/\/)/i.test(c.printable)?c.printable:window.location.origin+(c.printable.charAt(0)!=="/"?"/"+c.printable:c.printable);var h=new window.XMLHttpRequest;h.responseType="arraybuffer",h.addEventListener("error",function(){Object(o.cleanUp)(c),c.onError(h.statusText,h)}),h.addEventListener("load",function(){if([200,201].indexOf(h.status)===-1){Object(o.cleanUp)(c),c.onError(h.statusText,h);return}a(c,d,h.response)}),h.open("GET",c.printable,!0),h.send()}};function a(l,c,d){var f=new window.Blob([d],{type:"application/pdf"});f=window.URL.createObjectURL(f),c.setAttribute("src",f),s.default.send(l,c)}},"./src/js/print.js":function(n,r,i){i.r(r);var s=i("./src/js/browser.js"),o=i("./src/js/functions.js"),a={send:function(h,p){document.getElementsByTagName("body")[0].appendChild(p);var m=document.getElementById(h.frameId);m.onload=function(){if(h.type==="pdf"){s.default.isFirefox()?setTimeout(function(){return l(m,h)},1e3):l(m,h);return}var g=m.contentWindow||m.contentDocument;if(g.document&&(g=g.document),g.body.appendChild(h.printableElement),h.type!=="pdf"&&h.style){var b=document.createElement("style");b.innerHTML=h.style,g.head.appendChild(b)}var x=g.getElementsByTagName("img");x.length>0?c(Array.from(x)).then(function(){return l(m,h)}):l(m,h)}}};function l(f,h){try{if(f.focus(),s.default.isEdge()||s.default.isIE())try{f.contentWindow.document.execCommand("print",!1,null)}catch{f.contentWindow.print()}else f.contentWindow.print()}catch(p){h.onError(p)}finally{s.default.isFirefox()&&(f.style.visibility="hidden",f.style.left="-1px"),Object(o.cleanUp)(h)}}function c(f){var h=f.map(function(p){if(p.src&&p.src!==window.location.href)return d(p)});return Promise.all(h)}function d(f){return new Promise(function(h){var p=function m(){!f||typeof f.naturalWidth>"u"||f.naturalWidth===0||!f.complete?setTimeout(m,500):h()};p()})}r.default=a},"./src/js/raw-html.js":function(n,r,i){i.r(r);var s=i("./src/js/print.js");r.default={print:function(a,l){a.printableElement=document.createElement("div"),a.printableElement.setAttribute("style","width:100%"),a.printableElement.innerHTML=a.printable,s.default.send(a,l)}}},"./src/sass/index.scss":function(n,r,i){},0:function(n,r,i){n.exports=i("./src/index.js")}}).default})})(lj);var FW=lj.exports;const LW=H5(FW);function Vn(t){"@babel/helpers - typeof";return Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn(t)}function Ol(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function ci(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function eo(t){ci(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||Vn(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function MW(t,e){ci(2,arguments);var n=eo(t),r=Ol(e);return isNaN(r)?new Date(NaN):(r&&n.setDate(n.getDate()+r),n)}function BW(t,e){ci(2,arguments);var n=eo(t).getTime(),r=Ol(e);return new Date(n+r)}var OW={};function xy(){return OW}function VW(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function sx(t){ci(1,arguments);var e=eo(t);return e.setHours(0,0,0,0),e}function UW(t){return ci(1,arguments),t instanceof Date||Vn(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function zW(t){if(ci(1,arguments),!UW(t)&&typeof t!="number")return!1;var e=eo(t);return!isNaN(Number(e))}function ox(t){ci(1,arguments);var e=eo(t);return e.setHours(23,59,59,999),e}function qW(t,e){ci(2,arguments);var n=Ol(e);return BW(t,-n)}var HW=864e5;function WW(t){ci(1,arguments);var e=eo(t),n=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var r=e.getTime(),i=n-r;return Math.floor(i/HW)+1}function ax(t){ci(1,arguments);var e=1,n=eo(t),r=n.getUTCDay(),i=(r<e?7:0)+r-e;return n.setUTCDate(n.getUTCDate()-i),n.setUTCHours(0,0,0,0),n}function cj(t){ci(1,arguments);var e=eo(t),n=e.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=ax(r),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var o=ax(s);return e.getTime()>=i.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function $W(t){ci(1,arguments);var e=cj(t),n=new Date(0);n.setUTCFullYear(e,0,4),n.setUTCHours(0,0,0,0);var r=ax(n);return r}var GW=6048e5;function KW(t){ci(1,arguments);var e=eo(t),n=ax(e).getTime()-$W(e).getTime();return Math.round(n/GW)+1}function lx(t,e){var n,r,i,s,o,a,l,c;ci(1,arguments);var d=xy(),f=Ol((n=(r=(i=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.weekStartsOn)!==null&&i!==void 0?i:d.weekStartsOn)!==null&&r!==void 0?r:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&n!==void 0?n:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=eo(t),p=h.getUTCDay(),m=(p<f?7:0)+p-f;return h.setUTCDate(h.getUTCDate()-m),h.setUTCHours(0,0,0,0),h}function uj(t,e){var n,r,i,s,o,a,l,c;ci(1,arguments);var d=eo(t),f=d.getUTCFullYear(),h=xy(),p=Ol((n=(r=(i=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&i!==void 0?i:h.firstWeekContainsDate)!==null&&r!==void 0?r:(l=h.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=new Date(0);m.setUTCFullYear(f+1,0,p),m.setUTCHours(0,0,0,0);var g=lx(m,e),b=new Date(0);b.setUTCFullYear(f,0,p),b.setUTCHours(0,0,0,0);var x=lx(b,e);return d.getTime()>=g.getTime()?f+1:d.getTime()>=x.getTime()?f:f-1}function QW(t,e){var n,r,i,s,o,a,l,c;ci(1,arguments);var d=xy(),f=Ol((n=(r=(i=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(o=e.locale)===null||o===void 0||(a=o.options)===null||a===void 0?void 0:a.firstWeekContainsDate)!==null&&i!==void 0?i:d.firstWeekContainsDate)!==null&&r!==void 0?r:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&n!==void 0?n:1),h=uj(t,e),p=new Date(0);p.setUTCFullYear(h,0,f),p.setUTCHours(0,0,0,0);var m=lx(p,e);return m}var YW=6048e5;function XW(t,e){ci(1,arguments);var n=eo(t),r=lx(n,e).getTime()-QW(n,e).getTime();return Math.round(r/YW)+1}function Gn(t,e){for(var n=t<0?"-":"",r=Math.abs(t).toString();r.length<e;)r="0"+r;return n+r}var yc={y:function(e,n){var r=e.getUTCFullYear(),i=r>0?r:1-r;return Gn(n==="yy"?i%100:i,n.length)},M:function(e,n){var r=e.getUTCMonth();return n==="M"?String(r+1):Gn(r+1,2)},d:function(e,n){return Gn(e.getUTCDate(),n.length)},a:function(e,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,n){return Gn(e.getUTCHours()%12||12,n.length)},H:function(e,n){return Gn(e.getUTCHours(),n.length)},m:function(e,n){return Gn(e.getUTCMinutes(),n.length)},s:function(e,n){return Gn(e.getUTCSeconds(),n.length)},S:function(e,n){var r=n.length,i=e.getUTCMilliseconds(),s=Math.floor(i*Math.pow(10,r-3));return Gn(s,n.length)}},th={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},JW={G:function(e,n,r){var i=e.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,n,r){if(n==="yo"){var i=e.getUTCFullYear(),s=i>0?i:1-i;return r.ordinalNumber(s,{unit:"year"})}return yc.y(e,n)},Y:function(e,n,r,i){var s=uj(e,i),o=s>0?s:1-s;if(n==="YY"){var a=o%100;return Gn(a,2)}return n==="Yo"?r.ordinalNumber(o,{unit:"year"}):Gn(o,n.length)},R:function(e,n){var r=cj(e);return Gn(r,n.length)},u:function(e,n){var r=e.getUTCFullYear();return Gn(r,n.length)},Q:function(e,n,r){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(n){case"Q":return String(i);case"QQ":return Gn(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,n,r){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(n){case"q":return String(i);case"qq":return Gn(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,n,r){var i=e.getUTCMonth();switch(n){case"M":case"MM":return yc.M(e,n);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,n,r){var i=e.getUTCMonth();switch(n){case"L":return String(i+1);case"LL":return Gn(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,n,r,i){var s=XW(e,i);return n==="wo"?r.ordinalNumber(s,{unit:"week"}):Gn(s,n.length)},I:function(e,n,r){var i=KW(e);return n==="Io"?r.ordinalNumber(i,{unit:"week"}):Gn(i,n.length)},d:function(e,n,r){return n==="do"?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):yc.d(e,n)},D:function(e,n,r){var i=WW(e);return n==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Gn(i,n.length)},E:function(e,n,r){var i=e.getUTCDay();switch(n){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,n,r,i){var s=e.getUTCDay(),o=(s-i.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return Gn(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,n,r,i){var s=e.getUTCDay(),o=(s-i.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return Gn(o,n.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,n,r){var i=e.getUTCDay(),s=i===0?7:i;switch(n){case"i":return String(s);case"ii":return Gn(s,n.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,n,r){var i=e.getUTCHours(),s=i/12>=1?"pm":"am";switch(n){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,n,r){var i=e.getUTCHours(),s;switch(i===12?s=th.noon:i===0?s=th.midnight:s=i/12>=1?"pm":"am",n){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,n,r){var i=e.getUTCHours(),s;switch(i>=17?s=th.evening:i>=12?s=th.afternoon:i>=4?s=th.morning:s=th.night,n){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,n,r){if(n==="ho"){var i=e.getUTCHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return yc.h(e,n)},H:function(e,n,r){return n==="Ho"?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):yc.H(e,n)},K:function(e,n,r){var i=e.getUTCHours()%12;return n==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Gn(i,n.length)},k:function(e,n,r){var i=e.getUTCHours();return i===0&&(i=24),n==="ko"?r.ordinalNumber(i,{unit:"hour"}):Gn(i,n.length)},m:function(e,n,r){return n==="mo"?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):yc.m(e,n)},s:function(e,n,r){return n==="so"?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):yc.s(e,n)},S:function(e,n){return yc.S(e,n)},X:function(e,n,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();if(o===0)return"Z";switch(n){case"X":return tE(o);case"XXXX":case"XX":return Mu(o);case"XXXXX":case"XXX":default:return Mu(o,":")}},x:function(e,n,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();switch(n){case"x":return tE(o);case"xxxx":case"xx":return Mu(o);case"xxxxx":case"xxx":default:return Mu(o,":")}},O:function(e,n,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+eE(o,":");case"OOOO":default:return"GMT"+Mu(o,":")}},z:function(e,n,r,i){var s=i._originalDate||e,o=s.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+eE(o,":");case"zzzz":default:return"GMT"+Mu(o,":")}},t:function(e,n,r,i){var s=i._originalDate||e,o=Math.floor(s.getTime()/1e3);return Gn(o,n.length)},T:function(e,n,r,i){var s=i._originalDate||e,o=s.getTime();return Gn(o,n.length)}};function eE(t,e){var n=t>0?"-":"+",r=Math.abs(t),i=Math.floor(r/60),s=r%60;if(s===0)return n+String(i);var o=e;return n+String(i)+o+Gn(s,2)}function tE(t,e){if(t%60===0){var n=t>0?"-":"+";return n+Gn(Math.abs(t)/60,2)}return Mu(t,e)}function Mu(t,e){var n=e||"",r=t>0?"-":"+",i=Math.abs(t),s=Gn(Math.floor(i/60),2),o=Gn(i%60,2);return r+s+n+o}var nE=function(e,n){switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},dj=function(e,n){switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},ZW=function(e,n){var r=e.match(/(P+)(p+)?/)||[],i=r[1],s=r[2];if(!s)return nE(e,n);var o;switch(i){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",nE(i,n)).replace("{{time}}",dj(s,n))},e$={p:dj,P:ZW},t$=["D","DD"],n$=["YY","YYYY"];function r$(t){return t$.indexOf(t)!==-1}function i$(t){return n$.indexOf(t)!==-1}function rE(t,e,n){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var s$={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},o$=function(e,n,r){var i,s=s$[e];return typeof s=="string"?i=s:n===1?i=s.one:i=s.other.replace("{{count}}",n.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function Vh(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.width?String(e.width):t.defaultWidth,r=t.formats[n]||t.formats[t.defaultWidth];return r}}var a$={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},l$={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},c$={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},u$={date:Vh({formats:a$,defaultWidth:"full"}),time:Vh({formats:l$,defaultWidth:"full"}),dateTime:Vh({formats:c$,defaultWidth:"full"})},d$={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},h$=function(e,n,r,i){return d$[e]};function Ca(t){return function(e,n){var r=n!=null&&n.context?String(n.context):"standalone",i;if(r==="formatting"&&t.formattingValues){var s=t.defaultFormattingWidth||t.defaultWidth,o=n!=null&&n.width?String(n.width):s;i=t.formattingValues[o]||t.formattingValues[s]}else{var a=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[l]||t.values[a]}var c=t.argumentCallback?t.argumentCallback(e):e;return i[c]}}var f$={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},p$={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},m$={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},g$={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},x$={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},y$={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},v$=function(e,n){var r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},b$={ordinalNumber:v$,era:Ca({values:f$,defaultWidth:"wide"}),quarter:Ca({values:p$,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Ca({values:m$,defaultWidth:"wide"}),day:Ca({values:g$,defaultWidth:"wide"}),dayPeriod:Ca({values:x$,defaultWidth:"wide",formattingValues:y$,defaultFormattingWidth:"wide"})};function Pa(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.width,i=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;var o=s[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?_$(a,function(f){return f.test(o)}):w$(a,function(f){return f.test(o)}),c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;var d=e.slice(o.length);return{value:c,rest:d}}}function w$(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n}function _$(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n}function hj(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.match(t.matchPattern);if(!r)return null;var i=r[0],s=e.match(t.parsePattern);if(!s)return null;var o=t.valueCallback?t.valueCallback(s[0]):s[0];o=n.valueCallback?n.valueCallback(o):o;var a=e.slice(i.length);return{value:o,rest:a}}}var N$=/^(\d+)(th|st|nd|rd)?/i,A$=/\d+/i,S$={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},E$={any:[/^b/i,/^(a|c)/i]},C$={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},P$={any:[/1/i,/2/i,/3/i,/4/i]},k$={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},T$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},I$={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},j$={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},D$={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},R$={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},F$={ordinalNumber:hj({matchPattern:N$,parsePattern:A$,valueCallback:function(e){return parseInt(e,10)}}),era:Pa({matchPatterns:S$,defaultMatchWidth:"wide",parsePatterns:E$,defaultParseWidth:"any"}),quarter:Pa({matchPatterns:C$,defaultMatchWidth:"wide",parsePatterns:P$,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Pa({matchPatterns:k$,defaultMatchWidth:"wide",parsePatterns:T$,defaultParseWidth:"any"}),day:Pa({matchPatterns:I$,defaultMatchWidth:"wide",parsePatterns:j$,defaultParseWidth:"any"}),dayPeriod:Pa({matchPatterns:D$,defaultMatchWidth:"any",parsePatterns:R$,defaultParseWidth:"any"})},L$={code:"en-US",formatDistance:o$,formatLong:u$,formatRelative:h$,localize:b$,match:F$,options:{weekStartsOn:0,firstWeekContainsDate:1}},M$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,B$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,O$=/^'([^]*?)'?$/,V$=/''/g,U$=/[a-zA-Z]/;function Kt(t,e,n){var r,i,s,o,a,l,c,d,f,h,p,m,g,b,x,w,N,E;ci(2,arguments);var D=String(e),j=xy(),C=(r=(i=n==null?void 0:n.locale)!==null&&i!==void 0?i:j.locale)!==null&&r!==void 0?r:L$,v=Ol((s=(o=(a=(l=n==null?void 0:n.firstWeekContainsDate)!==null&&l!==void 0?l:n==null||(c=n.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&a!==void 0?a:j.firstWeekContainsDate)!==null&&o!==void 0?o:(f=j.locale)===null||f===void 0||(h=f.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(v>=1&&v<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=Ol((p=(m=(g=(b=n==null?void 0:n.weekStartsOn)!==null&&b!==void 0?b:n==null||(x=n.locale)===null||x===void 0||(w=x.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&g!==void 0?g:j.weekStartsOn)!==null&&m!==void 0?m:(N=j.locale)===null||N===void 0||(E=N.options)===null||E===void 0?void 0:E.weekStartsOn)!==null&&p!==void 0?p:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var I=eo(t);if(!zW(I))throw new RangeError("Invalid time value");var S=VW(I),P=qW(I,S),k={firstWeekContainsDate:v,weekStartsOn:A,locale:C,_originalDate:I},F=D.match(B$).map(function(q){var O=q[0];if(O==="p"||O==="P"){var M=e$[O];return M(q,C.formatLong)}return q}).join("").match(M$).map(function(q){if(q==="''")return"'";var O=q[0];if(O==="'")return z$(q);var M=JW[O];if(M)return!(n!=null&&n.useAdditionalWeekYearTokens)&&i$(q)&&rE(q,e,String(t)),!(n!=null&&n.useAdditionalDayOfYearTokens)&&r$(q)&&rE(q,e,String(t)),M(P,q,C.localize,k);if(O.match(U$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+O+"`");return q}).join("");return F}function z$(t){var e=t.match(O$);return e?e[1].replace(V$,"'"):t}function Ap(t,e){ci(2,arguments);var n=Ol(e);return MW(t,-n)}var q$={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},H$=function(e,n,r){var i,s=q$[e];return typeof s=="string"?i=s:n===1?i=s.one:i=s.other.replace("{{count}}",String(n)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+i:"il y a "+i:i},W$={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},$$={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},G$={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},K$={date:Vh({formats:W$,defaultWidth:"full"}),time:Vh({formats:$$,defaultWidth:"full"}),dateTime:Vh({formats:G$,defaultWidth:"full"})},Q$={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},Y$=function(e,n,r,i){return Q$[e]},X$={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},J$={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},Z$={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},eG={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},tG={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},nG=function(e,n){var r=Number(e),i=n==null?void 0:n.unit;if(r===0)return"0";var s=["year","week","hour","minute","second"],o;return r===1?o=i&&s.includes(i)?"ère":"er":o="ème",r+o},rG={ordinalNumber:nG,era:Ca({values:X$,defaultWidth:"wide"}),quarter:Ca({values:J$,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Ca({values:Z$,defaultWidth:"wide"}),day:Ca({values:eG,defaultWidth:"wide"}),dayPeriod:Ca({values:tG,defaultWidth:"wide"})},iG=/^(\d+)(ième|ère|ème|er|e)?/i,sG=/\d+/i,oG={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},aG={any:[/^av/i,/^ap/i]},lG={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},cG={any:[/1/i,/2/i,/3/i,/4/i]},uG={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},dG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},hG={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},fG={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},pG={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},mG={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},gG={ordinalNumber:hj({matchPattern:iG,parsePattern:sG,valueCallback:function(e){return parseInt(e)}}),era:Pa({matchPatterns:oG,defaultMatchWidth:"wide",parsePatterns:aG,defaultParseWidth:"any"}),quarter:Pa({matchPatterns:lG,defaultMatchWidth:"wide",parsePatterns:cG,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Pa({matchPatterns:uG,defaultMatchWidth:"wide",parsePatterns:dG,defaultParseWidth:"any"}),day:Pa({matchPatterns:hG,defaultMatchWidth:"wide",parsePatterns:fG,defaultParseWidth:"any"}),dayPeriod:Pa({matchPatterns:pG,defaultMatchWidth:"any",parsePatterns:mG,defaultParseWidth:"any"})},zn={code:"fr",formatDistance:H$,formatLong:K$,formatRelative:Y$,localize:rG,match:gG,options:{weekStartsOn:1,firstWeekContainsDate:4}};const xG=(t,e,n,r,i,s,o="EGREC BOULANGERIE",a=null)=>{const l=new Date,c=Kt(l,"dd/MM/yyyy",{locale:zn}),d=Kt(l,"HH:mm",{locale:zn});return`
    <div style="font-family: 'Courier New', monospace; width: 300px; padding: 20px;">
      <div style="text-align: center; margin-bottom: 20px;">
        <h2 style="margin: 0;">${o}</h2>
        ${a?`<p style="margin: 5px 0;">${a}</p>`:""}
        <p style="margin: 5px 0;">TVA: FR 12 345 678 901</p>
      </div>

      <div style="margin-bottom: 20px;">
        <p style="margin: 5px 0;">Date: ${c}</p>
        <p style="margin: 5px 0;">Heure: ${d}</p>
        <p style="margin: 5px 0;">Ticket #: ${Math.floor(Math.random()*1e4)}</p>
      </div>

      <div style="border-top: 1px dashed #000; border-bottom: 1px dashed #000; padding: 10px 0; margin-bottom: 10px;">
        ${t.map(f=>`
          <div style="display: flex; justify-content: space-between; margin: 5px 0;">
            <div>
              ${f.product.name} x${f.quantity}
            </div>
            <div>
              ${Math.round(f.product.price*f.quantity)} Fcfa
            </div>
          </div>
        `).join("")}
      </div>

      <div style="margin-bottom: 20px;">
        <div style="display: flex; justify-content: space-between; margin: 5px 0;">
          <div>Sous-total HT:</div>
          <div>${Math.round(n/1.1)} Fcfa</div>
        </div>
        <div style="display: flex; justify-content: space-between; margin: 5px 0;">
          <div>TVA (10%):</div>
          <div>${Math.round(r)} Fcfa</div>
        </div>
        <div style="display: flex; justify-content: space-between; margin: 5px 0; font-weight: bold;">
          <div>TOTAL TTC:</div>
          <div>${Math.round(e)} Fcfa</div>
        </div>
        <div style="display: flex; justify-content: space-between; margin: 5px 0;">
          <div>Espèces:</div>
          <div>${i} Fcfa</div>
        </div>
        <div style="display: flex; justify-content: space-between; margin: 5px 0;">
          <div>Monnaie:</div>
          <div>${Math.round(s)} Fcfa</div>
        </div>
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <p style="margin: 5px 0;">Merci de votre visite !</p>
        <p style="margin: 5px 0;">À bientôt !</p>
      </div>
    </div>
  `},fj=(t,e,n,r,i,s,o,a)=>{const l=xG(t,e,n,r,i,s,o,a),c=document.createElement("div");c.innerHTML=l,document.body.appendChild(c),LW({printable:c,type:"html",documentTitle:"Ticket de caisse",style:`
      @page { 
        size: 80mm 297mm;
        margin: 0;
      }
      @media print {
        body {
          width: 80mm;
        }
      }
    `}),document.body.removeChild(c)},yG=t=>{const n=`${Math.floor(t.timestamp.getTime()/1e3)}_${t.userUID}_${t.totalAmount}_${t.productReference.join("_")}`;return ix.SHA256(n).toString()},vG=async(t,e=5e3)=>{const n=new Date,r=new Date(n.getTime()-e),i=mn(en(ot,"ventes"),pt("saleHash","==",t),pt("timestamp",">=",Bt.fromDate(r)),pt("timestamp","<=",Bt.fromDate(n)));return!(await On(i)).empty},bG=async t=>{try{const e=yG(t);if(await vG(e))throw new Error("Transaction doublon détectée");const r={...t,saleHash:e,isDuplicate:!1,createdAt:new Date,updatedAt:new Date,deletedAt:null,deletedBy:null,deletedByName:null,deleteReason:null};return await aj(r),navigator.onLine&&await cm(ot,async i=>{if((await i.get(ln(ot,"ventes",e))).exists())throw new Error("Transaction doublon détectée");const o=await Promise.all(t.productReference.map(async d=>{const f=ln(ot,"products",d),h=await i.get(f);if(!h.exists())throw new Error(`Produit non trouvé: ${t.productName[t.productReference.indexOf(d)]}`);return{ref:f,data:h.data(),id:d}})),a=ln(ot,"statistics",t.company),l=await i.get(a),c=o.map((d,f)=>{const h=d.data.stockParAgence||{},p=h[t.agency]||0,m=t.quantity[f];if(m<=0)throw new Error(`Quantité invalide pour ${t.productName[f]}`);if(p<m)throw new Error(`Stock insuffisant pour ${t.productName[f]} dans l'agence ${t.agency} (Disponible: ${p})`);return h[t.agency]=p-m,{ref:d.ref,updates:{stockParAgence:h,totalQuantitySold:(d.data.totalQuantitySold||0)+m,totalRevenue:(d.data.totalRevenue||0)+m*d.data.price,updatedAt:Bt.now()}}});i.set(ln(ot,"ventes",e),r),c.forEach(d=>{i.update(d.ref,d.updates)}),l.exists()?i.update(a,{totalRevenue:jc(t.totalAmount),totalSalesCount:jc(1),lastUpdated:Bt.now()}):i.set(a,{totalRevenue:t.totalAmount,totalSalesCount:1,lastUpdated:Bt.now(),createdAt:Bt.now()})}),{success:!0}}catch(e){console.error("Error creating sale:",e);const n=e instanceof Error?e.message:"Erreur lors de la création de la vente";return ke.error(n),{success:!1,error:n}}},wG=async(t,e)=>{const n=ln(ot,"ventes",t);try{return await cm(ot,async r=>{const i=await r.get(n);if(!i.exists())throw new Error("La vente n'existe pas ou a déjà été supprimée");const s=i.data(),o=ln(ot,"statistics",s.company),a=await r.get(o),l=await Promise.all(s.productReference.map(async d=>{const f=ln(ot,"products",d),h=await r.get(f);return{ref:f,doc:h,data:h.data()}}));r.update(n,{deletedAt:Bt.now(),deletedBy:e.deletedBy,deletedByName:e.deletedByName,deleteReason:e.reason,updatedAt:Bt.now()}),a.exists()&&r.update(o,{totalRevenue:jc(-s.totalAmount),deletedSalesCount:jc(1),deletedSalesAmount:jc(s.totalAmount),lastUpdated:Bt.now()}),l.forEach((d,f)=>{if(d.doc.exists()){const h=d.data.stockParAgence||{},p=h[s.agency]||0,m=s.quantity[f];h[s.agency]=p+m,r.update(d.ref,{stockParAgence:h,totalQuantitySold:jc(-s.quantity[f]),totalRevenue:jc(-(s.quantity[f]*d.data.price)),updatedAt:Bt.now()})}});const c=en(ot,"deletionLogs");r.set(ln(c),{saleId:t,timestamp:Bt.now(),deletedBy:e.deletedBy,deletedByName:e.deletedByName,reason:e.reason,saleAmount:s.totalAmount,company:s.company,agency:s.agency})}),ke.success("Vente supprimée et statistiques mises à jour"),{success:!0}}catch(r){console.error("Error deleting sale:",r);const i=r instanceof Error?r.message:"Erreur lors de la suppression";throw ke.error(i),r}},_G=async()=>{try{const t=mn(en(ot,"ventes"),pt("stockUpdated","==",!1),pt("isDuplicate","==",!1),pt("deletedAt","==",null)),e=await On(t);if(e.empty)return;for(const n of e.docs){const r=n.data();try{await cm(ot,async i=>{if(r.stockUpdated)return;const s=await Promise.all(r.productReference.map(async(a,l)=>{const c=ln(ot,"products",a),d=await i.get(c);return{ref:c,doc:d,data:d.exists()?d.data():null,productId:a,productName:r.productName[l],quantity:r.quantity[l]}})),o=[];for(const a of s){if(!a.doc.exists()){console.error(`Product not found: ${a.productName}`);continue}const l=a.data,c=l.stockParAgence||{},d=c[r.agency]||0,f=a.quantity;d>=f?(c[r.agency]=d-f,o.push({ref:a.ref,updates:{stockParAgence:c,totalQuantitySold:(l.totalQuantitySold||0)+f,totalRevenue:(l.totalRevenue||0)+f*l.price}})):console.warn(`Insufficient stock for ${a.productName} in agency ${r.agency}`)}o.forEach(a=>{i.update(a.ref,a.updates)}),i.update(ln(ot,"ventes",n.id),{stockUpdated:!0,synced:!0})})}catch(i){console.error(`Error processing sale ${n.id}:`,i)}}ke.success("Synchronisation du stock terminée")}catch(t){console.error("Error syncing stock updates:",t),ke.error("Erreur lors de la synchronisation du stock")}},NG=({onClose:t,onComplete:e})=>{const{items:n,total:r,subtotal:i,tax:s,clearCart:o}=oy(),[a,l]=he.useState(""),[c,d]=he.useState(!1),[f,h]=he.useState(!1),[p,m]=he.useState(navigator.onLine),[g,b]=he.useState(!1),[x,w]=he.useState(null);he.useEffect(()=>{(async()=>{if(!fn.currentUser){ke.error("Vous devez être connecté pour effectuer une vente"),t();return}try{const I=await ps(ln(ot,"users",fn.currentUser.uid));if(!I.exists()){ke.error("Erreur: Informations utilisateur manquantes"),t();return}const S=I.data();if(!S.company||!S.role){ke.error("Erreur: Informations entreprise ou rôle manquants"),t();return}if(!S.agencyName){ke.error("Erreur: Aucune agence associée à votre compte. Impossible de procéder à la vente."),t();return}w({company:S.company,agency:S.agencyName,firstName:S.firstName||"",lastName:S.lastName||"",role:S.role})}catch(I){console.error("Error fetching user data:",I),ke.error("Erreur lors du chargement des données utilisateur"),t()}})()},[t]),Ko.useEffect(()=>{const A=()=>m(!0),I=()=>m(!1);return window.addEventListener("online",A),window.addEventListener("offline",I),()=>{window.removeEventListener("online",A),window.removeEventListener("offline",I)}},[]);const N=async()=>{if(!fn.currentUser){ke.error("Vous devez être connecté pour effectuer une vente");return}if(!x){ke.error("Erreur: Informations utilisateur manquantes");return}if(!x.agency){ke.error("Erreur: Aucune agence associée à votre compte. Impossible de procéder à la vente.");return}h(!0);try{const A={productName:n.map(I=>I.product.name),quantity:n.map(I=>I.quantity),unitPrice:n.map(I=>I.product.price),productCategory:n.map(I=>I.product.category),productReference:n.map(I=>I.product.id),totalAmount:r,recordedBy:`${x.firstName} ${x.lastName}`,userRole:x.role,userUID:fn.currentUser.uid,timestamp:new Date,cashReceived:parseFloat(a),changeDue:parseFloat(a)-r,company:x.company,agency:x.agency,createdAt:new Date,updatedAt:new Date};if(p){const I=await bG(A);if(!I.success)throw new Error(I.error);ke.success("Vente enregistrée avec succès et stock mis à jour")}else await aj(A),ke.success("Vente enregistrée localement. Le stock sera mis à jour automatiquement dès le retour de la connexion");d(!0)}catch(A){console.error("Erreur lors de l'enregistrement de la vente:",A),ke.error(A instanceof Error?A.message:"Une erreur s'est produite. Veuillez réessayer ou vérifier votre connexion")}finally{h(!1)}},E=async()=>{o(),e()},D=async()=>{if(x){b(!0);try{await fj(n,r,i,s,parseFloat(a),parseFloat(a)-r,x.company,x.agency),ke.success("Impression du ticket en cours")}catch(A){console.error("Erreur lors de l'impression:",A),ke.error("Erreur lors de l'impression")}finally{b(!1)}}},j=parseInt(a)||0,C=j>r?j-r:0,v=[500,1e3,1500,2e3,5e3,1e4];return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center sticky top-0",children:[u.jsxs("h2",{className:"font-bold text-xl flex items-center",children:[c?"Paiement Complété":"Paiement",p?u.jsx(wH,{className:"ml-2 h-5 w-5 text-green-300"}):u.jsx(Z1,{className:"ml-2 h-5 w-5 text-yellow-300"})]}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),!p&&u.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Z1,{className:"h-5 w-5 text-yellow-400 mr-2"}),u.jsx("p",{className:"text-sm text-yellow-700",children:"Mode hors-ligne actif. Les ventes seront synchronisées automatiquement lors du retour de la connexion."})]})}),x&&u.jsx("div",{className:"bg-gray-50 p-4 border-b",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Agence"}),u.jsx("p",{className:"font-medium",children:x.agency})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Vendeur"}),u.jsxs("p",{className:"font-medium",children:[x.firstName," ",x.lastName]})]})]})}),c?u.jsxs("div",{className:"p-6 text-center",children:[u.jsxs("div",{className:"bg-green-100 text-green-700 p-4 rounded-lg mb-6",children:[u.jsx("svg",{className:"mx-auto h-16 w-16 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsx("h3",{className:"text-xl font-bold mb-2",children:"Paiement réussi!"}),u.jsx("p",{children:"Vente enregistrée avec succès."})]}),u.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mb-6",children:[u.jsxs("div",{className:"flex justify-between mb-2",children:[u.jsx("span",{className:"text-gray-600",children:"Total:"}),u.jsxs("span",{children:[Math.round(r)," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between mb-2",children:[u.jsx("span",{className:"text-gray-600",children:"Montant reçu:"}),u.jsxs("span",{children:[j," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[u.jsx("span",{children:"Monnaie rendue:"}),u.jsxs("span",{className:"text-green-600",children:[Math.round(C)," Fcfa"]})]})]}),u.jsxs("div",{className:"flex space-x-4 mb-6",children:[u.jsx("button",{className:"flex-1 bg-[#8B4513] text-white py-3 rounded-lg font-bold flex items-center justify-center transition-colors hover:bg-[#663300]",onClick:E,children:"Nouvelle vente"}),u.jsxs("button",{className:"flex-1 border border-gray-300 text-gray-600 py-3 rounded-lg font-medium flex items-center justify-center hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",onClick:D,disabled:g,children:[u.jsx(bf,{className:"mr-2 h-5 w-5"}),g?"Impression...":"Imprimer reçu"]})]})]}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Récapitulatif"}),u.jsx("div",{className:"mb-4 max-h-60 overflow-y-auto bg-gray-50 rounded-lg",children:n.map(A=>u.jsxs("div",{className:"border-b border-gray-200 p-3 flex",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("span",{className:"font-medium",children:A.product.name}),u.jsxs("span",{className:"text-gray-500 ml-2",children:["x",A.quantity]})]}),u.jsxs("div",{className:"text-right",children:[Math.round(A.product.price*A.quantity)," Fcfa"]})]},A.product.id))}),u.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[u.jsxs("div",{className:"flex justify-between mb-2",children:[u.jsx("span",{className:"text-gray-600",children:"Sous-total:"}),u.jsxs("span",{children:[Math.round(i)," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between mb-2",children:[u.jsx("span",{className:"text-gray-600",children:"TVA (10%):"}),u.jsxs("span",{children:[Math.round(s)," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[u.jsx("span",{children:"Total:"}),u.jsxs("span",{children:[Math.round(r)," Fcfa"]})]})]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Paiement en Espèces"}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Montant reçu"}),u.jsxs("div",{className:"flex",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"Fcfa"}),u.jsx("input",{type:"number",className:"w-full py-3 pl-14 pr-3 border border-gray-300 rounded-l-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:a,onChange:A=>l(A.target.value),placeholder:"0",min:0})]}),u.jsx("button",{className:"bg-red-500 text-white px-4 rounded-r-lg hover:bg-red-600",onClick:()=>l(""),children:u.jsx(Cr,{className:"h-5 w-5"})})]})]}),u.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:v.map(A=>u.jsxs("button",{className:"bg-[#FFFDD0] text-[#8B4513] py-2 rounded-lg font-bold hover:bg-[#FFD700]/50",onClick:()=>l(A.toString()),children:[A," Fcfa"]},A))}),j>0&&u.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg mb-4",children:[u.jsxs("div",{className:"flex justify-between mb-2",children:[u.jsx("span",{className:"text-gray-600",children:"Montant reçu:"}),u.jsxs("span",{children:[j," Fcfa"]})]}),u.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[u.jsx("span",{children:"Monnaie à rendre:"}),u.jsxs("span",{className:C>0?"text-green-600":"",children:[Math.round(C)," Fcfa"]})]})]}),u.jsxs("button",{className:"w-full bg-[#8B4513] text-white py-3 rounded-lg font-bold text-lg flex items-center justify-center transition-colors hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed",onClick:N,disabled:j<r||f||!x,children:[u.jsx(J1,{className:"mr-2 h-5 w-5"}),f?"Traitement en cours...":"Encaisser"]})]}),u.jsxs("button",{className:"w-full border border-gray-300 text-gray-600 py-3 rounded-lg font-medium flex items-center justify-center hover:bg-gray-100",onClick:t,disabled:f,children:[u.jsx(ly,{className:"mr-2 h-5 w-5"}),"Retour"]})]})]})})};let Sp;const c4=async()=>{Sp=await s4("egrec-products",1,{upgrade(t){const e=t.createObjectStore("cached-products",{keyPath:"id"});e.createIndex("by-company","company"),e.createIndex("by-category","category")}})},AG=async(t,e)=>{Sp||await c4();const n=Sp.transaction("cached-products","readwrite"),r=n.objectStore("cached-products"),s=await r.index("by-company").getAllKeys(e);await Promise.all(s.map(o=>r.delete(o))),await Promise.all(t.map(o=>r.put(o))),await n.done},Ep=async t=>{Sp||await c4();try{return await Sp.transaction("cached-products").store.index("by-company").getAll(t)}catch(e){return console.error("Error getting cached products:",e),[]}},y5=async t=>{if(!ot)throw new Error("Base de données Firebase non initialisée");try{const e=mn(en(ot,"products"),pt("company","==",t)),r=(await On(e)).docs.map(i=>({id:i.id,...i.data()}));if(r.length===0)throw new Error("Aucun produit trouvé pour cette entreprise");return await AG(r,t),r}catch(e){console.error("Error fetching products:",e);const n=await Ep(t);if(n.length>0)return ke("Utilisation des produits en cache",{icon:"✅",duration:3e3}),n;throw e}},SG=()=>{const{user:t,loading:e,error:n}=Li(),[r,i]=he.useState("Boulangerie"),[s,o]=he.useState("pains"),[a,l]=he.useState("boisson"),[c,d]=he.useState([]),[f,h]=he.useState([]),[p,m]=he.useState(""),[g,b]=he.useState(!1),[x,w]=he.useState(!0),[N,E]=he.useState(null),[D,j]=he.useState(!navigator.onLine),[C,v]=he.useState(!1);he.useEffect(()=>{(async()=>{try{await c4(),v(!0)}catch(O){console.error("Failed to initialize product cache:",O),E("Failed to initialize product cache")}})()},[]),he.useEffect(()=>{const q=async()=>{if(j(!1),t!=null&&t.company&&C)try{const M=await y5(t.company);d(M),E(null)}catch(M){console.error("Error fetching products:",M),ke.error("Échec du chargement des produits")}},O=()=>{j(!0),ke("Mode hors-ligne activé - Utilisation du cache local",{icon:"🔌",duration:4e3})};return window.addEventListener("online",q),window.addEventListener("offline",O),()=>{window.removeEventListener("online",q),window.removeEventListener("offline",O)}},[t==null?void 0:t.company,C]),he.useEffect(()=>{e||(async()=>{if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName)||!C)){w(!0);try{let O=[];if(navigator.onLine)try{const M=mn(en(ot,"products"),pt("company","==",t.company),oi("name","asc"));O=(await On(M)).docs.map(z=>({id:z.id,...z.data()})),O=O.filter(z=>{var ne;const J=(ne=z.stateByAgency)==null?void 0:ne[t.agencyName];return!J||J==="active"}),await y5(t.company)}catch(M){if(console.error("Error fetching products:",M),O=await Ep(t.company),O.length>0)ke("Utilisation des produits en cache - Certaines données peuvent être obsolètes",{icon:"⚠️",duration:4e3});else throw new Error("Aucun produit disponible en ligne ou en cache")}else if(O=await Ep(t.company),O.length===0)throw new Error("Connexion Internet requise pour le premier chargement des produits");d(O),E(null)}catch(O){console.error("Error loading products:",O),E(O instanceof Error?O.message:"Échec du chargement des produits")}finally{w(!1)}}})()},[t==null?void 0:t.company,t==null?void 0:t.agencyName,e,C]);const A=c.filter(q=>q.department==="Boulangerie"),I=c.filter(q=>q.department==="Boutique"),S=()=>{const q={boisson:0,margarine:0,raffinerie:0,savonnerie:0,cosmetique:0,champs:0};return I.forEach(O=>{O.category in q&&q[O.category]++}),q};he.useEffect(()=>{let q=r==="Boulangerie"?A:I;p?q=q.filter(O=>O.name.toLowerCase().includes(p.toLowerCase())||O.reference.toLowerCase().includes(p.toLowerCase())):r==="Boulangerie"?s==="favoris"?q=q.filter(O=>O.isFavorite):q=q.filter(O=>O.category===s):q=q.filter(O=>O.category===a),h(q)},[r,s,a,p,A,I]);const P=q=>{m(q)},k=q=>{i(q),m("")},F=()=>{b(!1)};return e||x?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-[#8B4513] text-xl",children:"Chargement des produits..."})}):n||N?u.jsx("div",{className:"p-6",children:u.jsxs("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg flex flex-col items-center gap-4",children:[u.jsx("p",{children:n||N}),(N==null?void 0:N.includes("Aucun produit"))&&u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsx(yH,{className:"h-8 w-8"}),u.jsx("p",{className:"text-center",children:"Aucun produit trouvé pour votre entreprise. Veuillez ajouter des produits dans le panneau d'administration."})]})]})}):!(t!=null&&t.company)||!(t!=null&&t.agencyName)?u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Informations entreprise ou agence manquantes"})}):u.jsxs("div",{className:"flex flex-col md:flex-row h-full gap-6",children:[D&&u.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 fixed top-4 right-4 flex items-center space-x-2 z-40",children:[u.jsx(Z1,{className:"h-5 w-5 text-yellow-700"}),u.jsx("span",{className:"text-yellow-700",children:"Mode hors-ligne"})]}),u.jsxs("div",{className:"flex-grow md:w-2/3 overflow-auto",children:[u.jsx(VH,{onSearch:P}),u.jsx(BH,{selectedDepartment:r,onDepartmentChange:k,bakeryCount:A.length,storeCount:I.length}),u.jsxs("div",{className:"mb-4 flex items-center justify-between bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${r==="Boulangerie"?"bg-orange-500":"bg-blue-500"}`}),u.jsxs("span",{className:"font-medium text-gray-800",children:["Département : ",r]}),u.jsxs("span",{className:"ml-2 bg-white text-gray-800 px-3 py-1 rounded-full text-sm font-medium shadow-sm",children:[f.length," produit",f.length>1?"s":""]})]}),u.jsx("div",{className:"text-sm text-gray-600",children:r==="Boulangerie"?`Catégorie: ${s==="favoris"?"Favoris":s}`:`Catégorie: ${a}`})]}),r==="Boulangerie"?u.jsx(ej,{activeCategory:s,onCategoryChange:q=>{o(q),m("")}}):u.jsx(OH,{activeCategory:a,onCategoryChange:q=>{l(q),m("")},categoryCounts:S()}),u.jsx(zH,{products:f})]}),u.jsx("div",{className:"md:w-1/3",children:u.jsx(qH,{onCheckout:()=>b(!0)})}),g&&u.jsx(NG,{onClose:()=>b(!1),onComplete:F})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function fm(t){return t+.5|0}const Oc=(t,e,n)=>Math.max(Math.min(t,n),e);function d0(t){return Oc(fm(t*2.55),0,255)}function eu(t){return Oc(fm(t*255),0,255)}function vl(t){return Oc(fm(t/2.55)/100,0,1)}function iE(t){return Oc(fm(t*100),0,100)}const yo={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},v5=[..."0123456789ABCDEF"],EG=t=>v5[t&15],CG=t=>v5[(t&240)>>4]+v5[t&15],ug=t=>(t&240)>>4===(t&15),PG=t=>ug(t.r)&&ug(t.g)&&ug(t.b)&&ug(t.a);function kG(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&yo[t[1]]*17,g:255&yo[t[2]]*17,b:255&yo[t[3]]*17,a:e===5?yo[t[4]]*17:255}:(e===7||e===9)&&(n={r:yo[t[1]]<<4|yo[t[2]],g:yo[t[3]]<<4|yo[t[4]],b:yo[t[5]]<<4|yo[t[6]],a:e===9?yo[t[7]]<<4|yo[t[8]]:255})),n}const TG=(t,e)=>t<255?e(t):"";function IG(t){var e=PG(t)?EG:CG;return t?"#"+e(t.r)+e(t.g)+e(t.b)+TG(t.a,e):void 0}const jG=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function pj(t,e,n){const r=e*Math.min(n,1-n),i=(s,o=(s+t/30)%12)=>n-r*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function DG(t,e,n){const r=(i,s=(i+t/60)%6)=>n-n*e*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function RG(t,e,n){const r=pj(t,1,.5);let i;for(e+n>1&&(i=1/(e+n),e*=i,n*=i),i=0;i<3;i++)r[i]*=1-e-n,r[i]+=e;return r}function FG(t,e,n,r,i){return t===i?(e-n)/r+(e<n?6:0):e===i?(n-t)/r+2:(t-e)/r+4}function u4(t){const n=t.r/255,r=t.g/255,i=t.b/255,s=Math.max(n,r,i),o=Math.min(n,r,i),a=(s+o)/2;let l,c,d;return s!==o&&(d=s-o,c=a>.5?d/(2-s-o):d/(s+o),l=FG(n,r,i,d,s),l=l*60+.5),[l|0,c||0,a]}function d4(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(eu)}function h4(t,e,n){return d4(pj,t,e,n)}function LG(t,e,n){return d4(RG,t,e,n)}function MG(t,e,n){return d4(DG,t,e,n)}function mj(t){return(t%360+360)%360}function BG(t){const e=jG.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?d0(+e[5]):eu(+e[5]));const i=mj(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=LG(i,s,o):e[1]==="hsv"?r=MG(i,s,o):r=h4(i,s,o),{r:r[0],g:r[1],b:r[2],a:n}}function OG(t,e){var n=u4(t);n[0]=mj(n[0]+e),n=h4(n),t.r=n[0],t.g=n[1],t.b=n[2]}function VG(t){if(!t)return;const e=u4(t),n=e[0],r=iE(e[1]),i=iE(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${i}%, ${vl(t.a)})`:`hsl(${n}, ${r}%, ${i}%)`}const sE={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},oE={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function UG(){const t={},e=Object.keys(oE),n=Object.keys(sE);let r,i,s,o,a;for(r=0;r<e.length;r++){for(o=a=e[r],i=0;i<n.length;i++)s=n[i],a=a.replace(s,sE[s]);s=parseInt(oE[o],16),t[a]=[s>>16&255,s>>8&255,s&255]}return t}let dg;function zG(t){dg||(dg=UG(),dg.transparent=[0,0,0,0]);const e=dg[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const qG=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function HG(t){const e=qG.exec(t);let n=255,r,i,s;if(e){if(e[7]!==r){const o=+e[7];n=e[8]?d0(o):Oc(o*255,0,255)}return r=+e[1],i=+e[3],s=+e[5],r=255&(e[2]?d0(r):Oc(r,0,255)),i=255&(e[4]?d0(i):Oc(i,0,255)),s=255&(e[6]?d0(s):Oc(s,0,255)),{r,g:i,b:s,a:n}}}function WG(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${vl(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const x2=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,nh=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function $G(t,e,n){const r=nh(vl(t.r)),i=nh(vl(t.g)),s=nh(vl(t.b));return{r:eu(x2(r+n*(nh(vl(e.r))-r))),g:eu(x2(i+n*(nh(vl(e.g))-i))),b:eu(x2(s+n*(nh(vl(e.b))-s))),a:t.a+n*(e.a-t.a)}}function hg(t,e,n){if(t){let r=u4(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=h4(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function gj(t,e){return t&&Object.assign(e||{},t)}function aE(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=eu(t[3]))):(e=gj(t,{r:0,g:0,b:0,a:1}),e.a=eu(e.a)),e}function GG(t){return t.charAt(0)==="r"?HG(t):BG(t)}class Cp{constructor(e){if(e instanceof Cp)return e;const n=typeof e;let r;n==="object"?r=aE(e):n==="string"&&(r=kG(e)||zG(e)||GG(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=gj(this._rgb);return e&&(e.a=vl(e.a)),e}set rgb(e){this._rgb=aE(e)}rgbString(){return this._valid?WG(this._rgb):void 0}hexString(){return this._valid?IG(this._rgb):void 0}hslString(){return this._valid?VG(this._rgb):void 0}mix(e,n){if(e){const r=this.rgb,i=e.rgb;let s;const o=n===s?.5:n,a=2*o-1,l=r.a-i.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,r.r=255&c*r.r+s*i.r+.5,r.g=255&c*r.g+s*i.g+.5,r.b=255&c*r.b+s*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}interpolate(e,n){return e&&(this._rgb=$G(this._rgb,e._rgb,n)),this}clone(){return new Cp(this.rgb)}alpha(e){return this._rgb.a=eu(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=fm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return hg(this._rgb,2,e),this}darken(e){return hg(this._rgb,2,-e),this}saturate(e){return hg(this._rgb,1,e),this}desaturate(e){return hg(this._rgb,1,-e),this}rotate(e){return OG(this._rgb,e),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function fl(){}const KG=(()=>{let t=0;return()=>t++})();function qn(t){return t==null}function Xr(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Nn(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ts(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function va(t,e){return ts(t)?t:e}function xn(t,e){return typeof t>"u"?e:t}const QG=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,xj=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function hr(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Kn(t,e,n,r){let i,s,o;if(Xr(t))for(s=t.length,i=0;i<s;i++)e.call(n,t[i],i);else if(Nn(t))for(o=Object.keys(t),s=o.length,i=0;i<s;i++)e.call(n,t[o[i]],o[i])}function cx(t,e){let n,r,i,s;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(i=t[n],s=e[n],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function ux(t){if(Xr(t))return t.map(ux);if(Nn(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let i=0;for(;i<r;++i)e[n[i]]=ux(t[n[i]]);return e}return t}function yj(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function YG(t,e,n,r){if(!yj(t))return;const i=e[t],s=n[t];Nn(i)&&Nn(s)?Pp(i,s,r):e[t]=ux(s)}function Pp(t,e,n){const r=Xr(e)?e:[e],i=r.length;if(!Nn(t))return t;n=n||{};const s=n.merger||YG;let o;for(let a=0;a<i;++a){if(o=r[a],!Nn(o))continue;const l=Object.keys(o);for(let c=0,d=l.length;c<d;++c)s(l[c],t,o,n)}return t}function T0(t,e){return Pp(t,e,{merger:XG})}function XG(t,e,n){if(!yj(t))return;const r=e[t],i=n[t];Nn(r)&&Nn(i)?T0(r,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=ux(i))}const lE={"":t=>t,x:t=>t.x,y:t=>t.y};function JG(t){const e=t.split("."),n=[];let r="";for(const i of e)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function ZG(t){const e=JG(t);return n=>{for(const r of e){if(r==="")break;n=n&&n[r]}return n}}function Pd(t,e){return(lE[e]||(lE[e]=ZG(e)))(t)}function f4(t){return t.charAt(0).toUpperCase()+t.slice(1)}const kp=t=>typeof t<"u",cu=t=>typeof t=="function",cE=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function eK(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Dr=Math.PI,Ar=2*Dr,tK=Ar+Dr,dx=Number.POSITIVE_INFINITY,nK=Dr/180,si=Dr/2,Tu=Dr/4,uE=Dr*2/3,b5=Math.log10,Va=Math.sign;function I0(t,e,n){return Math.abs(t-e)<n}function dE(t){const e=Math.round(t);t=I0(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(b5(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function rK(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((i,s)=>i-s).pop(),e}function iK(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Tp(t){return!iK(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function sK(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function oK(t,e,n){let r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r][n],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function El(t){return t*(Dr/180)}function aK(t){return t*(180/Dr)}function hE(t){if(!ts(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function vj(t,e){const n=e.x-t.x,r=e.y-t.y,i=Math.sqrt(n*n+r*r);let s=Math.atan2(r,n);return s<-.5*Dr&&(s+=Ar),{angle:s,distance:i}}function w5(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function lK(t,e){return(t-e+tK)%Ar-Dr}function Aa(t){return(t%Ar+Ar)%Ar}function Ip(t,e,n,r){const i=Aa(t),s=Aa(e),o=Aa(n),a=Aa(s-i),l=Aa(o-i),c=Aa(i-s),d=Aa(i-o);return i===s||i===o||r&&s===o||a>l&&c<d}function Xi(t,e,n){return Math.max(e,Math.min(n,t))}function cK(t){return Xi(t,-32768,32767)}function Cl(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function p4(t,e,n){n=n||(o=>t[o]<e);let r=t.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,n(s)?i=s:r=s;return{lo:i,hi:r}}const Qu=(t,e,n,r)=>p4(t,n,r?i=>{const s=t[i][e];return s<n||s===n&&t[i+1][e]===n}:i=>t[i][e]<n),uK=(t,e,n)=>p4(t,n,r=>t[r][e]>=n);function dK(t,e,n){let r=0,i=t.length;for(;r<i&&t[r]<e;)r++;for(;i>r&&t[i-1]>n;)i--;return r>0||i<t.length?t.slice(r,i):t}const bj=["push","pop","shift","splice","unshift"];function hK(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),bj.forEach(n=>{const r="_onData"+f4(n),i=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return t._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...s)}),o}})})}function fE(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,i=r.indexOf(e);i!==-1&&r.splice(i,1),!(r.length>0)&&(bj.forEach(s=>{delete t[s]}),delete t._chartjs)}function wj(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const _j=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function Nj(t,e){let n=[],r=!1;return function(...i){n=i,r||(r=!0,_j.call(window,()=>{r=!1,t.apply(e,n)}))}}function fK(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const m4=t=>t==="start"?"left":t==="end"?"right":"center",Ki=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,pK=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e;function mK(t,e,n){const r=e.length;let i=0,s=r;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,d=o.axis,{min:f,max:h,minDefined:p,maxDefined:m}=o.getUserBounds();if(p){if(i=Math.min(Qu(l,d,f).lo,n?r:Qu(e,d,o.getPixelForValue(f)).lo),c){const g=l.slice(0,i+1).reverse().findIndex(b=>!qn(b[a.axis]));i-=Math.max(0,g)}i=Xi(i,0,r-1)}if(m){let g=Math.max(Qu(l,o.axis,h,!0).hi+1,n?0:Qu(e,d,o.getPixelForValue(h),!0).hi+1);if(c){const b=l.slice(g-1).findIndex(x=>!qn(x[a.axis]));g+=Math.max(0,b)}s=Xi(g,i,r)-i}else s=r-i}return{start:i,count:s}}function gK(t){const{xScale:e,yScale:n,_scaleRanges:r}=t,i={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!r)return t._scaleRanges=i,!0;const s=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),s}const fg=t=>t===0||t===1,pE=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Ar/n)),mE=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Ar/n)+1,j0={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*si)+1,easeOutSine:t=>Math.sin(t*si),easeInOutSine:t=>-.5*(Math.cos(Dr*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>fg(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>fg(t)?t:pE(t,.075,.3),easeOutElastic:t=>fg(t)?t:mE(t,.075,.3),easeInOutElastic(t){return fg(t)?t:t<.5?.5*pE(t*2,.1125,.45):.5+.5*mE(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-j0.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?j0.easeInBounce(t*2)*.5:j0.easeOutBounce(t*2-1)*.5+.5};function g4(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function gE(t){return g4(t)?t:new Cp(t)}function y2(t){return g4(t)?t:new Cp(t).saturate(.5).darken(.1).hexString()}const xK=["x","y","borderWidth","radius","tension"],yK=["color","borderColor","backgroundColor"];function vK(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:yK},numbers:{type:"number",properties:xK}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function bK(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const xE=new Map;function wK(t,e){e=e||{};const n=t+JSON.stringify(e);let r=xE.get(n);return r||(r=new Intl.NumberFormat(t,e),xE.set(n,r)),r}function x4(t,e,n){return wK(e,n).format(t)}const Aj={values(t){return Xr(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let i,s=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),s=_K(t,n)}const o=b5(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),x4(t,r,l)},logarithmic(t,e,n){if(t===0)return"0";const r=n[e].significand||t/Math.pow(10,Math.floor(b5(t)));return[1,2,3,5,10,15].includes(r)||e>.8*n.length?Aj.numeric.call(this,t,e,n):""}};function _K(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Sj={formatters:Aj};function NK(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Sj.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const kd=Object.create(null),_5=Object.create(null);function D0(t,e){if(!e)return t;const n=e.split(".");for(let r=0,i=n.length;r<i;++r){const s=n[r];t=t[s]||(t[s]=Object.create(null))}return t}function v2(t,e,n){return typeof e=="string"?Pp(D0(t,e),n):Pp(D0(t,""),e)}class AK{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>y2(i.backgroundColor),this.hoverBorderColor=(r,i)=>y2(i.borderColor),this.hoverColor=(r,i)=>y2(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return v2(this,e,n)}get(e){return D0(this,e)}describe(e,n){return v2(_5,e,n)}override(e,n){return v2(kd,e,n)}route(e,n,r,i){const s=D0(this,e),o=D0(this,r),a="_"+n;Object.defineProperties(s,{[a]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[i];return Nn(l)?Object.assign({},c,l):xn(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var qr=new AK({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[vK,bK,NK]);function SK(t){return!t||qn(t.size)||qn(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function yE(t,e,n,r,i){let s=e[i];return s||(s=e[i]=t.measureText(i).width,n.push(i)),s>r&&(r=s),r}function Iu(t,e,n){const r=t.currentDevicePixelRatio,i=n!==0?Math.max(n/2,.5):0;return Math.round((e-i)*r)/r+i}function vE(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function N5(t,e,n,r){Ej(t,e,n,r,null)}function Ej(t,e,n,r,i){let s,o,a,l,c,d,f,h;const p=e.pointStyle,m=e.rotation,g=e.radius;let b=(m||0)*nK;if(p&&typeof p=="object"&&(s=p.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(b),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(g)||g<=0)){switch(t.beginPath(),p){default:i?t.ellipse(n,r,i/2,g,0,0,Ar):t.arc(n,r,g,0,Ar),t.closePath();break;case"triangle":d=i?i/2:g,t.moveTo(n+Math.sin(b)*d,r-Math.cos(b)*g),b+=uE,t.lineTo(n+Math.sin(b)*d,r-Math.cos(b)*g),b+=uE,t.lineTo(n+Math.sin(b)*d,r-Math.cos(b)*g),t.closePath();break;case"rectRounded":c=g*.516,l=g-c,o=Math.cos(b+Tu)*l,f=Math.cos(b+Tu)*(i?i/2-c:l),a=Math.sin(b+Tu)*l,h=Math.sin(b+Tu)*(i?i/2-c:l),t.arc(n-f,r-a,c,b-Dr,b-si),t.arc(n+h,r-o,c,b-si,b),t.arc(n+f,r+a,c,b,b+si),t.arc(n-h,r+o,c,b+si,b+Dr),t.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*g,d=i?i/2:l,t.rect(n-d,r-l,2*d,2*l);break}b+=Tu;case"rectRot":f=Math.cos(b)*(i?i/2:g),o=Math.cos(b)*g,a=Math.sin(b)*g,h=Math.sin(b)*(i?i/2:g),t.moveTo(n-f,r-a),t.lineTo(n+h,r-o),t.lineTo(n+f,r+a),t.lineTo(n-h,r+o),t.closePath();break;case"crossRot":b+=Tu;case"cross":f=Math.cos(b)*(i?i/2:g),o=Math.cos(b)*g,a=Math.sin(b)*g,h=Math.sin(b)*(i?i/2:g),t.moveTo(n-f,r-a),t.lineTo(n+f,r+a),t.moveTo(n+h,r-o),t.lineTo(n-h,r+o);break;case"star":f=Math.cos(b)*(i?i/2:g),o=Math.cos(b)*g,a=Math.sin(b)*g,h=Math.sin(b)*(i?i/2:g),t.moveTo(n-f,r-a),t.lineTo(n+f,r+a),t.moveTo(n+h,r-o),t.lineTo(n-h,r+o),b+=Tu,f=Math.cos(b)*(i?i/2:g),o=Math.cos(b)*g,a=Math.sin(b)*g,h=Math.sin(b)*(i?i/2:g),t.moveTo(n-f,r-a),t.lineTo(n+f,r+a),t.moveTo(n+h,r-o),t.lineTo(n-h,r+o);break;case"line":o=i?i/2:Math.cos(b)*g,a=Math.sin(b)*g,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(b)*(i?i/2:g),r+Math.sin(b)*g);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function jp(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function yy(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function vy(t){t.restore()}function EK(t,e,n,r,i){if(!e)return t.lineTo(n.x,n.y);if(i==="middle"){const s=(e.x+n.x)/2;t.lineTo(s,e.y),t.lineTo(s,n.y)}else i==="after"!=!!r?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function CK(t,e,n,r){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function PK(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),qn(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function kK(t,e,n,r,i){if(i.strikethrough||i.underline){const s=t.measureText(r),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,d=i.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(o,d),t.lineTo(a,d),t.stroke()}}function TK(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Dp(t,e,n,r,i,s={}){const o=Xr(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(t.save(),t.font=i.string,PK(t,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&TK(t,s.backdrop),a&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),qn(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,n,r,s.maxWidth)),t.fillText(c,n,r,s.maxWidth),kK(t,n,r,c,s),r+=Number(i.lineHeight);t.restore()}function hx(t,e){const{x:n,y:r,w:i,h:s,radius:o}=e;t.arc(n+o.topLeft,r+o.topLeft,o.topLeft,1.5*Dr,Dr,!0),t.lineTo(n,r+s-o.bottomLeft),t.arc(n+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,Dr,si,!0),t.lineTo(n+i-o.bottomRight,r+s),t.arc(n+i-o.bottomRight,r+s-o.bottomRight,o.bottomRight,si,0,!0),t.lineTo(n+i,r+o.topRight),t.arc(n+i-o.topRight,r+o.topRight,o.topRight,0,-si,!0),t.lineTo(n+o.topLeft,r)}const IK=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,jK=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function DK(t,e){const n=(""+t).match(IK);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const RK=t=>+t||0;function y4(t,e){const n={},r=Nn(e),i=r?Object.keys(e):e,s=Nn(t)?r?o=>xn(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of i)n[o]=RK(s(o));return n}function Cj(t){return y4(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Uh(t){return y4(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ko(t){const e=Cj(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ji(t,e){t=t||{},e=e||qr.font;let n=xn(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=xn(t.style,e.style);r&&!(""+r).match(jK)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:xn(t.family,e.family),lineHeight:DK(xn(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:xn(t.weight,e.weight),string:""};return i.string=SK(i),i}function pg(t,e,n,r){let i,s,o;for(i=0,s=t.length;i<s;++i)if(o=t[i],o!==void 0&&o!==void 0)return o}function FK(t,e,n){const{min:r,max:i}=t,s=xj(e,(i-r)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(r,-Math.abs(s)),max:o(i,s)}}function Vd(t,e){return Object.assign(Object.create(t),e)}function v4(t,e=[""],n,r,i=()=>t[0]){const s=n||t;typeof r>"u"&&(r=Ij("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:r,_getTarget:i,override:a=>v4([a,...t],e,s,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return kj(a,l,()=>qK(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return wE(a).includes(l)},ownKeys(a){return wE(a)},set(a,l,c){const d=a._storage||(a._storage=i());return a[l]=d[l]=c,delete a._keys,!0}})}function cf(t,e,n,r){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Pj(t,r),setContext:s=>cf(t,s,n,r),override:s=>cf(t.override(s),e,n,r)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete t[o],!0},get(s,o,a){return kj(s,o,()=>MK(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(s,o,a){return t[o]=a,delete s[o],!0}})}function Pj(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:n,indexable:r,isScriptable:cu(n)?n:()=>n,isIndexable:cu(r)?r:()=>r}}const LK=(t,e)=>t?t+f4(e):e,b4=(t,e)=>Nn(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function kj(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=n();return t[e]=r,r}function MK(t,e,n){const{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=t;let a=r[e];return cu(a)&&o.isScriptable(e)&&(a=BK(e,a,t,n)),Xr(a)&&a.length&&(a=OK(e,a,t,o.isIndexable)),b4(e,a)&&(a=cf(a,i,s&&s[e],o)),a}function BK(t,e,n,r){const{_proxy:i,_context:s,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(s,o||r);return a.delete(t),b4(t,l)&&(l=w4(i._scopes,i,t,l)),l}function OK(t,e,n,r){const{_proxy:i,_context:s,_subProxy:o,_descriptors:a}=n;if(typeof s.index<"u"&&r(t))return e[s.index%e.length];if(Nn(e[0])){const l=e,c=i._scopes.filter(d=>d!==l);e=[];for(const d of l){const f=w4(c,i,t,d);e.push(cf(f,s,o&&o[t],a))}}return e}function Tj(t,e,n){return cu(t)?t(e,n):t}const VK=(t,e)=>t===!0?e:typeof t=="string"?Pd(e,t):void 0;function UK(t,e,n,r,i){for(const s of e){const o=VK(n,s);if(o){t.add(o);const a=Tj(o._fallback,n,i);if(typeof a<"u"&&a!==n&&a!==r)return a}else if(o===!1&&typeof r<"u"&&n!==r)return null}return!1}function w4(t,e,n,r){const i=e._rootScopes,s=Tj(e._fallback,n,r),o=[...t,...i],a=new Set;a.add(r);let l=bE(a,o,n,s||n,r);return l===null||typeof s<"u"&&s!==n&&(l=bE(a,o,s,l,r),l===null)?!1:v4(Array.from(a),[""],i,s,()=>zK(e,n,r))}function bE(t,e,n,r,i){for(;n;)n=UK(t,e,n,r,i);return n}function zK(t,e,n){const r=t._getTarget();e in r||(r[e]={});const i=r[e];return Xr(i)&&Nn(n)?n:i||{}}function qK(t,e,n,r){let i;for(const s of e)if(i=Ij(LK(s,t),n),typeof i<"u")return b4(t,i)?w4(n,r,t,i):i}function Ij(t,e){for(const n of e){if(!n)continue;const r=n[t];if(typeof r<"u")return r}}function wE(t){let e=t._keys;return e||(e=t._keys=HK(t._scopes)),e}function HK(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(i=>!i.startsWith("_")))e.add(r);return Array.from(e)}const WK=Number.EPSILON||1e-14,uf=(t,e)=>e<t.length&&!t[e].skip&&t[e],jj=t=>t==="x"?"y":"x";function $K(t,e,n,r){const i=t.skip?e:t,s=e,o=n.skip?e:n,a=w5(s,i),l=w5(o,s);let c=a/(a+l),d=l/(a+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const f=r*c,h=r*d;return{previous:{x:s.x-f*(o.x-i.x),y:s.y-f*(o.y-i.y)},next:{x:s.x+h*(o.x-i.x),y:s.y+h*(o.y-i.y)}}}function GK(t,e,n){const r=t.length;let i,s,o,a,l,c=uf(t,0);for(let d=0;d<r-1;++d)if(l=c,c=uf(t,d+1),!(!l||!c)){if(I0(e[d],0,WK)){n[d]=n[d+1]=0;continue}i=n[d]/e[d],s=n[d+1]/e[d],a=Math.pow(i,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),n[d]=i*o*e[d],n[d+1]=s*o*e[d])}}function KK(t,e,n="x"){const r=jj(n),i=t.length;let s,o,a,l=uf(t,0);for(let c=0;c<i;++c){if(o=a,a=l,l=uf(t,c+1),!a)continue;const d=a[n],f=a[r];o&&(s=(d-o[n])/3,a[`cp1${n}`]=d-s,a[`cp1${r}`]=f-s*e[c]),l&&(s=(l[n]-d)/3,a[`cp2${n}`]=d+s,a[`cp2${r}`]=f+s*e[c])}}function QK(t,e="x"){const n=jj(e),r=t.length,i=Array(r).fill(0),s=Array(r);let o,a,l,c=uf(t,0);for(o=0;o<r;++o)if(a=l,l=c,c=uf(t,o+1),!!l){if(c){const d=c[e]-l[e];i[o]=d!==0?(c[n]-l[n])/d:0}s[o]=a?c?Va(i[o-1])!==Va(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}GK(t,i,s),KK(t,s,e)}function mg(t,e,n){return Math.max(Math.min(t,n),e)}function YK(t,e){let n,r,i,s,o,a=jp(t[0],e);for(n=0,r=t.length;n<r;++n)o=s,s=a,a=n<r-1&&jp(t[n+1],e),s&&(i=t[n],o&&(i.cp1x=mg(i.cp1x,e.left,e.right),i.cp1y=mg(i.cp1y,e.top,e.bottom)),a&&(i.cp2x=mg(i.cp2x,e.left,e.right),i.cp2y=mg(i.cp2y,e.top,e.bottom)))}function XK(t,e,n,r,i){let s,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")QK(t,i);else{let c=r?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=$K(c,a,t[Math.min(s+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&YK(t,n)}function _4(){return typeof window<"u"&&typeof document<"u"}function N4(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function fx(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const by=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function JK(t,e){return by(t).getPropertyValue(e)}const ZK=["top","right","bottom","left"];function nd(t,e,n){const r={};n=n?"-"+n:"";for(let i=0;i<4;i++){const s=ZK[i];r[s]=parseFloat(t[e+"-"+s+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const eQ=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function tQ(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:i,offsetY:s}=r;let o=!1,a,l;if(eQ(i,s,t.target))a=i,l=s;else{const c=e.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Bu(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,i=by(n),s=i.boxSizing==="border-box",o=nd(i,"padding"),a=nd(i,"border","width"),{x:l,y:c,box:d}=tQ(t,n),f=o.left+(d&&a.left),h=o.top+(d&&a.top);let{width:p,height:m}=e;return s&&(p-=o.width+a.width,m-=o.height+a.height),{x:Math.round((l-f)/p*n.width/r),y:Math.round((c-h)/m*n.height/r)}}function nQ(t,e,n){let r,i;if(e===void 0||n===void 0){const s=t&&N4(t);if(!s)e=t.clientWidth,n=t.clientHeight;else{const o=s.getBoundingClientRect(),a=by(s),l=nd(a,"border","width"),c=nd(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,r=fx(a.maxWidth,s,"clientWidth"),i=fx(a.maxHeight,s,"clientHeight")}}return{width:e,height:n,maxWidth:r||dx,maxHeight:i||dx}}const gg=t=>Math.round(t*10)/10;function rQ(t,e,n,r){const i=by(t),s=nd(i,"margin"),o=fx(i.maxWidth,t,"clientWidth")||dx,a=fx(i.maxHeight,t,"clientHeight")||dx,l=nQ(t,e,n);let{width:c,height:d}=l;if(i.boxSizing==="content-box"){const h=nd(i,"border","width"),p=nd(i,"padding");c-=p.width+h.width,d-=p.height+h.height}return c=Math.max(0,c-s.width),d=Math.max(0,r?c/r:d-s.height),c=gg(Math.min(c,o,l.maxWidth)),d=gg(Math.min(d,a,l.maxHeight)),c&&!d&&(d=gg(c/2)),(e!==void 0||n!==void 0)&&r&&l.height&&d>l.height&&(d=l.height,c=gg(Math.floor(d*r))),{width:c,height:d}}function _E(t,e,n){const r=e||1,i=Math.floor(t.height*r),s=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||o.height!==i||o.width!==s?(t.currentDevicePixelRatio=r,o.height=i,o.width=s,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const iQ=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};_4()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function NE(t,e){const n=JK(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Ou(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function sQ(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:r==="middle"?n<.5?t.y:e.y:r==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function oQ(t,e,n,r){const i={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},o=Ou(t,i,n),a=Ou(i,s,n),l=Ou(s,e,n),c=Ou(o,a,n),d=Ou(a,l,n);return Ou(c,d,n)}const aQ=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},lQ=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function zh(t,e,n){return t?aQ(e,n):lQ()}function Dj(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function Rj(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Fj(t){return t==="angle"?{between:Ip,compare:lK,normalize:Aa}:{between:Cl,compare:(e,n)=>e-n,normalize:e=>e}}function AE({start:t,end:e,count:n,loop:r,style:i}){return{start:t%n,end:e%n,loop:r&&(e-t+1)%n===0,style:i}}function cQ(t,e,n){const{property:r,start:i,end:s}=n,{between:o,normalize:a}=Fj(r),l=e.length;let{start:c,end:d,loop:f}=t,h,p;if(f){for(c+=l,d+=l,h=0,p=l;h<p&&o(a(e[c%l][r]),i,s);++h)c--,d--;c%=l,d%=l}return d<c&&(d+=l),{start:c,end:d,loop:f,style:t.style}}function Lj(t,e,n){if(!n)return[t];const{property:r,start:i,end:s}=n,o=e.length,{compare:a,between:l,normalize:c}=Fj(r),{start:d,end:f,loop:h,style:p}=cQ(t,e,n),m=[];let g=!1,b=null,x,w,N;const E=()=>l(i,N,x)&&a(i,N)!==0,D=()=>a(s,x)===0||l(s,N,x),j=()=>g||E(),C=()=>!g||D();for(let v=d,A=d;v<=f;++v)w=e[v%o],!w.skip&&(x=c(w[r]),x!==N&&(g=l(x,i,s),b===null&&j()&&(b=a(x,i)===0?v:A),b!==null&&C()&&(m.push(AE({start:b,end:v,loop:h,count:o,style:p})),b=null),A=v,N=x));return b!==null&&m.push(AE({start:b,end:f,loop:h,count:o,style:p})),m}function Mj(t,e){const n=[],r=t.segments;for(let i=0;i<r.length;i++){const s=Lj(r[i],t.points,e);s.length&&n.push(...s)}return n}function uQ(t,e,n,r){let i=0,s=e-1;if(n&&!r)for(;i<e&&!t[i].skip;)i++;for(;i<e&&t[i].skip;)i++;for(i%=e,n&&(s+=i);s>i&&t[s%e].skip;)s--;return s%=e,{start:i,end:s}}function dQ(t,e,n,r){const i=t.length,s=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%i];c.skip||c.stop?a.skip||(r=!1,s.push({start:e%i,end:(l-1)%i,loop:r}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%i,end:o%i,loop:r}),s}function hQ(t,e){const n=t.points,r=t.options.spanGaps,i=n.length;if(!i)return[];const s=!!t._loop,{start:o,end:a}=uQ(n,i,s,r);if(r===!0)return SE(t,[{start:o,end:a,loop:s}],n,e);const l=a<o?a+i:a,c=!!t._fullLoop&&o===0&&a===i-1;return SE(t,dQ(n,o,l,c),n,e)}function SE(t,e,n,r){return!r||!r.setContext||!n?e:fQ(t,e,n,r)}function fQ(t,e,n,r){const i=t._chart.getContext(),s=EE(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let d=s,f=e[0].start,h=f;function p(m,g,b,x){const w=a?-1:1;if(m!==g){for(m+=l;n[m%l].skip;)m-=w;for(;n[g%l].skip;)g+=w;m%l!==g%l&&(c.push({start:m%l,end:g%l,loop:b,style:x}),d=x,f=g%l)}}for(const m of e){f=a?f:m.start;let g=n[f%l],b;for(h=f+1;h<=m.end;h++){const x=n[h%l];b=EE(r.setContext(Vd(i,{type:"segment",p0:g,p1:x,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:o}))),pQ(b,d)&&p(f,h-1,m.loop,d),g=x,d=b}f<h-1&&p(f,h-1,m.loop,d)}return c}function EE(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function pQ(t,e){if(!e)return!1;const n=[],r=function(i,s){return g4(s)?(n.includes(s)||n.push(s),n.indexOf(s)):s};return JSON.stringify(t,r)!==JSON.stringify(e,r)}function xg(t,e,n){return t.options.clip?t[n]:e[n]}function mQ(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:xg(n,e,"left"),right:xg(n,e,"right"),top:xg(r,e,"top"),bottom:xg(r,e,"bottom")}:e}function Bj(t,e){const n=e._clip;if(n.disabled)return!1;const r=mQ(e,t.chartArea);return{left:n.left===!1?0:r.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:r.right+(n.right===!0?0:n.right),top:n.top===!1?0:r.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:r.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class gQ{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,i){const s=n.listeners[i],o=n.duration;s.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(r-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=_j.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,r,e,"progress")),s.length||(r.running=!1,this._notify(i,r,e,"complete"),r.initial=!1),n+=s.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ml=new gQ;const CE="transparent",xQ={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=gE(t||CE),i=r.valid&&gE(e||CE);return i&&i.valid?i.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class yQ{constructor(e,n,r,i){const s=n[r];i=pg([e.to,i,s,e.from]);const o=pg([e.from,s,i]);this._active=!0,this._fn=e.fn||xQ[e.type||typeof o],this._easing=j0[e.easing]||j0.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=pg([e.to,n,i,e.from]),this._from=pg([e.from,i,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,i=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||n<r),!this._active){this._target[i]=a,this._notify(!0);return}if(n<0){this._target[i]=s;return}l=n/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][n]()}}class Oj{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Nn(e))return;const n=Object.keys(qr.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Nn(s))return;const o={};for(const a of n)o[a]=s[a];(Xr(s.properties)&&s.properties||[i]).forEach(a=>{(a===i||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,n){const r=n.options,i=bQ(e,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&vQ(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,n){const r=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(e,n));continue}const d=n[c];let f=s[c];const h=r.get(c);if(f)if(h&&f.active()){f.update(h,d,a);continue}else f.cancel();if(!h||!h.duration){e[c]=d;continue}s[c]=f=new yQ(h,e,c,d),i.push(f)}return i}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return ml.add(this._chart,r),!0}}function vQ(t,e){const n=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const s=t[r[i]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function bQ(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function PE(t,e){const n=t&&t.options||{},r=n.reverse,i=n.min===void 0?e:0,s=n.max===void 0?e:0;return{start:r?s:i,end:r?i:s}}function wQ(t,e,n){if(n===!1)return!1;const r=PE(t,n),i=PE(e,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function _Q(t){let e,n,r,i;return Nn(t)?(e=t.top,n=t.right,r=t.bottom,i=t.left):e=n=r=i=t,{top:e,right:n,bottom:r,left:i,disabled:t===!1}}function Vj(t,e){const n=[],r=t._getSortedDatasetMetas(e);let i,s;for(i=0,s=r.length;i<s;++i)n.push(r[i].index);return n}function kE(t,e,n,r={}){const i=t.keys,s=r.mode==="single";let o,a,l,c;if(e===null)return;let d=!1;for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===n){if(d=!0,r.all)continue;break}c=t.values[l],ts(c)&&(s||e===0||Va(e)===Va(c))&&(e+=c)}return!d&&!r.all?0:e}function NQ(t,e){const{iScale:n,vScale:r}=e,i=n.axis==="x"?"x":"y",s=r.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,d;for(l=0,c=o.length;l<c;++l)d=o[l],a[l]={[i]:d,[s]:t[d]};return a}function b2(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function AQ(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function SQ(t){const{min:e,max:n,minDefined:r,maxDefined:i}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}function EQ(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function TE(t,e,n,r){for(const i of e.getMatchingVisibleMetas(r).reverse()){const s=t[i.index];if(n&&s>0||!n&&s<0)return i.index}return null}function IE(t,e){const{chart:n,_cachedMeta:r}=t,i=n._stacks||(n._stacks={}),{iScale:s,vScale:o,index:a}=r,l=s.axis,c=o.axis,d=AQ(s,o,r),f=e.length;let h;for(let p=0;p<f;++p){const m=e[p],{[l]:g,[c]:b}=m,x=m._stacks||(m._stacks={});h=x[c]=EQ(i,d,g),h[a]=b,h._top=TE(h,o,!0,r.type),h._bottom=TE(h,o,!1,r.type);const w=h._visualValues||(h._visualValues={});w[a]=b}}function w2(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function CQ(t,e){return Vd(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function PQ(t,e,n){return Vd(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Kf(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const i of e){const s=i._stacks;if(!s||s[r]===void 0||s[r][n]===void 0)return;delete s[r][n],s[r]._visualValues!==void 0&&s[r]._visualValues[n]!==void 0&&delete s[r]._visualValues[n]}}}const _2=t=>t==="reset"||t==="none",jE=(t,e)=>e?t:Object.assign({},t),kQ=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Vj(n,!0),values:null};class rd{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=b2(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Kf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),i=(f,h,p,m)=>f==="x"?h:f==="r"?m:p,s=n.xAxisID=xn(r.xAxisID,w2(e,"x")),o=n.yAxisID=xn(r.yAxisID,w2(e,"y")),a=n.rAxisID=xn(r.rAxisID,w2(e,"r")),l=n.indexAxis,c=n.iAxisID=i(l,s,o,a),d=n.vAxisID=i(l,o,s,a);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&fE(this._data,this),e._stacked&&Kf(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(Nn(n)){const i=this._cachedMeta;this._data=NQ(n,i)}else if(r!==n){if(r){fE(r,this);const i=this._cachedMeta;Kf(i),i._parsed=[]}n&&Object.isExtensible(n)&&hK(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=n._stacked;n._stacked=b2(n.vScale,n),n.stack!==r.stack&&(i=!0,Kf(n),n.stack=r.stack),this._resyncElements(e),(i||s!==n._stacked)&&(IE(this,n._parsed),n._stacked=b2(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:o}=r,a=s.axis;let l=e===0&&n===i.length?!0:r._sorted,c=e>0&&r._parsed[e-1],d,f,h;if(this._parsing===!1)r._parsed=i,r._sorted=!0,h=i;else{Xr(i[e])?h=this.parseArrayData(r,i,e,n):Nn(i[e])?h=this.parseObjectData(r,i,e,n):h=this.parsePrimitiveData(r,i,e,n);const p=()=>f[a]===null||c&&f[a]<c[a];for(d=0;d<n;++d)r._parsed[d+e]=f=h[d],l&&(p()&&(l=!1),c=f);r._sorted=l}o&&IE(this,h)}parsePrimitiveData(e,n,r,i){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),d=s===o,f=new Array(i);let h,p,m;for(h=0,p=i;h<p;++h)m=h+r,f[h]={[a]:d||s.parse(c[m],m),[l]:o.parse(n[m],m)};return f}parseArrayData(e,n,r,i){const{xScale:s,yScale:o}=e,a=new Array(i);let l,c,d,f;for(l=0,c=i;l<c;++l)d=l+r,f=n[d],a[l]={x:s.parse(f[0],d),y:o.parse(f[1],d)};return a}parseObjectData(e,n,r,i){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let d,f,h,p;for(d=0,f=i;d<f;++d)h=d+r,p=n[h],c[d]={x:s.parse(Pd(p,a),h),y:o.parse(Pd(p,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const i=this.chart,s=this._cachedMeta,o=n[e.axis],a={keys:Vj(i,!0),values:n._stacks[e.axis]._visualValues};return kE(a,o,s.index,{mode:r})}updateRangeFromParsed(e,n,r,i){const s=r[n.axis];let o=s===null?NaN:s;const a=i&&r._stacks[n.axis];i&&a&&(i.values=a,o=kE(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&e===r.iScale,o=i.length,a=this._getOtherScale(e),l=kQ(n,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:f}=SQ(a);let h,p;function m(){p=i[h];const g=p[a.axis];return!ts(p[e.axis])||d>g||f<g}for(h=0;h<o&&!(!m()&&(this.updateRangeFromParsed(c,e,p,l),s));++h);if(s){for(h=o-1;h>=0;--h)if(!m()){this.updateRangeFromParsed(c,e,p,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let i,s,o;for(i=0,s=n.length;i<s;++i)o=n[i][e.axis],ts(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,i=n.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=_Q(xn(this.options.clip,wQ(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,i=r.data||[],s=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let d;for(r.dataset&&r.dataset.draw(e,s,a,l),d=a;d<a+l;++d){const f=i[d];f.hidden||(f.active&&c?o.push(f):f.draw(e,s))}for(d=0;d<o.length;++d)o[d].draw(e,s)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=PQ(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=CQ(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const i=n==="active",s=this._cachedDataOpts,o=e+"-"+n,a=s[o],l=this.enableOptionSharing&&kp(r);if(a)return jE(a,l);const c=this.chart.config,d=c.datasetElementScopeKeys(this._type,e),f=i?[`${e}Hover`,"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),d),p=Object.keys(qr.elements[e]),m=()=>this.getContext(r,i,n),g=c.resolveNamedOptions(h,p,m,f);return g.$shared&&(g.$shared=l,s[o]=Object.freeze(jE(g,l))),g}_resolveAnimations(e,n,r){const i=this.chart,s=this._cachedDataOpts,o=`animation-${n}`,a=s[o];if(a)return a;let l;if(i.options.animation!==!1){const d=this.chart.config,f=d.datasetAnimationScopeKeys(this._type,n),h=d.getOptionScopes(this.getDataset(),f);l=d.createResolver(h,this.getContext(e,r,n))}const c=new Oj(i,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||_2(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const r=this.resolveDataElementOptions(e,n),i=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(n,s)||s!==i;return this.updateSharedOptions(s,n,r),{sharedOptions:s,includeOptions:o}}updateElement(e,n,r,i){_2(i)?Object.assign(e,r):this._resolveAnimations(n,i).update(e,r)}updateSharedOptions(e,n,r){e&&!_2(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,i){e.active=i;const s=this.getStyle(n,i);this._resolveAnimations(n,r,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=r.length,s=n.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,n,r=!0){const i=this._cachedMeta,s=i.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,n),r&&this.updateElements(s,e,n,"reset")}updateElements(e,n,r,i){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(e,n);r._stacked&&Kf(r,i)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,i]=e;this[n](r,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Lt(rd,"defaults",{}),Lt(rd,"datasetElementType",null),Lt(rd,"dataElementType",null);function TQ(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let i=0,s=n.length;i<s;i++)r=r.concat(n[i].controller.getAllParsedValues(t));t._cache.$bar=wj(r.sort((i,s)=>i-s))}return t._cache.$bar}function IQ(t){const e=t.iScale,n=TQ(e,t.type);let r=e._length,i,s,o,a;const l=()=>{o===32767||o===-32768||(kp(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(i=0,s=n.length;i<s;++i)o=e.getPixelForValue(n[i]),l();for(a=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),l();return r}function jQ(t,e,n,r){const i=n.barThickness;let s,o;return qn(i)?(s=e.min*n.categoryPercentage,o=n.barPercentage):(s=i*r,o=1),{chunk:s/r,ratio:o,start:e.pixels[t]-s/2}}function DQ(t,e,n,r){const i=e.pixels,s=i[t];let o=t>0?i[t-1]:null,a=t<i.length-1?i[t+1]:null;const l=n.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/r,ratio:n.barPercentage,start:c}}function RQ(t,e,n,r){const i=n.parse(t[0],r),s=n.parse(t[1],r),o=Math.min(i,s),a=Math.max(i,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:i,end:s,min:o,max:a}}function Uj(t,e,n,r){return Xr(t)?RQ(t,e,n,r):e[n.axis]=n.parse(t,r),e}function DE(t,e,n,r){const i=t.iScale,s=t.vScale,o=i.getLabels(),a=i===s,l=[];let c,d,f,h;for(c=n,d=n+r;c<d;++c)h=e[c],f={},f[i.axis]=a||i.parse(o[c],c),l.push(Uj(h,f,s,c));return l}function N2(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function FQ(t,e,n){return t!==0?Va(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function LQ(t){let e,n,r,i,s;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(i="end",s="start"):(i="start",s="end"),{start:n,end:r,reverse:e,top:i,bottom:s}}function MQ(t,e,n,r){let i=e.borderSkipped;const s={};if(!i){t.borderSkipped=s;return}if(i===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:d}=LQ(t);i==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?i=c:(n._bottom||0)===r?i=d:(s[RE(d,o,a,l)]=!0,i=c)),s[RE(i,o,a,l)]=!0,t.borderSkipped=s}function RE(t,e,n,r){return r?(t=BQ(t,e,n),t=FE(t,n,e)):t=FE(t,e,n),t}function BQ(t,e,n){return t===e?n:t===n?e:t}function FE(t,e,n){return t==="start"?e:t==="end"?n:t}function OQ(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class n1 extends rd{parsePrimitiveData(e,n,r,i){return DE(e,n,r,i)}parseArrayData(e,n,r,i){return DE(e,n,r,i)}parseObjectData(e,n,r,i){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,d=o.axis==="x"?a:l,f=[];let h,p,m,g;for(h=r,p=r+i;h<p;++h)g=n[h],m={},m[s.axis]=s.parse(Pd(g,c),h),f.push(Uj(Pd(g,d),m,o,h));return f}updateRangeFromParsed(e,n,r,i){super.updateRangeFromParsed(e,n,r,i);const s=r._custom;s&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:r,vScale:i}=n,s=this.getParsed(e),o=s._custom,a=N2(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),d=this._getRuler(),{sharedOptions:f,includeOptions:h}=this._getSharedOptions(n,i);for(let p=n;p<n+r;p++){const m=this.getParsed(p),g=s||qn(m[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),b=this._calculateBarIndexPixels(p,d),x=(m._stacks||{})[a.axis],w={horizontal:c,base:g.base,enableBorderRadius:!x||N2(m._custom)||o===x._top||o===x._bottom,x:c?g.head:b.center,y:c?b.center:g.head,height:c?b.size:Math.abs(g.size),width:c?Math.abs(g.size):b.size};h&&(w.options=f||this.resolveDataElementOptions(p,e[p].active?"active":i));const N=w.options||e[p].options;MQ(w,N,x,o),OQ(w,N,d.ratio),this.updateElement(e[p],p,w,i)}}_getStacks(e,n){const{iScale:r}=this._cachedMeta,i=r.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),s=r.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[r.axis],c=d=>{const f=d._parsed.find(p=>p[r.axis]===l),h=f&&f[d.vScale.axis];if(qn(h)||isNaN(h))return!0};for(const d of i)if(!(n!==void 0&&c(d))&&((s===!1||o.indexOf(d.stack)===-1||s===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,n,r){const i=this._getStacks(e,r),s=n!==void 0?i.indexOf(n):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,n=this._cachedMeta,r=n.iScale,i=[];let s,o;for(s=0,o=n.data.length;s<o;++s)i.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const a=e.barThickness;return{min:a||IQ(n),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:r,index:i},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,d=N2(c);let f=l[n.axis],h=0,p=r?this.applyStack(n,l,r):f,m,g;p!==f&&(h=p-f,p=f),d&&(f=c.barStart,p=c.barEnd-c.barStart,f!==0&&Va(f)!==Va(c.barEnd)&&(h=0),h+=f);const b=!qn(s)&&!d?s:h;let x=n.getPixelForValue(b);if(this.chart.getDataVisibility(e)?m=n.getPixelForValue(h+p):m=x,g=m-x,Math.abs(g)<o){g=FQ(g,n,a)*o,f===a&&(x-=g/2);const w=n.getPixelForDecimal(0),N=n.getPixelForDecimal(1),E=Math.min(w,N),D=Math.max(w,N);x=Math.max(Math.min(x,D),E),m=x+g,r&&!d&&(l._stacks[n.axis]._visualValues[i]=n.getValueForPixel(m)-n.getValueForPixel(x))}if(x===n.getPixelForValue(a)){const w=Va(g)*n.getLineWidthForValue(a)/2;x+=w,g-=w}return{size:g,base:x,head:m,center:m+g/2}}_calculateBarIndexPixels(e,n){const r=n.scale,i=this.options,s=i.skipNull,o=xn(i.maxBarThickness,1/0);let a,l;if(n.grouped){const c=s?this._getStackCount(e):n.stackCount,d=i.barThickness==="flex"?DQ(e,n,i,c):jQ(e,n,i,c),f=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);a=d.start+d.chunk*f+d.chunk/2,l=Math.min(o,d.chunk*d.ratio)}else a=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,r=e.data,i=r.length;let s=0;for(;s<i;++s)this.getParsed(s)[n.axis]!==null&&!r[s].hidden&&r[s].draw(this._ctx)}}Lt(n1,"id","bar"),Lt(n1,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Lt(n1,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function VQ(t,e,n){let r=1,i=1,s=0,o=0;if(e<Ar){const a=t,l=a+e,c=Math.cos(a),d=Math.sin(a),f=Math.cos(l),h=Math.sin(l),p=(N,E,D)=>Ip(N,a,l,!0)?1:Math.max(E,E*n,D,D*n),m=(N,E,D)=>Ip(N,a,l,!0)?-1:Math.min(E,E*n,D,D*n),g=p(0,c,f),b=p(si,d,h),x=m(Dr,c,f),w=m(Dr+si,d,h);r=(g-x)/2,i=(b-w)/2,s=-(g+x)/2,o=-(b+w)/2}return{ratioX:r,ratioY:i,offsetX:s,offsetY:o}}class Ph extends rd{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const r=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=r;else{let s=l=>+r[l];if(Nn(r[e])){const{key:l="value"}=this._parsing;s=c=>+Pd(r[c],l)}let o,a;for(o=e,a=e+n;o<a;++o)i._parsed[o]=s(o)}}_getRotation(){return El(this.options.rotation-90)}_getCircumference(){return El(this.options.circumference)}_getRotationExtents(){let e=Ar,n=-Ar;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const i=this.chart.getDatasetMeta(r).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),n=Math.max(n,s+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:r}=n,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(r.width,r.height)-o)/2,0),l=Math.min(QG(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:d,rotation:f}=this._getRotationExtents(),{ratioX:h,ratioY:p,offsetX:m,offsetY:g}=VQ(f,d,l),b=(r.width-o)/h,x=(r.height-o)/p,w=Math.max(Math.min(b,x)/2,0),N=xj(this.options.radius,w),E=Math.max(N*l,0),D=(N-E)/this._getVisibleDatasetWeightTotal();this.offsetX=m*N,this.offsetY=g*N,i.total=this.calculateTotal(),this.outerRadius=N-D*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-D*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,n){const r=this.options,i=this._cachedMeta,s=this._getCircumference();return n&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/Ar)}updateElements(e,n,r,i){const s=i==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,d=(a.left+a.right)/2,f=(a.top+a.bottom)/2,h=s&&c.animateScale,p=h?0:this.innerRadius,m=h?0:this.outerRadius,{sharedOptions:g,includeOptions:b}=this._getSharedOptions(n,i);let x=this._getRotation(),w;for(w=0;w<n;++w)x+=this._circumference(w,s);for(w=n;w<n+r;++w){const N=this._circumference(w,s),E=e[w],D={x:d+this.offsetX,y:f+this.offsetY,startAngle:x,endAngle:x+N,circumference:N,outerRadius:m,innerRadius:p};b&&(D.options=g||this.resolveDataElementOptions(w,E.active?"active":i)),x+=N,this.updateElement(E,w,D,i)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let r=0,i;for(i=0;i<n.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!n[i].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Ar*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,r=this.chart,i=r.data.labels||[],s=x4(n._parsed[e],r.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let n=0;const r=this.chart;let i,s,o,a,l;if(!e){for(i=0,s=r.data.datasets.length;i<s;++i)if(r.isDatasetVisible(i)){o=r.getDatasetMeta(i),e=o.data,a=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)l=a.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let r=0,i=e.length;r<i;++r){const s=this.resolveDataElementOptions(r);n=Math.max(n,s.offset||0,s.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(n+=this._getRingWeight(r));return n}_getRingWeight(e){return Math.max(xn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Lt(Ph,"id","doughnut"),Lt(Ph,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Lt(Ph,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Lt(Ph,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:r,color:i}}=e.legend.options;return n.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}}});class r1 extends rd{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=mK(n,i,o);this._drawStart=a,this._drawCount=l,gK(n)&&(a=0,l=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},e),this.updateElements(i,a,l,e)}updateElements(e,n,r,i){const s=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:d,includeOptions:f}=this._getSharedOptions(n,i),h=o.axis,p=a.axis,{spanGaps:m,segment:g}=this.options,b=Tp(m)?m:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||s||i==="none",w=n+r,N=e.length;let E=n>0&&this.getParsed(n-1);for(let D=0;D<N;++D){const j=e[D],C=x?j:{};if(D<n||D>=w){C.skip=!0;continue}const v=this.getParsed(D),A=qn(v[p]),I=C[h]=o.getPixelForValue(v[h],D),S=C[p]=s||A?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,v,l):v[p],D);C.skip=isNaN(I)||isNaN(S)||A,C.stop=D>0&&Math.abs(v[h]-E[h])>b,g&&(C.parsed=v,C.raw=c.data[D]),f&&(C.options=d||this.resolveDataElementOptions(D,j.active?"active":i)),x||this.updateElement(j,D,C,i),E=v}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,r=n.options&&n.options.borderWidth||0,i=e.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Lt(r1,"id","line"),Lt(r1,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Lt(r1,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class A5 extends Ph{}Lt(A5,"id","pie"),Lt(A5,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function ju(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class A4{constructor(e){Lt(this,"options");this.options=e||{}}static override(e){Object.assign(A4.prototype,e)}init(){}formats(){return ju()}parse(){return ju()}format(){return ju()}add(){return ju()}diff(){return ju()}startOf(){return ju()}endOf(){return ju()}}var UQ={_date:A4};function zQ(t,e,n,r){const{controller:i,data:s,_sorted:o}=t,a=i._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const c=a._reversePixels?uK:Qu;if(r){if(i._sharedOptions){const d=s[0],f=typeof d.getRange=="function"&&d.getRange(e);if(f){const h=c(s,e,n-f),p=c(s,e,n+f);return{lo:h.lo,hi:p.hi}}}}else{const d=c(s,e,n);if(l){const{vScale:f}=i._cachedMeta,{_parsed:h}=t,p=h.slice(0,d.lo+1).reverse().findIndex(g=>!qn(g[f.axis]));d.lo-=Math.max(0,p);const m=h.slice(d.hi).findIndex(g=>!qn(g[f.axis]));d.hi+=Math.max(0,m)}return d}}return{lo:0,hi:s.length-1}}function pm(t,e,n,r,i){const s=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:d}=s[a],{lo:f,hi:h}=zQ(s[a],e,o,i);for(let p=f;p<=h;++p){const m=d[p];m.skip||r(m,c,p)}}}function qQ(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,i){const s=e?Math.abs(r.x-i.x):0,o=n?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function A2(t,e,n,r,i){const s=[];return!i&&!t.isPointInArea(e)||pm(t,n,e,function(a,l,c){!i&&!jp(a,t.chartArea,0)||a.inRange(e.x,e.y,r)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function HQ(t,e,n,r){let i=[];function s(o,a,l){const{startAngle:c,endAngle:d}=o.getProps(["startAngle","endAngle"],r),{angle:f}=vj(o,{x:e.x,y:e.y});Ip(f,c,d)&&i.push({element:o,datasetIndex:a,index:l})}return pm(t,n,e,s),i}function WQ(t,e,n,r,i,s){let o=[];const a=qQ(n);let l=Number.POSITIVE_INFINITY;function c(d,f,h){const p=d.inRange(e.x,e.y,i);if(r&&!p)return;const m=d.getCenterPoint(i);if(!(!!s||t.isPointInArea(m))&&!p)return;const b=a(e,m);b<l?(o=[{element:d,datasetIndex:f,index:h}],l=b):b===l&&o.push({element:d,datasetIndex:f,index:h})}return pm(t,n,e,c),o}function S2(t,e,n,r,i,s){return!s&&!t.isPointInArea(e)?[]:n==="r"&&!r?HQ(t,e,n,i):WQ(t,e,n,r,i,s)}function LE(t,e,n,r,i){const s=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return pm(t,n,e,(l,c,d)=>{l[o]&&l[o](e[n],i)&&(s.push({element:l,datasetIndex:c,index:d}),a=a||l.inRange(e.x,e.y,i))}),r&&!a?[]:s}var $Q={evaluateInteractionItems:pm,modes:{index(t,e,n,r){const i=Bu(e,t),s=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?A2(t,i,s,r,o):S2(t,i,s,!1,r,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const d=a[0].index,f=c.data[d];f&&!f.skip&&l.push({element:f,datasetIndex:c.index,index:d})}),l):[]},dataset(t,e,n,r){const i=Bu(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?A2(t,i,s,r,o):S2(t,i,s,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let d=0;d<c.length;++d)a.push({element:c[d],datasetIndex:l,index:d})}return a},point(t,e,n,r){const i=Bu(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;return A2(t,i,s,r,o)},nearest(t,e,n,r){const i=Bu(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;return S2(t,i,s,n.intersect,r,o)},x(t,e,n,r){const i=Bu(e,t);return LE(t,i,"x",n.intersect,r)},y(t,e,n,r){const i=Bu(e,t);return LE(t,i,"y",n.intersect,r)}}};const zj=["left","top","right","bottom"];function Qf(t,e){return t.filter(n=>n.pos===e)}function ME(t,e){return t.filter(n=>zj.indexOf(n.pos)===-1&&n.box.axis===e)}function Yf(t,e){return t.sort((n,r)=>{const i=e?r:n,s=e?n:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function GQ(t){const e=[];let n,r,i,s,o,a;for(n=0,r=(t||[]).length;n<r;++n)i=t[n],{position:s,options:{stack:o,stackWeight:a=1}}=i,e.push({index:n,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:a});return e}function KQ(t){const e={};for(const n of t){const{stack:r,pos:i,stackWeight:s}=n;if(!r||!zj.includes(i))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function QQ(t,e){const n=KQ(t),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let s,o,a;for(s=0,o=t.length;s<o;++s){a=t[s];const{fullSize:l}=a.box,c=n[a.stack],d=c&&a.stackWeight/c.weight;a.horizontal?(a.width=d?d*r:l&&e.availableWidth,a.height=i):(a.width=r,a.height=d?d*i:l&&e.availableHeight)}return n}function YQ(t){const e=GQ(t),n=Yf(e.filter(c=>c.box.fullSize),!0),r=Yf(Qf(e,"left"),!0),i=Yf(Qf(e,"right")),s=Yf(Qf(e,"top"),!0),o=Yf(Qf(e,"bottom")),a=ME(e,"x"),l=ME(e,"y");return{fullSize:n,leftAndTop:r.concat(s),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:Qf(e,"chartArea"),vertical:r.concat(i).concat(l),horizontal:s.concat(o).concat(a)}}function BE(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function qj(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function XQ(t,e,n,r){const{pos:i,box:s}=n,o=t.maxPadding;if(!Nn(i)){n.size&&(t[i]-=n.size);const f=r[n.stack]||{size:0,count:1};f.size=Math.max(f.size,n.horizontal?s.height:s.width),n.size=f.size/f.count,t[i]+=n.size}s.getPadding&&qj(o,s.getPadding());const a=Math.max(0,e.outerWidth-BE(o,t,"left","right")),l=Math.max(0,e.outerHeight-BE(o,t,"top","bottom")),c=a!==t.w,d=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:d}:{same:d,other:c}}function JQ(t){const e=t.maxPadding;function n(r){const i=Math.max(e[r]-t[r],0);return t[r]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function ZQ(t,e){const n=e.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],n[o])}),s}return r(t?["left","right"]:["top","bottom"])}function h0(t,e,n,r){const i=[];let s,o,a,l,c,d;for(s=0,o=t.length,c=0;s<o;++s){a=t[s],l=a.box,l.update(a.width||e.w,a.height||e.h,ZQ(a.horizontal,e));const{same:f,other:h}=XQ(e,n,a,r);c|=f&&i.length,d=d||h,l.fullSize||i.push(a)}return c&&h0(i,e,n,r)||d}function yg(t,e,n,r,i){t.top=n,t.left=e,t.right=e+r,t.bottom=n+i,t.width=r,t.height=i}function OE(t,e,n,r){const i=n.padding;let{x:s,y:o}=e;for(const a of t){const l=a.box,c=r[a.stack]||{count:1,placed:0,weight:1},d=a.stackWeight/c.weight||1;if(a.horizontal){const f=e.w*d,h=c.size||l.height;kp(c.start)&&(o=c.start),l.fullSize?yg(l,i.left,o,n.outerWidth-i.right-i.left,h):yg(l,e.left+c.placed,o,f,h),c.start=o,c.placed+=f,o=l.bottom}else{const f=e.h*d,h=c.size||l.width;kp(c.start)&&(s=c.start),l.fullSize?yg(l,s,i.top,h,n.outerHeight-i.bottom-i.top):yg(l,s,e.top+c.placed,h,f),c.start=s,c.placed+=f,s=l.right}}e.x=s,e.y=o}var No={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const i=ko(t.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(n-i.height,0),a=YQ(t.boxes),l=a.vertical,c=a.horizontal;Kn(t.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const d=l.reduce((g,b)=>b.box.options&&b.box.options.display===!1?g:g+1,0)||1,f=Object.freeze({outerWidth:e,outerHeight:n,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/d,hBoxMaxHeight:o/2}),h=Object.assign({},i);qj(h,ko(r));const p=Object.assign({maxPadding:h,w:s,h:o,x:i.left,y:i.top},i),m=QQ(l.concat(c),f);h0(a.fullSize,p,f,m),h0(l,p,f,m),h0(c,p,f,m)&&h0(l,p,f,m),JQ(p),OE(a.leftAndTop,p,f,m),p.x+=p.w,p.y+=p.h,OE(a.rightAndBottom,p,f,m),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Kn(a.chartArea,g=>{const b=g.box;Object.assign(b,t.chartArea),b.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class Hj{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,i){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,i?Math.floor(n/i):r)}}isAttached(e){return!0}updateConfig(e){}}class eY extends Hj{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const i1="$chartjs",tY={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},VE=t=>t===null||t==="";function nY(t,e){const n=t.style,r=t.getAttribute("height"),i=t.getAttribute("width");if(t[i1]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",VE(i)){const s=NE(t,"width");s!==void 0&&(t.width=s)}if(VE(r))if(t.style.height==="")t.height=t.width/(e||2);else{const s=NE(t,"height");s!==void 0&&(t.height=s)}return t}const Wj=iQ?{passive:!0}:!1;function rY(t,e,n){t&&t.addEventListener(e,n,Wj)}function iY(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Wj)}function sY(t,e){const n=tY[t.type]||t.type,{x:r,y:i}=Bu(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:i!==void 0?i:null}}function px(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function oY(t,e,n){const r=t.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||px(a.addedNodes,r),o=o&&!px(a.removedNodes,r);o&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function aY(t,e,n){const r=t.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||px(a.removedNodes,r),o=o&&!px(a.addedNodes,r);o&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}const Rp=new Map;let UE=0;function $j(){const t=window.devicePixelRatio;t!==UE&&(UE=t,Rp.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function lY(t,e){Rp.size||window.addEventListener("resize",$j),Rp.set(t,e)}function cY(t){Rp.delete(t),Rp.size||window.removeEventListener("resize",$j)}function uY(t,e,n){const r=t.canvas,i=r&&N4(r);if(!i)return;const s=Nj((a,l)=>{const c=i.clientWidth;n(a,l),c<i.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,d=l.contentRect.height;c===0&&d===0||s(c,d)});return o.observe(i),lY(t,s),o}function E2(t,e,n){n&&n.disconnect(),e==="resize"&&cY(t)}function dY(t,e,n){const r=t.canvas,i=Nj(s=>{t.ctx!==null&&n(sY(s,t))},t);return rY(r,e,i),i}class hY extends Hj{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(nY(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[i1])return!1;const r=n[i1].initial;["height","width"].forEach(s=>{const o=r[s];qn(o)?n.removeAttribute(s):n.setAttribute(s,o)});const i=r.style||{};return Object.keys(i).forEach(s=>{n.style[s]=i[s]}),n.width=n.width,delete n[i1],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const i=e.$proxies||(e.$proxies={}),o={attach:oY,detach:aY,resize:uY}[n]||dY;i[n]=o(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),i=r[n];if(!i)return;({attach:E2,detach:E2,resize:E2}[n]||iY)(e,n,i),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,i){return rQ(e,n,r,i)}isAttached(e){const n=e&&N4(e);return!!(n&&n.isConnected)}}function fY(t){return!_4()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?eY:hY}class ta{constructor(){Lt(this,"x");Lt(this,"y");Lt(this,"active",!1);Lt(this,"options");Lt(this,"$animations")}tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return Tp(this.x)&&Tp(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const i={};return e.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}}Lt(ta,"defaults",{}),Lt(ta,"defaultRoutes");function pY(t,e){const n=t.options.ticks,r=mY(t),i=Math.min(n.maxTicksLimit||r,r),s=n.major.enabled?xY(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>i)return yY(e,c,s,o/i),c;const d=gY(s,e,i);if(o>0){let f,h;const p=o>1?Math.round((l-a)/(o-1)):null;for(vg(e,c,d,qn(p)?0:a-p,a),f=0,h=o-1;f<h;f++)vg(e,c,d,s[f],s[f+1]);return vg(e,c,d,l,qn(p)?e.length:l+p),c}return vg(e,c,d),c}function mY(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),i=t._maxLength/n;return Math.floor(Math.min(r,i))}function gY(t,e,n){const r=vY(t),i=e.length/n;if(!r)return Math.max(i,1);const s=rK(r);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>i)return l}return Math.max(i,1)}function xY(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function yY(t,e,n,r){let i=0,s=n[0],o;for(r=Math.ceil(r),o=0;o<t.length;o++)o===s&&(e.push(t[o]),i++,s=n[i*r])}function vg(t,e,n,r,i){const s=xn(r,0),o=Math.min(xn(i,t.length),t.length);let a=0,l,c,d;for(n=Math.ceil(n),i&&(l=i-r,n=l/Math.floor(l/n)),d=s;d<0;)a++,d=Math.round(s+a*n);for(c=Math.max(s,0);c<o;c++)c===d&&(e.push(t[c]),a++,d=Math.round(s+a*n))}function vY(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const bY=t=>t==="left"?"right":t==="right"?"left":t,zE=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,qE=(t,e)=>Math.min(e||t,t);function HE(t,e){const n=[],r=t.length/e,i=t.length;let s=0;for(;s<i;s+=r)n.push(t[Math.floor(s)]);return n}function wY(t,e,n){const r=t.ticks.length,i=Math.min(e,r-1),s=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(i),c;if(!(n&&(r===1?c=Math.max(l-s,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(i-1))/2,l+=i<e?c:-c,l<s-a||l>o+a)))return l}function _Y(t,e){Kn(t,n=>{const r=n.gc,i=r.length/2;let s;if(i>e){for(s=0;s<i;++s)delete n.data[r[s]];r.splice(0,i)}})}function Xf(t){return t.drawTicks?t.tickLength:0}function WE(t,e){if(!t.display)return 0;const n=Ji(t.font,e),r=ko(t.padding);return(Xr(t.text)?t.text.length:1)*n.lineHeight+r.height}function NY(t,e){return Vd(t,{scale:e,type:"scale"})}function AY(t,e,n){return Vd(t,{tick:n,index:e,type:"tick"})}function SY(t,e,n){let r=m4(t);return(n&&e!=="right"||!n&&e==="right")&&(r=bY(r)),r}function EY(t,e,n,r){const{top:i,left:s,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:d}=l;let f=0,h,p,m;const g=o-i,b=a-s;if(t.isHorizontal()){if(p=Ki(r,s,a),Nn(n)){const x=Object.keys(n)[0],w=n[x];m=d[x].getPixelForValue(w)+g-e}else n==="center"?m=(c.bottom+c.top)/2+g-e:m=zE(t,n,e);h=a-s}else{if(Nn(n)){const x=Object.keys(n)[0],w=n[x];p=d[x].getPixelForValue(w)-b+e}else n==="center"?p=(c.left+c.right)/2-b+e:p=zE(t,n,e);m=Ki(r,o,i),f=n==="left"?-si:si}return{titleX:p,titleY:m,maxWidth:h,rotation:f}}class wf extends ta{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:i}=this;return e=va(e,Number.POSITIVE_INFINITY),n=va(n,Number.NEGATIVE_INFINITY),r=va(r,Number.POSITIVE_INFINITY),i=va(i,Number.NEGATIVE_INFINITY),{min:va(e,r),max:va(n,i),minDefined:ts(e),maxDefined:ts(n)}}getMinMax(e){let{min:n,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:n,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),i||(n=Math.min(n,o.min)),s||(r=Math.max(r,o.max));return n=s&&n>r?r:n,r=i&&n>r?n:r,{min:va(n,va(r,n)),max:va(r,va(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){hr(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:i,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=FK(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?HE(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=pY(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){hr(this.options.afterUpdate,[this])}beforeSetDimensions(){hr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){hr(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),hr(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){hr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r],s.label=hr(n.callback,[s.value,r,e],this)}afterTickToLabelConversion(){hr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){hr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=qE(this.ticks.length,e.ticks.maxTicksLimit),i=n.minRotation||0,s=n.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!n.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const d=this._getLabelSizes(),f=d.widest.width,h=d.highest.height,p=Xi(this.chart.width-f,0,this.maxWidth);a=e.offset?this.maxWidth/r:p/(r-1),f+6>a&&(a=p/(r-(e.offset?.5:1)),l=this.maxHeight-Xf(e.grid)-n.padding-WE(e.title,this.chart.options.font),c=Math.sqrt(f*f+h*h),o=aK(Math.min(Math.asin(Xi((d.highest.height+6)/a,-1,1)),Math.asin(Xi(l/c,-1,1))-Math.asin(Xi(h/c,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){hr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){hr(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:i,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=WE(i,n.options.font);if(a?(e.width=this.maxWidth,e.height=Xf(s)+l):(e.height=this.maxHeight,e.width=Xf(s)+l),r.display&&this.ticks.length){const{first:c,last:d,widest:f,highest:h}=this._getLabelSizes(),p=r.padding*2,m=El(this.labelRotation),g=Math.cos(m),b=Math.sin(m);if(a){const x=r.mirror?0:b*f.width+g*h.height;e.height=Math.min(this.maxHeight,e.height+x+p)}else{const x=r.mirror?0:g*f.width+b*h.height;e.width=Math.min(this.maxWidth,e.width+x+p)}this._calculatePadding(c,d,b,g)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,i){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,p=0;l?c?(h=i*e.width,p=r*n.height):(h=r*e.height,p=i*n.width):s==="start"?p=n.width:s==="end"?h=e.width:s!=="inner"&&(h=e.width/2,p=n.width/2),this.paddingLeft=Math.max((h-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-f+o)*this.width/(this.width-f),0)}else{let d=n.height/2,f=e.height/2;s==="start"?(d=0,f=e.height):s==="end"&&(d=n.height,f=0),this.paddingTop=d+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){hr(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)qn(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=HE(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,r){const{ctx:i,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(n/qE(n,r));let c=0,d=0,f,h,p,m,g,b,x,w,N,E,D;for(f=0;f<n;f+=l){if(m=e[f].label,g=this._resolveTickFontOptions(f),i.font=b=g.string,x=s[b]=s[b]||{data:{},gc:[]},w=g.lineHeight,N=E=0,!qn(m)&&!Xr(m))N=yE(i,x.data,x.gc,N,m),E=w;else if(Xr(m))for(h=0,p=m.length;h<p;++h)D=m[h],!qn(D)&&!Xr(D)&&(N=yE(i,x.data,x.gc,N,D),E+=w);o.push(N),a.push(E),c=Math.max(N,c),d=Math.max(E,d)}_Y(s,n);const j=o.indexOf(c),C=a.indexOf(d),v=A=>({width:o[A]||0,height:a[A]||0});return{first:v(0),last:v(n-1),widest:v(j),highest:v(C),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return cK(this._alignToPixels?Iu(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=AY(this.getContext(),e,r))}return this.$context||(this.$context=NY(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=El(this.labelRotation),r=Math.abs(Math.cos(n)),i=Math.abs(Math.sin(n)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*r>a*i?a/r:l/i:l*i<a*r?l/r:a/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,i=this.options,{grid:s,position:o,border:a}=i,l=s.offset,c=this.isHorizontal(),f=this.ticks.length+(l?1:0),h=Xf(s),p=[],m=a.setContext(this.getContext()),g=m.display?m.width:0,b=g/2,x=function(O){return Iu(r,O,g)};let w,N,E,D,j,C,v,A,I,S,P,k;if(o==="top")w=x(this.bottom),C=this.bottom-h,A=w-b,S=x(e.top)+b,k=e.bottom;else if(o==="bottom")w=x(this.top),S=e.top,k=x(e.bottom)-b,C=w+b,A=this.top+h;else if(o==="left")w=x(this.right),j=this.right-h,v=w-b,I=x(e.left)+b,P=e.right;else if(o==="right")w=x(this.left),I=e.left,P=x(e.right)-b,j=w+b,v=this.left+h;else if(n==="x"){if(o==="center")w=x((e.top+e.bottom)/2+.5);else if(Nn(o)){const O=Object.keys(o)[0],M=o[O];w=x(this.chart.scales[O].getPixelForValue(M))}S=e.top,k=e.bottom,C=w+b,A=C+h}else if(n==="y"){if(o==="center")w=x((e.left+e.right)/2);else if(Nn(o)){const O=Object.keys(o)[0],M=o[O];w=x(this.chart.scales[O].getPixelForValue(M))}j=w-b,v=j-h,I=e.left,P=e.right}const F=xn(i.ticks.maxTicksLimit,f),q=Math.max(1,Math.ceil(f/F));for(N=0;N<f;N+=q){const O=this.getContext(N),M=s.setContext(O),W=a.setContext(O),z=M.lineWidth,J=M.color,ne=W.dash||[],V=W.dashOffset,$=M.tickWidth,K=M.tickColor,X=M.tickBorderDash||[],ae=M.tickBorderDashOffset;E=wY(this,N,l),E!==void 0&&(D=Iu(r,E,z),c?j=v=I=P=D:C=A=S=k=D,p.push({tx1:j,ty1:C,tx2:v,ty2:A,x1:I,y1:S,x2:P,y2:k,width:z,color:J,borderDash:ne,borderDashOffset:V,tickWidth:$,tickColor:K,tickBorderDash:X,tickBorderDashOffset:ae}))}return this._ticksLength=f,this._borderValue=w,p}_computeLabelItems(e){const n=this.axis,r=this.options,{position:i,ticks:s}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:d,mirror:f}=s,h=Xf(r.grid),p=h+d,m=f?-d:p,g=-El(this.labelRotation),b=[];let x,w,N,E,D,j,C,v,A,I,S,P,k="middle";if(i==="top")j=this.bottom-m,C=this._getXAxisLabelAlignment();else if(i==="bottom")j=this.top+m,C=this._getXAxisLabelAlignment();else if(i==="left"){const q=this._getYAxisLabelAlignment(h);C=q.textAlign,D=q.x}else if(i==="right"){const q=this._getYAxisLabelAlignment(h);C=q.textAlign,D=q.x}else if(n==="x"){if(i==="center")j=(e.top+e.bottom)/2+p;else if(Nn(i)){const q=Object.keys(i)[0],O=i[q];j=this.chart.scales[q].getPixelForValue(O)+p}C=this._getXAxisLabelAlignment()}else if(n==="y"){if(i==="center")D=(e.left+e.right)/2-p;else if(Nn(i)){const q=Object.keys(i)[0],O=i[q];D=this.chart.scales[q].getPixelForValue(O)}C=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(l==="start"?k="top":l==="end"&&(k="bottom"));const F=this._getLabelSizes();for(x=0,w=a.length;x<w;++x){N=a[x],E=N.label;const q=s.setContext(this.getContext(x));v=this.getPixelForTick(x)+s.labelOffset,A=this._resolveTickFontOptions(x),I=A.lineHeight,S=Xr(E)?E.length:1;const O=S/2,M=q.color,W=q.textStrokeColor,z=q.textStrokeWidth;let J=C;o?(D=v,C==="inner"&&(x===w-1?J=this.options.reverse?"left":"right":x===0?J=this.options.reverse?"right":"left":J="center"),i==="top"?c==="near"||g!==0?P=-S*I+I/2:c==="center"?P=-F.highest.height/2-O*I+I:P=-F.highest.height+I/2:c==="near"||g!==0?P=I/2:c==="center"?P=F.highest.height/2-O*I:P=F.highest.height-S*I,f&&(P*=-1),g!==0&&!q.showLabelBackdrop&&(D+=I/2*Math.sin(g))):(j=v,P=(1-S)*I/2);let ne;if(q.showLabelBackdrop){const V=ko(q.backdropPadding),$=F.heights[x],K=F.widths[x];let X=P-V.top,ae=0-V.left;switch(k){case"middle":X-=$/2;break;case"bottom":X-=$;break}switch(C){case"center":ae-=K/2;break;case"right":ae-=K;break;case"inner":x===w-1?ae-=K:x>0&&(ae-=K/2);break}ne={left:ae,top:X,width:K+V.width,height:$+V.height,color:q.backdropColor}}b.push({label:E,font:A,textOffset:P,options:{rotation:g,color:M,strokeColor:W,strokeWidth:z,textAlign:J,textBaseline:k,translation:[D,j],backdrop:ne}})}return b}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-El(this.labelRotation))return e==="top"?"left":"right";let i="center";return n.align==="start"?i="left":n.align==="end"?i="right":n.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,d;return n==="left"?i?(d=this.right+s,r==="near"?c="left":r==="center"?(c="center",d+=l/2):(c="right",d+=l)):(d=this.right-a,r==="near"?c="right":r==="center"?(c="center",d-=l/2):(c="left",d=this.left)):n==="right"?i?(d=this.left+s,r==="near"?c="right":r==="center"?(c="center",d-=l/2):(c="left",d-=l)):(d=this.left+a,r==="near"?c="left":r==="center"?(c="center",d+=l/2):(c="right",d=this.right)):c="right",{textAlign:c,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:i,width:s,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,i,s,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?n.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,d)=>{!d.width||!d.color||(r.save(),r.lineWidth=d.width,r.strokeStyle=d.color,r.setLineDash(d.borderDash||[]),r.lineDashOffset=d.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(n.display)for(s=0,o=i.length;s<o;++s){const l=i[s];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,d,f,h;this.isHorizontal()?(c=Iu(e,this.left,o)-o/2,d=Iu(e,this.right,a)+a/2,f=h=l):(f=Iu(e,this.top,o)-o/2,h=Iu(e,this.bottom,a)+a/2,c=d=l),n.save(),n.lineWidth=s.width,n.strokeStyle=s.color,n.beginPath(),n.moveTo(c,f),n.lineTo(d,h),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&yy(r,i);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,d=o.textOffset;Dp(r,c,0,d,l,a)}i&&vy(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:i}}=this;if(!r.display)return;const s=Ji(r.font),o=ko(r.padding),a=r.align;let l=s.lineHeight/2;n==="bottom"||n==="center"||Nn(n)?(l+=o.bottom,Xr(r.text)&&(l+=s.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:d,maxWidth:f,rotation:h}=EY(this,l,n,a);Dp(e,r.text,0,0,s,{color:r.color,maxWidth:f,rotation:h,textAlign:SY(a,n,i),textBaseline:"middle",translation:[c,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=xn(e.grid&&e.grid.z,-1),i=xn(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==wf.prototype.draw?[{z:n,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:n,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,o;for(s=0,o=n.length;s<o;++s){const a=n[s];a[r]===this.id&&(!e||a.type===e)&&i.push(a)}return i}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Ji(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class bg{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;kY(n)&&(r=this.register(n));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,CY(e,o,r),this.override&&qr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,i=this.scope;r in n&&delete n[r],i&&r in qr[i]&&(delete qr[i][r],this.override&&delete kd[r])}}function CY(t,e,n){const r=Pp(Object.create(null),[n?qr.get(n):{},qr.get(e),t.defaults]);qr.set(e,r),t.defaultRoutes&&PY(e,t.defaultRoutes),t.descriptors&&qr.describe(e,t.descriptors)}function PY(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),i=r.pop(),s=[t].concat(r).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");qr.route(s,i,l,a)})}function kY(t){return"id"in t&&"defaults"in t}class TY{constructor(){this.controllers=new bg(rd,"datasets",!0),this.elements=new bg(ta,"elements"),this.plugins=new bg(Object,"plugins"),this.scales=new bg(wf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):Kn(i,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,r){const i=f4(e);hr(r["before"+i],[],r),n[e](r),hr(r["after"+i],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const i=n.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return i}}var Na=new TY;class IY{constructor(){this._init=[]}notify(e,n,r,i){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,n,r);return n==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,r,i){i=i||{};for(const s of e){const o=s.plugin,a=o[r],l=[n,i,s.options];if(hr(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){qn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,i=xn(r.options&&r.options.plugins,{}),s=jY(r);return i===!1&&!n?[]:RY(e,s,i,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,i=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(n,r),e,"stop"),this._notify(i(r,n),e,"start")}}function jY(t){const e={},n=[],r=Object.keys(Na.plugins.items);for(let s=0;s<r.length;s++)n.push(Na.getPlugin(r[s]));const i=t.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function DY(t,e){return!e&&t===!1?null:t===!0?{}:t}function RY(t,{plugins:e,localIds:n},r,i){const s=[],o=t.getContext();for(const a of e){const l=a.id,c=DY(r[l],i);c!==null&&s.push({plugin:a,options:FY(t.config,{plugin:a,local:n[l]},c,o)})}return s}function FY(t,{plugin:e,local:n},r,i){const s=t.pluginScopeKeys(e),o=t.getOptionScopes(r,s);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function S5(t,e){const n=qr.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function LY(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function MY(t,e){return t===e?"_index_":"_value_"}function $E(t){if(t==="x"||t==="y"||t==="r")return t}function BY(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function E5(t,...e){if($E(t))return t;for(const n of e){const r=n.axis||BY(n.position)||t.length>1&&$E(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function GE(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function OY(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(n.length)return GE(t,"x",n[0])||GE(t,"y",n[0])}return{}}function VY(t,e){const n=kd[t.type]||{scales:{}},r=e.scales||{},i=S5(t.type,e),s=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Nn(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=E5(o,a,OY(o,t),qr.scales[a.type]),c=MY(l,i),d=n.scales||{};s[o]=T0(Object.create(null),[{axis:l},a,d[l],d[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||S5(a,e),d=(kd[a]||{}).scales||{};Object.keys(d).forEach(f=>{const h=LY(f,l),p=o[h+"AxisID"]||h;s[p]=s[p]||Object.create(null),T0(s[p],[{axis:h},r[p],d[f]])})}),Object.keys(s).forEach(o=>{const a=s[o];T0(a,[qr.scales[a.type],qr.scale])}),s}function Gj(t){const e=t.options||(t.options={});e.plugins=xn(e.plugins,{}),e.scales=VY(t,e)}function Kj(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function UY(t){return t=t||{},t.data=Kj(t.data),Gj(t),t}const KE=new Map,Qj=new Set;function wg(t,e){let n=KE.get(t);return n||(n=e(),KE.set(t,n),Qj.add(n)),n}const Jf=(t,e,n)=>{const r=Pd(e,n);r!==void 0&&t.add(r)};class zY{constructor(e){this._config=UY(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Kj(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Gj(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return wg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return wg(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return wg(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return wg(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let i=r.get(e);return(!i||n)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,n,r){const{options:i,type:s}=this,o=this._cachedScopes(e,r),a=o.get(n);if(a)return a;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(f=>Jf(l,e,f))),d.forEach(f=>Jf(l,i,f)),d.forEach(f=>Jf(l,kd[s]||{},f)),d.forEach(f=>Jf(l,qr,f)),d.forEach(f=>Jf(l,_5,f))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),Qj.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,kd[n]||{},qr.datasets[n]||{},{type:n},qr,_5]}resolveNamedOptions(e,n,r,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=QE(this._resolverCache,e,i);let l=o;if(HY(o,n)){s.$shared=!1,r=cu(r)?r():r;const c=this.createResolver(e,r,a);l=cf(o,r,c)}for(const c of n)s[c]=l[c];return s}createResolver(e,n,r=[""],i){const{resolver:s}=QE(this._resolverCache,e,r);return Nn(n)?cf(s,n,void 0,i):s}}function QE(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const i=n.join();let s=r.get(i);return s||(s={resolver:v4(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},r.set(i,s)),s}const qY=t=>Nn(t)&&Object.getOwnPropertyNames(t).some(e=>cu(t[e]));function HY(t,e){const{isScriptable:n,isIndexable:r}=Pj(t);for(const i of e){const s=n(i),o=r(i),a=(o||s)&&t[i];if(s&&(cu(a)||qY(a))||o&&Xr(a))return!0}return!1}var WY="4.4.9";const $Y=["top","bottom","left","right","chartArea"];function YE(t,e){return t==="top"||t==="bottom"||$Y.indexOf(t)===-1&&e==="x"}function XE(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function JE(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),hr(n&&n.onComplete,[t],e)}function GY(t){const e=t.chart,n=e.options.animation;hr(n&&n.onProgress,[t],e)}function Yj(t){return _4()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const s1={},ZE=t=>{const e=Yj(t);return Object.values(s1).filter(n=>n.canvas===e).pop()};function KY(t,e,n){const r=Object.keys(t);for(const i of r){const s=+i;if(s>=e){const o=t[i];delete t[i],(n>0||s>e)&&(t[s+n]=o)}}}function QY(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}var wc;let _f=(wc=class{static register(...e){Na.add(...e),e6()}static unregister(...e){Na.remove(...e),e6()}constructor(e,n){const r=this.config=new zY(n),i=Yj(e),s=ZE(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||fY(i)),this.platform.updateConfig(r);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,d=l&&l.width;if(this.id=KG(),this.ctx=a,this.canvas=l,this.width=d,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new IY,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=fK(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],s1[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}ml.listen(this,"complete",JE),ml.listen(this,"progress",GY),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:i,_aspectRatio:s}=this;return qn(e)?n&&s?s:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Na}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():_E(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return vE(this.canvas,this.ctx),this}stop(){return ml.stop(this),this}resize(e,n){ml.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,n,s),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,_E(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),hr(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Kn(n,(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,i=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let s=[];n&&(s=s.concat(Object.keys(n).map(o=>{const a=n[o],l=E5(o,a),c=l==="r",d=l==="x";return{options:a,dposition:c?"chartArea":d?"bottom":"left",dtype:c?"radialLinear":d?"category":"linear"}}))),Kn(s,o=>{const a=o.options,l=a.id,c=E5(l,a),d=xn(a.type,o.dtype);(a.position===void 0||YE(a.position,c)!==YE(o.dposition))&&(a.position=o.dposition),i[l]=!0;let f=null;if(l in r&&r[l].type===d)f=r[l];else{const h=Na.getScale(d);f=new h({id:l,type:d,ctx:this.ctx,chart:this}),r[f.id]=f}f.init(a,e)}),Kn(i,(o,a)=>{o||delete r[a]}),Kn(r,o=>{No.configure(this,o,o.options),No.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((i,s)=>i.index-s.index),r>n){for(let i=n;i<r;++i)this._destroyDatasetMeta(i);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(XE("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,i)=>{n.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=n.length;r<i;r++){const s=n[r];let o=this.getDatasetMeta(r);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=s.indexAxis||S5(a,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=Na.getController(a),{datasetElementType:c,dataElementType:d}=qr.datasets[a];Object.assign(l,{dataElementType:Na.getElement(d),datasetElementType:c&&Na.getElement(c)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Kn(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,d=this.data.datasets.length;c<d;c++){const{controller:f}=this.getDatasetMeta(c),h=!i&&s.indexOf(f)===-1;f.buildOrUpdateElements(h),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),i||Kn(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(XE("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Kn(this.scales,e=>{No.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!cE(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of n){const o=r==="_removeElements"?-s:s;KY(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),i=r(0);for(let s=1;s<n;s++)if(!cE(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;No.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Kn(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,cu(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),i={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(n),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ml.has(this)?this.attached&&!ml.running(this)&&ml.start(this):(this.draw(),JE({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let i,s;for(i=0,s=n.length;i<s;++i){const o=n[i];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r={meta:e,index:e.index,cancelable:!0},i=Bj(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(i&&yy(n,i),e.controller.draw(),i&&vy(n),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return jp(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,i){const s=$Q.modes[n];return typeof s=="function"?s(this,e,r,i):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let i=r.filter(s=>s&&s._dataset===n).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=Vd(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const i=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);kp(n)?(s.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(a=>a.datasetIndex===e?i:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),ml.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),vE(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete s1[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(s,o)=>{n.addEventListener(this,s,o),e[s]=o},i=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};Kn(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},i=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){Kn(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Kn(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const i=r?"set":"remove";let s,o,a,l;for(n==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!cx(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){const i=this.options.hover,s=(l,c)=>l.filter(d=>!c.some(f=>d.datasetIndex===f.datasetIndex&&d.index===f.index)),o=s(n,e),a=r?e:s(e,n);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:i=[],options:s}=this,o=n,a=this._getActiveElements(e,i,r,o),l=eK(e),c=QY(e,this._lastEvent,r,l);r&&(this._lastEvent=null,hr(s.onHover,[e,a,this],this),l&&hr(s.onClick,[e,a,this],this));const d=!cx(a,i);return(d||n)&&(this._active=a,this._updateHoverStyles(a,i,n)),this._lastEvent=c,d}_getActiveElements(e,n,r,i){if(e.type==="mouseout")return[];if(!r)return n;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},Lt(wc,"defaults",qr),Lt(wc,"instances",s1),Lt(wc,"overrides",kd),Lt(wc,"registry",Na),Lt(wc,"version",WY),Lt(wc,"getChart",ZE),wc);function e6(){return Kn(_f.instances,t=>t._plugins.invalidate())}function YY(t,e,n){const{startAngle:r,pixelMargin:i,x:s,y:o,outerRadius:a,innerRadius:l}=e;let c=i/a;t.beginPath(),t.arc(s,o,a,r-c,n+c),l>i?(c=i/l,t.arc(s,o,l,n+c,r-c,!0)):t.arc(s,o,i,n+si,r-si),t.closePath(),t.clip()}function XY(t){return y4(t,["outerStart","outerEnd","innerStart","innerEnd"])}function JY(t,e,n,r){const i=XY(t.options.borderRadius),s=(n-e)/2,o=Math.min(s,r*e/2),a=l=>{const c=(n-Math.min(s,l))*r/2;return Xi(l,0,Math.min(s,c))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:Xi(i.innerStart,0,o),innerEnd:Xi(i.innerEnd,0,o)}}function rh(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function mx(t,e,n,r,i,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:d}=e,f=Math.max(e.outerRadius+r+n-c,0),h=d>0?d+r+n+c:0;let p=0;const m=i-l;if(r){const q=d>0?d-r:0,O=f>0?f-r:0,M=(q+O)/2,W=M!==0?m*M/(M+r):m;p=(m-W)/2}const g=Math.max(.001,m*f-n/Dr)/f,b=(m-g)/2,x=l+b+p,w=i-b-p,{outerStart:N,outerEnd:E,innerStart:D,innerEnd:j}=JY(e,h,f,w-x),C=f-N,v=f-E,A=x+N/C,I=w-E/v,S=h+D,P=h+j,k=x+D/S,F=w-j/P;if(t.beginPath(),s){const q=(A+I)/2;if(t.arc(o,a,f,A,q),t.arc(o,a,f,q,I),E>0){const z=rh(v,I,o,a);t.arc(z.x,z.y,E,I,w+si)}const O=rh(P,w,o,a);if(t.lineTo(O.x,O.y),j>0){const z=rh(P,F,o,a);t.arc(z.x,z.y,j,w+si,F+Math.PI)}const M=(w-j/h+(x+D/h))/2;if(t.arc(o,a,h,w-j/h,M,!0),t.arc(o,a,h,M,x+D/h,!0),D>0){const z=rh(S,k,o,a);t.arc(z.x,z.y,D,k+Math.PI,x-si)}const W=rh(C,x,o,a);if(t.lineTo(W.x,W.y),N>0){const z=rh(C,A,o,a);t.arc(z.x,z.y,N,x-si,A)}}else{t.moveTo(o,a);const q=Math.cos(A)*f+o,O=Math.sin(A)*f+a;t.lineTo(q,O);const M=Math.cos(I)*f+o,W=Math.sin(I)*f+a;t.lineTo(M,W)}t.closePath()}function ZY(t,e,n,r,i){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){mx(t,e,n,r,l,i);for(let c=0;c<s;++c)t.fill();isNaN(a)||(l=o+(a%Ar||Ar))}return mx(t,e,n,r,l,i),t.fill(),l}function eX(t,e,n,r,i){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:d,borderDash:f,borderDashOffset:h}=l,p=l.borderAlign==="inner";if(!c)return;t.setLineDash(f||[]),t.lineDashOffset=h,p?(t.lineWidth=c*2,t.lineJoin=d||"round"):(t.lineWidth=c,t.lineJoin=d||"bevel");let m=e.endAngle;if(s){mx(t,e,n,r,m,i);for(let g=0;g<s;++g)t.stroke();isNaN(a)||(m=o+(a%Ar||Ar))}p&&YY(t,e,m),s||(mx(t,e,n,r,m,i),t.stroke())}class kh extends ta{constructor(n){super();Lt(this,"circumference");Lt(this,"endAngle");Lt(this,"fullCircles");Lt(this,"innerRadius");Lt(this,"outerRadius");Lt(this,"pixelMargin");Lt(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,r,i){const s=this.getProps(["x","y"],i),{angle:o,distance:a}=vj(s,{x:n,y:r}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:f,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),p=(this.options.spacing+this.options.borderWidth)/2,m=xn(h,c-l),g=Ip(o,l,c)&&l!==c,b=m>=Ar||g,x=Cl(a,d+p,f+p);return b&&x}getCenterPoint(n){const{x:r,y:i,startAngle:s,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:c,spacing:d}=this.options,f=(s+o)/2,h=(a+l+d+c)/2;return{x:r+Math.cos(f)*h,y:i+Math.sin(f)*h}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:r,circumference:i}=this,s=(r.offset||0)/4,o=(r.spacing||0)/2,a=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=i>Ar?Math.floor(i/Ar):0,i===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Dr,i||0)),d=s*c;n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,ZY(n,this,d,o,a),eX(n,this,d,o,a),n.restore()}}Lt(kh,"id","arc"),Lt(kh,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Lt(kh,"defaultRoutes",{backgroundColor:"backgroundColor"}),Lt(kh,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function Xj(t,e,n=e){t.lineCap=xn(n.borderCapStyle,e.borderCapStyle),t.setLineDash(xn(n.borderDash,e.borderDash)),t.lineDashOffset=xn(n.borderDashOffset,e.borderDashOffset),t.lineJoin=xn(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=xn(n.borderWidth,e.borderWidth),t.strokeStyle=xn(n.borderColor,e.borderColor)}function tX(t,e,n){t.lineTo(n.x,n.y)}function nX(t){return t.stepped?EK:t.tension||t.cubicInterpolationMode==="monotone"?CK:tX}function Jj(t,e,n={}){const r=t.length,{start:i=0,end:s=r-1}=n,{start:o,end:a}=e,l=Math.max(i,o),c=Math.min(s,a),d=i<o&&s<o||i>a&&s>a;return{count:r,start:l,loop:e.loop,ilen:c<l&&!d?r+c-l:c-l}}function rX(t,e,n,r){const{points:i,options:s}=e,{count:o,start:a,loop:l,ilen:c}=Jj(i,n,r),d=nX(s);let{move:f=!0,reverse:h}=r||{},p,m,g;for(p=0;p<=c;++p)m=i[(a+(h?c-p:p))%o],!m.skip&&(f?(t.moveTo(m.x,m.y),f=!1):d(t,g,m,h,s.stepped),g=m);return l&&(m=i[(a+(h?c:0))%o],d(t,g,m,h,s.stepped)),!!l}function iX(t,e,n,r){const i=e.points,{count:s,start:o,ilen:a}=Jj(i,n,r),{move:l=!0,reverse:c}=r||{};let d=0,f=0,h,p,m,g,b,x;const w=E=>(o+(c?a-E:E))%s,N=()=>{g!==b&&(t.lineTo(d,b),t.lineTo(d,g),t.lineTo(d,x))};for(l&&(p=i[w(0)],t.moveTo(p.x,p.y)),h=0;h<=a;++h){if(p=i[w(h)],p.skip)continue;const E=p.x,D=p.y,j=E|0;j===m?(D<g?g=D:D>b&&(b=D),d=(f*d+E)/++f):(N(),t.lineTo(E,D),m=j,f=0,g=b=D),x=D}N()}function C5(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?iX:rX}function sX(t){return t.stepped?sQ:t.tension||t.cubicInterpolationMode==="monotone"?oQ:Ou}function oX(t,e,n,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,n,r)&&i.closePath()),Xj(t,e.options),t.stroke(i)}function aX(t,e,n,r){const{segments:i,options:s}=e,o=C5(e);for(const a of i)Xj(t,s,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}const lX=typeof Path2D=="function";function cX(t,e,n,r){lX&&!e.options.segment?oX(t,e,n,r):aX(t,e,n,r)}class Da extends ta{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;XK(this._points,r,e,i,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=hQ(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,r=e.length;return r&&n[e[r-1].end]}interpolate(e,n){const r=this.options,i=e[n],s=this.points,o=Mj(this,{property:n,start:i,end:i});if(!o.length)return;const a=[],l=sX(r);let c,d;for(c=0,d=o.length;c<d;++c){const{start:f,end:h}=o[c],p=s[f],m=s[h];if(p===m){a.push(p);continue}const g=Math.abs((i-p[n])/(m[n]-p[n])),b=l(p,m,g,r.stepped);b[n]=e[n],a.push(b)}return a.length===1?a[0]:a}pathSegment(e,n,r){return C5(this)(e,this,n,r)}path(e,n,r){const i=this.segments,s=C5(this);let o=this._loop;n=n||0,r=r||this.points.length-n;for(const a of i)o&=s(e,this,a,{start:n,end:n+r-1});return!!o}draw(e,n,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),cX(e,this,r,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Lt(Da,"id","line"),Lt(Da,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Lt(Da,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Lt(Da,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function t6(t,e,n,r){const i=t.options,{[n]:s}=t.getProps([n],r);return Math.abs(e-s)<i.radius+i.hitRadius}class qh extends ta{constructor(n){super();Lt(this,"parsed");Lt(this,"skip");Lt(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,r,i){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],i);return Math.pow(n-o,2)+Math.pow(r-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(n,r){return t6(this,n,"x",r)}inYRange(n,r){return t6(this,n,"y",r)}getCenterPoint(n){const{x:r,y:i}=this.getProps(["x","y"],n);return{x:r,y:i}}size(n){n=n||this.options||{};let r=n.radius||0;r=Math.max(r,r&&n.hoverRadius||0);const i=r&&n.borderWidth||0;return(r+i)*2}draw(n,r){const i=this.options;this.skip||i.radius<.1||!jp(this,r,this.size(i)/2)||(n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.fillStyle=i.backgroundColor,N5(n,i,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Lt(qh,"id","point"),Lt(qh,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Lt(qh,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Zj(t,e){const{x:n,y:r,base:i,width:s,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,d,f;return t.horizontal?(f=o/2,a=Math.min(n,i),l=Math.max(n,i),c=r-f,d=r+f):(f=s/2,a=n-f,l=n+f,c=Math.min(r,i),d=Math.max(r,i)),{left:a,top:c,right:l,bottom:d}}function Vc(t,e,n,r){return t?0:Xi(e,n,r)}function uX(t,e,n){const r=t.options.borderWidth,i=t.borderSkipped,s=Cj(r);return{t:Vc(i.top,s.top,0,n),r:Vc(i.right,s.right,0,e),b:Vc(i.bottom,s.bottom,0,n),l:Vc(i.left,s.left,0,e)}}function dX(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,s=Uh(i),o=Math.min(e,n),a=t.borderSkipped,l=r||Nn(i);return{topLeft:Vc(!l||a.top||a.left,s.topLeft,0,o),topRight:Vc(!l||a.top||a.right,s.topRight,0,o),bottomLeft:Vc(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:Vc(!l||a.bottom||a.right,s.bottomRight,0,o)}}function hX(t){const e=Zj(t),n=e.right-e.left,r=e.bottom-e.top,i=uX(t,n/2,r/2),s=dX(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:n-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function C2(t,e,n,r){const i=e===null,s=n===null,a=t&&!(i&&s)&&Zj(t,r);return a&&(i||Cl(e,a.left,a.right))&&(s||Cl(n,a.top,a.bottom))}function fX(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function pX(t,e){t.rect(e.x,e.y,e.w,e.h)}function P2(t,e,n={}){const r=t.x!==n.x?-e:0,i=t.y!==n.y?-e:0,s=(t.x+t.w!==n.x+n.w?e:0)-r,o=(t.y+t.h!==n.y+n.h?e:0)-i;return{x:t.x+r,y:t.y+i,w:t.w+s,h:t.h+o,radius:t.radius}}class o1 extends ta{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:r,backgroundColor:i}}=this,{inner:s,outer:o}=hX(this),a=fX(o.radius)?hx:pX;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,P2(o,n,s)),e.clip(),a(e,P2(s,-n,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,P2(s,n)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,n,r){return C2(this,e,n,r)}inXRange(e,n){return C2(this,e,null,n)}inYRange(e,n){return C2(this,null,e,n)}getCenterPoint(e){const{x:n,y:r,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(n+i)/2:n,y:s?r:(r+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Lt(o1,"id","bar"),Lt(o1,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Lt(o1,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function mX(t,e,n){const r=t.segments,i=t.points,s=e.points,o=[];for(const a of r){let{start:l,end:c}=a;c=S4(l,c,i);const d=P5(n,i[l],i[c],a.loop);if(!e.segments){o.push({source:a,target:d,start:i[l],end:i[c]});continue}const f=Mj(e,d);for(const h of f){const p=P5(n,s[h.start],s[h.end],h.loop),m=Lj(a,i,p);for(const g of m)o.push({source:g,target:h,start:{[n]:n6(d,p,"start",Math.max)},end:{[n]:n6(d,p,"end",Math.min)}})}}return o}function P5(t,e,n,r){if(r)return;let i=e[t],s=n[t];return t==="angle"&&(i=Aa(i),s=Aa(s)),{property:t,start:i,end:s}}function gX(t,e){const{x:n=null,y:r=null}=t||{},i=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=S4(o,a,i);const l=i[o],c=i[a];r!==null?(s.push({x:l.x,y:r}),s.push({x:c.x,y:r})):n!==null&&(s.push({x:n,y:l.y}),s.push({x:n,y:c.y}))}),s}function S4(t,e,n){for(;e>t;e--){const r=n[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function n6(t,e,n,r){return t&&e?r(t[n],e[n]):t?t[n]:e?e[n]:0}function eD(t,e){let n=[],r=!1;return Xr(t)?(r=!0,n=t):n=gX(t,e),n.length?new Da({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function r6(t){return t&&t.fill!==!1}function xX(t,e,n){let i=t[e].fill;const s=[e];let o;if(!n)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!ts(i))return i;if(o=t[i],!o)return!1;if(o.visible)return i;s.push(i),i=o.fill}return!1}function yX(t,e,n){const r=_X(t);if(Nn(r))return isNaN(r.value)?!1:r;let i=parseFloat(r);return ts(i)&&Math.floor(i)===i?vX(r[0],e,i,n):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function vX(t,e,n,r){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=r?!1:n}function bX(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:Nn(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function wX(t,e,n){let r;return t==="start"?r=n:t==="end"?r=e.options.reverse?e.min:e.max:Nn(t)?r=t.value:r=e.getBaseValue(),r}function _X(t){const e=t.options,n=e.fill;let r=xn(n&&n.target,n);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function NX(t){const{scale:e,index:n,line:r}=t,i=[],s=r.segments,o=r.points,a=AX(e,n);a.push(eD({x:null,y:e.bottom},r));for(let l=0;l<s.length;l++){const c=s[l];for(let d=c.start;d<=c.end;d++)SX(i,o[d],a)}return new Da({points:i,options:{}})}function AX(t,e){const n=[],r=t.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const s=r[i];if(s.index===e)break;s.hidden||n.unshift(s.dataset)}return n}function SX(t,e,n){const r=[];for(let i=0;i<n.length;i++){const s=n[i],{first:o,last:a,point:l}=EX(s,e,"x");if(!(!l||o&&a)){if(o)r.unshift(l);else if(t.push(l),!a)break}}t.push(...r)}function EX(t,e,n){const r=t.interpolate(e,n);if(!r)return{};const i=r[n],s=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const d=s[c],f=o[d.start][n],h=o[d.end][n];if(Cl(i,f,h)){a=i===f,l=i===h;break}}return{first:a,last:l,point:r}}class tD{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,r){const{x:i,y:s,radius:o}=this;return n=n||{start:0,end:Ar},e.arc(i,s,o,n.end,n.start,!0),!r.bounds}interpolate(e){const{x:n,y:r,radius:i}=this,s=e.angle;return{x:n+Math.cos(s)*i,y:r+Math.sin(s)*i,angle:s}}}function CX(t){const{chart:e,fill:n,line:r}=t;if(ts(n))return PX(e,n);if(n==="stack")return NX(t);if(n==="shape")return!0;const i=kX(t);return i instanceof tD?i:eD(i,r)}function PX(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function kX(t){return(t.scale||{}).getPointPositionForValue?IX(t):TX(t)}function TX(t){const{scale:e={},fill:n}=t,r=bX(n,e);if(ts(r)){const i=e.isHorizontal();return{x:i?r:null,y:i?null:r}}return null}function IX(t){const{scale:e,fill:n}=t,r=e.options,i=e.getLabels().length,s=r.reverse?e.max:e.min,o=wX(n,e,s),a=[];if(r.grid.circular){const l=e.getPointPositionForValue(0,s);return new tD({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<i;++l)a.push(e.getPointPositionForValue(l,o));return a}function k2(t,e,n){const r=CX(e),{chart:i,index:s,line:o,scale:a,axis:l}=e,c=o.options,d=c.fill,f=c.backgroundColor,{above:h=f,below:p=f}=d||{},m=i.getDatasetMeta(s),g=Bj(i,m);r&&o.points.length&&(yy(t,n),jX(t,{line:o,target:r,above:h,below:p,area:n,scale:a,axis:l,clip:g}),vy(t))}function jX(t,e){const{line:n,target:r,above:i,below:s,area:o,scale:a,clip:l}=e,c=n._loop?"angle":e.axis;t.save(),c==="x"&&s!==i&&(i6(t,r,o.top),s6(t,{line:n,target:r,color:i,scale:a,property:c,clip:l}),t.restore(),t.save(),i6(t,r,o.bottom)),s6(t,{line:n,target:r,color:s,scale:a,property:c,clip:l}),t.restore()}function i6(t,e,n){const{segments:r,points:i}=e;let s=!0,o=!1;t.beginPath();for(const a of r){const{start:l,end:c}=a,d=i[l],f=i[S4(l,c,i)];s?(t.moveTo(d.x,d.y),s=!1):(t.lineTo(d.x,n),t.lineTo(d.x,d.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(f.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function s6(t,e){const{line:n,target:r,property:i,color:s,scale:o,clip:a}=e,l=mX(n,r,i);for(const{source:c,target:d,start:f,end:h}of l){const{style:{backgroundColor:p=s}={}}=c,m=r!==!0;t.save(),t.fillStyle=p,DX(t,o,a,m&&P5(i,f,h)),t.beginPath();const g=!!n.pathSegment(t,c);let b;if(m){g?t.closePath():o6(t,r,h,i);const x=!!r.pathSegment(t,d,{move:g,reverse:!0});b=g&&x,b||o6(t,r,f,i)}t.closePath(),t.fill(b?"evenodd":"nonzero"),t.restore()}}function DX(t,e,n,r){const i=e.chart.chartArea,{property:s,start:o,end:a}=r||{};if(s==="x"||s==="y"){let l,c,d,f;s==="x"?(l=o,c=i.top,d=a,f=i.bottom):(l=i.left,c=o,d=i.right,f=a),t.beginPath(),n&&(l=Math.max(l,n.left),d=Math.min(d,n.right),c=Math.max(c,n.top),f=Math.min(f,n.bottom)),t.rect(l,c,d-l,f-c),t.clip()}}function o6(t,e,n,r){const i=e.interpolate(n,r);i&&t.lineTo(i.x,i.y)}var E4={id:"filler",afterDatasetsUpdate(t,e,n){const r=(t.data.datasets||[]).length,i=[];let s,o,a,l;for(o=0;o<r;++o)s=t.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof Da&&(l={visible:t.isDatasetVisible(o),index:o,fill:yX(a,o,r),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,i.push(l);for(o=0;o<r;++o)l=i[o],!(!l||l.fill===!1)&&(l.fill=xX(i,o,n.propagate))},beforeDraw(t,e,n){const r=n.drawTime==="beforeDraw",i=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let o=i.length-1;o>=0;--o){const a=i[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),r&&a.fill&&k2(t.ctx,a,s))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const r=t.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const s=r[i].$filler;r6(s)&&k2(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,e,n){const r=e.meta.$filler;!r6(r)||n.drawTime!=="beforeDatasetDraw"||k2(t.ctx,r,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const a6=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},RX=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class l6 extends ta{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=hr(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,i)=>e.sort(r,i,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,i=Ji(r.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=a6(r,s);let c,d;n.font=i.string,this.isHorizontal()?(c=this.maxWidth,d=this._fitRows(o,s,a,l)+10):(d=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,i){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],d=i+a;let f=e;s.textAlign="left",s.textBaseline="middle";let h=-1,p=-d;return this.legendItems.forEach((m,g)=>{const b=r+n/2+s.measureText(m.text).width;(g===0||c[c.length-1]+b+2*a>o)&&(f+=d,c[c.length-(g>0?0:1)]=0,p+=d,h++),l[g]={left:0,top:p,row:h,width:b,height:i},c[c.length-1]+=b+a}),f}_fitCols(e,n,r,i){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],d=o-e;let f=a,h=0,p=0,m=0,g=0;return this.legendItems.forEach((b,x)=>{const{itemWidth:w,itemHeight:N}=FX(r,n,s,b,i);x>0&&p+N+2*a>d&&(f+=h+a,c.push({width:h,height:p}),m+=h+a,g++,h=p=0),l[x]={left:m,top:p,col:g,width:w,height:N},h=Math.max(h,w),p+=N+a}),f+=h,c.push({width:h,height:p}),f}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:i},rtl:s}}=this,o=zh(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=Ki(r,this.left+i,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Ki(r,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+e+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=Ki(r,this.top+e+i,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Ki(r,this.top+e+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;yy(e,this),this._draw(),vy(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:i}=this,{align:s,labels:o}=e,a=qr.color,l=zh(e.rtl,this.left,this.width),c=Ji(o.font),{padding:d}=o,f=c.size,h=f/2;let p;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:m,boxHeight:g,itemHeight:b}=a6(o,f),x=function(j,C,v){if(isNaN(m)||m<=0||isNaN(g)||g<0)return;i.save();const A=xn(v.lineWidth,1);if(i.fillStyle=xn(v.fillStyle,a),i.lineCap=xn(v.lineCap,"butt"),i.lineDashOffset=xn(v.lineDashOffset,0),i.lineJoin=xn(v.lineJoin,"miter"),i.lineWidth=A,i.strokeStyle=xn(v.strokeStyle,a),i.setLineDash(xn(v.lineDash,[])),o.usePointStyle){const I={radius:g*Math.SQRT2/2,pointStyle:v.pointStyle,rotation:v.rotation,borderWidth:A},S=l.xPlus(j,m/2),P=C+h;Ej(i,I,S,P,o.pointStyleWidth&&m)}else{const I=C+Math.max((f-g)/2,0),S=l.leftForLtr(j,m),P=Uh(v.borderRadius);i.beginPath(),Object.values(P).some(k=>k!==0)?hx(i,{x:S,y:I,w:m,h:g,radius:P}):i.rect(S,I,m,g),i.fill(),A!==0&&i.stroke()}i.restore()},w=function(j,C,v){Dp(i,v.text,j,C+b/2,c,{strikethrough:v.hidden,textAlign:l.textAlign(v.textAlign)})},N=this.isHorizontal(),E=this._computeTitleHeight();N?p={x:Ki(s,this.left+d,this.right-r[0]),y:this.top+d+E,line:0}:p={x:this.left+d,y:Ki(s,this.top+E+d,this.bottom-n[0].height),line:0},Dj(this.ctx,e.textDirection);const D=b+d;this.legendItems.forEach((j,C)=>{i.strokeStyle=j.fontColor,i.fillStyle=j.fontColor;const v=i.measureText(j.text).width,A=l.textAlign(j.textAlign||(j.textAlign=o.textAlign)),I=m+h+v;let S=p.x,P=p.y;l.setWidth(this.width),N?C>0&&S+I+d>this.right&&(P=p.y+=D,p.line++,S=p.x=Ki(s,this.left+d,this.right-r[p.line])):C>0&&P+D>this.bottom&&(S=p.x=S+n[p.line].width+d,p.line++,P=p.y=Ki(s,this.top+E+d,this.bottom-n[p.line].height));const k=l.x(S);if(x(k,P,j),S=pK(A,S+m+h,N?S+I:this.right,e.rtl),w(l.x(S),P,j),N)p.x+=I+d;else if(typeof j.text!="string"){const F=c.lineHeight;p.y+=nD(j,F)+d}else p.y+=D}),Rj(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=Ji(n.font),i=ko(n.padding);if(!n.display)return;const s=zh(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=r.size/2,c=i.top+l;let d,f=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),d=this.top+c,f=Ki(e.align,f,this.right-h);else{const m=this.columnSizes.reduce((g,b)=>Math.max(g,b.height),0);d=c+Ki(e.align,this.top,this.bottom-m-e.labels.padding-this._computeTitleHeight())}const p=Ki(a,f,f+h);o.textAlign=s.textAlign(m4(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=r.string,Dp(o,n.text,p,d,r)}_computeTitleHeight(){const e=this.options.title,n=Ji(e.font),r=ko(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,i,s;if(Cl(e,this.left,this.right)&&Cl(n,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(i=s[r],Cl(e,i.left,i.left+i.width)&&Cl(n,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!BX(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=RX(i,r);i&&!s&&hr(n.onLeave,[e,i,this],this),this._hoveredItem=r,r&&!s&&hr(n.onHover,[e,r,this],this)}else r&&hr(n.onClick,[e,r,this],this)}}function FX(t,e,n,r,i){const s=LX(r,t,e,n),o=MX(i,r,e.lineHeight);return{itemWidth:s,itemHeight:o}}function LX(t,e,n,r){let i=t.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+n.size/2+r.measureText(i).width}function MX(t,e,n){let r=t;return typeof e.text!="string"&&(r=nD(e,n)),r}function nD(t,e){const n=t.text?t.text.length:0;return e*n}function BX(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var C4={id:"legend",_element:l6,start(t,e,n){const r=t.legend=new l6({ctx:t.ctx,options:n,chart:t});No.configure(t,r,n),No.addBox(t,r)},stop(t){No.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;No.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,i=n.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:i,color:s,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),d=ko(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class rD extends ta{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const i=Xr(r.text)?r.text.length:1;this._padding=ko(r.padding);const s=i*Ji(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:r,bottom:i,right:s,options:o}=this,a=o.align;let l=0,c,d,f;return this.isHorizontal()?(d=Ki(a,r,s),f=n+e,c=s-r):(o.position==="left"?(d=r+e,f=Ki(a,i,n),l=Dr*-.5):(d=s-e,f=Ki(a,n,i),l=Dr*.5),c=i-n),{titleX:d,titleY:f,maxWidth:c,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const r=Ji(n.font),s=r.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);Dp(e,n.text,0,0,r,{color:n.color,maxWidth:l,rotation:c,textAlign:m4(n.align),textBaseline:"middle",translation:[o,a]})}}function OX(t,e){const n=new rD({ctx:t.ctx,options:e,chart:t});No.configure(t,n,e),No.addBox(t,n),t.titleBlock=n}var P4={id:"title",_element:rD,start(t,e,n){OX(t,n)},stop(t){const e=t.titleBlock;No.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;No.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const f0={average(t){if(!t.length)return!1;let e,n,r=new Set,i=0,s=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();r.add(l.x),i+=l.y,++s}}return s===0||r.size===0?!1:{x:[...r].reduce((a,l)=>a+l)/r.size,y:i/s}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,i=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=t.length;s<o;++s){const l=t[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),d=w5(e,c);d<i&&(i=d,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,r=l.y}return{x:n,y:r}}};function ba(t,e){return e&&(Xr(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function gl(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function VX(t,e){const{element:n,datasetIndex:r,index:i}=e,s=t.getDatasetMeta(r).controller,{label:o,value:a}=s.getLabelAndValue(i);return{chart:t,label:o,parsed:s.getParsed(i),raw:t.data.datasets[r].data[i],formattedValue:a,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:n}}function c6(t,e){const n=t.chart.ctx,{body:r,footer:i,title:s}=t,{boxWidth:o,boxHeight:a}=e,l=Ji(e.bodyFont),c=Ji(e.titleFont),d=Ji(e.footerFont),f=s.length,h=i.length,p=r.length,m=ko(e.padding);let g=m.height,b=0,x=r.reduce((E,D)=>E+D.before.length+D.lines.length+D.after.length,0);if(x+=t.beforeBody.length+t.afterBody.length,f&&(g+=f*c.lineHeight+(f-1)*e.titleSpacing+e.titleMarginBottom),x){const E=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=p*E+(x-p)*l.lineHeight+(x-1)*e.bodySpacing}h&&(g+=e.footerMarginTop+h*d.lineHeight+(h-1)*e.footerSpacing);let w=0;const N=function(E){b=Math.max(b,n.measureText(E).width+w)};return n.save(),n.font=c.string,Kn(t.title,N),n.font=l.string,Kn(t.beforeBody.concat(t.afterBody),N),w=e.displayColors?o+2+e.boxPadding:0,Kn(r,E=>{Kn(E.before,N),Kn(E.lines,N),Kn(E.after,N)}),w=0,n.font=d.string,Kn(t.footer,N),n.restore(),b+=m.width,{width:b,height:g}}function UX(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function zX(t,e,n,r){const{x:i,width:s}=r,o=n.caretSize+n.caretPadding;if(t==="left"&&i+s+o>e.width||t==="right"&&i-s-o<0)return!0}function qX(t,e,n,r){const{x:i,width:s}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return r==="center"?c=i<=(a+l)/2?"left":"right":i<=s/2?c="left":i>=o-s/2&&(c="right"),zX(c,t,e,n)&&(c="center"),c}function u6(t,e,n){const r=n.yAlign||e.yAlign||UX(t,n);return{xAlign:n.xAlign||e.xAlign||qX(t,e,n,r),yAlign:r}}function HX(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function WX(t,e,n){let{y:r,height:i}=t;return e==="top"?r+=n:e==="bottom"?r-=i+n:r-=i/2,r}function d6(t,e,n,r){const{caretSize:i,caretPadding:s,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=i+s,{topLeft:d,topRight:f,bottomLeft:h,bottomRight:p}=Uh(o);let m=HX(e,a);const g=WX(e,l,c);return l==="center"?a==="left"?m+=c:a==="right"&&(m-=c):a==="left"?m-=Math.max(d,h)+i:a==="right"&&(m+=Math.max(f,p)+i),{x:Xi(m,0,r.width-e.width),y:Xi(g,0,r.height-e.height)}}function _g(t,e,n){const r=ko(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function h6(t){return ba([],gl(t))}function $X(t,e,n){return Vd(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function f6(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const iD={beforeTitle:fl,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:fl,beforeBody:fl,beforeLabel:fl,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return qn(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:fl,afterBody:fl,beforeFooter:fl,footer:fl,afterFooter:fl};function ws(t,e,n,r){const i=t[e].call(n,r);return typeof i>"u"?iD[e].call(n,r):i}class k5 extends ta{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&n.options.animation&&r.animations,s=new Oj(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=$X(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,i=ws(r,"beforeTitle",this,e),s=ws(r,"title",this,e),o=ws(r,"afterTitle",this,e);let a=[];return a=ba(a,gl(i)),a=ba(a,gl(s)),a=ba(a,gl(o)),a}getBeforeBody(e,n){return h6(ws(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:r}=n,i=[];return Kn(e,s=>{const o={before:[],lines:[],after:[]},a=f6(r,s);ba(o.before,gl(ws(a,"beforeLabel",this,s))),ba(o.lines,ws(a,"label",this,s)),ba(o.after,gl(ws(a,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,n){return h6(ws(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:r}=n,i=ws(r,"beforeFooter",this,e),s=ws(r,"footer",this,e),o=ws(r,"afterFooter",this,e);let a=[];return a=ba(a,gl(i)),a=ba(a,gl(s)),a=ba(a,gl(o)),a}_createItems(e){const n=this._active,r=this.chart.data,i=[],s=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(VX(this.chart,n[l]));return e.filter&&(a=a.filter((d,f,h)=>e.filter(d,f,h,r))),e.itemSort&&(a=a.sort((d,f)=>e.itemSort(d,f,r))),Kn(a,d=>{const f=f6(e.callbacks,d);i.push(ws(f,"labelColor",this,d)),s.push(ws(f,"labelPointStyle",this,d)),o.push(ws(f,"labelTextColor",this,d))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const r=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const a=f0[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=c6(this,r),c=Object.assign({},a,l),d=u6(this.chart,r,c),f=d6(r,c,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,s={opacity:1,x:f.x,y:f.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,i){const s=this.getCaretPosition(e,r,i);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(e,n,r){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:d,bottomRight:f}=Uh(a),{x:h,y:p}=e,{width:m,height:g}=n;let b,x,w,N,E,D;return s==="center"?(E=p+g/2,i==="left"?(b=h,x=b-o,N=E+o,D=E-o):(b=h+m,x=b+o,N=E-o,D=E+o),w=b):(i==="left"?x=h+Math.max(l,d)+o:i==="right"?x=h+m-Math.max(c,f)-o:x=this.caretX,s==="top"?(N=p,E=N-o,b=x-o,w=x+o):(N=p+g,E=N+o,b=x+o,w=x-o),D=N),{x1:b,x2:x,x3:w,y1:N,y2:E,y3:D}}drawTitle(e,n,r){const i=this.title,s=i.length;let o,a,l;if(s){const c=zh(r.rtl,this.x,this.width);for(e.x=_g(this,r.titleAlign,r),n.textAlign=c.textAlign(r.titleAlign),n.textBaseline="middle",o=Ji(r.titleFont),a=r.titleSpacing,n.fillStyle=r.titleColor,n.font=o.string,l=0;l<s;++l)n.fillText(i[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,n,r,i,s){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=s,d=Ji(s.bodyFont),f=_g(this,"left",s),h=i.x(f),p=l<d.lineHeight?(d.lineHeight-l)/2:0,m=n.y+p;if(s.usePointStyle){const g={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},b=i.leftForLtr(h,c)+c/2,x=m+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,N5(e,g,b,x),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,N5(e,g,b,x)}else{e.lineWidth=Nn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const g=i.leftForLtr(h,c),b=i.leftForLtr(i.xPlus(h,1),c-2),x=Uh(o.borderRadius);Object.values(x).some(w=>w!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,hx(e,{x:g,y:m,w:c,h:l,radius:x}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),hx(e,{x:b,y:m+1,w:c-2,h:l-2,radius:x}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(g,m,c,l),e.strokeRect(g,m,c,l),e.fillStyle=o.backgroundColor,e.fillRect(b,m+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:d}=r,f=Ji(r.bodyFont);let h=f.lineHeight,p=0;const m=zh(r.rtl,this.x,this.width),g=function(v){n.fillText(v,m.x(e.x+p),e.y+h/2),e.y+=h+s},b=m.textAlign(o);let x,w,N,E,D,j,C;for(n.textAlign=o,n.textBaseline="middle",n.font=f.string,e.x=_g(this,b,r),n.fillStyle=r.bodyColor,Kn(this.beforeBody,g),p=a&&b!=="right"?o==="center"?c/2+d:c+2+d:0,E=0,j=i.length;E<j;++E){for(x=i[E],w=this.labelTextColors[E],n.fillStyle=w,Kn(x.before,g),N=x.lines,a&&N.length&&(this._drawColorBox(n,e,E,m,r),h=Math.max(f.lineHeight,l)),D=0,C=N.length;D<C;++D)g(N[D]),h=f.lineHeight;Kn(x.after,g)}p=0,h=f.lineHeight,Kn(this.afterBody,g),e.y-=s}drawFooter(e,n,r){const i=this.footer,s=i.length;let o,a;if(s){const l=zh(r.rtl,this.x,this.width);for(e.x=_g(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=l.textAlign(r.footerAlign),n.textBaseline="middle",o=Ji(r.footerFont),n.fillStyle=r.footerColor,n.font=o.string,a=0;a<s;++a)n.fillText(i[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,n,r,i){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:d}=r,{topLeft:f,topRight:h,bottomLeft:p,bottomRight:m}=Uh(i.cornerRadius);n.fillStyle=i.backgroundColor,n.strokeStyle=i.borderColor,n.lineWidth=i.borderWidth,n.beginPath(),n.moveTo(a+f,l),o==="top"&&this.drawCaret(e,n,r,i),n.lineTo(a+c-h,l),n.quadraticCurveTo(a+c,l,a+c,l+h),o==="center"&&s==="right"&&this.drawCaret(e,n,r,i),n.lineTo(a+c,l+d-m),n.quadraticCurveTo(a+c,l+d,a+c-m,l+d),o==="bottom"&&this.drawCaret(e,n,r,i),n.lineTo(a+p,l+d),n.quadraticCurveTo(a,l+d,a,l+d-p),o==="center"&&s==="left"&&this.drawCaret(e,n,r,i),n.lineTo(a,l+f),n.quadraticCurveTo(a,l,a+f,l),n.closePath(),n.fill(),i.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const o=f0[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=c6(this,e),l=Object.assign({},o,this._size),c=u6(n,e,l),d=d6(e,l,c,n);(i._to!==d.x||s._to!==d.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=ko(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,i,n),Dj(e,n.textDirection),s.y+=o.top,this.drawTitle(s,e,n),this.drawBody(s,e,n),this.drawFooter(s,e,n),Rj(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,i=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!cx(r,i),o=this._positionChanged(i,n);(s||o)&&(this._active=i,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,n,r),a=this._positionChanged(o,e),l=n||!cx(o,s)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,r,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:r,caretY:i,options:s}=this,o=f0[s.position].call(this,e,n);return o!==!1&&(r!==o.x||i!==o.y)}}Lt(k5,"positioners",f0);var k4={id:"tooltip",_element:k5,positioners:f0,afterInit(t,e,n){n&&(t.tooltip=new k5({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:iD},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const GX=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function KX(t,e,n,r){const i=t.indexOf(e);if(i===-1)return GX(t,e,n,r);const s=t.lastIndexOf(e);return i!==s?n:i}const QX=(t,e)=>t===null?null:Xi(Math.round(t),0,e);function p6(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Fp extends wf{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:i,label:s}of n)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(qn(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:KX(r,e,xn(n,e),this._addedLabels),QX(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=e===0&&n===s.length-1?s:s.slice(e,n+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=n;o++)i.push({value:o});return i}getLabelForValue(e){return p6.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Lt(Fp,"id","category"),Lt(Fp,"defaults",{ticks:{callback:p6}});function YX(t,e){const n=[],{bounds:i,step:s,min:o,max:a,precision:l,count:c,maxTicks:d,maxDigits:f,includeBounds:h}=t,p=s||1,m=d-1,{min:g,max:b}=e,x=!qn(o),w=!qn(a),N=!qn(c),E=(b-g)/(f+1);let D=dE((b-g)/m/p)*p,j,C,v,A;if(D<1e-14&&!x&&!w)return[{value:g},{value:b}];A=Math.ceil(b/D)-Math.floor(g/D),A>m&&(D=dE(A*D/m/p)*p),qn(l)||(j=Math.pow(10,l),D=Math.ceil(D*j)/j),i==="ticks"?(C=Math.floor(g/D)*D,v=Math.ceil(b/D)*D):(C=g,v=b),x&&w&&s&&sK((a-o)/s,D/1e3)?(A=Math.round(Math.min((a-o)/D,d)),D=(a-o)/A,C=o,v=a):N?(C=x?o:C,v=w?a:v,A=c-1,D=(v-C)/A):(A=(v-C)/D,I0(A,Math.round(A),D/1e3)?A=Math.round(A):A=Math.ceil(A));const I=Math.max(hE(D),hE(C));j=Math.pow(10,qn(l)?I:l),C=Math.round(C*j)/j,v=Math.round(v*j)/j;let S=0;for(x&&(h&&C!==o?(n.push({value:o}),C<o&&S++,I0(Math.round((C+S*D)*j)/j,o,m6(o,E,t))&&S++):C<o&&S++);S<A;++S){const P=Math.round((C+S*D)*j)/j;if(w&&P>a)break;n.push({value:P})}return w&&h&&v!==a?n.length&&I0(n[n.length-1].value,a,m6(a,E,t))?n[n.length-1].value=a:n.push({value:a}):(!w||v===a)&&n.push({value:v}),n}function m6(t,e,{horizontal:n,minRotation:r}){const i=El(r),s=(n?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+t).length;return Math.min(e/s,o)}class XX extends wf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return qn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const o=l=>i=n?i:l,a=l=>s=r?s:l;if(e){const l=Va(i),c=Va(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(i-l)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),n=n||11),n&&(i=Math.min(n,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,o=YX(i,s);return e.bounds==="ticks"&&oK(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const i=(r-n)/Math.max(e.length-1,1)/2;n-=i,r+=i}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return x4(e,this.chart.options.locale,this.options.ticks.format)}}class Lp extends XX{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ts(e)?e:0,this.max=ts(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=El(this.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Lt(Lp,"id","linear"),Lt(Lp,"defaults",{ticks:{callback:Sj.formatters.numeric}});const wy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ss=Object.keys(wy);function g6(t,e){return t-e}function x6(t,e){if(qn(e))return null;const n=t._adapter,{parser:r,round:i,isoWeekday:s}=t._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),ts(o)||(o=typeof r=="string"?n.parse(o,r):n.parse(o)),o===null?null:(i&&(o=i==="week"&&(Tp(s)||s===!0)?n.startOf(o,"isoWeek",s):n.startOf(o,i)),+o)}function y6(t,e,n,r){const i=Ss.length;for(let s=Ss.indexOf(t);s<i-1;++s){const o=wy[Ss[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=r)return Ss[s]}return Ss[i-1]}function JX(t,e,n,r,i){for(let s=Ss.length-1;s>=Ss.indexOf(n);s--){const o=Ss[s];if(wy[o].common&&t._adapter.diff(i,r,o)>=e-1)return o}return Ss[n?Ss.indexOf(n):0]}function ZX(t){for(let e=Ss.indexOf(t)+1,n=Ss.length;e<n;++e)if(wy[Ss[e]].common)return Ss[e]}function v6(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:i}=p4(n,e),s=n[r]>=e?n[r]:n[i];t[s]=!0}}function eJ(t,e,n,r){const i=t._adapter,s=+i.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+i.add(a,1,r))l=n[a],l>=0&&(e[l].major=!0);return e}function b6(t,e,n){const r=[],i={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],i[a]=o,r.push({value:a,major:!1});return s===0||!n?r:eJ(t,r,i,n)}class gx extends wf{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const r=e.time||(e.time={}),i=this._adapter=new UQ._date(e.adapters.date);i.init(n),T0(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:x6(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=ts(i)&&!isNaN(i)?i:+n.startOf(Date.now(),r),s=ts(s)&&!isNaN(s)?s:+n.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,a=dK(i,s,o);return this._unit=n.unit||(r.autoSkip?y6(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):JX(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:ZX(this._unit),this.initOffsets(i),e.reverse&&a.reverse(),b6(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?n=1-i:n=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=Xi(n,0,o),r=Xi(r,0,o),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||y6(s.minUnit,n,r,this._getLabelCapacity(n)),a=xn(i.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=Tp(l)||l===!0,d={};let f=n,h,p;if(c&&(f=+e.startOf(f,"isoWeek",l)),f=+e.startOf(f,c?"day":o),e.diff(r,n,o)>1e5*a)throw new Error(n+" and "+r+" are too far apart with stepSize of "+a+" "+o);const m=i.ticks.source==="data"&&this.getDataTimestamps();for(h=f,p=0;h<r;h=+e.add(h,a,o),p++)v6(d,h,m);return(h===r||i.bounds==="ticks"||p===1)&&v6(d,h,m),Object.keys(d).sort(g6).map(g=>+g)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){const i=this.options.time.displayFormats,s=this._unit,o=n||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,n,r,i){const s=this.options,o=s.ticks.callback;if(o)return hr(o,[e,n,r],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,d=l&&a[l],f=c&&a[c],h=r[n],p=c&&f&&h&&h.major;return this._adapter.format(e,i||(p?f:d))}generateTickLabels(e){let n,r,i;for(n=0,r=e.length;n<r;++n)i=e[n],i.label=this._tickFormatFunction(i.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,i=El(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:r*s+a*o,h:r*o+a*s}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,i=r[n.unit]||r.millisecond,s=this._tickFormatFunction(e,0,b6(this,[e],this._majorUnit),i),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(n=0,r=i.length;n<r;++n)e=e.concat(i[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const i=this.getLabels();for(n=0,r=i.length;n<r;++n)e.push(x6(this,i[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return wj(e.sort(g6))}}Lt(gx,"id","time"),Lt(gx,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Ng(t,e,n){let r=0,i=t.length-1,s,o,a,l;n?(e>=t[r].pos&&e<=t[i].pos&&({lo:r,hi:i}=Qu(t,"pos",e)),{pos:s,time:a}=t[r],{pos:o,time:l}=t[i]):(e>=t[r].time&&e<=t[i].time&&({lo:r,hi:i}=Qu(t,"time",e)),{time:s,pos:a}=t[r],{time:o,pos:l}=t[i]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class w6 extends gx{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Ng(n,this.min),this._tableRange=Ng(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,i=[],s=[];let o,a,l,c,d;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=r&&i.push(c);if(i.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(o=0,a=i.length;o<a;++o)d=i[o+1],l=i[o-1],c=i[o],Math.round((d+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_generate(){const e=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Ng(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return Ng(this._table,r*this._tableRange+this._minPos,!0)}}Lt(w6,"id","timeseries"),Lt(w6,"defaults",gx.defaults);const sD="label";function _6(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function tJ(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function oD(t,e){t.labels=e}function aD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sD;const r=[];t.datasets=e.map(i=>{const s=t.datasets.find(o=>o[n]===i[n]);return!s||!i.data||r.includes(s)?{...i}:(r.push(s),Object.assign(s,i),s)})}function nJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sD;const n={labels:[],datasets:[]};return oD(n,t.labels),aD(n,t.datasets,e),n}function rJ(t,e){const{height:n=150,width:r=300,redraw:i=!1,datasetIdKey:s,type:o,data:a,options:l,plugins:c=[],fallbackContent:d,updateMode:f,...h}=t,p=he.useRef(null),m=he.useRef(null),g=()=>{p.current&&(m.current=new _f(p.current,{type:o,data:nJ(a,s),options:l&&{...l},plugins:c}),_6(e,m.current))},b=()=>{_6(e,null),m.current&&(m.current.destroy(),m.current=null)};return he.useEffect(()=>{!i&&m.current&&l&&tJ(m.current,l)},[i,l]),he.useEffect(()=>{!i&&m.current&&oD(m.current.config.data,a.labels)},[i,a.labels]),he.useEffect(()=>{!i&&m.current&&a.datasets&&aD(m.current.config.data,a.datasets,s)},[i,a.datasets]),he.useEffect(()=>{m.current&&(i?(b(),setTimeout(g)):m.current.update(f))},[i,l,a.labels,a.datasets,f]),he.useEffect(()=>{m.current&&(b(),setTimeout(g))},[o]),he.useEffect(()=>(g(),()=>b()),[]),Ko.createElement("canvas",{ref:p,role:"img",height:n,width:r,...h},d)}const iJ=he.forwardRef(rJ);function _y(t,e){return _f.register(e),he.forwardRef((n,r)=>Ko.createElement(iJ,{...n,ref:r,type:t}))}const R0=_y("line",r1),sJ=_y("bar",n1),N6=_y("doughnut",Ph),oJ=_y("pie",A5);_f.register(Fp,Lp,qh,Da,P4,k4,C4,E4);const aJ=()=>{const[t,e]=he.useState({labels:[],datasets:[]}),[n,r]=he.useState(0),[i,s]=he.useState(0),[o,a]=he.useState(!0),[l,c]=he.useState(null),[d,f]=he.useState(null);he.useEffect(()=>{(async()=>{if(fn.currentUser)try{const g=await ps(ln(ot,"users",fn.currentUser.uid));if(g.exists()){const b=g.data();c(b.agencyName||null),f(b.company||null)}}catch(g){console.error("Error fetching user data:",g)}})()},[]),he.useEffect(()=>{(async()=>{if(!(!d||!l))try{const g=new Date,b=Ap(g,1),x=Array(24).fill(0),w=Array(24).fill(0),N=sx(g),E=ox(g),D=mn(en(ot,"ventes"),pt("company","==",d),pt("agency","==",l),pt("timestamp",">=",Bt.fromDate(N)),pt("timestamp","<=",Bt.fromDate(E))),j=sx(b),C=ox(b),v=mn(en(ot,"ventes"),pt("company","==",d),pt("agency","==",l),pt("timestamp",">=",Bt.fromDate(j)),pt("timestamp","<=",Bt.fromDate(C))),[A,I]=await Promise.all([On(D),On(v)]);let S=0;A.forEach(F=>{const q=F.data(),O=new Date(q.timestamp.toDate()).getHours(),M=q.totalAmount||0;x[O]+=M,S+=M});let P=0;I.forEach(F=>{const q=F.data(),O=new Date(q.timestamp.toDate()).getHours(),M=q.totalAmount||0;w[O]+=M,P+=M}),r(S),s(P);const k=Array.from({length:24},(F,q)=>`${q}h`);e({labels:k,datasets:[{label:"Aujourd'hui",data:x,borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.1)",borderWidth:2,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:4,pointHoverBackgroundColor:"rgb(147, 51, 234)",pointHoverBorderColor:"white",pointHoverBorderWidth:2},{label:"Hier",data:w,borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.1)",borderWidth:2,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:4,pointHoverBackgroundColor:"rgb(99, 102, 241)",pointHoverBorderColor:"white",pointHoverBorderWidth:2}]}),a(!1)}catch(g){console.error("Error fetching sales data:",g),a(!1)}})()},[d,l]);const h=i>0?(n-i)/i*100:0,p=n-i;return o?u.jsx("div",{className:"animate-pulse bg-white rounded-2xl shadow-sm p-6",children:u.jsx("div",{className:"h-[400px] bg-gray-100 rounded-xl"})}):u.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-8",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(tH,{className:"h-6 w-6 text-purple-600"}),u.jsx("h3",{className:"font-semibold text-xl text-gray-900",children:"Évolution des Ventes"})]}),u.jsx("div",{className:"text-sm text-gray-500",children:Kt(new Date,"dd MMMM yyyy",{locale:zn})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 animate-fade-in",children:[u.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 transform hover:scale-[1.02] transition-transform",children:[u.jsx("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"Chiffre du jour"}),u.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(n)})]}),u.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 transform hover:scale-[1.02] transition-transform",children:[u.jsx("div",{className:"text-sm font-medium text-gray-500 mb-2",children:"Chiffre de la veille"}),u.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(i)})]}),u.jsxs("div",{className:`rounded-xl p-4 transform hover:scale-[1.02] transition-transform ${h>=0?"bg-green-50":"bg-red-50"}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Évolution"}),h>=0?u.jsx(Np,{className:"h-5 w-5 text-green-600"}):u.jsx(d5,{className:"h-5 w-5 text-red-600"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:`text-2xl font-semibold ${h>=0?"text-green-600":"text-red-600"}`,children:[h.toFixed(1),"%"]}),u.jsxs("div",{className:`text-sm font-medium ${h>=0?"text-green-600":"text-red-600"}`,children:[p>=0?"+":"",new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(p)]})]})]})]}),u.jsx("div",{className:"h-[300px]",children:u.jsx(R0,{data:t,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top",align:"end",labels:{usePointStyle:!0,pointStyle:"circle",padding:20,font:{family:"'Inter', sans-serif",size:12}}},tooltip:{backgroundColor:"white",titleColor:"rgb(17, 24, 39)",bodyColor:"rgb(107, 114, 128)",borderColor:"rgb(229, 231, 235)",borderWidth:1,padding:12,bodyFont:{family:"'Inter', sans-serif",size:12},titleFont:{family:"'Inter', sans-serif",size:12,weight:"600"},mode:"index",intersect:!1,callbacks:{label:function(m){let g=m.dataset.label||"";return g&&(g+=": "),m.parsed.y!==null&&(g+=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(m.parsed.y)),g}}}},scales:{x:{grid:{display:!1},ticks:{font:{family:"'Inter', sans-serif",size:12}}},y:{beginAtZero:!0,border:{display:!1},grid:{color:"rgb(243, 244, 246)"},ticks:{font:{family:"'Inter', sans-serif",size:12},callback:function(m){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF",notation:"compact"}).format(Number(m))}}}}}})})]})},A6=()=>{const{user:t,loading:e}=Li();he.useState([new Date,new Date]);const[n,r]=he.useState(0),[i,s]=he.useState(0),[o,a]=he.useState(0),[l,c]=he.useState(0),[d,f]=he.useState(0),[h,p]=he.useState([]),[m,g]=he.useState([]),[b,x]=he.useState([]),[w,N]=he.useState({pains:0,viennoiseries:0,patisseries:0});return he.useEffect(()=>{if(!(t!=null&&t.company)||!(t!=null&&t.agencyName)||e)return;const E=new Date;E.setHours(0,0,0,0);const D=new Date(E);D.setDate(D.getDate()+1);const j=new Date(E);j.setDate(j.getDate()-1);const C=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",t.agencyName),pt("timestamp",">=",Bt.fromDate(E)),pt("timestamp","<",Bt.fromDate(D))),v=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",t.agencyName),pt("timestamp",">=",Bt.fromDate(j)),pt("timestamp","<",Bt.fromDate(E))),A=Ic(C,M=>{const W=M.docs.reduce((J,ne)=>J+ne.data().totalAmount,0);r(W),f(M.size);const z=M.docs.reduce((J,ne)=>J+ne.data().quantity.reduce((V,$)=>V+$,0),0);c(z)});On(v).then(M=>{const W=M.docs.reduce((z,J)=>z+J.data().totalAmount,0);if(s(W),W>0){const z=(n-W)/W*100;a(z)}});const I=mn(en(ot,"products"),pt("company","==",t.company),oi("totalSales","desc"),Cv(5)),S=Ic(I,M=>{const W=M.docs.map(z=>({name:z.data().name,quantity:z.data().totalQuantitySold||0,revenue:z.data().totalRevenue||0}));p(W)}),P=mn(en(ot,"products"),pt("company","==",t.company),pt("stock","<=",8),oi("stock","asc"),Cv(3)),k=Ic(P,M=>{const W=M.docs.map(z=>({name:z.data().name,stock:z.data().stock}));g(W)}),F=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",t.agencyName),oi("timestamp","desc"),Cv(10)),q=Ic(F,M=>{const W=M.docs.map(z=>{const J=z.data(),ne=J.timestamp instanceof Bt?J.timestamp.toDate():new Date(J.timestamp);return{time:Kt(ne,"HH:mm"),amount:J.totalAmount,items:J.quantity.reduce((V,$)=>V+$,0)}});x(W)}),O=Ic(mn(en(ot,"products"),pt("company","==",t.company)),M=>{const W=M.docs.reduce((J,ne)=>{const V=ne.data().category,$=ne.data().totalQuantitySold||0;return J[V]=(J[V]||0)+$,J},{}),z=Object.values(W).reduce((J,ne)=>J+ne,0);z>0&&Object.keys(W).forEach(J=>{W[J]=W[J]/z*100}),N(W)});return()=>{A(),S(),k(),q(),O()}},[t,e,n]),e?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#8B4513]"})}):!(t!=null&&t.company)||!(t!=null&&t.agencyName)?u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Informations entreprise ou agence manquantes"})}):u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Tableau de Bord"})}),u.jsx("div",{className:"mb-8",children:u.jsx(aJ,{userCompany:t.company})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[u.jsx("div",{className:"flex items-center justify-between mb-6",children:u.jsx("h3",{className:"font-bold text-lg text-[#8B4513]",children:"Meilleures Ventes"})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[u.jsx("th",{className:"pb-2",children:"Produit"}),u.jsx("th",{className:"pb-2",children:"Qté"}),u.jsx("th",{className:"pb-2",children:"Revenu"})]})}),u.jsx("tbody",{children:h.map((E,D)=>u.jsxs("tr",{className:"border-b border-gray-100",children:[u.jsx("td",{className:"py-3",children:E.name}),u.jsx("td",{className:"py-3",children:E.quantity}),u.jsxs("td",{className:"py-3",children:[Math.round(E.revenue)," Fcfa"]})]},D))})]})})]}),u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[u.jsx("div",{className:"flex items-center justify-between mb-6",children:u.jsx("h3",{className:"font-bold text-lg text-[#8B4513]",children:"Ventes par Catégorie"})}),u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"flex flex-col space-y-4 w-full",children:Object.entries(w).map(([E,D])=>u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between mb-1",children:[u.jsx("span",{className:"text-sm font-medium",children:E}),u.jsxs("span",{className:"text-sm font-medium",children:[Math.round(D),"%"]})]}),u.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:`h-2 rounded-full ${E==="pains"?"bg-[#8B4513]":E==="viennoiseries"?"bg-[#FFD700]":"bg-[#FF6B6B]"}`,style:{width:`${D}%`}})})]},E))})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"font-bold text-lg text-[#8B4513]",children:"Stock Faible"}),u.jsx("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded",children:"Attention"})]}),m.length>0?u.jsx("div",{className:"space-y-4",children:m.map((E,D)=>u.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg",children:[u.jsx("span",{className:"font-medium",children:E.name}),u.jsxs("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded",children:["Stock: ",E.stock]})]},D))}):u.jsx("p",{className:"text-center py-4 text-gray-500",children:"Tous les stocks sont à des niveaux satisfaisants."})]}),u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[u.jsx("div",{className:"flex items-center justify-between mb-6",children:u.jsx("h3",{className:"font-bold text-lg text-[#8B4513]",children:"Ventes Récentes"})}),u.jsx("div",{className:"space-y-3",children:b.map((E,D)=>u.jsxs("div",{className:"flex justify-between items-center p-3 border-b last:border-0",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500",children:E.time}),u.jsxs("p",{className:"text-sm",children:[E.items," article",E.items>1?"s":""]})]}),u.jsxs("span",{className:"font-bold",children:[Math.round(E.amount)," Fcfa"]})]},D))})]})]})]})},lJ=({onClose:t,onProductAdded:e})=>{const[n,r]=he.useState(!1),[i,s]=he.useState(""),o=he.useRef(null),[a,l]=he.useState(null),[c,d]=he.useState({name:"",description:"",price:"",category:"pains",reference:"",allergens:"",stock:"0",minStock:"5",freshWeight:"",department:"Boulangerie"}),f=[{value:"pains",label:"Pains"},{value:"viennoiseries",label:"Viennoiseries"},{value:"patisseries",label:"Pâtisseries"}],h=[{value:"boisson",label:"Boisson"},{value:"margarine",label:"Margarine"},{value:"raffinerie",label:"Raffinerie"},{value:"savonnerie",label:"Savonnerie"},{value:"cosmetique",label:"Cosmétique"},{value:"champs",label:"Champs"}],p=x=>{d(w=>({...w,department:x,category:x==="Boulangerie"?"pains":"boisson"}))},m=x=>{d(w=>({...w,category:x}))},g=x=>{var N;const w=(N=x.target.files)==null?void 0:N[0];if(w){if(w.size>2*1024*1024){s("L'image ne doit pas dépasser 2MB");return}const E=new FileReader;E.onloadend=()=>{l(E.result)},E.readAsDataURL(w)}},b=async x=>{var w,N;if(x.preventDefault(),!!fn.currentUser){s(""),r(!0);try{const E=parseFloat(c.price),D=parseInt(c.stock),j=parseInt(c.minStock),C=parseFloat(c.freshWeight);if(isNaN(E)||E<=0)throw new Error("Le prix doit être un nombre positif");if(isNaN(j)||j<0)throw new Error("Le stock minimum doit être un nombre positif");if(isNaN(D)||D<0)throw new Error("Le stock doit être un nombre positif");if(isNaN(C)||C<=0)throw new Error("Le poids unitaire frais doit être un nombre positif");if(j>D)throw new Error("Le stock minimum ne peut pas être supérieur au stock actuel");let v="";if((N=(w=o.current)==null?void 0:w.files)!=null&&N[0]){const P=o.current.files[0],k=vp(bp,`products/${lf()}`);await X_(k,P),v=await J_(k)}const A=await ps(ln(ot,"users",fn.currentUser.uid)),I=A.exists()?A.data().company:void 0;if(!I)throw new Error("Erreur: Informations entreprise manquantes");const S={name:c.name,description:c.description,price:E,category:c.category,reference:c.reference||`REF-${Date.now()}`,allergens:c.allergens.split(",").map(P=>P.trim()).filter(Boolean),stock:D,minStock:j,freshWeight:C,image:v,isFavorite:!1,createdAt:new Date().toISOString(),company:I,department:c.department};await Ld(en(ot,"products"),S),e(),t()}catch(E){s(E instanceof Error?E.message:"Une erreur est survenue")}finally{r(!1)}}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center sticky top-0",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Nouveau Produit"}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:b,className:"p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nom du produit *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.name,onChange:x=>d({...c,name:x.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Prix (Fcfa) *"}),u.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.price,onChange:x=>d({...c,price:x.target.value})})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Description"}),u.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",rows:3,value:c.description,onChange:x=>d({...c,description:x.target.value})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Département *"}),u.jsxs("select",{required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.department,onChange:x=>p(x.target.value),children:[u.jsx("option",{value:"Boulangerie",children:"Boulangerie"}),u.jsx("option",{value:"Boutique",children:"Boutique"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Catégorie *"}),u.jsx("select",{required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.category,onChange:x=>m(x.target.value),disabled:!c.department,children:c.department==="Boulangerie"?f.map(x=>u.jsx("option",{value:x.value,children:x.label},x.value)):h.map(x=>u.jsx("option",{value:x.value,children:x.label},x.value))}),c.department==="Boutique"&&u.jsx("p",{className:"mt-1 text-sm text-blue-600",children:"Catégories spécifiques à la boutique disponibles"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Référence"}),u.jsx("input",{type:"text",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.reference,onChange:x=>d({...c,reference:x.target.value}),placeholder:"Généré automatiquement si vide"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Stock initial"}),u.jsx("input",{type:"number",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.stock,onChange:x=>d({...c,stock:x.target.value})})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Stock minimum",u.jsx("span",{className:"ml-1 text-gray-400 hover:text-gray-600 cursor-help",title:"Seuil d'alerte pour le réapprovisionnement",children:"ⓘ"})]}),u.jsx("input",{type:"number",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.minStock,onChange:x=>d({...c,minStock:x.target.value})})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Poids unitaire frais (kg) *",u.jsx("span",{className:"ml-1 text-gray-400 hover:text-gray-600 cursor-help",title:"Poids du produit à l'état frais",children:"ⓘ"})]}),u.jsx("input",{type:"number",step:"0.001",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.freshWeight,onChange:x=>d({...c,freshWeight:x.target.value}),placeholder:"Ex: 0.250",min:"0.001"})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Allergènes"}),u.jsx("input",{type:"text",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:c.allergens,onChange:x=>d({...c,allergens:x.target.value}),placeholder:"Séparés par des virgules"})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Image du produit"}),u.jsx("div",{className:"mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg",children:u.jsxs("div",{className:"space-y-2 text-center",children:[a?u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:a,alt:"Aperçu",className:"mx-auto h-32 w-32 object-cover rounded-lg"}),u.jsx("button",{type:"button",onClick:()=>{l(null),o.current&&(o.current.value="")},className:"absolute top-0 right-0 -mt-2 -mr-2 bg-red-500 text-white rounded-full p-1",children:u.jsx(Cr,{className:"h-4 w-4"})})]}):u.jsxs(u.Fragment,{children:[u.jsx(n4,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("div",{className:"flex text-sm text-gray-600",children:u.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-[#8B4513] hover:text-[#663300]",children:[u.jsx("span",{children:"Télécharger une image"}),u.jsx("input",{ref:o,type:"file",className:"sr-only",accept:"image/*",onChange:g})]})})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG jusqu'à 2MB"})]})})]}),i&&u.jsx("div",{className:"mt-6 p-4 bg-red-100 text-red-700 rounded-lg",children:i}),u.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:n,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:n?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer"})]})]})]})})},cJ=({product:t,onClose:e,onProductUpdated:n})=>{var E,D;const{user:r}=Li(),[i,s]=he.useState(!1),[o,a]=he.useState(!1),[l,c]=he.useState(!1),[d,f]=he.useState([]),h=he.useRef(null),[p,m]=he.useState(null),[g,b]=he.useState({name:t.name,description:t.description||"",price:t.price.toString(),category:t.category,reference:t.reference,allergens:t.allergens.join(", "),minStock:((E=t.minStock)==null?void 0:E.toString())||"5",freshWeight:((D=t.freshWeight)==null?void 0:D.toString())||"",department:t.department,image:t.image,modificationReason:""});Ko.useEffect(()=>{(async()=>{try{const C=await ps(ln(ot,"products",t.id));if(C.exists()){const v=C.data();f(v.modificationHistory||[])}}catch(C){console.error("Error fetching modification history:",C)}})()},[t.id]);const x=async j=>{var v;const C=(v=j.target.files)==null?void 0:v[0];if(C){if(C.size>2*1024*1024){ke.error("L'image ne doit pas dépasser 2MB");return}try{a(!0);const I=await Ci(C,{maxSizeMB:1,maxWidthOrHeight:800,useWebWorker:!0}),S=new FileReader;S.onloadend=()=>{m(S.result)},S.readAsDataURL(I);const P=vp(bp,`products/${lf()}`);await X_(P,I);const k=await J_(P);b(F=>({...F,image:k})),ke.success("Image mise à jour")}catch(A){console.error("Error uploading image:",A),ke.error("Erreur lors du téléchargement de l'image")}finally{a(!1)}}},w=()=>{const j=[];return g.name!==t.name&&j.push({field:"Nom",oldValue:t.name,newValue:g.name}),g.description!==(t.description||"")&&j.push({field:"Description",oldValue:t.description||"",newValue:g.description}),parseFloat(g.price)!==t.price&&j.push({field:"Prix",oldValue:t.price,newValue:parseFloat(g.price)}),g.category!==t.category&&j.push({field:"Catégorie",oldValue:t.category,newValue:g.category}),g.reference!==t.reference&&j.push({field:"Référence",oldValue:t.reference,newValue:g.reference}),g.allergens!==t.allergens.join(", ")&&j.push({field:"Allergènes",oldValue:t.allergens.join(", "),newValue:g.allergens}),parseInt(g.minStock)!==(t.minStock||5)&&j.push({field:"Stock minimum",oldValue:t.minStock||5,newValue:parseInt(g.minStock)}),parseFloat(g.freshWeight)!==(t.freshWeight||0)&&j.push({field:"Poids unitaire",oldValue:t.freshWeight||0,newValue:parseFloat(g.freshWeight)}),g.department!==t.department&&j.push({field:"Département",oldValue:t.department,newValue:g.department}),g.image!==t.image&&j.push({field:"Image",oldValue:"Image précédente",newValue:"Nouvelle image"}),j},N=async j=>{if(j.preventDefault(),!r)return;const C=parseFloat(g.price),v=parseInt(g.minStock),A=parseFloat(g.freshWeight);if(isNaN(C)||C<=0){ke.error("Le prix doit être un nombre positif");return}if(isNaN(v)||v<0){ke.error("Le stock minimum doit être un nombre positif");return}if(isNaN(A)||A<=0){ke.error("Le poids unitaire doit être un nombre positif");return}const I=w();if(I.length===0){ke.error("Aucune modification détectée");return}if(!g.modificationReason.trim()){ke.error("Veuillez indiquer la raison de la modification");return}s(!0);try{if(g.image!==t.image&&t.image)try{const P=vp(bp,t.image);await SI(P)}catch(P){console.error("Error deleting old image:",P)}const S={name:g.name.trim(),description:g.description.trim(),price:C,category:g.category,reference:g.reference.trim(),allergens:g.allergens.split(",").map(P=>P.trim()).filter(Boolean),minStock:v,freshWeight:A,department:g.department,image:g.image,updatedAt:Bt.now(),lastModifiedBy:r.id,lastModifiedByName:`${r.firstName} ${r.lastName}`,modificationHistory:lI({timestamp:Bt.now(),modifiedBy:r.id,modifiedByName:`${r.firstName} ${r.lastName}`,changes:I,reason:g.modificationReason.trim()})};await na(ln(ot,"products",t.id),S),ke.success("Produit modifié avec succès"),n(),e()}catch(S){console.error("Error updating product:",S),ke.error("Erreur lors de la modification du produit")}finally{s(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center sticky top-0",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Modifier le Produit"}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>c(!l),className:"text-white hover:bg-[#663300] p-2 rounded-full",title:"Historique des modifications",children:u.jsx(LI,{className:"h-5 w-5"})}),u.jsx("button",{onClick:e,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]})]}),l&&u.jsxs("div",{className:"bg-gray-50 p-4 border-b",children:[u.jsx("h3",{className:"font-bold text-lg mb-4",children:"Historique des Modifications"}),d.length===0?u.jsx("p",{className:"text-gray-500",children:"Aucune modification enregistrée"}):u.jsx("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:d.map((j,C)=>u.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium",children:j.modifiedByName}),u.jsx("p",{className:"text-sm text-gray-500",children:Kt(j.timestamp.toDate(),"dd MMMM yyyy à HH:mm",{locale:zn})})]}),j.reason&&u.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:j.reason})]}),u.jsx("div",{className:"space-y-1",children:j.changes.map((v,A)=>u.jsxs("div",{className:"text-sm",children:[u.jsxs("span",{className:"font-medium",children:[v.field,":"]}),u.jsx("span",{className:"text-red-600 line-through ml-2",children:v.oldValue}),u.jsxs("span",{className:"text-green-600 ml-2",children:["→ ",v.newValue]})]},A))})]},C))})]}),u.jsxs("form",{onSubmit:N,className:"p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nom du produit *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.name,onChange:j=>b({...g,name:j.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Prix (Fcfa) *"}),u.jsx("input",{type:"number",step:"0.01",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.price,onChange:j=>b({...g,price:j.target.value})})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Description"}),u.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",rows:3,value:g.description,onChange:j=>b({...g,description:j.target.value})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Département *"}),u.jsxs("select",{required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.department,onChange:j=>b({...g,department:j.target.value}),children:[u.jsx("option",{value:"Boulangerie",children:"Boulangerie"}),u.jsx("option",{value:"Boutique",children:"Boutique"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Catégorie *"}),u.jsxs("select",{required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.category,onChange:j=>b({...g,category:j.target.value}),children:[u.jsx("option",{value:"pains",children:"Pains"}),u.jsx("option",{value:"viennoiseries",children:"Viennoiseries"}),u.jsx("option",{value:"patisseries",children:"Pâtisseries"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Référence *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.reference,onChange:j=>b({...g,reference:j.target.value})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Stock minimum"}),u.jsx("input",{type:"number",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.minStock,onChange:j=>b({...g,minStock:j.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Poids unitaire frais (kg) *"}),u.jsx("input",{type:"number",step:"0.001",required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.freshWeight,onChange:j=>b({...g,freshWeight:j.target.value}),min:"0.001"})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Allergènes"}),u.jsx("input",{type:"text",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:g.allergens,onChange:j=>b({...g,allergens:j.target.value}),placeholder:"Séparés par des virgules"})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Image du produit"}),u.jsx("div",{className:"mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg",children:u.jsxs("div",{className:"space-y-2 text-center",children:[p||g.image?u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:p||g.image,alt:"Aperçu",className:"mx-auto h-32 w-32 object-cover rounded-lg"}),u.jsx("button",{type:"button",onClick:()=>{m(null),b({...g,image:""}),h.current&&(h.current.value="")},className:"absolute top-0 right-0 -mt-2 -mr-2 bg-red-500 text-white rounded-full p-1",children:u.jsx(Cr,{className:"h-4 w-4"})})]}):u.jsxs(u.Fragment,{children:[u.jsx(n4,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("div",{className:"flex text-sm text-gray-600",children:u.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-[#8B4513] hover:text-[#663300]",children:[u.jsx("span",{children:"Télécharger une image"}),u.jsx("input",{ref:h,type:"file",className:"sr-only",accept:"image/*",onChange:x})]})})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG jusqu'à 2MB"})]})})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Raison de la modification *"}),u.jsx("textarea",{required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",rows:3,value:g.modificationReason,onChange:j=>b({...g,modificationReason:j.target.value}),placeholder:"Expliquez pourquoi vous modifiez ce produit..."})]}),u.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:i||o,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:i?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):u.jsxs(u.Fragment,{children:[u.jsx(hm,{className:"h-5 w-5 mr-2"}),"Enregistrer les modifications"]})})]})]})]})})},uJ=({selectedType:t,onTypeChange:e,bakeryCount:n,storeCount:r})=>u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:u.jsx("div",{className:"flex items-center justify-center",children:u.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[u.jsxs("button",{onClick:()=>e("bakery"),className:`flex items-center px-6 py-3 rounded-md text-sm font-medium transition-all duration-200 ${t==="bakery"?"bg-[#8B4513] text-white shadow-md transform scale-105":"text-gray-600 hover:text-[#8B4513] hover:bg-gray-50"}`,children:[u.jsx(dm,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Produits Boulangerie"}),u.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-bold ${t==="bakery"?"bg-white text-[#8B4513]":"bg-gray-200 text-gray-600"}`,children:n})]}),u.jsxs("button",{onClick:()=>e("store"),className:`flex items-center px-6 py-3 rounded-md text-sm font-medium transition-all duration-200 ${t==="store"?"bg-[#8B4513] text-white shadow-md transform scale-105":"text-gray-600 hover:text-[#8B4513] hover:bg-gray-50"}`,children:[u.jsx(dy,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Produits Boutique"}),u.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-bold ${t==="store"?"bg-white text-[#8B4513]":"bg-gray-200 text-gray-600"}`,children:r})]})]})})}),dJ=({activeCategory:t,onCategoryChange:e,categoryCounts:n})=>{const r=[{id:"boisson",name:"Boissons",icon:FI,color:"blue"},{id:"margarine",name:"Margarine",icon:ji,color:"yellow"},{id:"raffinerie",name:"Raffinerie",icon:ji,color:"orange"},{id:"savonnerie",name:"Savonnerie",icon:MI,color:"green"},{id:"cosmetique",name:"Cosmétique",icon:VI,color:"pink"},{id:"champs",name:"Champs",icon:UI,color:"emerald"}],i=(s,o)=>{const a={blue:o?"bg-blue-600 text-white":"bg-blue-50 text-blue-700 hover:bg-blue-100",yellow:o?"bg-yellow-600 text-white":"bg-yellow-50 text-yellow-700 hover:bg-yellow-100",orange:o?"bg-orange-600 text-white":"bg-orange-50 text-orange-700 hover:bg-orange-100",green:o?"bg-green-600 text-white":"bg-green-50 text-green-700 hover:bg-green-100",pink:o?"bg-pink-600 text-white":"bg-pink-50 text-pink-700 hover:bg-pink-100",emerald:o?"bg-emerald-600 text-white":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100"};return a[s]||a.blue};return u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:r.map(s=>{const o=s.icon,a=t===s.id,l=n[s.id]||0;return u.jsxs("button",{className:`flex flex-col items-center justify-center p-4 rounded-lg transition-all duration-200 transform hover:scale-105 ${i(s.color,a)} ${a?"shadow-lg":"shadow-sm hover:shadow-md"}`,onClick:()=>e(s.id),children:[u.jsx(o,{className:"h-8 w-8 mb-2"}),u.jsx("span",{className:"font-medium text-sm text-center",children:s.name}),u.jsx("span",{className:`mt-1 px-2 py-1 rounded-full text-xs font-bold ${a?"bg-white/20 text-white":"bg-gray-200 text-gray-600"}`,children:l})]},s.id)})})})},hJ=()=>{const{user:t}=Li(),[e,n]=he.useState([]),[r,i]=he.useState(!0),[s,o]=he.useState(!1),[a,l]=he.useState(!1),[c,d]=he.useState(null),[f,h]=he.useState(""),[p,m]=he.useState("bakery"),[g,b]=he.useState("pains"),[x,w]=he.useState("boisson"),N=(t==null?void 0:t.role)==="ADMINISTRATEUR",E=async()=>{if(!(!fn.currentUser||!(t!=null&&t.company)))try{const k=mn(en(ot,"products"),pt("company","==",t.company),oi("name","asc")),q=(await On(k)).docs.map(O=>({id:O.id,...O.data()}));n(q)}catch(k){console.error("Erreur lors du chargement des produits:",k),ke.error("Erreur lors du chargement des produits")}finally{i(!1)}};he.useEffect(()=>{E()},[t]);const D=async(k,F)=>{if(!(t!=null&&t.agencyName)){ke.error("Agence non définie");return}try{const q=ln(ot,"products",k),O=F==="active"?"dormant":"active";await na(q,{[`stateByAgency.${t.agencyName}`]:O,updatedAt:new Date().toISOString()}),ke.success(`Produit marqué comme ${O==="active"?"actif":"dormant"}`),E()}catch(q){console.error("Erreur lors de la mise à jour:",q),ke.error("Erreur lors de la mise à jour")}},j=k=>{if(!N){ke.error("Seuls les administrateurs peuvent modifier les produits");return}d(k),l(!0)},C=async(k,F)=>{if(!N){ke.error("Seuls les administrateurs peuvent supprimer les produits");return}if(window.confirm(`Êtes-vous sûr de vouloir supprimer le produit "${F}" ? Cette action est irréversible.`))try{await ry(ln(ot,"products",k)),ke.success("Produit supprimé avec succès"),E()}catch(q){console.error("Erreur lors de la suppression:",q),ke.error("Erreur lors de la suppression du produit")}},v=e.filter(k=>k.department==="Boulangerie"),A=e.filter(k=>k.department==="Boutique"),S=(()=>{let k=p==="bakery"?v:A;return p==="bakery"?g==="favoris"?k=k.filter(F=>F.isFavorite):k=k.filter(F=>F.category===g):k=k.filter(F=>F.category===x),f&&(k=k.filter(F=>F.name.toLowerCase().includes(f.toLowerCase())||F.reference.toLowerCase().includes(f.toLowerCase()))),k})(),P=()=>{const k={boisson:0,margarine:0,raffinerie:0,savonnerie:0,cosmetique:0,champs:0};return A.forEach(F=>{F.category in k&&k[F.category]++}),k};return r?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Gestion des Produits"}),N&&u.jsxs("button",{className:"bg-[#8B4513] text-white px-4 py-2 rounded-lg flex items-center hover:bg-[#663300]",onClick:()=>o(!0),children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Nouveau Produit"]})]}),!N&&u.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700",children:u.jsxs("p",{className:"text-sm",children:[u.jsx("strong",{children:"Information :"})," Seuls les administrateurs peuvent ajouter, modifier ou supprimer des produits."]})}),u.jsx(uJ,{selectedType:p,onTypeChange:m,bakeryCount:v.length,storeCount:A.length}),u.jsxs("div",{className:"mb-4 flex items-center justify-between bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${p==="bakery"?"bg-orange-500":"bg-blue-500"}`}),u.jsxs("span",{className:"font-medium text-gray-800",children:["Affichage des produits : ",p==="bakery"?"Boulangerie":"Boutique"]}),u.jsxs("span",{className:"ml-2 bg-white text-gray-800 px-3 py-1 rounded-full text-sm font-medium shadow-sm",children:[S.length," produit",S.length>1?"s":""]})]}),u.jsx("div",{className:"text-sm text-gray-600",children:p==="bakery"?`Catégorie: ${g==="favoris"?"Favoris":g}`:`Catégorie: ${x}`})]}),p==="bakery"?u.jsx(ej,{activeCategory:g,onCategoryChange:b}):u.jsx(dJ,{activeCategory:x,onCategoryChange:w,categoryCounts:P()}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"mb-6 relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Wl,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:`Rechercher dans les produits ${p==="bakery"?"boulangerie":"boutique"}...`,className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:f,onChange:k=>h(k.target.value)})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Nom"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Catégorie"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Référence"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Prix"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Stock Agence"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"État"}),N&&u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:S.map(k=>{var O;const F=t!=null&&t.agencyName&&((O=k.stateByAgency)==null?void 0:O[t.agencyName])||"active",q=t!=null&&t.agencyName&&k.stockParAgence&&k.stockParAgence[t.agencyName]||0;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 font-medium",children:k.name}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p==="bakery"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:k.category})}),u.jsx("td",{className:"px-6 py-4",children:k.reference}),u.jsxs("td",{className:"px-6 py-4",children:[k.price," Fcfa"]}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q<=(k.minStock||0)?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:q})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[u.jsx("input",{type:"checkbox",className:"sr-only peer",checked:F==="active",onChange:()=>D(k.id,F)}),u.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#8B4513]/50 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#8B4513]"}),u.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900",children:F==="active"?"Actif":"Dormant"})]})}),N&&u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:()=>j(k),className:"text-[#8B4513] hover:text-[#663300] font-medium transition-colors",title:"Modifier le produit",children:"Modifier"}),u.jsx("button",{onClick:()=>C(k.id,k.name),className:"text-red-600 hover:text-red-800 font-medium transition-colors",title:"Supprimer le produit",children:"Supprimer"})]})})]},k.id)})})]})}),S.length===0&&u.jsx("div",{className:"text-center py-8 text-gray-500",children:f?`Aucun produit trouvé pour "${f}" dans la catégorie ${p==="bakery"?g:x}`:`Aucun produit trouvé dans la catégorie ${p==="bakery"?g:x}`})]}),s&&N&&u.jsx(lJ,{onClose:()=>o(!1),onProductAdded:E}),a&&c&&N&&u.jsx(cJ,{product:c,onClose:()=>{l(!1),d(null)},onProductUpdated:E})]})},fJ=({user:t,onClose:e,onUserUpdated:n})=>{const[r,i]=he.useState({firstName:t.firstName,lastName:t.lastName,phone:t.phone||"",role:t.role}),[s,o]=he.useState(!1),a=async l=>{l.preventDefault(),o(!0);try{await na(ln(ot,"users",t.id),{firstName:r.firstName,lastName:r.lastName,phone:r.phone,role:r.role}),ke.success("Utilisateur mis à jour avec succès"),n(),e()}catch(c){console.error("Erreur lors de la mise à jour:",c),ke.error("Erreur lors de la mise à jour")}finally{o(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Modifier l'utilisateur"}),u.jsx("button",{onClick:e,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:a,className:"p-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Prénom"}),u.jsx("input",{type:"text",value:r.firstName,onChange:l=>i({...r,firstName:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nom"}),u.jsx("input",{type:"text",value:r.lastName,onChange:l=>i({...r,lastName:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Grade"}),u.jsxs("select",{value:r.role,onChange:l=>i({...r,role:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"CAISSIERE BOULANGERIE",children:"Caissière Boulangerie"}),u.jsx("option",{value:"CAISSIERE BOUTIQUE",children:"Caissière Boutique"}),u.jsx("option",{value:"GESTIONNAIRE",children:"Gestionnaire"}),u.jsx("option",{value:"ADMINISTRATEUR",children:"Administrateur"}),u.jsx("option",{value:"PRODUCTEUR",children:"Producteur"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Téléphone"}),u.jsx("input",{type:"tel",value:r.phone,onChange:l=>i({...r,phone:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",placeholder:"Ex: 06 12 34 56 78"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email"}),u.jsx("input",{type:"email",value:t.email,className:"w-full p-3 bg-gray-100 border border-gray-300 rounded-lg text-gray-500",disabled:!0})]})]}),u.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:s,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:s?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer"})]})]})]})})};var lD={exports:{}},T5={exports:{}};(function(t,e){(function(n,r){r(e,he)})(dn,function(n,r){function i(L,Y,te,oe,ge,de,xe){try{var Fe=L[de](xe),Le=Fe.value}catch(Ve){return void te(Ve)}Fe.done?Y(Le):Promise.resolve(Le).then(oe,ge)}function s(L){return function(){var Y=this,te=arguments;return new Promise(function(oe,ge){var de=L.apply(Y,te);function xe(Le){i(de,oe,ge,xe,Fe,"next",Le)}function Fe(Le){i(de,oe,ge,xe,Fe,"throw",Le)}xe(void 0)})}}function o(){return(o=Object.assign||function(L){for(var Y=1;Y<arguments.length;Y++){var te=arguments[Y];for(var oe in te)Object.prototype.hasOwnProperty.call(te,oe)&&(L[oe]=te[oe])}return L}).apply(this,arguments)}function a(L,Y){if(L==null)return{};var te,oe,ge={},de=Object.keys(L);for(oe=0;oe<de.length;oe++)te=de[oe],Y.indexOf(te)>=0||(ge[te]=L[te]);return ge}function l(L){var Y=function(te,oe){if(typeof te!="object"||te===null)return te;var ge=te[Symbol.toPrimitive];if(ge!==void 0){var de=ge.call(te,oe);if(typeof de!="object")return de;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(te)}(L,"string");return typeof Y=="symbol"?Y:String(Y)}r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var c={init:"init"},d=function(L){var Y=L.value;return Y===void 0?"":Y},f=function(){return r.createElement(r.Fragment,null," ")},h={Cell:d,width:150,minWidth:0,maxWidth:Number.MAX_SAFE_INTEGER};function p(){for(var L=arguments.length,Y=new Array(L),te=0;te<L;te++)Y[te]=arguments[te];return Y.reduce(function(oe,ge){var de=ge.style,xe=ge.className;return oe=o({},oe,{},a(ge,["style","className"])),de&&(oe.style=oe.style?o({},oe.style||{},{},de||{}):de),xe&&(oe.className=oe.className?oe.className+" "+xe:xe),oe.className===""&&delete oe.className,oe},{})}var m=function(L,Y){return Y===void 0&&(Y={}),function(te){return te===void 0&&(te={}),[].concat(L,[te]).reduce(function(oe,ge){return function de(xe,Fe,Le){return typeof Fe=="function"?de({},Fe(xe,Le)):Array.isArray(Fe)?p.apply(void 0,[xe].concat(Fe)):p(xe,Fe)}(oe,ge,o({},Y,{userProps:te}))},{})}},g=function(L,Y,te,oe){return te===void 0&&(te={}),L.reduce(function(ge,de){return de(ge,te)},Y)},b=function(L,Y,te){return te===void 0&&(te={}),L.forEach(function(oe){oe(Y,te)})};function x(L,Y,te,oe){L.findIndex(function(ge){return ge.pluginName===te}),Y.forEach(function(ge){L.findIndex(function(de){return de.pluginName===ge})})}function w(L,Y){return typeof L=="function"?L(Y):L}function N(L){var Y=r.useRef();return Y.current=L,r.useCallback(function(){return Y.current},[])}var E=typeof document<"u"?r.useLayoutEffect:r.useEffect;function D(L,Y){var te=r.useRef(!1);E(function(){te.current&&L(),te.current=!0},Y)}function j(L,Y,te){return te===void 0&&(te={}),function(oe,ge){ge===void 0&&(ge={});var de=typeof oe=="string"?Y[oe]:oe;if(de===void 0)throw console.info(Y),new Error("Renderer Error ☝️");return C(de,o({},L,{column:Y},te,{},ge))}}function C(L,Y){return function(oe){return typeof oe=="function"&&(ge=Object.getPrototypeOf(oe)).prototype&&ge.prototype.isReactComponent;var ge}(te=L)||typeof te=="function"||function(oe){return typeof oe=="object"&&typeof oe.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(oe.$$typeof.description)}(te)?r.createElement(L,Y):L;var te}function v(L,Y,te){return te===void 0&&(te=0),L.map(function(oe){return I(oe=o({},oe,{parent:Y,depth:te})),oe.columns&&(oe.columns=v(oe.columns,oe,te+1)),oe})}function A(L){return O(L,"columns")}function I(L){var Y=L.id,te=L.accessor,oe=L.Header;if(typeof te=="string"){Y=Y||te;var ge=te.split(".");te=function(de){return function(xe,Fe,Le){if(!Fe)return xe;var Ve,rt=typeof Fe=="function"?Fe:JSON.stringify(Fe),et=k.get(rt)||function(){var it=function(He){return function tt(ht,gt){if(gt===void 0&&(gt=[]),Array.isArray(ht))for(var St=0;St<ht.length;St+=1)tt(ht[St],gt);else gt.push(ht);return gt}(He).map(function(tt){return String(tt).replace(".","_")}).join(".").replace(V,".").replace($,"").split(".")}(Fe);return k.set(rt,it),it}();try{Ve=et.reduce(function(it,He){return it[He]},xe)}catch{}return Ve!==void 0?Ve:Le}(de,ge)}}if(!Y&&typeof oe=="string"&&oe&&(Y=oe),!Y&&L.columns)throw console.error(L),new Error('A column ID (or unique "Header" value) is required!');if(!Y)throw console.error(L),new Error("A column ID (or string accessor) is required!");return Object.assign(L,{id:Y,accessor:te}),L}function S(L,Y){if(!Y)throw new Error;return Object.assign(L,o({Header:f,Footer:f},h,{},Y,{},L)),Object.assign(L,{originalWidth:L.width}),L}function P(L,Y,te){te===void 0&&(te=function(){return{}});for(var oe=[],ge=L,de=0,xe=function(){return de++},Fe=function(){var Le={headers:[]},Ve=[],rt=ge.some(function(et){return et.parent});ge.forEach(function(et){var it,He=[].concat(Ve).reverse()[0];rt&&(et.parent?it=o({},et.parent,{originalId:et.parent.id,id:et.parent.id+"_"+xe(),headers:[et]},te(et)):it=S(o({originalId:et.id+"_placeholder",id:et.id+"_placeholder_"+xe(),placeholderOf:et,headers:[et]},te(et)),Y),He&&He.originalId===it.originalId?He.headers.push(et):Ve.push(it)),Le.headers.push(et)}),oe.push(Le),ge=Ve};ge.length;)Fe();return oe.reverse()}var k=new Map;function F(){for(var L=arguments.length,Y=new Array(L),te=0;te<L;te++)Y[te]=arguments[te];for(var oe=0;oe<Y.length;oe+=1)if(Y[oe]!==void 0)return Y[oe]}function q(L){if(typeof L=="function")return L}function O(L,Y){var te=[];return function oe(ge){ge.forEach(function(de){de[Y]?oe(de[Y]):te.push(de)})}(L),te}function M(L,Y){var te=Y.manualExpandedKey,oe=Y.expanded,ge=Y.expandSubRows,de=ge===void 0||ge,xe=[];return L.forEach(function(Fe){return function Le(Ve,rt){rt===void 0&&(rt=!0),Ve.isExpanded=Ve.original&&Ve.original[te]||oe[Ve.id],Ve.canExpand=Ve.subRows&&!!Ve.subRows.length,rt&&xe.push(Ve),Ve.subRows&&Ve.subRows.length&&Ve.isExpanded&&Ve.subRows.forEach(function(et){return Le(et,de)})}(Fe)}),xe}function W(L,Y,te){return q(L)||Y[L]||te[L]||te.text}function z(L,Y,te){return L?L(Y,te):Y===void 0}function J(){throw new Error("React-Table: You have not called prepareRow(row) one or more rows you are attempting to render.")}var ne=null,V=/\[/g,$=/\]/g,K=function(L){return o({role:"table"},L)},X=function(L){return o({role:"rowgroup"},L)},ae=function(L,Y){var te=Y.column;return o({key:"header_"+te.id,colSpan:te.totalVisibleHeaderCount,role:"columnheader"},L)},ye=function(L,Y){var te=Y.column;return o({key:"footer_"+te.id,colSpan:te.totalVisibleHeaderCount},L)},me=function(L,Y){return o({key:"headerGroup_"+Y.index,role:"row"},L)},_e=function(L,Y){return o({key:"footerGroup_"+Y.index},L)},Se=function(L,Y){return o({key:"row_"+Y.row.id,role:"row"},L)},Ce=function(L,Y){var te=Y.cell;return o({key:"cell_"+te.row.id+"_"+te.column.id,role:"cell"},L)};function ze(){return{useOptions:[],stateReducers:[],useControlledState:[],columns:[],columnsDeps:[],allColumns:[],allColumnsDeps:[],accessValue:[],materializedColumns:[],materializedColumnsDeps:[],useInstanceAfterData:[],visibleColumns:[],visibleColumnsDeps:[],headerGroups:[],headerGroupsDeps:[],useInstanceBeforeDimensions:[],useInstance:[],prepareRow:[],getTableProps:[K],getTableBodyProps:[X],getHeaderGroupProps:[me],getFooterGroupProps:[_e],getHeaderProps:[ae],getFooterProps:[ye],getRowProps:[Se],getCellProps:[Ce],useFinalInstance:[]}}c.resetHiddenColumns="resetHiddenColumns",c.toggleHideColumn="toggleHideColumn",c.setHiddenColumns="setHiddenColumns",c.toggleHideAllColumns="toggleHideAllColumns";var $e=function(L){L.getToggleHiddenProps=[dt],L.getToggleHideAllColumnsProps=[Ie],L.stateReducers.push(fe),L.useInstanceBeforeDimensions.push(yt),L.headerGroupsDeps.push(function(Y,te){var oe=te.instance;return[].concat(Y,[oe.state.hiddenColumns])}),L.useInstance.push(nt)};$e.pluginName="useColumnVisibility";var dt=function(L,Y){var te=Y.column;return[L,{onChange:function(oe){te.toggleHidden(!oe.target.checked)},style:{cursor:"pointer"},checked:te.isVisible,title:"Toggle Column Visible"}]},Ie=function(L,Y){var te=Y.instance;return[L,{onChange:function(oe){te.toggleHideAllColumns(!oe.target.checked)},style:{cursor:"pointer"},checked:!te.allColumnsHidden&&!te.state.hiddenColumns.length,title:"Toggle All Columns Hidden",indeterminate:!te.allColumnsHidden&&te.state.hiddenColumns.length}]};function fe(L,Y,te,oe){if(Y.type===c.init)return o({hiddenColumns:[]},L);if(Y.type===c.resetHiddenColumns)return o({},L,{hiddenColumns:oe.initialState.hiddenColumns||[]});if(Y.type===c.toggleHideColumn){var ge=(Y.value!==void 0?Y.value:!L.hiddenColumns.includes(Y.columnId))?[].concat(L.hiddenColumns,[Y.columnId]):L.hiddenColumns.filter(function(de){return de!==Y.columnId});return o({},L,{hiddenColumns:ge})}return Y.type===c.setHiddenColumns?o({},L,{hiddenColumns:w(Y.value,L.hiddenColumns)}):Y.type===c.toggleHideAllColumns?o({},L,{hiddenColumns:(Y.value!==void 0?Y.value:!L.hiddenColumns.length)?oe.allColumns.map(function(de){return de.id}):[]}):void 0}function yt(L){var Y=L.headers,te=L.state.hiddenColumns;r.useRef(!1).current;var oe=0;Y.forEach(function(ge){return oe+=function de(xe,Fe){xe.isVisible=Fe&&!te.includes(xe.id);var Le=0;return xe.headers&&xe.headers.length?xe.headers.forEach(function(Ve){return Le+=de(Ve,xe.isVisible)}):Le=xe.isVisible?1:0,xe.totalVisibleHeaderCount=Le,Le}(ge,!0)})}function nt(L){var Y=L.columns,te=L.flatHeaders,oe=L.dispatch,ge=L.allColumns,de=L.getHooks,xe=L.state.hiddenColumns,Fe=L.autoResetHiddenColumns,Le=Fe===void 0||Fe,Ve=N(L),rt=ge.length===xe.length,et=r.useCallback(function(gt,St){return oe({type:c.toggleHideColumn,columnId:gt,value:St})},[oe]),it=r.useCallback(function(gt){return oe({type:c.setHiddenColumns,value:gt})},[oe]),He=r.useCallback(function(gt){return oe({type:c.toggleHideAllColumns,value:gt})},[oe]),tt=m(de().getToggleHideAllColumnsProps,{instance:Ve()});te.forEach(function(gt){gt.toggleHidden=function(St){oe({type:c.toggleHideColumn,columnId:gt.id,value:St})},gt.getToggleHiddenProps=m(de().getToggleHiddenProps,{instance:Ve(),column:gt})});var ht=N(Le);D(function(){ht()&&oe({type:c.resetHiddenColumns})},[oe,Y]),Object.assign(L,{allColumnsHidden:rt,toggleHideColumn:et,setHiddenColumns:it,toggleHideAllColumns:He,getToggleHideAllColumnsProps:tt})}var qe={},Xe={},Ye=function(L,Y,te){return L},Je=function(L,Y){return L.subRows||[]},ut=function(L,Y,te){return""+(te?[te.id,Y].join("."):Y)},mt=function(L){return L};function Dt(L){var Y=L.initialState,te=Y===void 0?qe:Y,oe=L.defaultColumn,ge=oe===void 0?Xe:oe,de=L.getSubRows,xe=de===void 0?Je:de,Fe=L.getRowId,Le=Fe===void 0?ut:Fe,Ve=L.stateReducer,rt=Ve===void 0?Ye:Ve,et=L.useControlledState,it=et===void 0?mt:et;return o({},a(L,["initialState","defaultColumn","getSubRows","getRowId","stateReducer","useControlledState"]),{initialState:te,defaultColumn:ge,getSubRows:xe,getRowId:Le,stateReducer:rt,useControlledState:it})}function _t(L,Y){Y===void 0&&(Y=0);var te=0,oe=0,ge=0,de=0;return L.forEach(function(xe){var Fe=xe.headers;if(xe.totalLeft=Y,Fe&&Fe.length){var Le=_t(Fe,Y),Ve=Le[0],rt=Le[1],et=Le[2],it=Le[3];xe.totalMinWidth=Ve,xe.totalWidth=rt,xe.totalMaxWidth=et,xe.totalFlexWidth=it}else xe.totalMinWidth=xe.minWidth,xe.totalWidth=Math.min(Math.max(xe.minWidth,xe.width),xe.maxWidth),xe.totalMaxWidth=xe.maxWidth,xe.totalFlexWidth=xe.canResize?xe.totalWidth:0;xe.isVisible&&(Y+=xe.totalWidth,te+=xe.totalMinWidth,oe+=xe.totalWidth,ge+=xe.totalMaxWidth,de+=xe.totalFlexWidth)}),[te,oe,ge,de]}function Mt(L){var Y=L.data,te=L.rows,oe=L.flatRows,ge=L.rowsById,de=L.column,xe=L.getRowId,Fe=L.getSubRows,Le=L.accessValueHooks,Ve=L.getInstance;Y.forEach(function(rt,et){return function it(He,tt,ht,gt,St){ht===void 0&&(ht=0);var $t=He,Ct=xe(He,tt,gt),st=ge[Ct];if(st)st.subRows&&st.originalSubRows.forEach(function(bt,Pt){return it(bt,Pt,ht+1,st)});else if((st={id:Ct,original:$t,index:tt,depth:ht,cells:[{}]}).cells.map=J,st.cells.filter=J,st.cells.forEach=J,st.cells[0].getCellProps=J,st.values={},St.push(st),oe.push(st),ge[Ct]=st,st.originalSubRows=Fe(He,tt),st.originalSubRows){var Ut=[];st.originalSubRows.forEach(function(bt,Pt){return it(bt,Pt,ht+1,st,Ut)}),st.subRows=Ut}de.accessor&&(st.values[de.id]=de.accessor(He,tt,st,St,Y)),st.values[de.id]=g(Le,st.values[de.id],{row:st,column:de,instance:Ve()})}(rt,et,0,void 0,te)})}c.resetExpanded="resetExpanded",c.toggleRowExpanded="toggleRowExpanded",c.toggleAllRowsExpanded="toggleAllRowsExpanded";var Ht=function(L){L.getToggleAllRowsExpandedProps=[Rt],L.getToggleRowExpandedProps=[Ot],L.stateReducers.push(at),L.useInstance.push(cn),L.prepareRow.push(Yt)};Ht.pluginName="useExpanded";var Rt=function(L,Y){var te=Y.instance;return[L,{onClick:function(oe){te.toggleAllRowsExpanded()},style:{cursor:"pointer"},title:"Toggle All Rows Expanded"}]},Ot=function(L,Y){var te=Y.row;return[L,{onClick:function(){te.toggleRowExpanded()},style:{cursor:"pointer"},title:"Toggle Row Expanded"}]};function at(L,Y,te,oe){if(Y.type===c.init)return o({expanded:{}},L);if(Y.type===c.resetExpanded)return o({},L,{expanded:oe.initialState.expanded||{}});if(Y.type===c.toggleAllRowsExpanded){var ge=Y.value,de=oe.rowsById,xe=Object.keys(de).length===Object.keys(L.expanded).length;if(ge!==void 0?ge:!xe){var Fe={};return Object.keys(de).forEach(function(tt){Fe[tt]=!0}),o({},L,{expanded:Fe})}return o({},L,{expanded:{}})}if(Y.type===c.toggleRowExpanded){var Le,Ve=Y.id,rt=Y.value,et=L.expanded[Ve],it=rt!==void 0?rt:!et;if(!et&&it)return o({},L,{expanded:o({},L.expanded,(Le={},Le[Ve]=!0,Le))});if(et&&!it){var He=L.expanded;return He[Ve],o({},L,{expanded:a(He,[Ve].map(l))})}return L}}function cn(L){var Y=L.data,te=L.rows,oe=L.rowsById,ge=L.manualExpandedKey,de=ge===void 0?"expanded":ge,xe=L.paginateExpandedRows,Fe=xe===void 0||xe,Le=L.expandSubRows,Ve=Le===void 0||Le,rt=L.autoResetExpanded,et=rt===void 0||rt,it=L.getHooks,He=L.plugins,tt=L.state.expanded,ht=L.dispatch;x(He,["useSortBy","useGroupBy","usePivotColumns","useGlobalFilter"],"useExpanded");var gt=N(et),St=!!(Object.keys(oe).length&&Object.keys(tt).length);St&&Object.keys(oe).some(function(Zt){return!tt[Zt]})&&(St=!1),D(function(){gt()&&ht({type:c.resetExpanded})},[ht,Y]);var $t=r.useCallback(function(Zt,R){ht({type:c.toggleRowExpanded,id:Zt,value:R})},[ht]),Ct=r.useCallback(function(Zt){return ht({type:c.toggleAllRowsExpanded,value:Zt})},[ht]),st=r.useMemo(function(){return Fe?M(te,{manualExpandedKey:de,expanded:tt,expandSubRows:Ve}):te},[Fe,te,de,tt,Ve]),Ut=r.useMemo(function(){return function(Zt){var R=0;return Object.keys(Zt).forEach(function(Q){var ce=Q.split(".");R=Math.max(R,ce.length)}),R}(tt)},[tt]),bt=N(L),Pt=m(it().getToggleAllRowsExpandedProps,{instance:bt()});Object.assign(L,{preExpandedRows:te,expandedRows:st,rows:st,expandedDepth:Ut,isAllRowsExpanded:St,toggleRowExpanded:$t,toggleAllRowsExpanded:Ct,getToggleAllRowsExpandedProps:Pt})}function Yt(L,Y){var te=Y.instance.getHooks,oe=Y.instance;L.toggleRowExpanded=function(ge){return oe.toggleRowExpanded(L.id,ge)},L.getToggleRowExpandedProps=m(te().getToggleRowExpandedProps,{instance:oe,row:L})}var Rn=function(L,Y,te){return L=L.filter(function(oe){return Y.some(function(ge){var de=oe.values[ge];return String(de).toLowerCase().includes(String(te).toLowerCase())})})};Rn.autoRemove=function(L){return!L};var nn=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){var de=oe.values[ge];return de===void 0||String(de).toLowerCase()===String(te).toLowerCase()})})};nn.autoRemove=function(L){return!L};var An=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){var de=oe.values[ge];return de===void 0||String(de)===String(te)})})};An.autoRemove=function(L){return!L};var Zr=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){return oe.values[ge].includes(te)})})};Zr.autoRemove=function(L){return!L||!L.length};var sn=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){var de=oe.values[ge];return de&&de.length&&te.every(function(xe){return de.includes(xe)})})})};sn.autoRemove=function(L){return!L||!L.length};var ui=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){var de=oe.values[ge];return de&&de.length&&te.some(function(xe){return de.includes(xe)})})})};ui.autoRemove=function(L){return!L||!L.length};var yn=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){var de=oe.values[ge];return te.includes(de)})})};yn.autoRemove=function(L){return!L||!L.length};var mr=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){return oe.values[ge]===te})})};mr.autoRemove=function(L){return L===void 0};var Xn=function(L,Y,te){return L.filter(function(oe){return Y.some(function(ge){return oe.values[ge]==te})})};Xn.autoRemove=function(L){return L==null};var pn=function(L,Y,te){var oe=te||[],ge=oe[0],de=oe[1];if((ge=typeof ge=="number"?ge:-1/0)>(de=typeof de=="number"?de:1/0)){var xe=ge;ge=de,de=xe}return L.filter(function(Fe){return Y.some(function(Le){var Ve=Fe.values[Le];return Ve>=ge&&Ve<=de})})};pn.autoRemove=function(L){return!L||typeof L[0]!="number"&&typeof L[1]!="number"};var Et=Object.freeze({__proto__:null,text:Rn,exactText:nn,exactTextCase:An,includes:Zr,includesAll:sn,includesSome:ui,includesValue:yn,exact:mr,equals:Xn,between:pn});c.resetFilters="resetFilters",c.setFilter="setFilter",c.setAllFilters="setAllFilters";var on=function(L){L.stateReducers.push(Hr),L.useInstance.push(In)};function Hr(L,Y,te,oe){if(Y.type===c.init)return o({filters:[]},L);if(Y.type===c.resetFilters)return o({},L,{filters:oe.initialState.filters||[]});if(Y.type===c.setFilter){var ge=Y.columnId,de=Y.filterValue,xe=oe.allColumns,Fe=oe.filterTypes,Le=xe.find(function(ht){return ht.id===ge});if(!Le)throw new Error("React-Table: Could not find a column with id: "+ge);var Ve=W(Le.filter,Fe||{},Et),rt=L.filters.find(function(ht){return ht.id===ge}),et=w(de,rt&&rt.value);return z(Ve.autoRemove,et,Le)?o({},L,{filters:L.filters.filter(function(ht){return ht.id!==ge})}):o({},L,rt?{filters:L.filters.map(function(ht){return ht.id===ge?{id:ge,value:et}:ht})}:{filters:[].concat(L.filters,[{id:ge,value:et}])})}if(Y.type===c.setAllFilters){var it=Y.filters,He=oe.allColumns,tt=oe.filterTypes;return o({},L,{filters:w(it,L.filters).filter(function(ht){var gt=He.find(function(St){return St.id===ht.id});return!z(W(gt.filter,tt||{},Et).autoRemove,ht.value,gt)})})}}function In(L){var Y=L.data,te=L.rows,oe=L.flatRows,ge=L.rowsById,de=L.allColumns,xe=L.filterTypes,Fe=L.manualFilters,Le=L.defaultCanFilter,Ve=Le!==void 0&&Le,rt=L.disableFilters,et=L.state.filters,it=L.dispatch,He=L.autoResetFilters,tt=He===void 0||He,ht=r.useCallback(function(bt,Pt){it({type:c.setFilter,columnId:bt,filterValue:Pt})},[it]),gt=r.useCallback(function(bt){it({type:c.setAllFilters,filters:bt})},[it]);de.forEach(function(bt){var Pt=bt.id,Zt=bt.accessor,R=bt.defaultCanFilter,Q=bt.disableFilters;bt.canFilter=Zt?F(Q!==!0&&void 0,rt!==!0&&void 0,!0):F(R,Ve,!1),bt.setFilter=function(pe){return ht(bt.id,pe)};var ce=et.find(function(pe){return pe.id===Pt});bt.filterValue=ce&&ce.value});var St=r.useMemo(function(){if(Fe||!et.length)return[te,oe,ge];var bt=[],Pt={};return[function Zt(R,Q){Q===void 0&&(Q=0);var ce=R;return(ce=et.reduce(function(pe,ve){var Te=ve.id,Oe=ve.value,Me=de.find(function(U){return U.id===Te});if(!Me)return pe;Q===0&&(Me.preFilteredRows=pe);var _=W(Me.filter,xe||{},Et);return _?(Me.filteredRows=_(pe,[Te],Oe),Me.filteredRows):(console.warn("Could not find a valid 'column.filter' for column with the ID: "+Me.id+"."),pe)},R)).forEach(function(pe){bt.push(pe),Pt[pe.id]=pe,pe.subRows&&(pe.subRows=pe.subRows&&pe.subRows.length>0?Zt(pe.subRows,Q+1):pe.subRows)}),ce}(te),bt,Pt]},[Fe,et,te,oe,ge,de,xe]),$t=St[0],Ct=St[1],st=St[2];r.useMemo(function(){de.filter(function(bt){return!et.find(function(Pt){return Pt.id===bt.id})}).forEach(function(bt){bt.preFilteredRows=$t,bt.filteredRows=$t})},[$t,et,de]);var Ut=N(tt);D(function(){Ut()&&it({type:c.resetFilters})},[it,Fe?null:Y]),Object.assign(L,{preFilteredRows:te,preFilteredFlatRows:oe,preFilteredRowsById:ge,filteredRows:$t,filteredFlatRows:Ct,filteredRowsById:st,rows:$t,flatRows:Ct,rowsById:st,setFilter:ht,setAllFilters:gt})}on.pluginName="useFilters",c.resetGlobalFilter="resetGlobalFilter",c.setGlobalFilter="setGlobalFilter";var Hn=function(L){L.stateReducers.push(di),L.useInstance.push(Nt)};function di(L,Y,te,oe){if(Y.type===c.resetGlobalFilter)return o({},L,{globalFilter:oe.initialState.globalFilter||void 0});if(Y.type===c.setGlobalFilter){var ge=Y.filterValue,de=oe.userFilterTypes,xe=W(oe.globalFilter,de||{},Et),Fe=w(ge,L.globalFilter);return z(xe.autoRemove,Fe)?(L.globalFilter,a(L,["globalFilter"])):o({},L,{globalFilter:Fe})}}function Nt(L){var Y=L.data,te=L.rows,oe=L.flatRows,ge=L.rowsById,de=L.allColumns,xe=L.filterTypes,Fe=L.globalFilter,Le=L.manualGlobalFilter,Ve=L.state.globalFilter,rt=L.dispatch,et=L.autoResetGlobalFilter,it=et===void 0||et,He=L.disableGlobalFilter,tt=r.useCallback(function(st){rt({type:c.setGlobalFilter,filterValue:st})},[rt]),ht=r.useMemo(function(){if(Le||Ve===void 0)return[te,oe,ge];var st=[],Ut={},bt=W(Fe,xe||{},Et);if(!bt)return console.warn("Could not find a valid 'globalFilter' option."),te;de.forEach(function(Zt){var R=Zt.disableGlobalFilter;Zt.canFilter=F(R!==!0&&void 0,He!==!0&&void 0,!0)});var Pt=de.filter(function(Zt){return Zt.canFilter===!0});return[function Zt(R){return(R=bt(R,Pt.map(function(Q){return Q.id}),Ve)).forEach(function(Q){st.push(Q),Ut[Q.id]=Q,Q.subRows=Q.subRows&&Q.subRows.length?Zt(Q.subRows):Q.subRows}),R}(te),st,Ut]},[Le,Ve,Fe,xe,de,te,oe,ge,He]),gt=ht[0],St=ht[1],$t=ht[2],Ct=N(it);D(function(){Ct()&&rt({type:c.resetGlobalFilter})},[rt,Le?null:Y]),Object.assign(L,{preGlobalFilteredRows:te,preGlobalFilteredFlatRows:oe,preGlobalFilteredRowsById:ge,globalFilteredRows:gt,globalFilteredFlatRows:St,globalFilteredRowsById:$t,rows:gt,flatRows:St,rowsById:$t,setGlobalFilter:tt,disableGlobalFilter:He})}function Wr(L,Y){return Y.reduce(function(te,oe){return te+(typeof oe=="number"?oe:0)},0)}Hn.pluginName="useGlobalFilter";var Cn=Object.freeze({__proto__:null,sum:Wr,min:function(L){var Y=L[0]||0;return L.forEach(function(te){typeof te=="number"&&(Y=Math.min(Y,te))}),Y},max:function(L){var Y=L[0]||0;return L.forEach(function(te){typeof te=="number"&&(Y=Math.max(Y,te))}),Y},minMax:function(L){var Y=L[0]||0,te=L[0]||0;return L.forEach(function(oe){typeof oe=="number"&&(Y=Math.min(Y,oe),te=Math.max(te,oe))}),Y+".."+te},average:function(L){return Wr(0,L)/L.length},median:function(L){if(!L.length)return null;var Y=Math.floor(L.length/2),te=[].concat(L).sort(function(oe,ge){return oe-ge});return L.length%2!=0?te[Y]:(te[Y-1]+te[Y])/2},unique:function(L){return Array.from(new Set(L).values())},uniqueCount:function(L){return new Set(L).size},count:function(L){return L.length}}),Fn=[],sr={};c.resetGroupBy="resetGroupBy",c.setGroupBy="setGroupBy",c.toggleGroupBy="toggleGroupBy";var tr=function(L){L.getGroupByToggleProps=[Pr],L.stateReducers.push(sa),L.visibleColumnsDeps.push(function(Y,te){var oe=te.instance;return[].concat(Y,[oe.state.groupBy])}),L.visibleColumns.push(Ds),L.useInstance.push(Mi),L.prepareRow.push(wi)};tr.pluginName="useGroupBy";var Pr=function(L,Y){var te=Y.header;return[L,{onClick:te.canGroupBy?function(oe){oe.persist(),te.toggleGroupBy()}:void 0,style:{cursor:te.canGroupBy?"pointer":void 0},title:"Toggle GroupBy"}]};function sa(L,Y,te,oe){if(Y.type===c.init)return o({groupBy:[]},L);if(Y.type===c.resetGroupBy)return o({},L,{groupBy:oe.initialState.groupBy||[]});if(Y.type===c.setGroupBy)return o({},L,{groupBy:Y.value});if(Y.type===c.toggleGroupBy){var ge=Y.columnId,de=Y.value,xe=de!==void 0?de:!L.groupBy.includes(ge);return o({},L,xe?{groupBy:[].concat(L.groupBy,[ge])}:{groupBy:L.groupBy.filter(function(Fe){return Fe!==ge})})}}function Ds(L,Y){var te=Y.instance.state.groupBy,oe=te.map(function(de){return L.find(function(xe){return xe.id===de})}).filter(Boolean),ge=L.filter(function(de){return!te.includes(de.id)});return(L=[].concat(oe,ge)).forEach(function(de){de.isGrouped=te.includes(de.id),de.groupedIndex=te.indexOf(de.id)}),L}var hi={};function Mi(L){var Y=L.data,te=L.rows,oe=L.flatRows,ge=L.rowsById,de=L.allColumns,xe=L.flatHeaders,Fe=L.groupByFn,Le=Fe===void 0?fi:Fe,Ve=L.manualGroupBy,rt=L.aggregations,et=rt===void 0?hi:rt,it=L.plugins,He=L.state.groupBy,tt=L.dispatch,ht=L.autoResetGroupBy,gt=ht===void 0||ht,St=L.disableGroupBy,$t=L.defaultCanGroupBy,Ct=L.getHooks;x(it,["useColumnOrder","useFilters"],"useGroupBy");var st=N(L);de.forEach(function(Me){var _=Me.accessor,U=Me.defaultGroupBy,G=Me.disableGroupBy;Me.canGroupBy=_?F(Me.canGroupBy,G!==!0&&void 0,St!==!0&&void 0,!0):F(Me.canGroupBy,U,$t,!1),Me.canGroupBy&&(Me.toggleGroupBy=function(){return L.toggleGroupBy(Me.id)}),Me.Aggregated=Me.Aggregated||Me.Cell});var Ut=r.useCallback(function(Me,_){tt({type:c.toggleGroupBy,columnId:Me,value:_})},[tt]),bt=r.useCallback(function(Me){tt({type:c.setGroupBy,value:Me})},[tt]);xe.forEach(function(Me){Me.getGroupByToggleProps=m(Ct().getGroupByToggleProps,{instance:st(),header:Me})});var Pt=r.useMemo(function(){if(Ve||!He.length)return[te,oe,ge,Fn,sr,oe,ge];var Me=He.filter(function(Ft){return de.find(function(rn){return rn.id===Ft})}),_=[],U={},G=[],ee={},be=[],Pe={},We=function Ft(rn,Wt,Pn){if(Wt===void 0&&(Wt=0),Wt===Me.length)return rn.map(function(kr){return o({},kr,{depth:Wt})});var Mn=Me[Wt],Os=Le(rn,Mn);return Object.entries(Os).map(function(kr,uo){var Vs=kr[0],ma=kr[1],ga=Mn+":"+Vs,nl=Ft(ma,Wt+1,ga=Pn?Pn+">"+ga:ga),$r=Wt?O(ma,"leafRows"):ma,Zl=function(ei,rl,Vi){var tc={};return de.forEach(function(or){if(Me.includes(or.id))tc[or.id]=rl[0]?rl[0].values[or.id]:null;else{var _u=typeof or.aggregate=="function"?or.aggregate:et[or.aggregate]||Cn[or.aggregate];if(_u){var xs=rl.map(function(il){return il.values[or.id]}),nc=ei.map(function(il){var rc=il.values[or.id];if(!Vi&&or.aggregateValue){var Mo=typeof or.aggregateValue=="function"?or.aggregateValue:et[or.aggregateValue]||Cn[or.aggregateValue];if(!Mo)throw console.info({column:or}),new Error("React Table: Invalid column.aggregateValue option for column listed above");rc=Mo(rc,il,or)}return rc});tc[or.id]=_u(nc,xs)}else{if(or.aggregate)throw console.info({column:or}),new Error("React Table: Invalid column.aggregate option for column listed above");tc[or.id]=null}}}),tc}($r,ma,Wt),ec={id:ga,isGrouped:!0,groupByID:Mn,groupByVal:Vs,values:Zl,subRows:nl,leafRows:$r,depth:Wt,index:uo};return nl.forEach(function(ei){_.push(ei),U[ei.id]=ei,ei.isGrouped?(G.push(ei),ee[ei.id]=ei):(be.push(ei),Pe[ei.id]=ei)}),ec})}(te);return We.forEach(function(Ft){_.push(Ft),U[Ft.id]=Ft,Ft.isGrouped?(G.push(Ft),ee[Ft.id]=Ft):(be.push(Ft),Pe[Ft.id]=Ft)}),[We,_,U,G,ee,be,Pe]},[Ve,He,te,oe,ge,de,et,Le]),Zt=Pt[0],R=Pt[1],Q=Pt[2],ce=Pt[3],pe=Pt[4],ve=Pt[5],Te=Pt[6],Oe=N(gt);D(function(){Oe()&&tt({type:c.resetGroupBy})},[tt,Ve?null:Y]),Object.assign(L,{preGroupedRows:te,preGroupedFlatRow:oe,preGroupedRowsById:ge,groupedRows:Zt,groupedFlatRows:R,groupedRowsById:Q,onlyGroupedFlatRows:ce,onlyGroupedRowsById:pe,nonGroupedFlatRows:ve,nonGroupedRowsById:Te,rows:Zt,flatRows:R,rowsById:Q,toggleGroupBy:Ut,setGroupBy:bt})}function wi(L){L.allCells.forEach(function(Y){var te;Y.isGrouped=Y.column.isGrouped&&Y.column.id===L.groupByID,Y.isPlaceholder=!Y.isGrouped&&Y.column.isGrouped,Y.isAggregated=!Y.isGrouped&&!Y.isPlaceholder&&((te=L.subRows)==null?void 0:te.length)})}function fi(L,Y){return L.reduce(function(te,oe,ge){var de=""+oe.values[Y];return te[de]=Array.isArray(te[de])?te[de]:[],te[de].push(oe),te},{})}var gr=/([0-9]+)/gm;function _i(L,Y){return L===Y?0:L>Y?1:-1}function Bi(L,Y,te){return[L.values[te],Y.values[te]]}function Rs(L){return typeof L=="number"?isNaN(L)||L===1/0||L===-1/0?"":String(L):typeof L=="string"?L:""}var to=Object.freeze({__proto__:null,alphanumeric:function(L,Y,te){var oe=Bi(L,Y,te),ge=oe[0],de=oe[1];for(ge=Rs(ge),de=Rs(de),ge=ge.split(gr).filter(Boolean),de=de.split(gr).filter(Boolean);ge.length&&de.length;){var xe=ge.shift(),Fe=de.shift(),Le=parseInt(xe,10),Ve=parseInt(Fe,10),rt=[Le,Ve].sort();if(isNaN(rt[0])){if(xe>Fe)return 1;if(Fe>xe)return-1}else{if(isNaN(rt[1]))return isNaN(Le)?-1:1;if(Le>Ve)return 1;if(Ve>Le)return-1}}return ge.length-de.length},datetime:function(L,Y,te){var oe=Bi(L,Y,te),ge=oe[0],de=oe[1];return _i(ge=ge.getTime(),de=de.getTime())},basic:function(L,Y,te){var oe=Bi(L,Y,te);return _i(oe[0],oe[1])},string:function(L,Y,te){var oe=Bi(L,Y,te),ge=oe[0],de=oe[1];for(ge=ge.split("").filter(Boolean),de=de.split("").filter(Boolean);ge.length&&de.length;){var xe=ge.shift(),Fe=de.shift(),Le=xe.toLowerCase(),Ve=Fe.toLowerCase();if(Le>Ve)return 1;if(Ve>Le)return-1;if(xe>Fe)return 1;if(Fe>xe)return-1}return ge.length-de.length},number:function(L,Y,te){var oe=Bi(L,Y,te),ge=oe[0],de=oe[1],xe=/[^0-9.]/gi;return _i(ge=Number(String(ge).replace(xe,"")),de=Number(String(de).replace(xe,"")))}});c.resetSortBy="resetSortBy",c.setSortBy="setSortBy",c.toggleSortBy="toggleSortBy",c.clearSortBy="clearSortBy",h.sortType="alphanumeric",h.sortDescFirst=!1;var no=function(L){L.getSortByToggleProps=[To],L.stateReducers.push($l),L.useInstance.push(oa)};no.pluginName="useSortBy";var To=function(L,Y){var te=Y.instance,oe=Y.column,ge=te.isMultiSortEvent,de=ge===void 0?function(xe){return xe.shiftKey}:ge;return[L,{onClick:oe.canSort?function(xe){xe.persist(),oe.toggleSortBy(void 0,!te.disableMultiSort&&de(xe))}:void 0,style:{cursor:oe.canSort?"pointer":void 0},title:oe.canSort?"Toggle SortBy":void 0}]};function $l(L,Y,te,oe){if(Y.type===c.init)return o({sortBy:[]},L);if(Y.type===c.resetSortBy)return o({},L,{sortBy:oe.initialState.sortBy||[]});if(Y.type===c.clearSortBy)return o({},L,{sortBy:L.sortBy.filter(function(st){return st.id!==Y.columnId})});if(Y.type===c.setSortBy)return o({},L,{sortBy:Y.sortBy});if(Y.type===c.toggleSortBy){var ge,de=Y.columnId,xe=Y.desc,Fe=Y.multi,Le=oe.allColumns,Ve=oe.disableMultiSort,rt=oe.disableSortRemove,et=oe.disableMultiRemove,it=oe.maxMultiSortColCount,He=it===void 0?Number.MAX_SAFE_INTEGER:it,tt=L.sortBy,ht=Le.find(function(st){return st.id===de}).sortDescFirst,gt=tt.find(function(st){return st.id===de}),St=tt.findIndex(function(st){return st.id===de}),$t=xe!=null,Ct=[];return(ge=!Ve&&Fe?gt?"toggle":"add":St!==tt.length-1||tt.length!==1?"replace":gt?"toggle":"replace")!="toggle"||rt||$t||Fe&&et||!(gt&&gt.desc&&!ht||!gt.desc&&ht)||(ge="remove"),ge==="replace"?Ct=[{id:de,desc:$t?xe:ht}]:ge==="add"?(Ct=[].concat(tt,[{id:de,desc:$t?xe:ht}])).splice(0,Ct.length-He):ge==="toggle"?Ct=tt.map(function(st){return st.id===de?o({},st,{desc:$t?xe:!gt.desc}):st}):ge==="remove"&&(Ct=tt.filter(function(st){return st.id!==de})),o({},L,{sortBy:Ct})}}function oa(L){var Y=L.data,te=L.rows,oe=L.flatRows,ge=L.allColumns,de=L.orderByFn,xe=de===void 0?Wa:de,Fe=L.sortTypes,Le=L.manualSortBy,Ve=L.defaultCanSort,rt=L.disableSortBy,et=L.flatHeaders,it=L.state.sortBy,He=L.dispatch,tt=L.plugins,ht=L.getHooks,gt=L.autoResetSortBy,St=gt===void 0||gt;x(tt,["useFilters","useGlobalFilter","useGroupBy","usePivotColumns"],"useSortBy");var $t=r.useCallback(function(R){He({type:c.setSortBy,sortBy:R})},[He]),Ct=r.useCallback(function(R,Q,ce){He({type:c.toggleSortBy,columnId:R,desc:Q,multi:ce})},[He]),st=N(L);et.forEach(function(R){var Q=R.accessor,ce=R.canSort,pe=R.disableSortBy,ve=R.id,Te=Q?F(pe!==!0&&void 0,rt!==!0&&void 0,!0):F(Ve,ce,!1);R.canSort=Te,R.canSort&&(R.toggleSortBy=function(Me,_){return Ct(R.id,Me,_)},R.clearSortBy=function(){He({type:c.clearSortBy,columnId:R.id})}),R.getSortByToggleProps=m(ht().getSortByToggleProps,{instance:st(),column:R});var Oe=it.find(function(Me){return Me.id===ve});R.isSorted=!!Oe,R.sortedIndex=it.findIndex(function(Me){return Me.id===ve}),R.isSortedDesc=R.isSorted?Oe.desc:void 0});var Ut=r.useMemo(function(){if(Le||!it.length)return[te,oe];var R=[],Q=it.filter(function(ce){return ge.find(function(pe){return pe.id===ce.id})});return[function ce(pe){var ve=xe(pe,Q.map(function(Te){var Oe=ge.find(function(U){return U.id===Te.id});if(!Oe)throw new Error("React-Table: Could not find a column with id: "+Te.id+" while sorting");var Me=Oe.sortType,_=q(Me)||(Fe||{})[Me]||to[Me];if(!_)throw new Error("React-Table: Could not find a valid sortType of '"+Me+"' for column '"+Te.id+"'.");return function(U,G){return _(U,G,Te.id,Te.desc)}}),Q.map(function(Te){var Oe=ge.find(function(Me){return Me.id===Te.id});return Oe&&Oe.sortInverted?Te.desc:!Te.desc}));return ve.forEach(function(Te){R.push(Te),Te.subRows&&Te.subRows.length!==0&&(Te.subRows=ce(Te.subRows))}),ve}(te),R]},[Le,it,te,oe,ge,xe,Fe]),bt=Ut[0],Pt=Ut[1],Zt=N(St);D(function(){Zt()&&He({type:c.resetSortBy})},[Le?null:Y]),Object.assign(L,{preSortedRows:te,preSortedFlatRows:oe,sortedRows:bt,sortedFlatRows:Pt,rows:bt,flatRows:Pt,setSortBy:$t,toggleSortBy:Ct})}function Wa(L,Y,te){return[].concat(L).sort(function(oe,ge){for(var de=0;de<Y.length;de+=1){var xe=Y[de],Fe=te[de]===!1||te[de]==="desc",Le=xe(oe,ge);if(Le!==0)return Fe?-Le:Le}return te[0]?oe.index-ge.index:ge.index-oe.index})}c.resetPage="resetPage",c.gotoPage="gotoPage",c.setPageSize="setPageSize";var Fs=function(L){L.stateReducers.push(ro),L.useInstance.push(Ls)};function ro(L,Y,te,oe){if(Y.type===c.init)return o({pageSize:10,pageIndex:0},L);if(Y.type===c.resetPage)return o({},L,{pageIndex:oe.initialState.pageIndex||0});if(Y.type===c.gotoPage){var ge=oe.pageCount,de=oe.page,xe=w(Y.pageIndex,L.pageIndex),Fe=!1;return xe>L.pageIndex?Fe=ge===-1?de.length>=L.pageSize:xe<ge:xe<L.pageIndex&&(Fe=xe>-1),Fe?o({},L,{pageIndex:xe}):L}if(Y.type===c.setPageSize){var Le=Y.pageSize,Ve=L.pageSize*L.pageIndex;return o({},L,{pageIndex:Math.floor(Ve/Le),pageSize:Le})}}function Ls(L){var Y=L.rows,te=L.autoResetPage,oe=te===void 0||te,ge=L.manualExpandedKey,de=ge===void 0?"expanded":ge,xe=L.plugins,Fe=L.pageCount,Le=L.paginateExpandedRows,Ve=Le===void 0||Le,rt=L.expandSubRows,et=rt===void 0||rt,it=L.state,He=it.pageSize,tt=it.pageIndex,ht=it.expanded,gt=it.globalFilter,St=it.filters,$t=it.groupBy,Ct=it.sortBy,st=L.dispatch,Ut=L.data,bt=L.manualPagination;x(xe,["useGlobalFilter","useFilters","useGroupBy","useSortBy","useExpanded"],"usePagination");var Pt=N(oe);D(function(){Pt()&&st({type:c.resetPage})},[st,bt?null:Ut,gt,St,$t,Ct]);var Zt=bt?Fe:Math.ceil(Y.length/He),R=r.useMemo(function(){return Zt>0?[].concat(new Array(Zt)).fill(null).map(function(_,U){return U}):[]},[Zt]),Q=r.useMemo(function(){var _;if(bt)_=Y;else{var U=He*tt,G=U+He;_=Y.slice(U,G)}return Ve?_:M(_,{manualExpandedKey:de,expanded:ht,expandSubRows:et})},[et,ht,de,bt,tt,He,Ve,Y]),ce=tt>0,pe=Zt===-1?Q.length>=He:tt<Zt-1,ve=r.useCallback(function(_){st({type:c.gotoPage,pageIndex:_})},[st]),Te=r.useCallback(function(){return ve(function(_){return _-1})},[ve]),Oe=r.useCallback(function(){return ve(function(_){return _+1})},[ve]),Me=r.useCallback(function(_){st({type:c.setPageSize,pageSize:_})},[st]);Object.assign(L,{pageOptions:R,pageCount:Zt,page:Q,canPreviousPage:ce,canNextPage:pe,gotoPage:ve,previousPage:Te,nextPage:Oe,setPageSize:Me})}Fs.pluginName="usePagination",c.resetPivot="resetPivot",c.togglePivot="togglePivot";var io=function(L){L.getPivotToggleProps=[$a],L.stateReducers.push(Kl),L.useInstanceAfterData.push(Io),L.allColumns.push(Ga),L.accessValue.push(nr),L.materializedColumns.push(Ka),L.materializedColumnsDeps.push(Qa),L.visibleColumns.push(Ql),L.visibleColumnsDeps.push(Ya),L.useInstance.push(Yl),L.prepareRow.push(Oi)};io.pluginName="usePivotColumns";var Gl=[],$a=function(L,Y){var te=Y.header;return[L,{onClick:te.canPivot?function(oe){oe.persist(),te.togglePivot()}:void 0,style:{cursor:te.canPivot?"pointer":void 0},title:"Toggle Pivot"}]};function Kl(L,Y,te,oe){if(Y.type===c.init)return o({pivotColumns:Gl},L);if(Y.type===c.resetPivot)return o({},L,{pivotColumns:oe.initialState.pivotColumns||Gl});if(Y.type===c.togglePivot){var ge=Y.columnId,de=Y.value,xe=de!==void 0?de:!L.pivotColumns.includes(ge);return o({},L,xe?{pivotColumns:[].concat(L.pivotColumns,[ge])}:{pivotColumns:L.pivotColumns.filter(function(Fe){return Fe!==ge})})}}function Io(L){L.allColumns.forEach(function(Y){Y.isPivotSource=L.state.pivotColumns.includes(Y.id)})}function Ga(L,Y){var te=Y.instance;return L.forEach(function(oe){oe.isPivotSource=te.state.pivotColumns.includes(oe.id),oe.uniqueValues=new Set}),L}function nr(L,Y){var te=Y.column;return te.uniqueValues&&L!==void 0&&te.uniqueValues.add(L),L}function Ka(L,Y){var te=Y.instance,oe=te.allColumns,ge=te.state;if(!ge.pivotColumns.length||!ge.groupBy||!ge.groupBy.length)return L;var de=ge.pivotColumns.map(function(Le){return oe.find(function(Ve){return Ve.id===Le})}).filter(Boolean),xe=oe.filter(function(Le){return!Le.isPivotSource&&!ge.groupBy.includes(Le.id)&&!ge.pivotColumns.includes(Le.id)}),Fe=A(function Le(Ve,rt,et){Ve===void 0&&(Ve=0),et===void 0&&(et=[]);var it=de[Ve];return it?Array.from(it.uniqueValues).sort().map(function(He){var tt=o({},it,{Header:it.PivotHeader||typeof it.header=="string"?it.Header+": "+He:He,isPivotGroup:!0,parent:rt,depth:Ve,id:rt?rt.id+"."+it.id+"."+He:it.id+"."+He,pivotValue:He});return tt.columns=Le(Ve+1,tt,[].concat(et,[function(ht){return ht.values[it.id]===He}])),tt}):xe.map(function(He){return o({},He,{canPivot:!1,isPivoted:!0,parent:rt,depth:Ve,id:""+(rt?rt.id+"."+He.id:He.id),accessor:function(tt,ht,gt){if(et.every(function(St){return St(gt)}))return gt.values[He.id]}})})}());return[].concat(L,Fe)}function Qa(L,Y){var te=Y.instance.state,oe=te.pivotColumns,ge=te.groupBy;return[].concat(L,[oe,ge])}function Ql(L,Y){var te=Y.instance.state;return L=L.filter(function(oe){return!oe.isPivotSource}),te.pivotColumns.length&&te.groupBy&&te.groupBy.length&&(L=L.filter(function(oe){return oe.isGrouped||oe.isPivoted})),L}function Ya(L,Y){var te=Y.instance;return[].concat(L,[te.state.pivotColumns,te.state.groupBy])}function Yl(L){var Y=L.columns,te=L.allColumns,oe=L.flatHeaders,ge=L.getHooks,de=L.plugins,xe=L.dispatch,Fe=L.autoResetPivot,Le=Fe===void 0||Fe,Ve=L.manaulPivot,rt=L.disablePivot,et=L.defaultCanPivot;x(de,["useGroupBy"],"usePivotColumns");var it=N(L);te.forEach(function(tt){var ht=tt.accessor,gt=tt.defaultPivot,St=tt.disablePivot;tt.canPivot=ht?F(tt.canPivot,St!==!0&&void 0,rt!==!0&&void 0,!0):F(tt.canPivot,gt,et,!1),tt.canPivot&&(tt.togglePivot=function(){return L.togglePivot(tt.id)}),tt.Aggregated=tt.Aggregated||tt.Cell}),oe.forEach(function(tt){tt.getPivotToggleProps=m(ge().getPivotToggleProps,{instance:it(),header:tt})});var He=N(Le);D(function(){He()&&xe({type:c.resetPivot})},[xe,Ve?null:Y]),Object.assign(L,{togglePivot:function(tt,ht){xe({type:c.togglePivot,columnId:tt,value:ht})}})}function Oi(L){L.allCells.forEach(function(Y){Y.isPivoted=Y.column.isPivoted})}c.resetSelectedRows="resetSelectedRows",c.toggleAllRowsSelected="toggleAllRowsSelected",c.toggleRowSelected="toggleRowSelected",c.toggleAllPageRowsSelected="toggleAllPageRowsSelected";var jo=function(L){L.getToggleRowSelectedProps=[xr],L.getToggleAllRowsSelectedProps=[Ni],L.getToggleAllPageRowsSelectedProps=[Do],L.stateReducers.push(aa),L.useInstance.push(Xa),L.prepareRow.push(Ln)};jo.pluginName="useRowSelect";var xr=function(L,Y){var te=Y.instance,oe=Y.row,ge=te.manualRowSelectedKey,de=ge===void 0?"isSelected":ge;return[L,{onChange:function(xe){oe.toggleRowSelected(xe.target.checked)},style:{cursor:"pointer"},checked:!(!oe.original||!oe.original[de])||oe.isSelected,title:"Toggle Row Selected",indeterminate:oe.isSomeSelected}]},Ni=function(L,Y){var te=Y.instance;return[L,{onChange:function(oe){te.toggleAllRowsSelected(oe.target.checked)},style:{cursor:"pointer"},checked:te.isAllRowsSelected,title:"Toggle All Rows Selected",indeterminate:!!(!te.isAllRowsSelected&&Object.keys(te.state.selectedRowIds).length)}]},Do=function(L,Y){var te=Y.instance;return[L,{onChange:function(oe){te.toggleAllPageRowsSelected(oe.target.checked)},style:{cursor:"pointer"},checked:te.isAllPageRowsSelected,title:"Toggle All Current Page Rows Selected",indeterminate:!!(!te.isAllPageRowsSelected&&te.page.some(function(oe){var ge=oe.id;return te.state.selectedRowIds[ge]}))}]};function aa(L,Y,te,oe){if(Y.type===c.init)return o({selectedRowIds:{}},L);if(Y.type===c.resetSelectedRows)return o({},L,{selectedRowIds:oe.initialState.selectedRowIds||{}});if(Y.type===c.toggleAllRowsSelected){var ge=Y.value,de=oe.isAllRowsSelected,xe=oe.rowsById,Fe=oe.nonGroupedRowsById,Le=Fe===void 0?xe:Fe,Ve=ge!==void 0?ge:!de,rt=Object.assign({},L.selectedRowIds);return Ve?Object.keys(Le).forEach(function(ve){rt[ve]=!0}):Object.keys(Le).forEach(function(ve){delete rt[ve]}),o({},L,{selectedRowIds:rt})}if(Y.type===c.toggleRowSelected){var et=Y.id,it=Y.value,He=oe.rowsById,tt=oe.selectSubRows,ht=tt===void 0||tt,gt=oe.getSubRows,St=L.selectedRowIds[et],$t=it!==void 0?it:!St;if(St===$t)return L;var Ct=o({},L.selectedRowIds);return function ve(Te){var Oe=He[Te];if(Oe&&(Oe.isGrouped||($t?Ct[Te]=!0:delete Ct[Te]),ht&&gt(Oe)))return gt(Oe).forEach(function(Me){return ve(Me.id)})}(et),o({},L,{selectedRowIds:Ct})}if(Y.type===c.toggleAllPageRowsSelected){var st=Y.value,Ut=oe.page,bt=oe.rowsById,Pt=oe.selectSubRows,Zt=Pt===void 0||Pt,R=oe.isAllPageRowsSelected,Q=oe.getSubRows,ce=st!==void 0?st:!R,pe=o({},L.selectedRowIds);return Ut.forEach(function(ve){return function Te(Oe){var Me=bt[Oe];if(Me.isGrouped||(ce?pe[Oe]=!0:delete pe[Oe]),Zt&&Q(Me))return Q(Me).forEach(function(_){return Te(_.id)})}(ve.id)}),o({},L,{selectedRowIds:pe})}return L}function Xa(L){var Y=L.data,te=L.rows,oe=L.getHooks,ge=L.plugins,de=L.rowsById,xe=L.nonGroupedRowsById,Fe=xe===void 0?de:xe,Le=L.autoResetSelectedRows,Ve=Le===void 0||Le,rt=L.state.selectedRowIds,et=L.selectSubRows,it=et===void 0||et,He=L.dispatch,tt=L.page,ht=L.getSubRows;x(ge,["useFilters","useGroupBy","useSortBy","useExpanded","usePagination"],"useRowSelect");var gt=r.useMemo(function(){var Q=[];return te.forEach(function(ce){var pe=it?function ve(Te,Oe,Me){if(Oe[Te.id])return!0;var _=Me(Te);if(_&&_.length){var U=!0,G=!1;return _.forEach(function(ee){G&&!U||(ve(ee,Oe,Me)?G=!0:U=!1)}),!!U||!!G&&null}return!1}(ce,rt,ht):!!rt[ce.id];ce.isSelected=!!pe,ce.isSomeSelected=pe===null,pe&&Q.push(ce)}),Q},[te,it,rt,ht]),St=!!(Object.keys(Fe).length&&Object.keys(rt).length),$t=St;St&&Object.keys(Fe).some(function(Q){return!rt[Q]})&&(St=!1),St||tt&&tt.length&&tt.some(function(Q){var ce=Q.id;return!rt[ce]})&&($t=!1);var Ct=N(Ve);D(function(){Ct()&&He({type:c.resetSelectedRows})},[He,Y]);var st=r.useCallback(function(Q){return He({type:c.toggleAllRowsSelected,value:Q})},[He]),Ut=r.useCallback(function(Q){return He({type:c.toggleAllPageRowsSelected,value:Q})},[He]),bt=r.useCallback(function(Q,ce){return He({type:c.toggleRowSelected,id:Q,value:ce})},[He]),Pt=N(L),Zt=m(oe().getToggleAllRowsSelectedProps,{instance:Pt()}),R=m(oe().getToggleAllPageRowsSelectedProps,{instance:Pt()});Object.assign(L,{selectedFlatRows:gt,isAllRowsSelected:St,isAllPageRowsSelected:$t,toggleRowSelected:bt,toggleAllRowsSelected:st,getToggleAllRowsSelectedProps:Zt,getToggleAllPageRowsSelectedProps:R,toggleAllPageRowsSelected:Ut})}function Ln(L,Y){var te=Y.instance;L.toggleRowSelected=function(oe){return te.toggleRowSelected(L.id,oe)},L.getToggleRowSelectedProps=m(te.getHooks().getToggleRowSelectedProps,{instance:te,row:L})}var so=function(L){return{}},oo=function(L){return{}};c.setRowState="setRowState",c.setCellState="setCellState",c.resetRowState="resetRowState";var ms=function(L){L.stateReducers.push(bu),L.useInstance.push(Xl),L.prepareRow.push(wu)};function bu(L,Y,te,oe){var ge=oe.initialRowStateAccessor,de=ge===void 0?so:ge,xe=oe.initialCellStateAccessor,Fe=xe===void 0?oo:xe,Le=oe.rowsById;if(Y.type===c.init)return o({rowState:{}},L);if(Y.type===c.resetRowState)return o({},L,{rowState:oe.initialState.rowState||{}});if(Y.type===c.setRowState){var Ve,rt=Y.rowId,et=Y.value,it=L.rowState[rt]!==void 0?L.rowState[rt]:de(Le[rt]);return o({},L,{rowState:o({},L.rowState,(Ve={},Ve[rt]=w(et,it),Ve))})}if(Y.type===c.setCellState){var He,tt,ht,gt,St,$t=Y.rowId,Ct=Y.columnId,st=Y.value,Ut=L.rowState[$t]!==void 0?L.rowState[$t]:de(Le[$t]),bt=(Ut==null||(He=Ut.cellState)==null?void 0:He[Ct])!==void 0?Ut.cellState[Ct]:Fe((tt=Le[$t])==null||(ht=tt.cells)==null?void 0:ht.find(function(Pt){return Pt.column.id===Ct}));return o({},L,{rowState:o({},L.rowState,(St={},St[$t]=o({},Ut,{cellState:o({},Ut.cellState||{},(gt={},gt[Ct]=w(st,bt),gt))}),St))})}}function Xl(L){var Y=L.autoResetRowState,te=Y===void 0||Y,oe=L.data,ge=L.dispatch,de=r.useCallback(function(Le,Ve){return ge({type:c.setRowState,rowId:Le,value:Ve})},[ge]),xe=r.useCallback(function(Le,Ve,rt){return ge({type:c.setCellState,rowId:Le,columnId:Ve,value:rt})},[ge]),Fe=N(te);D(function(){Fe()&&ge({type:c.resetRowState})},[oe]),Object.assign(L,{setRowState:de,setCellState:xe})}function wu(L,Y){var te=Y.instance,oe=te.initialRowStateAccessor,ge=oe===void 0?so:oe,de=te.initialCellStateAccessor,xe=de===void 0?oo:de,Fe=te.state.rowState;L&&(L.state=Fe[L.id]!==void 0?Fe[L.id]:ge(L),L.setState=function(Le){return te.setRowState(L.id,Le)},L.cells.forEach(function(Le){L.state.cellState||(L.state.cellState={}),Le.state=L.state.cellState[Le.column.id]!==void 0?L.state.cellState[Le.column.id]:xe(Le),Le.setState=function(Ve){return te.setCellState(L.id,Le.column.id,Ve)}}))}ms.pluginName="useRowState",c.resetColumnOrder="resetColumnOrder",c.setColumnOrder="setColumnOrder";var gs=function(L){L.stateReducers.push(la),L.visibleColumnsDeps.push(function(Y,te){var oe=te.instance;return[].concat(Y,[oe.state.columnOrder])}),L.visibleColumns.push(ca),L.useInstance.push(ao)};function la(L,Y,te,oe){return Y.type===c.init?o({columnOrder:[]},L):Y.type===c.resetColumnOrder?o({},L,{columnOrder:oe.initialState.columnOrder||[]}):Y.type===c.setColumnOrder?o({},L,{columnOrder:w(Y.columnOrder,L.columnOrder)}):void 0}function ca(L,Y){var te=Y.instance.state.columnOrder;if(!te||!te.length)return L;for(var oe=[].concat(te),ge=[].concat(L),de=[],xe=function(){var Fe=oe.shift(),Le=ge.findIndex(function(Ve){return Ve.id===Fe});Le>-1&&de.push(ge.splice(Le,1)[0])};ge.length&&oe.length;)xe();return[].concat(de,ge)}function ao(L){var Y=L.dispatch;L.setColumnOrder=r.useCallback(function(te){return Y({type:c.setColumnOrder,columnOrder:te})},[Y])}gs.pluginName="useColumnOrder",h.canResize=!0,c.columnStartResizing="columnStartResizing",c.columnResizing="columnResizing",c.columnDoneResizing="columnDoneResizing",c.resetResize="resetResize";var Jn=function(L){L.getResizerProps=[Jl],L.getHeaderProps.push({style:{position:"relative"}}),L.stateReducers.push(Ja),L.useInstance.push(lo),L.useInstanceBeforeDimensions.push(Qt)},Jl=function(L,Y){var te=Y.instance,oe=Y.header,ge=te.dispatch,de=function(xe,Fe){var Le=!1;if(xe.type==="touchstart"){if(xe.touches&&xe.touches.length>1)return;Le=!0}var Ve,rt,et=function(Ct){var st=[];return function Ut(bt){bt.columns&&bt.columns.length&&bt.columns.map(Ut),st.push(bt)}(Ct),st}(Fe).map(function(Ct){return[Ct.id,Ct.totalWidth]}),it=Le?Math.round(xe.touches[0].clientX):xe.clientX,He=function(){window.cancelAnimationFrame(Ve),Ve=null,ge({type:c.columnDoneResizing})},tt=function(){window.cancelAnimationFrame(Ve),Ve=null,ge({type:c.columnResizing,clientX:rt})},ht=function(Ct){rt=Ct,Ve||(Ve=window.requestAnimationFrame(tt))},gt={mouse:{moveEvent:"mousemove",moveHandler:function(Ct){return ht(Ct.clientX)},upEvent:"mouseup",upHandler:function(Ct){document.removeEventListener("mousemove",gt.mouse.moveHandler),document.removeEventListener("mouseup",gt.mouse.upHandler),He()}},touch:{moveEvent:"touchmove",moveHandler:function(Ct){return Ct.cancelable&&(Ct.preventDefault(),Ct.stopPropagation()),ht(Ct.touches[0].clientX),!1},upEvent:"touchend",upHandler:function(Ct){document.removeEventListener(gt.touch.moveEvent,gt.touch.moveHandler),document.removeEventListener(gt.touch.upEvent,gt.touch.moveHandler),He()}}},St=Le?gt.touch:gt.mouse,$t=!!function(){if(typeof ne=="boolean")return ne;var Ct=!1;try{var st={get passive(){return Ct=!0,!1}};window.addEventListener("test",null,st),window.removeEventListener("test",null,st)}catch{Ct=!1}return ne=Ct}()&&{passive:!1};document.addEventListener(St.moveEvent,St.moveHandler,$t),document.addEventListener(St.upEvent,St.upHandler,$t),ge({type:c.columnStartResizing,columnId:Fe.id,columnWidth:Fe.totalWidth,headerIdWidths:et,clientX:it})};return[L,{onMouseDown:function(xe){return xe.persist()||de(xe,oe)},onTouchStart:function(xe){return xe.persist()||de(xe,oe)},style:{cursor:"col-resize"},draggable:!1,role:"separator"}]};function Ja(L,Y){if(Y.type===c.init)return o({columnResizing:{columnWidths:{}}},L);if(Y.type===c.resetResize)return o({},L,{columnResizing:{columnWidths:{}}});if(Y.type===c.columnStartResizing){var te=Y.clientX,oe=Y.columnId,ge=Y.columnWidth,de=Y.headerIdWidths;return o({},L,{columnResizing:o({},L.columnResizing,{startX:te,headerIdWidths:de,columnWidth:ge,isResizingColumn:oe})})}if(Y.type===c.columnResizing){var xe=Y.clientX,Fe=L.columnResizing,Le=Fe.startX,Ve=Fe.columnWidth,rt=Fe.headerIdWidths,et=(xe-Le)/Ve,it={};return(rt===void 0?[]:rt).forEach(function(He){var tt=He[0],ht=He[1];it[tt]=Math.max(ht+ht*et,0)}),o({},L,{columnResizing:o({},L.columnResizing,{columnWidths:o({},L.columnResizing.columnWidths,{},it)})})}return Y.type===c.columnDoneResizing?o({},L,{columnResizing:o({},L.columnResizing,{startX:null,isResizingColumn:null})}):void 0}Jn.pluginName="useResizeColumns";var Qt=function(L){var Y=L.flatHeaders,te=L.disableResizing,oe=L.getHooks,ge=L.state.columnResizing,de=N(L);Y.forEach(function(xe){var Fe=F(xe.disableResizing!==!0&&void 0,te!==!0&&void 0,!0);xe.canResize=Fe,xe.width=ge.columnWidths[xe.id]||xe.originalWidth||xe.width,xe.isResizing=ge.isResizingColumn===xe.id,Fe&&(xe.getResizerProps=m(oe().getResizerProps,{instance:de(),header:xe}))})};function lo(L){var Y=L.plugins,te=L.dispatch,oe=L.autoResetResize,ge=oe===void 0||oe,de=L.columns;x(Y,["useAbsoluteLayout"],"useResizeColumns");var xe=N(ge);D(function(){xe()&&te({type:c.resetResize})},[de]);var Fe=r.useCallback(function(){return te({type:c.resetResize})},[te]);Object.assign(L,{resetResizing:Fe})}var Za={position:"absolute",top:0},ns=function(L){L.getTableBodyProps.push(Ro),L.getRowProps.push(Ro),L.getHeaderGroupProps.push(Ro),L.getFooterGroupProps.push(Ro),L.getHeaderProps.push(function(Y,te){var oe=te.column;return[Y,{style:o({},Za,{left:oe.totalLeft+"px",width:oe.totalWidth+"px"})}]}),L.getCellProps.push(function(Y,te){var oe=te.cell;return[Y,{style:o({},Za,{left:oe.column.totalLeft+"px",width:oe.column.totalWidth+"px"})}]}),L.getFooterProps.push(function(Y,te){var oe=te.column;return[Y,{style:o({},Za,{left:oe.totalLeft+"px",width:oe.totalWidth+"px"})}]})};ns.pluginName="useAbsoluteLayout";var Ro=function(L,Y){return[L,{style:{position:"relative",width:Y.instance.totalColumnsWidth+"px"}}]},Ai={display:"inline-block",boxSizing:"border-box"},co=function(L,Y){return[L,{style:{display:"flex",width:Y.instance.totalColumnsWidth+"px"}}]},ua=function(L){L.getRowProps.push(co),L.getHeaderGroupProps.push(co),L.getFooterGroupProps.push(co),L.getHeaderProps.push(function(Y,te){var oe=te.column;return[Y,{style:o({},Ai,{width:oe.totalWidth+"px"})}]}),L.getCellProps.push(function(Y,te){var oe=te.cell;return[Y,{style:o({},Ai,{width:oe.column.totalWidth+"px"})}]}),L.getFooterProps.push(function(Y,te){var oe=te.column;return[Y,{style:o({},Ai,{width:oe.totalWidth+"px"})}]})};function Fo(L){L.getTableProps.push(da),L.getRowProps.push(ha),L.getHeaderGroupProps.push(ha),L.getFooterGroupProps.push(ha),L.getHeaderProps.push(Ms),L.getCellProps.push(rs),L.getFooterProps.push(Bs)}ua.pluginName="useBlockLayout",Fo.pluginName="useFlexLayout";var da=function(L,Y){return[L,{style:{minWidth:Y.instance.totalColumnsMinWidth+"px"}}]},ha=function(L,Y){return[L,{style:{display:"flex",flex:"1 0 auto",minWidth:Y.instance.totalColumnsMinWidth+"px"}}]},Ms=function(L,Y){var te=Y.column;return[L,{style:{boxSizing:"border-box",flex:te.totalFlexWidth?te.totalFlexWidth+" 0 auto":void 0,minWidth:te.totalMinWidth+"px",width:te.totalWidth+"px"}}]},rs=function(L,Y){var te=Y.cell;return[L,{style:{boxSizing:"border-box",flex:te.column.totalFlexWidth+" 0 auto",minWidth:te.column.totalMinWidth+"px",width:te.column.totalWidth+"px"}}]},Bs=function(L,Y){var te=Y.column;return[L,{style:{boxSizing:"border-box",flex:te.totalFlexWidth?te.totalFlexWidth+" 0 auto":void 0,minWidth:te.totalMinWidth+"px",width:te.totalWidth+"px"}}]};function fa(L){L.stateReducers.push(tl),L.getTableProps.push(jn),L.getHeaderProps.push(el),L.getRowProps.push(pa)}c.columnStartResizing="columnStartResizing",c.columnResizing="columnResizing",c.columnDoneResizing="columnDoneResizing",c.resetResize="resetResize",fa.pluginName="useGridLayout";var jn=function(L,Y){var te=Y.instance;return[L,{style:{display:"grid",gridTemplateColumns:te.visibleColumns.map(function(oe){var ge;return te.state.gridLayout.columnWidths[oe.id]?te.state.gridLayout.columnWidths[oe.id]+"px":(ge=te.state.columnResizing)!=null&&ge.isResizingColumn?te.state.gridLayout.startWidths[oe.id]+"px":typeof oe.width=="number"?oe.width+"px":oe.width}).join(" ")}}]},el=function(L,Y){var te=Y.column;return[L,{id:"header-cell-"+te.id,style:{position:"sticky",gridColumn:"span "+te.totalVisibleHeaderCount}}]},pa=function(L,Y){var te=Y.row;return te.isExpanded?[L,{style:{gridColumn:"1 / "+(te.cells.length+1)}}]:[L,{}]};function tl(L,Y,te,oe){if(Y.type===c.init)return o({gridLayout:{columnWidths:{}}},L);if(Y.type===c.resetResize)return o({},L,{gridLayout:{columnWidths:{}}});if(Y.type===c.columnStartResizing){var ge=Y.columnId,de=Y.headerIdWidths,xe=Lo(ge);if(xe!==void 0){var Fe=oe.visibleColumns.reduce(function(st,Ut){var bt;return o({},st,((bt={})[Ut.id]=Lo(Ut.id),bt))},{}),Le=oe.visibleColumns.reduce(function(st,Ut){var bt;return o({},st,((bt={})[Ut.id]=Ut.minWidth,bt))},{}),Ve=oe.visibleColumns.reduce(function(st,Ut){var bt;return o({},st,((bt={})[Ut.id]=Ut.maxWidth,bt))},{}),rt=de.map(function(st){var Ut=st[0];return[Ut,Lo(Ut)]});return o({},L,{gridLayout:o({},L.gridLayout,{startWidths:Fe,minWidths:Le,maxWidths:Ve,headerIdGridWidths:rt,columnWidth:xe})})}return L}if(Y.type===c.columnResizing){var et=Y.clientX,it=L.columnResizing.startX,He=L.gridLayout,tt=He.columnWidth,ht=He.minWidths,gt=He.maxWidths,St=He.headerIdGridWidths,$t=(et-it)/tt,Ct={};return(St===void 0?[]:St).forEach(function(st){var Ut=st[0],bt=st[1];Ct[Ut]=Math.min(Math.max(ht[Ut],bt+bt*$t),gt[Ut])}),o({},L,{gridLayout:o({},L.gridLayout,{columnWidths:o({},L.gridLayout.columnWidths,{},Ct)})})}return Y.type===c.columnDoneResizing?o({},L,{gridLayout:o({},L.gridLayout,{startWidths:{},minWidths:{},maxWidths:{}})}):void 0}function Lo(L){var Y,te=(Y=document.getElementById("header-cell-"+L))==null?void 0:Y.offsetWidth;if(te!==void 0)return te}n._UNSTABLE_usePivotColumns=io,n.actions=c,n.defaultColumn=h,n.defaultGroupByFn=fi,n.defaultOrderByFn=Wa,n.defaultRenderer=d,n.emptyRenderer=f,n.ensurePluginOrder=x,n.flexRender=C,n.functionalUpdate=w,n.loopHooks=b,n.makePropGetter=m,n.makeRenderer=j,n.reduceHooks=g,n.safeUseLayoutEffect=E,n.useAbsoluteLayout=ns,n.useAsyncDebounce=function(L,Y){Y===void 0&&(Y=0);var te=r.useRef({}),oe=N(L),ge=N(Y);return r.useCallback(function(){var de=s(regeneratorRuntime.mark(function xe(){var Fe,Le,Ve,rt=arguments;return regeneratorRuntime.wrap(function(et){for(;;)switch(et.prev=et.next){case 0:for(Fe=rt.length,Le=new Array(Fe),Ve=0;Ve<Fe;Ve++)Le[Ve]=rt[Ve];return te.current.promise||(te.current.promise=new Promise(function(it,He){te.current.resolve=it,te.current.reject=He})),te.current.timeout&&clearTimeout(te.current.timeout),te.current.timeout=setTimeout(s(regeneratorRuntime.mark(function it(){return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return delete te.current.timeout,He.prev=1,He.t0=te.current,He.next=5,oe().apply(void 0,Le);case 5:He.t1=He.sent,He.t0.resolve.call(He.t0,He.t1),He.next=12;break;case 9:He.prev=9,He.t2=He.catch(1),te.current.reject(He.t2);case 12:return He.prev=12,delete te.current.promise,He.finish(12);case 15:case"end":return He.stop()}},it,null,[[1,9,12,15]])})),ge()),et.abrupt("return",te.current.promise);case 5:case"end":return et.stop()}},xe)}));return function(){return de.apply(this,arguments)}}(),[oe,ge])},n.useBlockLayout=ua,n.useColumnOrder=gs,n.useExpanded=Ht,n.useFilters=on,n.useFlexLayout=Fo,n.useGetLatest=N,n.useGlobalFilter=Hn,n.useGridLayout=fa,n.useGroupBy=tr,n.useMountedLayoutEffect=D,n.usePagination=Fs,n.useResizeColumns=Jn,n.useRowSelect=jo,n.useRowState=ms,n.useSortBy=no,n.useTable=function(L){for(var Y=arguments.length,te=new Array(Y>1?Y-1:0),oe=1;oe<Y;oe++)te[oe-1]=arguments[oe];L=Dt(L),te=[$e].concat(te);var ge=r.useRef({}),de=N(ge.current);Object.assign(de(),o({},L,{plugins:te,hooks:ze()})),te.filter(Boolean).forEach(function(ee){ee(de().hooks)});var xe=N(de().hooks);de().getHooks=xe,delete de().hooks,Object.assign(de(),g(xe().useOptions,Dt(L)));var Fe=de(),Le=Fe.data,Ve=Fe.columns,rt=Fe.initialState,et=Fe.defaultColumn,it=Fe.getSubRows,He=Fe.getRowId,tt=Fe.stateReducer,ht=Fe.useControlledState,gt=N(tt),St=r.useCallback(function(ee,be){if(!be.type)throw console.info({action:be}),new Error("Unknown Action 👆");return[].concat(xe().stateReducers,Array.isArray(gt())?gt():[gt()]).reduce(function(Pe,We){return We(Pe,be,ee,de())||Pe},ee)},[xe,gt,de]),$t=r.useReducer(St,void 0,function(){return St(rt,{type:c.init})}),Ct=$t[0],st=$t[1],Ut=g([].concat(xe().useControlledState,[ht]),Ct,{instance:de()});Object.assign(de(),{state:Ut,dispatch:st});var bt=r.useMemo(function(){return v(g(xe().columns,Ve,{instance:de()}))},[xe,de,Ve].concat(g(xe().columnsDeps,[],{instance:de()})));de().columns=bt;var Pt=r.useMemo(function(){return g(xe().allColumns,A(bt),{instance:de()}).map(I)},[bt,xe,de].concat(g(xe().allColumnsDeps,[],{instance:de()})));de().allColumns=Pt;var Zt=r.useMemo(function(){for(var ee=[],be=[],Pe={},We=[].concat(Pt);We.length;){var Ft=We.shift();Mt({data:Le,rows:ee,flatRows:be,rowsById:Pe,column:Ft,getRowId:He,getSubRows:it,accessValueHooks:xe().accessValue,getInstance:de})}return[ee,be,Pe]},[Pt,Le,He,it,xe,de]),R=Zt[0],Q=Zt[1],ce=Zt[2];Object.assign(de(),{rows:R,initialRows:[].concat(R),flatRows:Q,rowsById:ce}),b(xe().useInstanceAfterData,de());var pe=r.useMemo(function(){return g(xe().visibleColumns,Pt,{instance:de()}).map(function(ee){return S(ee,et)})},[xe,Pt,de,et].concat(g(xe().visibleColumnsDeps,[],{instance:de()})));Pt=r.useMemo(function(){var ee=[].concat(pe);return Pt.forEach(function(be){ee.find(function(Pe){return Pe.id===be.id})||ee.push(be)}),ee},[Pt,pe]),de().allColumns=Pt;var ve=r.useMemo(function(){return g(xe().headerGroups,P(pe,et),de())},[xe,pe,et,de].concat(g(xe().headerGroupsDeps,[],{instance:de()})));de().headerGroups=ve;var Te=r.useMemo(function(){return ve.length?ve[0].headers:[]},[ve]);de().headers=Te,de().flatHeaders=ve.reduce(function(ee,be){return[].concat(ee,be.headers)},[]),b(xe().useInstanceBeforeDimensions,de());var Oe=pe.filter(function(ee){return ee.isVisible}).map(function(ee){return ee.id}).sort().join("_");pe=r.useMemo(function(){return pe.filter(function(ee){return ee.isVisible})},[pe,Oe]),de().visibleColumns=pe;var Me=_t(Te),_=Me[0],U=Me[1],G=Me[2];return de().totalColumnsMinWidth=_,de().totalColumnsWidth=U,de().totalColumnsMaxWidth=G,b(xe().useInstance,de()),[].concat(de().flatHeaders,de().allColumns).forEach(function(ee){ee.render=j(de(),ee),ee.getHeaderProps=m(xe().getHeaderProps,{instance:de(),column:ee}),ee.getFooterProps=m(xe().getFooterProps,{instance:de(),column:ee})}),de().headerGroups=r.useMemo(function(){return ve.filter(function(ee,be){return ee.headers=ee.headers.filter(function(Pe){return Pe.headers?function We(Ft){return Ft.filter(function(rn){return rn.headers?We(rn.headers):rn.isVisible}).length}(Pe.headers):Pe.isVisible}),!!ee.headers.length&&(ee.getHeaderGroupProps=m(xe().getHeaderGroupProps,{instance:de(),headerGroup:ee,index:be}),ee.getFooterGroupProps=m(xe().getFooterGroupProps,{instance:de(),headerGroup:ee,index:be}),!0)})},[ve,de,xe]),de().footerGroups=[].concat(de().headerGroups).reverse(),de().prepareRow=r.useCallback(function(ee){ee.getRowProps=m(xe().getRowProps,{instance:de(),row:ee}),ee.allCells=Pt.map(function(be){var Pe=ee.values[be.id],We={column:be,row:ee,value:Pe};return We.getCellProps=m(xe().getCellProps,{instance:de(),cell:We}),We.render=j(de(),be,{row:ee,cell:We,value:Pe}),We}),ee.cells=pe.map(function(be){return ee.allCells.find(function(Pe){return Pe.column.id===be.id})}),b(xe().prepareRow,ee,{instance:de()})},[xe,de,Pt,pe]),de().getTableProps=m(xe().getTableProps,{instance:de()}),de().getTableBodyProps=m(xe().getTableBodyProps,{instance:de()}),b(xe().useFinalInstance,de()),de()},Object.defineProperty(n,"__esModule",{value:!0})})})(T5,T5.exports);var pJ=T5.exports;lD.exports=pJ;var Ag=lD.exports;const mJ=({users:t,onEditUser:e,onDeleteUser:n,onToggleStatus:r,onResetPassword:i,onManagePermissions:s,isAdmin:o})=>{const a=he.useMemo(()=>[{Header:"Utilisateur",accessor:A=>`${A.firstName} ${A.lastName}`,Cell:({row:A})=>u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"h-10 w-10 rounded-full bg-[#8B4513] text-white flex items-center justify-center mr-3",children:[A.original.firstName[0],A.original.lastName[0]]}),u.jsxs("div",{children:[u.jsxs("div",{className:"font-medium",children:[A.original.firstName," ",A.original.lastName]}),A.original.phone&&u.jsx("div",{className:"text-sm text-gray-500",children:A.original.phone})]})]})},{Header:"Email",accessor:"email"},{Header:"Grade",accessor:"role",Cell:({value:A})=>u.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:A})},{Header:"Inscription",accessor:"createdAt",Cell:({value:A})=>Kt(new Date(A),"dd/MM/yyyy",{locale:zn})},{Header:"Dernière connexion",accessor:"lastSignInTime",Cell:({value:A})=>A?Kt(new Date(A),"dd/MM/yyyy HH:mm",{locale:zn}):"Jamais connecté"},{Header:"Statut",accessor:"disabled",Cell:({value:A})=>u.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${A?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:A?"Inactif":"Actif"})}],[]),{getTableProps:l,getTableBodyProps:c,headerGroups:d,page:f,prepareRow:h,canPreviousPage:p,canNextPage:m,pageOptions:g,pageCount:b,gotoPage:x,nextPage:w,previousPage:N,setPageSize:E,setGlobalFilter:D,state:{pageIndex:j,pageSize:C,globalFilter:v}}=Ag.useTable({columns:a,data:t,initialState:{pageIndex:0,pageSize:10}},Ag.useGlobalFilter,Ag.useSortBy,Ag.usePagination);return u.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsx("input",{type:"text",value:v||"",onChange:A=>D(A.target.value),placeholder:"Rechercher un utilisateur...",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]"})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{...l(),className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50",children:d.map(A=>u.jsxs("tr",{...A.getHeaderGroupProps(),children:[A.headers.map(I=>u.jsx("th",{...I.getHeaderProps(I.getSortByToggleProps()),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:u.jsxs("div",{className:"flex items-center",children:[I.render("Header"),u.jsx("span",{className:"ml-2",children:I.isSorted?I.isSortedDesc?u.jsx(jI,{className:"h-4 w-4"}):u.jsx(DI,{className:"h-4 w-4"}):null})]})})),o&&u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]}))}),u.jsx("tbody",{...c(),className:"bg-white divide-y divide-gray-200",children:f.map(A=>(h(A),u.jsxs("tr",{...A.getRowProps(),className:"hover:bg-gray-50",children:[A.cells.map(I=>u.jsx("td",{...I.getCellProps(),className:"px-6 py-4 whitespace-nowrap",children:I.render("Cell")})),o&&u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:u.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[u.jsxs("button",{onClick:()=>r(A.original.id,!!A.original.disabled),className:`text-gray-500 hover:text-${A.original.disabled?"green":"red"}-600`,title:A.original.disabled?"Activer le compte":"Désactiver le compte",children:[u.jsx("span",{className:"sr-only",children:A.original.disabled?"Activer":"Désactiver"}),A.original.disabled?"✓":"✕"]}),u.jsxs("button",{onClick:()=>i(A.original.email),className:"text-gray-500 hover:text-blue-600",title:"Réinitialiser le mot de passe",children:[u.jsx("span",{className:"sr-only",children:"Réinitialiser le mot de passe"}),"🔑"]}),u.jsx("button",{onClick:()=>s(A.original),className:"text-gray-500 hover:text-[#8B4513]",title:"Gérer les permissions",children:u.jsx(dH,{className:"h-5 w-5"})}),u.jsxs("button",{onClick:()=>e(A.original),className:"text-gray-500 hover:text-[#8B4513]",title:"Modifier l'utilisateur",children:[u.jsx("span",{className:"sr-only",children:"Modifier"}),"✎"]}),u.jsxs("button",{onClick:()=>n(A.original.id),className:"text-gray-500 hover:text-red-600",title:"Supprimer l'utilisateur",children:[u.jsx("span",{className:"sr-only",children:"Supprimer"}),"🗑"]})]})})]})))})]})}),u.jsxs("div",{className:"px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx("button",{onClick:()=>N(),disabled:!p,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Précédent"}),u.jsx("button",{onClick:()=>w(),disabled:!m,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Suivant"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsxs("div",{className:"flex gap-x-2 items-center",children:[u.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",u.jsx("span",{className:"font-medium",children:j+1})," sur"," ",u.jsx("span",{className:"font-medium",children:g.length})]}),u.jsx("select",{value:C,onChange:A=>E(Number(A.target.value)),className:"text-sm border-gray-300 rounded-md focus:ring-[#8B4513] focus:border-[#8B4513]",children:[10,20,30,40,50].map(A=>u.jsxs("option",{value:A,children:["Afficher ",A]},A))})]}),u.jsxs("div",{className:"flex gap-x-2",children:[u.jsxs("button",{onClick:()=>x(0),disabled:!p,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-500 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[u.jsx("span",{className:"sr-only",children:"Première page"}),u.jsx(sH,{className:"h-5 w-5"})]}),u.jsxs("button",{onClick:()=>N(),disabled:!p,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-500 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[u.jsx("span",{className:"sr-only",children:"Page précédente"}),u.jsx(rH,{className:"h-5 w-5"})]}),u.jsxs("button",{onClick:()=>w(),disabled:!m,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-500 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[u.jsx("span",{className:"sr-only",children:"Page suivante"}),u.jsx(iH,{className:"h-5 w-5"})]}),u.jsxs("button",{onClick:()=>x(b-1),disabled:!m,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-500 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[u.jsx("span",{className:"sr-only",children:"Dernière page"}),u.jsx(oH,{className:"h-5 w-5"})]})]})]})]})]})},S6=[{id:"pos",name:"Point de Vente"},{id:"admin",name:"Administration"},{id:"production",name:"Production"},{id:"inventory",name:"Inventaire"},{id:"reports",name:"Rapports"},{id:"users",name:"Utilisateurs"},{id:"settings",name:"Paramètres"}],gJ=({user:t,onClose:e,onPermissionsUpdated:n})=>{const[r,i]=he.useState(t.permissions||S6.map(c=>({module:c.id,read:!1,write:!1}))),[s,o]=he.useState(!1),a=(c,d,f)=>{i(h=>h.map(p=>p.module===c?{...p,[d]:f}:p))},l=async c=>{c.preventDefault(),o(!0);try{await na(ln(ot,"users",t.id),{permissions:r,updatedAt:new Date().toISOString()}),ke.success("Permissions mises à jour avec succès"),n(),e()}catch(d){console.error("Error updating permissions:",d),ke.error("Erreur lors de la mise à jour des permissions")}finally{o(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Gestion des Permissions"}),u.jsx("button",{onClick:e,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:l,className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs("h3",{className:"font-medium text-gray-900 mb-2",children:[t.firstName," ",t.lastName]}),u.jsxs("p",{className:"text-sm text-gray-500",children:[t.email," - ",t.role]})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left border-b",children:[u.jsx("th",{className:"pb-2",children:"Module"}),u.jsx("th",{className:"pb-2 text-center",children:"Lecture"}),u.jsx("th",{className:"pb-2 text-center",children:"Écriture"})]})}),u.jsx("tbody",{children:S6.map(c=>{const d=r.find(f=>f.module===c.id);return u.jsxs("tr",{className:"border-b last:border-0",children:[u.jsx("td",{className:"py-3",children:c.name}),u.jsx("td",{className:"py-3 text-center",children:u.jsx("input",{type:"checkbox",checked:(d==null?void 0:d.read)||!1,onChange:f=>a(c.id,"read",f.target.checked),className:"rounded border-gray-300 text-[#8B4513] focus:ring-[#8B4513]"})}),u.jsx("td",{className:"py-3 text-center",children:u.jsx("input",{type:"checkbox",checked:(d==null?void 0:d.write)||!1,onChange:f=>a(c.id,"write",f.target.checked),className:"rounded border-gray-300 text-[#8B4513] focus:ring-[#8B4513]"})})]},c.id)})})]})}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:s,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:s?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):u.jsxs(u.Fragment,{children:[u.jsx(hm,{className:"h-5 w-5 mr-2"}),"Enregistrer"]})})]})]})]})})},xJ=()=>{const[t,e]=he.useState([]),[n,r]=he.useState(!0),[i,s]=he.useState(null),[o,a]=he.useState(!1),[l,c]=he.useState(!1),[d,f]=he.useState(null),[h,p]=he.useState(null),[m,g]=he.useState(null),b=async()=>{if(fn.currentUser)try{const j=await ps(ln(ot,"users",fn.currentUser.uid));if(!j.exists()){ke.error("Erreur: Informations utilisateur manquantes");return}const C=j.data();p(C.role),g(C.company);const v=mn(en(ot,"users"),pt("company","==",C.company)),I=(await On(v)).docs.map(S=>({id:S.id,...S.data()}));I.sort((S,P)=>new Date(P.createdAt).getTime()-new Date(S.createdAt).getTime()),e(I)}catch(j){console.error("Erreur lors du chargement des utilisateurs:",j),ke.error("Erreur lors du chargement des utilisateurs")}finally{r(!1)}};he.useEffect(()=>{b()},[]);const x=h==="ADMINISTRATEUR",w=async(j,C)=>{if(!x){ke.error("Action non autorisée");return}f(`status-${j}`);try{await na(ln(ot,"users",j),{disabled:!C}),await b(),ke.success(`Compte ${C?"activé":"désactivé"} avec succès`)}catch(v){console.error("Erreur lors de la modification du statut:",v),ke.error("Erreur lors de la modification du statut")}finally{f(null)}},N=async j=>{if(!x){ke.error("Action non autorisée");return}try{await gB(fn,j),ke.success("Email de réinitialisation envoyé avec succès")}catch(C){console.error("Erreur lors de l'envoi de l'email:",C),ke.error("Erreur lors de l'envoi de l'email")}},E=async j=>{if(!x){ke.error("Action non autorisée");return}if(window.confirm("Êtes-vous sûr de vouloir supprimer cet utilisateur ?")){f(`delete-${j}`);try{await ry(ln(ot,"users",j)),await b(),ke.success("Utilisateur supprimé avec succès")}catch(C){console.error("Erreur lors de la suppression:",C),ke.error("Erreur lors de la suppression")}finally{f(null)}}},D=j=>{if(!x){ke.error("Action non autorisée");return}s(j),c(!0)};return n?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#8B4513]"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Gestion des Utilisateurs"}),u.jsxs("button",{onClick:b,className:"flex items-center px-4 py-2 text-[#8B4513] hover:bg-[#8B4513]/10 rounded-lg",children:[u.jsx(gH,{className:"h-5 w-5 mr-2"}),"Actualiser"]})]}),u.jsx(mJ,{users:t,onEditUser:j=>{if(!x){ke.error("Action non autorisée");return}s(j),a(!0)},onDeleteUser:E,onToggleStatus:w,onResetPassword:N,onManagePermissions:D,isAdmin:x}),o&&i&&u.jsx(fJ,{user:i,onClose:()=>{a(!1),s(null)},onUserUpdated:b}),l&&i&&u.jsx(gJ,{user:i,onClose:()=>{c(!1),s(null)},onPermissionsUpdated:b})]})},yJ=({onConfirm:t,onCancel:e})=>{const[n,r]=he.useState("");return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[u.jsx("h3",{className:"text-lg font-bold mb-4",children:"Confirmer la suppression"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Cette action ne peut pas être annulée. La transaction sera marquée comme supprimée mais conservée dans la base de données."}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Raison de la suppression"}),u.jsx("textarea",{value:n,onChange:i=>r(i.target.value),className:"w-full p-3 border border-gray-300 rounded-lg",required:!0,rows:3,placeholder:"Veuillez indiquer la raison de la suppression..."})]}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg",children:"Annuler"}),u.jsx("button",{onClick:()=>t(n),disabled:!n.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-lg disabled:bg-gray-300",children:"Confirmer la suppression"})]})]})})},vJ=()=>{const{user:t,loading:e,error:n}=Li(),[r,i]=he.useState([]),[s,o]=he.useState([]),[a,l]=he.useState(!0),[c,d]=he.useState(null),[f,h]=he.useState(!1),[p,m]=he.useState(null),[g,b]=he.useState(!1);he.useEffect(()=>{!e&&t&&(async()=>{if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName)))try{const D=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",t.agencyName),oi("timestamp","desc")),j=await On(D),C=[],v=[];j.forEach(A=>{const I={id:A.id,...A.data(),date:A.data().timestamp.toDate()};I.deletedAt&&!g||(I.stockUpdated?v.push(I):C.push(I))}),i(C),o(v)}catch(D){console.error("Error fetching sales:",D),d("Erreur lors du chargement des ventes")}finally{l(!1)}})()},[t,e,g]);const x=E=>{m(E),h(!0)},w=async E=>{if(!(!p||!t))try{const D=ln(ot,"ventes",p.id);if(!(await ps(D)).exists()){i(C=>C.filter(v=>v.id!==p.id)),o(C=>C.filter(v=>v.id!==p.id)),ke.error("Cette vente a déjà été supprimée"),h(!1),m(null);return}await wG(p.id,{reason:E,deletedBy:t.id,deletedByName:`${t.firstName} ${t.lastName}`}),ke.success("Transaction supprimée avec succès"),i(C=>C.filter(v=>v.id!==p.id)),o(C=>C.filter(v=>v.id!==p.id))}catch(D){console.error("Error deleting sale:",D),ke.error(D.message||"Erreur lors de la suppression")}finally{h(!1),m(null)}},N=({sales:E,isPending:D})=>u.jsxs("div",{className:"space-y-4",children:[E.map(j=>u.jsx("div",{className:`bg-white rounded-lg shadow-sm p-4 border-l-4 ${j.deletedAt?"opacity-50 border-gray-300":D?"border-red-500":"border-green-500"}`,children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[D?u.jsx(aS,{className:"h-5 w-5 text-red-500"}):u.jsx(cS,{className:"h-5 w-5 text-green-500"}),u.jsx("span",{className:"font-medium",children:Kt(j.date,"dd MMMM yyyy à HH:mm",{locale:zn})})]}),u.jsx("div",{className:"mt-2 space-y-1",children:j.productName.map((C,v)=>u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:C}),u.jsxs("span",{className:"font-medium",children:["x",j.quantity[v]]})]},v))}),j.deletedAt&&u.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[u.jsxs("p",{children:["Supprimé le ",Kt(j.deletedAt.toDate(),"dd/MM/yyyy HH:mm",{locale:zn})]}),u.jsxs("p",{children:["Par: ",j.deletedByName]}),u.jsxs("p",{children:["Raison: ",j.deleteReason]})]})]}),u.jsxs("div",{className:"text-right flex flex-col items-end gap-2",children:[u.jsxs("span",{className:"font-bold",children:[Math.round(j.totalAmount)," Fcfa"]}),u.jsx("div",{className:"text-sm text-gray-500",children:D?"En attente de sync":"Synchronisé"}),!j.deletedAt&&u.jsx("button",{onClick:()=>x(j),className:"text-red-600 hover:text-red-800 p-2",title:"Supprimer",children:u.jsx(hy,{className:"h-5 w-5"})})]})]})},j.id)),E.length===0&&u.jsxs("div",{className:"text-center py-8 text-gray-500",children:["Aucune vente ",D?"en attente":"synchronisée"]})]});return e||a?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):n||c?u.jsx("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg",children:n||c}):!(t!=null&&t.company)||!(t!=null&&t.agencyName)?u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Informations entreprise ou agence manquantes"}):u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("h3",{className:"text-lg font-bold text-red-600 mb-4 flex items-center",children:[u.jsx(aS,{className:"h-5 w-5 mr-2"}),"En attente de synchronisation (",r.length,")"]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",checked:g,onChange:E=>b(E.target.checked),className:"rounded border-gray-300 text-[#8B4513] focus:ring-[#8B4513]"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Afficher les transactions supprimées"})]})})]}),u.jsx(N,{sales:r,isPending:!0}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-bold text-green-600 mb-4 flex items-center",children:[u.jsx(cS,{className:"h-5 w-5 mr-2"}),"Ventes synchronisées (",s.length,")"]}),u.jsx(N,{sales:s,isPending:!1})]}),f&&u.jsx(yJ,{onConfirm:w,onCancel:()=>{h(!1),m(null)}})]})},bJ="modulepreload",wJ=function(t){return"/"+t},E6={},I5=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=wJ(l),l in E6)return;E6[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":bJ,c||(f.as="script"),f.crossOrigin="",f.href=l,a&&f.setAttribute("nonce",a),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var Yi=Uint8Array,Ks=Uint16Array,T4=Int32Array,Ny=new Yi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ay=new Yi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),j5=new Yi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cD=function(t,e){for(var n=new Ks(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new T4(n[30]),r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},uD=cD(Ny,2),dD=uD.b,D5=uD.r;dD[28]=258,D5[258]=28;var hD=cD(Ay,0),_J=hD.b,C6=hD.r,R5=new Ks(32768);for(var fr=0;fr<32768;++fr){var vc=(fr&43690)>>1|(fr&21845)<<1;vc=(vc&52428)>>2|(vc&13107)<<2,vc=(vc&61680)>>4|(vc&3855)<<4,R5[fr]=((vc&65280)>>8|(vc&255)<<8)>>1}var Ua=function(t,e,n){for(var r=t.length,i=0,s=new Ks(e);i<r;++i)t[i]&&++s[t[i]-1];var o=new Ks(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(n){a=new Ks(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var c=i<<4|t[i],d=e-t[i],f=o[t[i]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)a[R5[f]>>l]=c}else for(a=new Ks(r),i=0;i<r;++i)t[i]&&(a[i]=R5[o[t[i]-1]++]>>15-t[i]);return a},uu=new Yi(288);for(var fr=0;fr<144;++fr)uu[fr]=8;for(var fr=144;fr<256;++fr)uu[fr]=9;for(var fr=256;fr<280;++fr)uu[fr]=7;for(var fr=280;fr<288;++fr)uu[fr]=8;var Mp=new Yi(32);for(var fr=0;fr<32;++fr)Mp[fr]=5;var NJ=Ua(uu,9,0),AJ=Ua(uu,9,1),SJ=Ua(Mp,5,0),EJ=Ua(Mp,5,1),T2=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Uo=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},I2=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},I4=function(t){return(t+7)/8|0},fD=function(t,e,n){return(n==null||n>t.length)&&(n=t.length),new Yi(t.subarray(e,n))},CJ=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Wo=function(t,e,n){var r=new Error(e||CJ[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,Wo),!n)throw r;return r},PJ=function(t,e,n,r){var i=t.length,s=0;if(!i||e.f&&!e.l)return n||new Yi(0);var o=!n,a=o||e.i!=2,l=e.i;o&&(n=new Yi(i*3));var c=function(Ce){var ze=n.length;if(Ce>ze){var $e=new Yi(Math.max(ze*2,Ce));$e.set(n),n=$e}},d=e.f||0,f=e.p||0,h=e.b||0,p=e.l,m=e.d,g=e.m,b=e.n,x=i*8;do{if(!p){d=Uo(t,f,1);var w=Uo(t,f+1,3);if(f+=3,w)if(w==1)p=AJ,m=EJ,g=9,b=5;else if(w==2){var j=Uo(t,f,31)+257,C=Uo(t,f+10,15)+4,v=j+Uo(t,f+5,31)+1;f+=14;for(var A=new Yi(v),I=new Yi(19),S=0;S<C;++S)I[j5[S]]=Uo(t,f+S*3,7);f+=C*3;for(var P=T2(I),k=(1<<P)-1,F=Ua(I,P,1),S=0;S<v;){var q=F[Uo(t,f,k)];f+=q&15;var N=q>>4;if(N<16)A[S++]=N;else{var O=0,M=0;for(N==16?(M=3+Uo(t,f,3),f+=2,O=A[S-1]):N==17?(M=3+Uo(t,f,7),f+=3):N==18&&(M=11+Uo(t,f,127),f+=7);M--;)A[S++]=O}}var W=A.subarray(0,j),z=A.subarray(j);g=T2(W),b=T2(z),p=Ua(W,g,1),m=Ua(z,b,1)}else Wo(1);else{var N=I4(f)+4,E=t[N-4]|t[N-3]<<8,D=N+E;if(D>i){l&&Wo(0);break}a&&c(h+E),n.set(t.subarray(N,D),h),e.b=h+=E,e.p=f=D*8,e.f=d;continue}if(f>x){l&&Wo(0);break}}a&&c(h+131072);for(var J=(1<<g)-1,ne=(1<<b)-1,V=f;;V=f){var O=p[I2(t,f)&J],$=O>>4;if(f+=O&15,f>x){l&&Wo(0);break}if(O||Wo(2),$<256)n[h++]=$;else if($==256){V=f,p=null;break}else{var K=$-254;if($>264){var S=$-257,X=Ny[S];K=Uo(t,f,(1<<X)-1)+dD[S],f+=X}var ae=m[I2(t,f)&ne],ye=ae>>4;ae||Wo(3),f+=ae&15;var z=_J[ye];if(ye>3){var X=Ay[ye];z+=I2(t,f)&(1<<X)-1,f+=X}if(f>x){l&&Wo(0);break}a&&c(h+131072);var me=h+K;if(h<z){var _e=s-z,Se=Math.min(z,me);for(_e+h<0&&Wo(3);h<Se;++h)n[h]=r[_e+h]}for(;h<me;++h)n[h]=n[h-z]}}e.l=p,e.p=V,e.b=h,e.f=d,p&&(d=1,e.m=g,e.d=m,e.n=b)}while(!d);return h!=n.length&&o?fD(n,0,h):n.subarray(0,h)},pl=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},Zf=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},j2=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return{t:mD,l:0};if(i==1){var o=new Yi(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(D,j){return D.f-j.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,d=1,f=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};d!=i-1;)a=n[n[c].f<n[f].f?c++:f++],l=n[c!=d&&n[c].f<n[f].f?c++:f++],n[d++]={s:-1,f:a.f+l.f,l:a,r:l};for(var h=s[0].s,r=1;r<i;++r)s[r].s>h&&(h=s[r].s);var p=new Ks(h+1),m=F5(n[d-1],p,0);if(m>e){var r=0,g=0,b=m-e,x=1<<b;for(s.sort(function(j,C){return p[C.s]-p[j.s]||j.f-C.f});r<i;++r){var w=s[r].s;if(p[w]>e)g+=x-(1<<m-p[w]),p[w]=e;else break}for(g>>=b;g>0;){var N=s[r].s;p[N]<e?g-=1<<e-p[N]++-1:++r}for(;r>=0&&g;--r){var E=s[r].s;p[E]==e&&(--p[E],++g)}m=e}return{t:new Yi(p),l:m}},F5=function(t,e,n){return t.s==-1?Math.max(F5(t.l,e,n+1),F5(t.r,e,n+1)):e[t.s]=n},P6=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Ks(++e),r=0,i=t[0],s=1,o=function(l){n[r++]=l},a=1;a<=e;++a)if(t[a]==i&&a!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=t[a]}return{c:n.subarray(0,r),n:e}},e0=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},pD=function(t,e,n){var r=n.length,i=I4(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var s=0;s<r;++s)t[i+s+4]=n[s];return(i+4+r)*8},k6=function(t,e,n,r,i,s,o,a,l,c,d){pl(e,d++,n),++i[256];for(var f=j2(i,15),h=f.t,p=f.l,m=j2(s,15),g=m.t,b=m.l,x=P6(h),w=x.c,N=x.n,E=P6(g),D=E.c,j=E.n,C=new Ks(19),v=0;v<w.length;++v)++C[w[v]&31];for(var v=0;v<D.length;++v)++C[D[v]&31];for(var A=j2(C,7),I=A.t,S=A.l,P=19;P>4&&!I[j5[P-1]];--P);var k=c+5<<3,F=e0(i,uu)+e0(s,Mp)+o,q=e0(i,h)+e0(s,g)+o+14+3*P+e0(C,I)+2*C[16]+3*C[17]+7*C[18];if(l>=0&&k<=F&&k<=q)return pD(e,d,t.subarray(l,l+c));var O,M,W,z;if(pl(e,d,1+(q<F)),d+=2,q<F){O=Ua(h,p,0),M=h,W=Ua(g,b,0),z=g;var J=Ua(I,S,0);pl(e,d,N-257),pl(e,d+5,j-1),pl(e,d+10,P-4),d+=14;for(var v=0;v<P;++v)pl(e,d+3*v,I[j5[v]]);d+=3*P;for(var ne=[w,D],V=0;V<2;++V)for(var $=ne[V],v=0;v<$.length;++v){var K=$[v]&31;pl(e,d,J[K]),d+=I[K],K>15&&(pl(e,d,$[v]>>5&127),d+=$[v]>>12)}}else O=NJ,M=uu,W=SJ,z=Mp;for(var v=0;v<a;++v){var X=r[v];if(X>255){var K=X>>18&31;Zf(e,d,O[K+257]),d+=M[K+257],K>7&&(pl(e,d,X>>23&31),d+=Ny[K]);var ae=X&31;Zf(e,d,W[ae]),d+=z[ae],ae>3&&(Zf(e,d,X>>5&8191),d+=Ay[ae])}else Zf(e,d,O[X]),d+=M[X]}return Zf(e,d,O[256]),d+M[256]},kJ=new T4([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),mD=new Yi(0),TJ=function(t,e,n,r,i,s){var o=s.z||t.length,a=new Yi(r+o+5*(1+Math.ceil(o/7e3))+i),l=a.subarray(r,a.length-i),c=s.l,d=(s.r||0)&7;if(e){d&&(l[0]=s.r>>3);for(var f=kJ[e-1],h=f>>13,p=f&8191,m=(1<<n)-1,g=s.p||new Ks(32768),b=s.h||new Ks(m+1),x=Math.ceil(n/3),w=2*x,N=function(dt){return(t[dt]^t[dt+1]<<x^t[dt+2]<<w)&m},E=new T4(25e3),D=new Ks(288),j=new Ks(32),C=0,v=0,A=s.i||0,I=0,S=s.w||0,P=0;A+2<o;++A){var k=N(A),F=A&32767,q=b[k];if(g[F]=q,b[k]=F,S<=A){var O=o-A;if((C>7e3||I>24576)&&(O>423||!c)){d=k6(t,l,0,E,D,j,v,I,P,A-P,d),I=C=v=0,P=A;for(var M=0;M<286;++M)D[M]=0;for(var M=0;M<30;++M)j[M]=0}var W=2,z=0,J=p,ne=F-q&32767;if(O>2&&k==N(A-ne))for(var V=Math.min(h,O)-1,$=Math.min(32767,A),K=Math.min(258,O);ne<=$&&--J&&F!=q;){if(t[A+W]==t[A+W-ne]){for(var X=0;X<K&&t[A+X]==t[A+X-ne];++X);if(X>W){if(W=X,z=ne,X>V)break;for(var ae=Math.min(ne,X-2),ye=0,M=0;M<ae;++M){var me=A-ne+M&32767,_e=g[me],Se=me-_e&32767;Se>ye&&(ye=Se,q=me)}}}F=q,q=g[F],ne+=F-q&32767}if(z){E[I++]=268435456|D5[W]<<18|C6[z];var Ce=D5[W]&31,ze=C6[z]&31;v+=Ny[Ce]+Ay[ze],++D[257+Ce],++j[ze],S=A+W,++C}else E[I++]=t[A],++D[t[A]]}}for(A=Math.max(A,S);A<o;++A)E[I++]=t[A],++D[t[A]];d=k6(t,l,c,E,D,j,v,I,P,A-P,d),c||(s.r=d&7|l[d/8|0]<<3,d-=7,s.h=b,s.p=g,s.i=A,s.w=S)}else{for(var A=s.w||0;A<o+c;A+=65535){var $e=A+65535;$e>=o&&(l[d/8|0]=c,$e=o),d=pD(l,d+1,t.subarray(A,$e))}s.i=o}return fD(a,0,r+I4(d)+i)},gD=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,s=n.length|0,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},IJ=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Yi(s.length+t.length);o.set(s),o.set(t,s.length),t=o,i.w=s.length}return TJ(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},xD=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},jJ=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=gD();i.p(e.dictionary),xD(t,2,i.d())}},DJ=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Wo(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&Wo(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function L5(t,e){e||(e={});var n=gD();n.p(t);var r=IJ(t,e,e.dictionary?6:2,4);return jJ(r,e),xD(r,r.length-4,n.d()),r}function RJ(t,e){return PJ(t.subarray(DJ(t,e),-4),{i:2},e,e)}var FJ=typeof TextDecoder<"u"&&new TextDecoder,LJ=0;try{FJ.decode(mD,{stream:!0}),LJ=1}catch{}var Xt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function D2(){Xt.console&&typeof Xt.console.log=="function"&&Xt.console.log.apply(Xt.console,arguments)}var ir={log:D2,warn:function(t){Xt.console&&(typeof Xt.console.warn=="function"?Xt.console.warn.apply(Xt.console,arguments):D2.call(null,arguments))},error:function(t){Xt.console&&(typeof Xt.console.error=="function"?Xt.console.error.apply(Xt.console,arguments):D2(t))}};function R2(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Vu(r.response,e,n)},r.onerror=function(){ir.error("could not download file")},r.send()}function T6(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Sg(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var F0,M5,Vu=Xt.saveAs||((typeof window>"u"?"undefined":Vn(window))!=="object"||window!==Xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=Xt.URL||Xt.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?T6(i.href)?R2(t,e,n):Sg(i,i.target="_blank"):Sg(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Sg(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(T6(t))R2(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Sg(r)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Vn(s)!=="object"&&(ir.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return R2(t,e,n);var i=t.type==="application/octet-stream",s=/constructor/i.test(Xt.HTMLElement)||Xt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":Vn(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var d=a.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=d:location=d,r=null},a.readAsDataURL(t)}else{var l=Xt.URL||Xt.webkitURL,c=l.createObjectURL(t);r?r.location=c:location.href=c,r=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function yD(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,o=i.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return a.length==1&&(a="0"+a),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+a+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function F2(t,e){var n=t[0],r=t[1],i=t[2],s=t[3];n=Hi(n,r,i,s,e[0],7,-680876936),s=Hi(s,n,r,i,e[1],12,-389564586),i=Hi(i,s,n,r,e[2],17,606105819),r=Hi(r,i,s,n,e[3],22,-1044525330),n=Hi(n,r,i,s,e[4],7,-176418897),s=Hi(s,n,r,i,e[5],12,1200080426),i=Hi(i,s,n,r,e[6],17,-1473231341),r=Hi(r,i,s,n,e[7],22,-45705983),n=Hi(n,r,i,s,e[8],7,1770035416),s=Hi(s,n,r,i,e[9],12,-1958414417),i=Hi(i,s,n,r,e[10],17,-42063),r=Hi(r,i,s,n,e[11],22,-1990404162),n=Hi(n,r,i,s,e[12],7,1804603682),s=Hi(s,n,r,i,e[13],12,-40341101),i=Hi(i,s,n,r,e[14],17,-1502002290),n=Wi(n,r=Hi(r,i,s,n,e[15],22,1236535329),i,s,e[1],5,-165796510),s=Wi(s,n,r,i,e[6],9,-1069501632),i=Wi(i,s,n,r,e[11],14,643717713),r=Wi(r,i,s,n,e[0],20,-373897302),n=Wi(n,r,i,s,e[5],5,-701558691),s=Wi(s,n,r,i,e[10],9,38016083),i=Wi(i,s,n,r,e[15],14,-660478335),r=Wi(r,i,s,n,e[4],20,-405537848),n=Wi(n,r,i,s,e[9],5,568446438),s=Wi(s,n,r,i,e[14],9,-1019803690),i=Wi(i,s,n,r,e[3],14,-187363961),r=Wi(r,i,s,n,e[8],20,1163531501),n=Wi(n,r,i,s,e[13],5,-1444681467),s=Wi(s,n,r,i,e[2],9,-51403784),i=Wi(i,s,n,r,e[7],14,1735328473),n=$i(n,r=Wi(r,i,s,n,e[12],20,-1926607734),i,s,e[5],4,-378558),s=$i(s,n,r,i,e[8],11,-2022574463),i=$i(i,s,n,r,e[11],16,1839030562),r=$i(r,i,s,n,e[14],23,-35309556),n=$i(n,r,i,s,e[1],4,-1530992060),s=$i(s,n,r,i,e[4],11,1272893353),i=$i(i,s,n,r,e[7],16,-155497632),r=$i(r,i,s,n,e[10],23,-1094730640),n=$i(n,r,i,s,e[13],4,681279174),s=$i(s,n,r,i,e[0],11,-358537222),i=$i(i,s,n,r,e[3],16,-722521979),r=$i(r,i,s,n,e[6],23,76029189),n=$i(n,r,i,s,e[9],4,-640364487),s=$i(s,n,r,i,e[12],11,-421815835),i=$i(i,s,n,r,e[15],16,530742520),n=Gi(n,r=$i(r,i,s,n,e[2],23,-995338651),i,s,e[0],6,-198630844),s=Gi(s,n,r,i,e[7],10,1126891415),i=Gi(i,s,n,r,e[14],15,-1416354905),r=Gi(r,i,s,n,e[5],21,-57434055),n=Gi(n,r,i,s,e[12],6,1700485571),s=Gi(s,n,r,i,e[3],10,-1894986606),i=Gi(i,s,n,r,e[10],15,-1051523),r=Gi(r,i,s,n,e[1],21,-2054922799),n=Gi(n,r,i,s,e[8],6,1873313359),s=Gi(s,n,r,i,e[15],10,-30611744),i=Gi(i,s,n,r,e[6],15,-1560198380),r=Gi(r,i,s,n,e[13],21,1309151649),n=Gi(n,r,i,s,e[4],6,-145523070),s=Gi(s,n,r,i,e[11],10,-1120210379),i=Gi(i,s,n,r,e[2],15,718787259),r=Gi(r,i,s,n,e[9],21,-343485551),t[0]=Uc(n,t[0]),t[1]=Uc(r,t[1]),t[2]=Uc(i,t[2]),t[3]=Uc(s,t[3])}function Sy(t,e,n,r,i,s){return e=Uc(Uc(e,t),Uc(r,s)),Uc(e<<i|e>>>32-i,n)}function Hi(t,e,n,r,i,s,o){return Sy(e&n|~e&r,t,e,i,s,o)}function Wi(t,e,n,r,i,s,o){return Sy(e&r|n&~r,t,e,i,s,o)}function $i(t,e,n,r,i,s,o){return Sy(e^n^r,t,e,i,s,o)}function Gi(t,e,n,r,i,s,o){return Sy(n^(e|~r),t,e,i,s,o)}function vD(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)F2(r,MJ(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(F2(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,F2(r,i),r}function MJ(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}F0=Xt.atob.bind(Xt),M5=Xt.btoa.bind(Xt);var I6="0123456789abcdef".split("");function BJ(t){for(var e="",n=0;n<4;n++)e+=I6[t>>8*n+4&15]+I6[t>>8*n&15];return e}function OJ(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function B5(t){return vD(t).map(OJ).join("")}var VJ=function(t){for(var e=0;e<t.length;e++)t[e]=BJ(t[e]);return t.join("")}(vD("hello"))!="5d41402abc4b2a76b9719d911017c592";function Uc(t,e){if(VJ){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function O5(t,e){var n,r,i,s;if(t!==n){for(var o=(i=t,s=1+(256/t.length>>0),new Array(s+1).join(i)),a=[],l=0;l<256;l++)a[l]=l;var c=0;for(l=0;l<256;l++){var d=a[l];c=(c+d+o.charCodeAt(l))%256,a[l]=a[c],a[c]=d}n=t,r=a}else a=r;var f=e.length,h=0,p=0,m="";for(l=0;l<f;l++)p=(p+(d=a[h=(h+1)%256]))%256,a[h]=a[p],a[p]=d,o=a[(a[h]+a[p])%256],m+=String.fromCharCode(e.charCodeAt(l)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var j6={print:4,modify:8,copy:16,"annot-forms":32};function dh(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(a){if(j6.perm!==void 0)throw new Error("Invalid permission: "+a);i+=j6[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=B5(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=O5(this.encryptionKey,this.padding)}function hh(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[r]}return e}function D6(t){if(Vn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var s=Math.random().toString(35);return e[n][s]=[r,!!i],s},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in e[n]){var o=e[n][s];try{o[0].apply(t,r)}catch(a){Xt.console&&ir.error("jsPDF PubSub Error",a.message,a)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Bp(t){if(!(this instanceof Bp))return new Bp(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function bD(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Fc(t,e,n,r,i){if(!(this instanceof Fc))return new Fc(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,bD.call(this,r,i)}function Yu(t,e,n,r,i){if(!(this instanceof Yu))return new Yu(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,bD.call(this,r,i)}function zt(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],o=[],a=1,l=16,c="S",d=null;Vn(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,s=t.compress||t.compressPdf||s,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),a=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=D6;var m="1.3",g=p.__private__.getPdfVersion=function(){return m};p.__private__.setPdfVersion=function(R){m=R};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return b};var x=p.__private__.getPageFormat=function(R){return b[R]};i=i||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},N=w.COMPAT;function E(){this.saveGraphicsState(),fe(new Nt(at,0,0,-at,0,Pt()*at).toString()+" cm"),this.setFontSize(this.getFontSize()/at),c="n",N=w.ADVANCED}function D(){this.restoreGraphicsState(),c="S",N=w.COMPAT}var j=p.__private__.combineFontStyleAndFontWeight=function(R,Q){if(R=="bold"&&Q=="normal"||R=="bold"&&Q==400||R=="normal"&&Q=="italic"||R=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(R=Q==400||Q==="normal"?R==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||R!=="normal"?(Q==700?"bold":Q)+""+R:"bold"),R};p.advancedAPI=function(R){var Q=N===w.COMPAT;return Q&&E.call(this),typeof R!="function"||(R(this),Q&&D.call(this)),this},p.compatAPI=function(R){var Q=N===w.ADVANCED;return Q&&D.call(this),typeof R!="function"||(R(this),Q&&E.call(this)),this},p.isAdvancedAPI=function(){return N===w.ADVANCED};var C,v=function(R){if(N!==w.ADVANCED)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},A=p.roundToPrecision=p.__private__.roundToPrecision=function(R,Q){var ce=e||Q;if(isNaN(R)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(ce).replace(/0+$/,"")};C=p.hpf=p.__private__.hpf=typeof l=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return A(R,l)}:l==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return A(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return A(R,16)};var I=p.f2=p.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return A(R,2)},S=p.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return A(R,3)},P=p.scale=p.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return N===w.COMPAT?R*at:N===w.ADVANCED?R:void 0},k=function(R){return N===w.COMPAT?Pt()-R:N===w.ADVANCED?R:void 0},F=function(R){return P(k(R))};p.__private__.setPrecision=p.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(e=parseInt(R,10))};var q,O="00000000000000000000000000000000",M=p.__private__.getFileId=function(){return O},W=p.__private__.setFileId=function(R){return O=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():O.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Jn=new dh(d.userPermissions,d.userPassword,d.ownerPassword,O)),O};p.setFileId=function(R){return W(R),this},p.getFileId=function(){return M()};var z=p.__private__.convertDateToPDFDate=function(R){var Q=R.getTimezoneOffset(),ce=Q<0?"+":"-",pe=Math.floor(Math.abs(Q/60)),ve=Math.abs(Q%60),Te=[ce,K(pe),"'",K(ve),"'"].join("");return["D:",R.getFullYear(),K(R.getMonth()+1),K(R.getDate()),K(R.getHours()),K(R.getMinutes()),K(R.getSeconds()),Te].join("")},J=p.__private__.convertPDFDateToDate=function(R){var Q=parseInt(R.substr(2,4),10),ce=parseInt(R.substr(6,2),10)-1,pe=parseInt(R.substr(8,2),10),ve=parseInt(R.substr(10,2),10),Te=parseInt(R.substr(12,2),10),Oe=parseInt(R.substr(14,2),10);return new Date(Q,ce,pe,ve,Te,Oe,0)},ne=p.__private__.setCreationDate=function(R){var Q;if(R===void 0&&(R=new Date),R instanceof Date)Q=z(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=R}return q=Q},V=p.__private__.getCreationDate=function(R){var Q=q;return R==="jsDate"&&(Q=J(q)),Q};p.setCreationDate=function(R){return ne(R),this},p.getCreationDate=function(R){return V(R)};var $,K=p.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},X=p.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},ae=0,ye=[],me=[],_e=0,Se=[],Ce=[],ze=!1,$e=me,dt=function(){ae=0,_e=0,me=[],ye=[],Se=[],Ds=tr(),hi=tr()};p.__private__.setCustomOutputDestination=function(R){ze=!0,$e=R};var Ie=function(R){ze||($e=R)};p.__private__.resetCustomOutputDestination=function(){ze=!1,$e=me};var fe=p.__private__.out=function(R){return R=R.toString(),_e+=R.length+1,$e.push(R),$e},yt=p.__private__.write=function(R){return fe(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},nt=p.__private__.getArrayBuffer=function(R){for(var Q=R.length,ce=new ArrayBuffer(Q),pe=new Uint8Array(ce);Q--;)pe[Q]=R.charCodeAt(Q);return ce},qe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return qe};var Xe=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(R){return Xe=N===w.ADVANCED?R/at:R,this};var Ye,Je=p.__private__.getFontSize=p.getFontSize=function(){return N===w.COMPAT?Xe:Xe*at},ut=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(R){return ut=R,this},p.__private__.getR2L=p.getR2L=function(){return ut};var mt,Dt=p.__private__.setZoomMode=function(R){var Q=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))Ye=R;else if(isNaN(R)){if(Q.indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');Ye=R}else Ye=parseInt(R,10)};p.__private__.getZoomMode=function(){return Ye};var _t,Mt=p.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');mt=R};p.__private__.getPageMode=function(){return mt};var Ht=p.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');_t=R};p.__private__.getLayoutMode=function(){return _t},p.__private__.setDisplayMode=p.setDisplayMode=function(R,Q,ce){return Dt(R),Ht(Q),Mt(ce),this};var Rt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(R){if(Object.keys(Rt).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Rt[R]},p.__private__.getDocumentProperties=function(){return Rt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(R){for(var Q in Rt)Rt.hasOwnProperty(Q)&&R[Q]&&(Rt[Q]=R[Q]);return this},p.__private__.setDocumentProperty=function(R,Q){if(Object.keys(Rt).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Rt[R]=Q};var Ot,at,cn,Yt,Rn,nn={},An={},Zr=[],sn={},ui={},yn={},mr={},Xn=null,pn=0,Et=[],on=new D6(p),Hr=t.hotfixes||[],In={},Hn={},di=[],Nt=function R(Q,ce,pe,ve,Te,Oe){if(!(this instanceof R))return new R(Q,ce,pe,ve,Te,Oe);isNaN(Q)&&(Q=1),isNaN(ce)&&(ce=0),isNaN(pe)&&(pe=0),isNaN(ve)&&(ve=1),isNaN(Te)&&(Te=0),isNaN(Oe)&&(Oe=0),this._matrix=[Q,ce,pe,ve,Te,Oe]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(R)},Nt.prototype.multiply=function(R){var Q=R.sx*this.sx+R.shy*this.shx,ce=R.sx*this.shy+R.shy*this.sy,pe=R.shx*this.sx+R.sy*this.shx,ve=R.shx*this.shy+R.sy*this.sy,Te=R.tx*this.sx+R.ty*this.shx+this.tx,Oe=R.tx*this.shy+R.ty*this.sy+this.ty;return new Nt(Q,ce,pe,ve,Te,Oe)},Nt.prototype.decompose=function(){var R=this.sx,Q=this.shy,ce=this.shx,pe=this.sy,ve=this.tx,Te=this.ty,Oe=Math.sqrt(R*R+Q*Q),Me=(R/=Oe)*ce+(Q/=Oe)*pe;ce-=R*Me,pe-=Q*Me;var _=Math.sqrt(ce*ce+pe*pe);return Me/=_,R*(pe/=_)<Q*(ce/=_)&&(R=-R,Q=-Q,Me=-Me,Oe=-Oe),{scale:new Nt(Oe,0,0,_,0,0),translate:new Nt(1,0,0,1,ve,Te),rotate:new Nt(R,Q,-Q,R,0,0),skew:new Nt(1,0,Me,1,0,0)}},Nt.prototype.toString=function(R){return this.join(" ")},Nt.prototype.inversed=function(){var R=this.sx,Q=this.shy,ce=this.shx,pe=this.sy,ve=this.tx,Te=this.ty,Oe=1/(R*pe-Q*ce),Me=pe*Oe,_=-Q*Oe,U=-ce*Oe,G=R*Oe;return new Nt(Me,_,U,G,-Me*ve-U*Te,-_*ve-G*Te)},Nt.prototype.applyToPoint=function(R){var Q=R.x*this.sx+R.y*this.shx+this.tx,ce=R.x*this.shy+R.y*this.sy+this.ty;return new ht(Q,ce)},Nt.prototype.applyToRectangle=function(R){var Q=this.applyToPoint(R),ce=this.applyToPoint(new ht(R.x+R.w,R.y+R.h));return new gt(Q.x,Q.y,ce.x-Q.x,ce.y-Q.y)},Nt.prototype.clone=function(){var R=this.sx,Q=this.shy,ce=this.shx,pe=this.sy,ve=this.tx,Te=this.ty;return new Nt(R,Q,ce,pe,ve,Te)},p.Matrix=Nt;var Wr=p.matrixMult=function(R,Q){return Q.multiply(R)},Cn=new Nt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Cn;var Fn=function(R,Q){if(!ui[R]){var ce=(Q instanceof Fc?"Sh":"P")+(Object.keys(sn).length+1).toString(10);Q.id=ce,ui[R]=ce,sn[ce]=Q,on.publish("addPattern",Q)}};p.ShadingPattern=Fc,p.TilingPattern=Yu,p.addShadingPattern=function(R,Q){return v("addShadingPattern()"),Fn(R,Q),this},p.beginTilingPattern=function(R){v("beginTilingPattern()"),$t(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},p.endTilingPattern=function(R,Q){v("endTilingPattern()"),Q.stream=Ce[$].join(`
`),Fn(R,Q),on.publish("endTilingPattern",Q),di.pop().restore()};var sr=p.__private__.newObject=function(){var R=tr();return Pr(R,!0),R},tr=p.__private__.newObjectDeferred=function(){return ae++,ye[ae]=function(){return _e},ae},Pr=function(R,Q){return Q=typeof Q=="boolean"&&Q,ye[R]=_e,Q&&fe(R+" 0 obj"),R},sa=p.__private__.newAdditionalObject=function(){var R={objId:tr(),content:""};return Se.push(R),R},Ds=tr(),hi=tr(),Mi=p.__private__.decodeColorString=function(R){var Q=R.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length===5&&(Q[4]==="k"||Q[4]==="K")&&(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var ce=parseFloat(Q[0]);Q=[ce,ce,ce,"r"]}for(var pe="#",ve=0;ve<3;ve++)pe+=("0"+Math.floor(255*parseFloat(Q[ve])).toString(16)).slice(-2);return pe},wi=p.__private__.encodeColorString=function(R){var Q;typeof R=="string"&&(R={ch1:R});var ce=R.ch1,pe=R.ch2,ve=R.ch3,Te=R.ch4,Oe=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var Me=new yD(ce);if(Me.ok)ce=Me.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var _=parseInt(ce.substr(1),16);ce=_>>16&255,pe=_>>8&255,ve=255&_}if(pe===void 0||Te===void 0&&ce===pe&&pe===ve)if(typeof ce=="string")Q=ce+" "+Oe[0];else switch(R.precision){case 2:Q=I(ce/255)+" "+Oe[0];break;case 3:default:Q=S(ce/255)+" "+Oe[0]}else if(Te===void 0||Vn(Te)==="object"){if(Te&&!isNaN(Te.a)&&Te.a===0)return Q=["1.","1.","1.",Oe[1]].join(" ");if(typeof ce=="string")Q=[ce,pe,ve,Oe[1]].join(" ");else switch(R.precision){case 2:Q=[I(ce/255),I(pe/255),I(ve/255),Oe[1]].join(" ");break;default:case 3:Q=[S(ce/255),S(pe/255),S(ve/255),Oe[1]].join(" ")}}else if(typeof ce=="string")Q=[ce,pe,ve,Te,Oe[2]].join(" ");else switch(R.precision){case 2:Q=[I(ce),I(pe),I(ve),I(Te),Oe[2]].join(" ");break;case 3:default:Q=[S(ce),S(pe),S(ve),S(Te),Oe[2]].join(" ")}return Q},fi=p.__private__.getFilters=function(){return o},gr=p.__private__.putStream=function(R){var Q=(R=R||{}).data||"",ce=R.filters||fi(),pe=R.alreadyAppliedFilters||[],ve=R.addLength1||!1,Te=Q.length,Oe=R.objectId,Me=function(Ft){return Ft};if(d!==null&&Oe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Me=Jn.encryptor(Oe,0));var _={};ce===!0&&(ce=["FlateEncode"]);var U=R.additionalKeyValues||[],G=(_=zt.API.processDataByFilters!==void 0?zt.API.processDataByFilters(Q,ce):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(pe)?pe.join(" "):pe.toString());if(_.data.length!==0&&(U.push({key:"Length",value:_.data.length}),ve===!0&&U.push({key:"Length1",value:Te})),G.length!=0)if(G.split("/").length-1==1)U.push({key:"Filter",value:G});else{U.push({key:"Filter",value:"["+G+"]"});for(var ee=0;ee<U.length;ee+=1)if(U[ee].key==="DecodeParms"){for(var be=[],Pe=0;Pe<_.reverseChain.split("/").length-1;Pe+=1)be.push("null");be.push(U[ee].value),U[ee].value="["+be.join(" ")+"]"}}fe("<<");for(var We=0;We<U.length;We++)fe("/"+U[We].key+" "+U[We].value);fe(">>"),_.data.length!==0&&(fe("stream"),fe(Me(_.data)),fe("endstream"))},_i=p.__private__.putPage=function(R){var Q=R.number,ce=R.data,pe=R.objId,ve=R.contentsObjId;Pr(pe,!0),fe("<</Type /Page"),fe("/Parent "+R.rootDictionaryObjId+" 0 R"),fe("/Resources "+R.resourceDictionaryObjId+" 0 R"),fe("/MediaBox ["+parseFloat(C(R.mediaBox.bottomLeftX))+" "+parseFloat(C(R.mediaBox.bottomLeftY))+" "+C(R.mediaBox.topRightX)+" "+C(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&fe("/CropBox ["+C(R.cropBox.bottomLeftX)+" "+C(R.cropBox.bottomLeftY)+" "+C(R.cropBox.topRightX)+" "+C(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&fe("/BleedBox ["+C(R.bleedBox.bottomLeftX)+" "+C(R.bleedBox.bottomLeftY)+" "+C(R.bleedBox.topRightX)+" "+C(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&fe("/TrimBox ["+C(R.trimBox.bottomLeftX)+" "+C(R.trimBox.bottomLeftY)+" "+C(R.trimBox.topRightX)+" "+C(R.trimBox.topRightY)+"]"),R.artBox!==null&&fe("/ArtBox ["+C(R.artBox.bottomLeftX)+" "+C(R.artBox.bottomLeftY)+" "+C(R.artBox.topRightX)+" "+C(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&fe("/UserUnit "+R.userUnit),on.publish("putPage",{objId:pe,pageContext:Et[Q],pageNumber:Q,page:ce}),fe("/Contents "+ve+" 0 R"),fe(">>"),fe("endobj");var Te=ce.join(`
`);return N===w.ADVANCED&&(Te+=`
Q`),Pr(ve,!0),gr({data:Te,filters:fi(),objectId:ve}),fe("endobj"),pe},Bi=p.__private__.putPages=function(){var R,Q,ce=[];for(R=1;R<=pn;R++)Et[R].objId=tr(),Et[R].contentsObjId=tr();for(R=1;R<=pn;R++)ce.push(_i({number:R,data:Ce[R],objId:Et[R].objId,contentsObjId:Et[R].contentsObjId,mediaBox:Et[R].mediaBox,cropBox:Et[R].cropBox,bleedBox:Et[R].bleedBox,trimBox:Et[R].trimBox,artBox:Et[R].artBox,userUnit:Et[R].userUnit,rootDictionaryObjId:Ds,resourceDictionaryObjId:hi}));Pr(Ds,!0),fe("<</Type /Pages");var pe="/Kids [";for(Q=0;Q<pn;Q++)pe+=ce[Q]+" 0 R ";fe(pe+"]"),fe("/Count "+pn),fe(">>"),fe("endobj"),on.publish("postPutPages")},Rs=function(R){on.publish("putFont",{font:R,out:fe,newObject:sr,putStream:gr}),R.isAlreadyPutted!==!0&&(R.objectNumber=sr(),fe("<<"),fe("/Type /Font"),fe("/BaseFont /"+hh(R.postScriptName)),fe("/Subtype /Type1"),typeof R.encoding=="string"&&fe("/Encoding /"+R.encoding),fe("/FirstChar 32"),fe("/LastChar 255"),fe(">>"),fe("endobj"))},to=function(){for(var R in nn)nn.hasOwnProperty(R)&&(f===!1||f===!0&&h.hasOwnProperty(R))&&Rs(nn[R])},no=function(R){R.objectNumber=sr();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[C(R.x),C(R.y),C(R.x+R.width),C(R.y+R.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var ce=R.pages[1].join(`
`);gr({data:ce,additionalKeyValues:Q,objectId:R.objectNumber}),fe("endobj")},To=function(){for(var R in In)In.hasOwnProperty(R)&&no(In[R])},$l=function(R,Q){var ce,pe=[],ve=1/(Q-1);for(ce=0;ce<1;ce+=ve)pe.push(ce);if(pe.push(1),R[0].offset!=0){var Te={offset:0,color:R[0].color};R.unshift(Te)}if(R[R.length-1].offset!=1){var Oe={offset:1,color:R[R.length-1].color};R.push(Oe)}for(var Me="",_=0,U=0;U<pe.length;U++){for(ce=pe[U];ce>R[_+1].offset;)_++;var G=R[_].offset,ee=(ce-G)/(R[_+1].offset-G),be=R[_].color,Pe=R[_+1].color;Me+=X(Math.round((1-ee)*be[0]+ee*Pe[0]).toString(16))+X(Math.round((1-ee)*be[1]+ee*Pe[1]).toString(16))+X(Math.round((1-ee)*be[2]+ee*Pe[2]).toString(16))}return Me.trim()},oa=function(R,Q){Q||(Q=21);var ce=sr(),pe=$l(R.colors,Q),ve=[];ve.push({key:"FunctionType",value:"0"}),ve.push({key:"Domain",value:"[0.0 1.0]"}),ve.push({key:"Size",value:"["+Q+"]"}),ve.push({key:"BitsPerSample",value:"8"}),ve.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ve.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),gr({data:pe,additionalKeyValues:ve,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),fe("endobj"),R.objectNumber=sr(),fe("<< /ShadingType "+R.type),fe("/ColorSpace /DeviceRGB");var Te="/Coords ["+C(parseFloat(R.coords[0]))+" "+C(parseFloat(R.coords[1]))+" ";R.type===2?Te+=C(parseFloat(R.coords[2]))+" "+C(parseFloat(R.coords[3])):Te+=C(parseFloat(R.coords[2]))+" "+C(parseFloat(R.coords[3]))+" "+C(parseFloat(R.coords[4]))+" "+C(parseFloat(R.coords[5])),fe(Te+="]"),R.matrix&&fe("/Matrix ["+R.matrix.toString()+"]"),fe("/Function "+ce+" 0 R"),fe("/Extend [true true]"),fe(">>"),fe("endobj")},Wa=function(R,Q){var ce=tr(),pe=sr();Q.push({resourcesOid:ce,objectOid:pe}),R.objectNumber=pe;var ve=[];ve.push({key:"Type",value:"/Pattern"}),ve.push({key:"PatternType",value:"1"}),ve.push({key:"PaintType",value:"1"}),ve.push({key:"TilingType",value:"1"}),ve.push({key:"BBox",value:"["+R.boundingBox.map(C).join(" ")+"]"}),ve.push({key:"XStep",value:C(R.xStep)}),ve.push({key:"YStep",value:C(R.yStep)}),ve.push({key:"Resources",value:ce+" 0 R"}),R.matrix&&ve.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),gr({data:R.stream,additionalKeyValues:ve,objectId:R.objectNumber}),fe("endobj")},Fs=function(R){var Q;for(Q in sn)sn.hasOwnProperty(Q)&&(sn[Q]instanceof Fc?oa(sn[Q]):sn[Q]instanceof Yu&&Wa(sn[Q],R))},ro=function(R){for(var Q in R.objectNumber=sr(),fe("<<"),R)switch(Q){case"opacity":fe("/ca "+I(R[Q]));break;case"stroke-opacity":fe("/CA "+I(R[Q]))}fe(">>"),fe("endobj")},Ls=function(){var R;for(R in yn)yn.hasOwnProperty(R)&&ro(yn[R])},io=function(){for(var R in fe("/XObject <<"),In)In.hasOwnProperty(R)&&In[R].objectNumber>=0&&fe("/"+R+" "+In[R].objectNumber+" 0 R");on.publish("putXobjectDict"),fe(">>")},Gl=function(){Jn.oid=sr(),fe("<<"),fe("/Filter /Standard"),fe("/V "+Jn.v),fe("/R "+Jn.r),fe("/U <"+Jn.toHexString(Jn.U)+">"),fe("/O <"+Jn.toHexString(Jn.O)+">"),fe("/P "+Jn.P),fe(">>"),fe("endobj")},$a=function(){for(var R in fe("/Font <<"),nn)nn.hasOwnProperty(R)&&(f===!1||f===!0&&h.hasOwnProperty(R))&&fe("/"+R+" "+nn[R].objectNumber+" 0 R");fe(">>")},Kl=function(){if(Object.keys(sn).length>0){for(var R in fe("/Shading <<"),sn)sn.hasOwnProperty(R)&&sn[R]instanceof Fc&&sn[R].objectNumber>=0&&fe("/"+R+" "+sn[R].objectNumber+" 0 R");on.publish("putShadingPatternDict"),fe(">>")}},Io=function(R){if(Object.keys(sn).length>0){for(var Q in fe("/Pattern <<"),sn)sn.hasOwnProperty(Q)&&sn[Q]instanceof p.TilingPattern&&sn[Q].objectNumber>=0&&sn[Q].objectNumber<R&&fe("/"+Q+" "+sn[Q].objectNumber+" 0 R");on.publish("putTilingPatternDict"),fe(">>")}},Ga=function(){if(Object.keys(yn).length>0){var R;for(R in fe("/ExtGState <<"),yn)yn.hasOwnProperty(R)&&yn[R].objectNumber>=0&&fe("/"+R+" "+yn[R].objectNumber+" 0 R");on.publish("putGStateDict"),fe(">>")}},nr=function(R){Pr(R.resourcesOid,!0),fe("<<"),fe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),$a(),Kl(),Io(R.objectOid),Ga(),io(),fe(">>"),fe("endobj")},Ka=function(){var R=[];to(),Ls(),To(),Fs(R),on.publish("putResources"),R.forEach(nr),nr({resourcesOid:hi,objectOid:Number.MAX_SAFE_INTEGER}),on.publish("postPutResources")},Qa=function(){on.publish("putAdditionalObjects");for(var R=0;R<Se.length;R++){var Q=Se[R];Pr(Q.objId,!0),fe(Q.content),fe("endobj")}on.publish("postPutAdditionalObjects")},Ql=function(R){An[R.fontName]=An[R.fontName]||{},An[R.fontName][R.fontStyle]=R.id},Ya=function(R,Q,ce,pe,ve){var Te={id:"F"+(Object.keys(nn).length+1).toString(10),postScriptName:R,fontName:Q,fontStyle:ce,encoding:pe,isStandardFont:ve||!1,metadata:{}};return on.publish("addFont",{font:Te,instance:this}),nn[Te.id]=Te,Ql(Te),Te.id},Yl=function(R){for(var Q=0,ce=qe.length;Q<ce;Q++){var pe=Ya.call(this,R[Q][0],R[Q][1],R[Q][2],qe[Q][3],!0);f===!1&&(h[pe]=!0);var ve=R[Q][0].split("-");Ql({id:pe,fontName:ve[0],fontStyle:ve[1]||""})}on.publish("addFonts",{fonts:nn,dictionary:An})},Oi=function(R){return R.foo=function(){try{return R.apply(this,arguments)}catch(pe){var Q=pe.stack||"";~Q.indexOf(" at ")&&(Q=Q.split(" at ")[1]);var ce="Error in function "+Q.split(`
`)[0].split("<")[0]+": "+pe.message;if(!Xt.console)throw new Error(ce);Xt.console.error(ce,pe),Xt.alert&&alert(ce)}},R.foo.bar=R,R.foo},jo=function(R,Q){var ce,pe,ve,Te,Oe,Me,_,U,G;if(ve=(Q=Q||{}).sourceEncoding||"Unicode",Oe=Q.outputEncoding,(Q.autoencode||Oe)&&nn[Ot].metadata&&nn[Ot].metadata[ve]&&nn[Ot].metadata[ve].encoding&&(Te=nn[Ot].metadata[ve].encoding,!Oe&&nn[Ot].encoding&&(Oe=nn[Ot].encoding),!Oe&&Te.codePages&&(Oe=Te.codePages[0]),typeof Oe=="string"&&(Oe=Te[Oe]),Oe)){for(_=!1,Me=[],ce=0,pe=R.length;ce<pe;ce++)(U=Oe[R.charCodeAt(ce)])?Me.push(String.fromCharCode(U)):Me.push(R[ce]),Me[ce].charCodeAt(0)>>8&&(_=!0);R=Me.join("")}for(ce=R.length;_===void 0&&ce!==0;)R.charCodeAt(ce-1)>>8&&(_=!0),ce--;if(!_)return R;for(Me=Q.noBOM?[]:[254,255],ce=0,pe=R.length;ce<pe;ce++){if((G=(U=R.charCodeAt(ce))>>8)>>8)throw new Error("Character at position "+ce+" of string '"+R+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Me.push(G),Me.push(U-(G<<8))}return String.fromCharCode.apply(void 0,Me)},xr=p.__private__.pdfEscape=p.pdfEscape=function(R,Q){return jo(R,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ni=p.__private__.beginPage=function(R){Ce[++pn]=[],Et[pn]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},Xa(pn),Ie(Ce[$])},Do=function(R,Q){var ce,pe,ve;switch(n=Q||n,typeof R=="string"&&(ce=x(R.toLowerCase()),Array.isArray(ce)&&(pe=ce[0],ve=ce[1])),Array.isArray(R)&&(pe=R[0]*at,ve=R[1]*at),isNaN(pe)&&(pe=i[0],ve=i[1]),(pe>14400||ve>14400)&&(ir.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),pe=Math.min(14400,pe),ve=Math.min(14400,ve)),i=[pe,ve],n.substr(0,1)){case"l":ve>pe&&(i=[ve,pe]);break;case"p":pe>ve&&(i=[ve,pe])}Ni(i),tl(el),fe(xe),it!==0&&fe(it+" J"),He!==0&&fe(He+" j"),on.publish("addPage",{pageNumber:pn})},aa=function(R){R>0&&R<=pn&&(Ce.splice(R,1),Et.splice(R,1),pn--,$>pn&&($=pn),this.setPage($))},Xa=function(R){R>0&&R<=pn&&($=R)},Ln=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Ce.length-1},so=function(R,Q,ce){var pe,ve=void 0;return ce=ce||{},R=R!==void 0?R:nn[Ot].fontName,Q=Q!==void 0?Q:nn[Ot].fontStyle,pe=R.toLowerCase(),An[pe]!==void 0&&An[pe][Q]!==void 0?ve=An[pe][Q]:An[R]!==void 0&&An[R][Q]!==void 0?ve=An[R][Q]:ce.disableWarning===!1&&ir.warn("Unable to look up font label for font '"+R+"', '"+Q+"'. Refer to getFontList() for available fonts."),ve||ce.noFallback||(ve=An.times[Q])==null&&(ve=An.times.normal),ve},oo=p.__private__.putInfo=function(){var R=sr(),Q=function(pe){return pe};for(var ce in d!==null&&(Q=Jn.encryptor(R,0)),fe("<<"),fe("/Producer ("+xr(Q("jsPDF "+zt.version))+")"),Rt)Rt.hasOwnProperty(ce)&&Rt[ce]&&fe("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+xr(Q(Rt[ce]))+")");fe("/CreationDate ("+xr(Q(q))+")"),fe(">>"),fe("endobj")},ms=p.__private__.putCatalog=function(R){var Q=(R=R||{}).rootDictionaryObjId||Ds;switch(sr(),fe("<<"),fe("/Type /Catalog"),fe("/Pages "+Q+" 0 R"),Ye||(Ye="fullwidth"),Ye){case"fullwidth":fe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":fe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":fe("/OpenAction [3 0 R /Fit]");break;case"original":fe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+Ye;ce.substr(ce.length-1)==="%"&&(Ye=parseInt(Ye)/100),typeof Ye=="number"&&fe("/OpenAction [3 0 R /XYZ null null "+I(Ye)+"]")}switch(_t||(_t="continuous"),_t){case"continuous":fe("/PageLayout /OneColumn");break;case"single":fe("/PageLayout /SinglePage");break;case"two":case"twoleft":fe("/PageLayout /TwoColumnLeft");break;case"tworight":fe("/PageLayout /TwoColumnRight")}mt&&fe("/PageMode /"+mt),on.publish("putCatalog"),fe(">>"),fe("endobj")},bu=p.__private__.putTrailer=function(){fe("trailer"),fe("<<"),fe("/Size "+(ae+1)),fe("/Root "+ae+" 0 R"),fe("/Info "+(ae-1)+" 0 R"),d!==null&&fe("/Encrypt "+Jn.oid+" 0 R"),fe("/ID [ <"+O+"> <"+O+"> ]"),fe(">>")},Xl=p.__private__.putHeader=function(){fe("%PDF-"+m),fe("%ºß¬à")},wu=p.__private__.putXRef=function(){var R="0000000000";fe("xref"),fe("0 "+(ae+1)),fe("0000000000 65535 f ");for(var Q=1;Q<=ae;Q++)typeof ye[Q]=="function"?fe((R+ye[Q]()).slice(-10)+" 00000 n "):ye[Q]!==void 0?fe((R+ye[Q]).slice(-10)+" 00000 n "):fe("0000000000 00000 n ")},gs=p.__private__.buildDocument=function(){dt(),Ie(me),on.publish("buildDocument"),Xl(),Bi(),Qa(),Ka(),d!==null&&Gl(),oo(),ms();var R=_e;return wu(),bu(),fe("startxref"),fe(""+R),fe("%%EOF"),Ie(Ce[$]),me.join(`
`)},la=p.__private__.getBlob=function(R){return new Blob([nt(R)],{type:"application/pdf"})},ca=p.output=p.__private__.output=Oi(function(R,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",R){case void 0:return gs();case"save":p.save(Q.filename);break;case"arraybuffer":return nt(gs());case"blob":return la(gs());case"bloburi":case"bloburl":if(Xt.URL!==void 0&&typeof Xt.URL.createObjectURL=="function")return Xt.URL&&Xt.URL.createObjectURL(la(gs()))||void 0;ir.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",pe=gs();try{ce=M5(pe)}catch{ce=M5(unescape(encodeURIComponent(pe)))}return"data:application/pdf;filename="+Q.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var ve="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Te=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(ve=Q.pdfObjectUrl,Te="");var Oe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ve+'"'+Te+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",Me=Xt.open();return Me!==null&&Me.document.write(Oe),Me}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var _='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',U=Xt.open();if(U!==null){U.document.write(_);var G=this;U.document.documentElement.querySelector("#pdfViewer").onload=function(){U.document.title=Q.filename,U.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(G.output("bloburl"))}}return U}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ee='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',be=Xt.open();if(be!==null&&(be.document.write(ee),be.document.title=Q.filename),be||typeof safari>"u")return be;break;case"datauri":case"dataurl":return Xt.document.location.href=this.output("datauristring",Q);default:return null}}),ao=function(R){return Array.isArray(Hr)===!0&&Hr.indexOf(R)>-1};switch(r){case"pt":at=1;break;case"mm":at=72/25.4;break;case"cm":at=72/2.54;break;case"in":at=72;break;case"px":at=ao("px_scaling")==1?.75:96/72;break;case"pc":case"em":at=12;break;case"ex":at=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);at=r}var Jn=null;ne(),W();var Jl=function(R){return d!==null?Jn.encryptor(R,0):function(Q){return Q}},Ja=p.__private__.getPageInfo=p.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Et[R].objId,pageNumber:R,pageContext:Et[R]}},Qt=p.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in Et)if(Et[Q].objId===R)break;return Ja(Q)},lo=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Et[$].objId,pageNumber:$,pageContext:Et[$]}};p.addPage=function(){return Do.apply(this,arguments),this},p.setPage=function(){return Xa.apply(this,arguments),Ie.call(this,Ce[$]),this},p.insertPage=function(R){return this.addPage(),this.movePage($,R),this},p.movePage=function(R,Q){var ce,pe;if(R>Q){ce=Ce[R],pe=Et[R];for(var ve=R;ve>Q;ve--)Ce[ve]=Ce[ve-1],Et[ve]=Et[ve-1];Ce[Q]=ce,Et[Q]=pe,this.setPage(Q)}else if(R<Q){ce=Ce[R],pe=Et[R];for(var Te=R;Te<Q;Te++)Ce[Te]=Ce[Te+1],Et[Te]=Et[Te+1];Ce[Q]=ce,Et[Q]=pe,this.setPage(Q)}return this},p.deletePage=function(){return aa.apply(this,arguments),this},p.__private__.text=p.text=function(R,Q,ce,pe,ve){var Te,Oe,Me,_,U,G,ee,be,Pe,We=(pe=pe||{}).scope||this;if(typeof R=="number"&&typeof Q=="number"&&(typeof ce=="string"||Array.isArray(ce))){var Ft=ce;ce=Q,Q=R,R=Ft}if(arguments[3]instanceof Nt?(v("The transform parameter of text() with a Matrix value"),Pe=ve):(Me=arguments[4],_=arguments[5],Vn(ee=arguments[3])==="object"&&ee!==null||(typeof Me=="string"&&(_=Me,Me=null),typeof ee=="string"&&(_=ee,ee=null),typeof ee=="number"&&(Me=ee,ee=null),pe={flags:ee,angle:Me,align:_})),isNaN(Q)||isNaN(ce)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return We;var rn="",Wt=!1,Pn=typeof pe.lineHeightFactor=="number"?pe.lineHeightFactor:jn,Mn=We.internal.scaleFactor;function Os(ar){return ar=ar.split("	").join(Array(pe.TabLen||9).join(" ")),xr(ar,ee)}function kr(ar){for(var lr,Mr=ar.concat(),ti=[],ll=Mr.length;ll--;)typeof(lr=Mr.shift())=="string"?ti.push(lr):Array.isArray(ar)&&(lr.length===1||lr[1]===void 0&&lr[2]===void 0)?ti.push(lr[0]):ti.push([lr[0],lr[1],lr[2]]);return ti}function uo(ar,lr){var Mr;if(typeof ar=="string")Mr=lr(ar)[0];else if(Array.isArray(ar)){for(var ti,ll,Ef=ar.concat(),Wd=[],gm=Ef.length;gm--;)typeof(ti=Ef.shift())=="string"?Wd.push(lr(ti)[0]):Array.isArray(ti)&&typeof ti[0]=="string"&&(ll=lr(ti[0],ti[1],ti[2]),Wd.push([ll[0],ll[1],ll[2]]));Mr=Wd}return Mr}var Vs=!1,ma=!0;if(typeof R=="string")Vs=!0;else if(Array.isArray(R)){var ga=R.concat();Oe=[];for(var nl,$r=ga.length;$r--;)(typeof(nl=ga.shift())!="string"||Array.isArray(nl)&&typeof nl[0]!="string")&&(ma=!1);Vs=ma}if(Vs===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var Zl=Xe/We.internal.scaleFactor,ec=Zl*(Pn-1);switch(pe.baseline){case"bottom":ce-=ec;break;case"top":ce+=Zl-ec;break;case"hanging":ce+=Zl-2*ec;break;case"middle":ce+=Zl/2-ec}if((G=pe.maxWidth||0)>0&&(typeof R=="string"?R=We.splitTextToSize(R,G):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(ar,lr){return ar.concat(We.splitTextToSize(lr,G))},[]))),Te={text:R,x:Q,y:ce,options:pe,mutex:{pdfEscape:xr,activeFontKey:Ot,fonts:nn,activeFontSize:Xe}},on.publish("preProcessText",Te),R=Te.text,Me=(pe=Te.options).angle,!(Pe instanceof Nt)&&Me&&typeof Me=="number"){Me*=Math.PI/180,pe.rotationDirection===0&&(Me=-Me),N===w.ADVANCED&&(Me=-Me);var ei=Math.cos(Me),rl=Math.sin(Me);Pe=new Nt(ei,rl,-rl,ei,0,0)}else Me&&Me instanceof Nt&&(Pe=Me);N!==w.ADVANCED||Pe||(Pe=Cn),(U=pe.charSpace||rt)!==void 0&&(rn+=C(P(U))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(be=pe.horizontalScale)!==void 0&&(rn+=C(100*be)+` Tz
`),pe.lang;var Vi=-1,tc=pe.renderingMode!==void 0?pe.renderingMode:pe.stroke,or=We.internal.getCurrentPageInfo().pageContext;switch(tc){case 0:case!1:case"fill":Vi=0;break;case 1:case!0:case"stroke":Vi=1;break;case 2:case"fillThenStroke":Vi=2;break;case 3:case"invisible":Vi=3;break;case 4:case"fillAndAddForClipping":Vi=4;break;case 5:case"strokeAndAddPathForClipping":Vi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Vi=6;break;case 7:case"addToPathForClipping":Vi=7}var _u=or.usedRenderingMode!==void 0?or.usedRenderingMode:-1;Vi!==-1?rn+=Vi+` Tr
`:_u!==-1&&(rn+=`0 Tr
`),Vi!==-1&&(or.usedRenderingMode=Vi),_=pe.align||"left";var xs,nc=Xe*Pn,il=We.internal.pageSize.getWidth(),rc=nn[Ot];U=pe.charSpace||rt,G=pe.maxWidth||0,ee=Object.assign({autoencode:!0,noBOM:!0},pe.flags);var Mo=[],Nu=function(ar){return We.getStringUnitWidth(ar,{font:rc,charSpace:U,fontSize:Xe,doKerning:!1})*Xe/Mn};if(Object.prototype.toString.call(R)==="[object Array]"){var ys;Oe=kr(R),_!=="left"&&(xs=Oe.map(Nu));var is,ic=0;if(_==="right"){Q-=xs[0],R=[],$r=Oe.length;for(var sl=0;sl<$r;sl++)sl===0?(is=te(Q),ys=oe(ce)):(is=P(ic-xs[sl]),ys=-nc),R.push([Oe[sl],is,ys]),ic=xs[sl]}else if(_==="center"){Q-=xs[0]/2,R=[],$r=Oe.length;for(var ol=0;ol<$r;ol++)ol===0?(is=te(Q),ys=oe(ce)):(is=P((ic-xs[ol])/2),ys=-nc),R.push([Oe[ol],is,ys]),ic=xs[ol]}else if(_==="left"){R=[],$r=Oe.length;for(var zd=0;zd<$r;zd++)R.push(Oe[zd])}else if(_==="justify"&&rc.encoding==="Identity-H"){R=[],$r=Oe.length,G=G!==0?G:il;for(var al=0,Lr=0;Lr<$r;Lr++)if(ys=Lr===0?oe(ce):-nc,is=Lr===0?te(Q):al,Lr<$r-1){var Nf=P((G-xs[Lr])/(Oe[Lr].split(" ").length-1)),ss=Oe[Lr].split(" ");R.push([ss[0]+" ",is,ys]),al=0;for(var ho=1;ho<ss.length;ho++){var qd=(Nu(ss[ho-1]+" "+ss[ho])-Nu(ss[ho]))*Mn+Nf;ho==ss.length-1?R.push([ss[ho],qd,0]):R.push([ss[ho]+" ",qd,0]),al-=qd}}else R.push([Oe[Lr],is,ys]);R.push(["",al,0])}else{if(_!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],$r=Oe.length,G=G!==0?G:il,Lr=0;Lr<$r;Lr++)ys=Lr===0?oe(ce):-nc,is=Lr===0?te(Q):0,Lr<$r-1?Mo.push(C(P((G-xs[Lr])/(Oe[Lr].split(" ").length-1)))):Mo.push(0),R.push([Oe[Lr],is,ys])}}var mm=typeof pe.R2L=="boolean"?pe.R2L:ut;mm===!0&&(R=uo(R,function(ar,lr,Mr){return[ar.split("").reverse().join(""),lr,Mr]})),Te={text:R,x:Q,y:ce,options:pe,mutex:{pdfEscape:xr,activeFontKey:Ot,fonts:nn,activeFontSize:Xe}},on.publish("postProcessText",Te),R=Te.text,Wt=Te.mutex.isHex||!1;var Af=nn[Ot].encoding;Af!=="WinAnsiEncoding"&&Af!=="StandardEncoding"||(R=uo(R,function(ar,lr,Mr){return[Os(ar),lr,Mr]})),Oe=kr(R),R=[];for(var Au,Su,sc,Eu=0,Hd=1,Cu=Array.isArray(Oe[0])?Hd:Eu,oc="",Sf=function(ar,lr,Mr){var ti="";return Mr instanceof Nt?(Mr=typeof pe.angle=="number"?Wr(Mr,new Nt(1,0,0,1,ar,lr)):Wr(new Nt(1,0,0,1,ar,lr),Mr),N===w.ADVANCED&&(Mr=Wr(new Nt(1,0,0,-1,0,0),Mr)),ti=Mr.join(" ")+` Tm
`):ti=C(ar)+" "+C(lr)+` Td
`,ti},fo=0;fo<Oe.length;fo++){switch(oc="",Cu){case Hd:sc=(Wt?"<":"(")+Oe[fo][0]+(Wt?">":")"),Au=parseFloat(Oe[fo][1]),Su=parseFloat(Oe[fo][2]);break;case Eu:sc=(Wt?"<":"(")+Oe[fo]+(Wt?">":")"),Au=te(Q),Su=oe(ce)}Mo!==void 0&&Mo[fo]!==void 0&&(oc=Mo[fo]+` Tw
`),fo===0?R.push(oc+Sf(Au,Su,Pe)+sc):Cu===Eu?R.push(oc+sc):Cu===Hd&&R.push(oc+Sf(Au,Su,Pe)+sc)}R=Cu===Eu?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var po=`BT
/`;return po+=Ot+" "+Xe+` Tf
`,po+=C(Xe*Pn)+` TL
`,po+=Le+`
`,po+=rn,po+=R,fe(po+="ET"),h[Ot]=!0,We};var Za=p.__private__.clip=p.clip=function(R){return fe(R==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Za("evenodd")},p.__private__.discardPath=p.discardPath=function(){return fe("n"),this};var ns=p.__private__.isValidStyle=function(R){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(Q=!0),Q};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(R){return ns(R)&&(c=R),this};var Ro=p.__private__.getStyle=p.getStyle=function(R){var Q=c;switch(R){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=R}return Q},Ai=p.close=function(){return fe("h"),this};p.stroke=function(){return fe("S"),this},p.fill=function(R){return co("f",R),this},p.fillEvenOdd=function(R){return co("f*",R),this},p.fillStroke=function(R){return co("B",R),this},p.fillStrokeEvenOdd=function(R){return co("B*",R),this};var co=function(R,Q){Vn(Q)==="object"?da(Q,R):fe(R)},ua=function(R){R===null||N===w.ADVANCED&&R===void 0||(R=Ro(R),fe(R))};function Fo(R,Q,ce,pe,ve){var Te=new Yu(Q||this.boundingBox,ce||this.xStep,pe||this.yStep,this.gState,ve||this.matrix);Te.stream=this.stream;var Oe=R+"$$"+this.cloneIndex+++"$$";return Fn(Oe,Te),Te}var da=function(R,Q){var ce=ui[R.key],pe=sn[ce];if(pe instanceof Fc)fe("q"),fe(ha(Q)),pe.gState&&p.setGState(pe.gState),fe(R.matrix.toString()+" cm"),fe("/"+ce+" sh"),fe("Q");else if(pe instanceof Yu){var ve=new Nt(1,0,0,-1,0,Pt());R.matrix&&(ve=ve.multiply(R.matrix||Cn),ce=Fo.call(pe,R.key,R.boundingBox,R.xStep,R.yStep,ve).id),fe("q"),fe("/Pattern cs"),fe("/"+ce+" scn"),pe.gState&&p.setGState(pe.gState),fe(Q),fe("Q")}},ha=function(R){switch(R){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ms=p.moveTo=function(R,Q){return fe(C(P(R))+" "+C(F(Q))+" m"),this},rs=p.lineTo=function(R,Q){return fe(C(P(R))+" "+C(F(Q))+" l"),this},Bs=p.curveTo=function(R,Q,ce,pe,ve,Te){return fe([C(P(R)),C(F(Q)),C(P(ce)),C(F(pe)),C(P(ve)),C(F(Te)),"c"].join(" ")),this};p.__private__.line=p.line=function(R,Q,ce,pe,ve){if(isNaN(R)||isNaN(Q)||isNaN(ce)||isNaN(pe)||!ns(ve))throw new Error("Invalid arguments passed to jsPDF.line");return N===w.COMPAT?this.lines([[ce-R,pe-Q]],R,Q,[1,1],ve||"S"):this.lines([[ce-R,pe-Q]],R,Q,[1,1]).stroke()},p.__private__.lines=p.lines=function(R,Q,ce,pe,ve,Te){var Oe,Me,_,U,G,ee,be,Pe,We,Ft,rn,Wt;if(typeof R=="number"&&(Wt=ce,ce=Q,Q=R,R=Wt),pe=pe||[1,1],Te=Te||!1,isNaN(Q)||isNaN(ce)||!Array.isArray(R)||!Array.isArray(pe)||!ns(ve)||typeof Te!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ms(Q,ce),Oe=pe[0],Me=pe[1],U=R.length,Ft=Q,rn=ce,_=0;_<U;_++)(G=R[_]).length===2?(Ft=G[0]*Oe+Ft,rn=G[1]*Me+rn,rs(Ft,rn)):(ee=G[0]*Oe+Ft,be=G[1]*Me+rn,Pe=G[2]*Oe+Ft,We=G[3]*Me+rn,Ft=G[4]*Oe+Ft,rn=G[5]*Me+rn,Bs(ee,be,Pe,We,Ft,rn));return Te&&Ai(),ua(ve),this},p.path=function(R){for(var Q=0;Q<R.length;Q++){var ce=R[Q],pe=ce.c;switch(ce.op){case"m":Ms(pe[0],pe[1]);break;case"l":rs(pe[0],pe[1]);break;case"c":Bs.apply(this,pe);break;case"h":Ai()}}return this},p.__private__.rect=p.rect=function(R,Q,ce,pe,ve){if(isNaN(R)||isNaN(Q)||isNaN(ce)||isNaN(pe)||!ns(ve))throw new Error("Invalid arguments passed to jsPDF.rect");return N===w.COMPAT&&(pe=-pe),fe([C(P(R)),C(F(Q)),C(P(ce)),C(P(pe)),"re"].join(" ")),ua(ve),this},p.__private__.triangle=p.triangle=function(R,Q,ce,pe,ve,Te,Oe){if(isNaN(R)||isNaN(Q)||isNaN(ce)||isNaN(pe)||isNaN(ve)||isNaN(Te)||!ns(Oe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-R,pe-Q],[ve-ce,Te-pe],[R-ve,Q-Te]],R,Q,[1,1],Oe,!0),this},p.__private__.roundedRect=p.roundedRect=function(R,Q,ce,pe,ve,Te,Oe){if(isNaN(R)||isNaN(Q)||isNaN(ce)||isNaN(pe)||isNaN(ve)||isNaN(Te)||!ns(Oe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Me=4/3*(Math.SQRT2-1);return ve=Math.min(ve,.5*ce),Te=Math.min(Te,.5*pe),this.lines([[ce-2*ve,0],[ve*Me,0,ve,Te-Te*Me,ve,Te],[0,pe-2*Te],[0,Te*Me,-ve*Me,Te,-ve,Te],[2*ve-ce,0],[-ve*Me,0,-ve,-Te*Me,-ve,-Te],[0,2*Te-pe],[0,-Te*Me,ve*Me,-Te,ve,-Te]],R+ve,Q,[1,1],Oe,!0),this},p.__private__.ellipse=p.ellipse=function(R,Q,ce,pe,ve){if(isNaN(R)||isNaN(Q)||isNaN(ce)||isNaN(pe)||!ns(ve))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Te=4/3*(Math.SQRT2-1)*ce,Oe=4/3*(Math.SQRT2-1)*pe;return Ms(R+ce,Q),Bs(R+ce,Q-Oe,R+Te,Q-pe,R,Q-pe),Bs(R-Te,Q-pe,R-ce,Q-Oe,R-ce,Q),Bs(R-ce,Q+Oe,R-Te,Q+pe,R,Q+pe),Bs(R+Te,Q+pe,R+ce,Q+Oe,R+ce,Q),ua(ve),this},p.__private__.circle=p.circle=function(R,Q,ce,pe){if(isNaN(R)||isNaN(Q)||isNaN(ce)||!ns(pe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,Q,ce,ce,pe)},p.setFont=function(R,Q,ce){return ce&&(Q=j(Q,ce)),Ot=so(R,Q,{disableWarning:!1}),this};var fa=p.__private__.getFont=p.getFont=function(){return nn[so.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var R,Q,ce={};for(R in An)if(An.hasOwnProperty(R))for(Q in ce[R]=[],An[R])An[R].hasOwnProperty(Q)&&ce[R].push(Q);return ce},p.addFont=function(R,Q,ce,pe,ve){var Te=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Te.indexOf(arguments[3])!==-1?ve=arguments[3]:arguments[3]&&Te.indexOf(arguments[3])==-1&&(ce=j(ce,pe)),ve=ve||"Identity-H",Ya.call(this,R,Q,ce,ve)};var jn,el=t.lineWidth||.200025,pa=p.__private__.getLineWidth=p.getLineWidth=function(){return el},tl=p.__private__.setLineWidth=p.setLineWidth=function(R){return el=R,fe(C(P(R))+" w"),this};p.__private__.setLineDash=zt.API.setLineDash=zt.API.setLineDashPattern=function(R,Q){if(R=R||[],Q=Q||0,isNaN(Q)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(ce){return C(P(ce))}).join(" "),Q=C(P(Q)),fe("["+R+"] "+Q+" d"),this};var Lo=p.__private__.getLineHeight=p.getLineHeight=function(){return Xe*jn};p.__private__.getLineHeight=p.getLineHeight=function(){return Xe*jn};var L=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(jn=R),this},Y=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return jn};L(t.lineHeight);var te=p.__private__.getHorizontalCoordinate=function(R){return P(R)},oe=p.__private__.getVerticalCoordinate=function(R){return N===w.ADVANCED?R:Et[$].mediaBox.topRightY-Et[$].mediaBox.bottomLeftY-P(R)},ge=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(R){return C(te(R))},de=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(R){return C(oe(R))},xe=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Mi(xe)},p.__private__.setStrokeColor=p.setDrawColor=function(R,Q,ce,pe){return xe=wi({ch1:R,ch2:Q,ch3:ce,ch4:pe,pdfColorType:"draw",precision:2}),fe(xe),this};var Fe=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Mi(Fe)},p.__private__.setFillColor=p.setFillColor=function(R,Q,ce,pe){return Fe=wi({ch1:R,ch2:Q,ch3:ce,ch4:pe,pdfColorType:"fill",precision:2}),fe(Fe),this};var Le=t.textColor||"0 g",Ve=p.__private__.getTextColor=p.getTextColor=function(){return Mi(Le)};p.__private__.setTextColor=p.setTextColor=function(R,Q,ce,pe){return Le=wi({ch1:R,ch2:Q,ch3:ce,ch4:pe,pdfColorType:"text",precision:3}),this};var rt=t.charSpace,et=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(rt||0)};p.__private__.setCharSpace=p.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return rt=R,this};var it=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(R){var Q=p.CapJoinStyles[R];if(Q===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return it=Q,fe(Q+" J"),this};var He=0;p.__private__.setLineJoin=p.setLineJoin=function(R){var Q=p.CapJoinStyles[R];if(Q===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return He=Q,fe(Q+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return fe(C(P(R))+" M"),this},p.GState=Bp,p.setGState=function(R){(R=typeof R=="string"?yn[mr[R]]:tt(null,R)).equals(Xn)||(fe("/"+R.id+" gs"),Xn=R)};var tt=function(R,Q){if(!R||!mr[R]){var ce=!1;for(var pe in yn)if(yn.hasOwnProperty(pe)&&yn[pe].equals(Q)){ce=!0;break}if(ce)Q=yn[pe];else{var ve="GS"+(Object.keys(yn).length+1).toString(10);yn[ve]=Q,Q.id=ve}return R&&(mr[R]=Q.id),on.publish("addGState",Q),Q}};p.addGState=function(R,Q){return tt(R,Q),this},p.saveGraphicsState=function(){return fe("q"),Zr.push({key:Ot,size:Xe,color:Le}),this},p.restoreGraphicsState=function(){fe("Q");var R=Zr.pop();return Ot=R.key,Xe=R.size,Le=R.color,Xn=null,this},p.setCurrentTransformationMatrix=function(R){return fe(R.toString()+" cm"),this},p.comment=function(R){return fe("#"+R),this};var ht=function(R,Q){var ce=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Te){isNaN(Te)||(ce=parseFloat(Te))}});var pe=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return pe},set:function(Te){isNaN(Te)||(pe=parseFloat(Te))}});var ve="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ve},set:function(Te){ve=Te.toString()}}),this},gt=function(R,Q,ce,pe){ht.call(this,R,Q),this.type="rect";var ve=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ve},set:function(Oe){isNaN(Oe)||(ve=parseFloat(Oe))}});var Te=pe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Te},set:function(Oe){isNaN(Oe)||(Te=parseFloat(Oe))}}),this},St=function(){this.page=pn,this.currentPage=$,this.pages=Ce.slice(0),this.pagesContext=Et.slice(0),this.x=cn,this.y=Yt,this.matrix=Rn,this.width=Ut($),this.height=Pt($),this.outputDestination=$e,this.id="",this.objectNumber=-1};St.prototype.restore=function(){pn=this.page,$=this.currentPage,Et=this.pagesContext,Ce=this.pages,cn=this.x,Yt=this.y,Rn=this.matrix,bt($,this.width),Zt($,this.height),$e=this.outputDestination};var $t=function(R,Q,ce,pe,ve){di.push(new St),pn=$=0,Ce=[],cn=R,Yt=Q,Rn=ve,Ni([ce,pe])},Ct=function(R){if(Hn[R])di.pop().restore();else{var Q=new St,ce="Xo"+(Object.keys(In).length+1).toString(10);Q.id=ce,Hn[R]=ce,In[ce]=Q,on.publish("addFormObject",Q),di.pop().restore()}};for(var st in p.beginFormObject=function(R,Q,ce,pe,ve){return $t(R,Q,ce,pe,ve),this},p.endFormObject=function(R){return Ct(R),this},p.doFormObject=function(R,Q){var ce=In[Hn[R]];return fe("q"),fe(Q.toString()+" cm"),fe("/"+ce.id+" Do"),fe("Q"),this},p.getFormObject=function(R){var Q=In[Hn[R]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},p.save=function(R,Q){return R=R||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(Vu(la(gs()),R),typeof Vu.unload=="function"&&Xt.setTimeout&&setTimeout(Vu.unload,911),this):new Promise(function(ce,pe){try{var ve=Vu(la(gs()),R);typeof Vu.unload=="function"&&Xt.setTimeout&&setTimeout(Vu.unload,911),ce(ve)}catch(Te){pe(Te.message)}})},zt.API)zt.API.hasOwnProperty(st)&&(st==="events"&&zt.API.events.length?function(R,Q){var ce,pe,ve;for(ve=Q.length-1;ve!==-1;ve--)ce=Q[ve][0],pe=Q[ve][1],R.subscribe.apply(R,[ce].concat(typeof pe=="function"?[pe]:pe))}(on,zt.API.events):p[st]=zt.API[st]);var Ut=p.getPageWidth=function(R){return(Et[R=R||$].mediaBox.topRightX-Et[R].mediaBox.bottomLeftX)/at},bt=p.setPageWidth=function(R,Q){Et[R].mediaBox.topRightX=Q*at+Et[R].mediaBox.bottomLeftX},Pt=p.getPageHeight=function(R){return(Et[R=R||$].mediaBox.topRightY-Et[R].mediaBox.bottomLeftY)/at},Zt=p.setPageHeight=function(R,Q){Et[R].mediaBox.topRightY=Q*at+Et[R].mediaBox.bottomLeftY};return p.internal={pdfEscape:xr,getStyle:Ro,getFont:fa,getFontSize:Je,getCharSpace:et,getTextColor:Ve,getLineHeight:Lo,getLineHeightFactor:Y,getLineWidth:pa,write:yt,getHorizontalCoordinate:te,getVerticalCoordinate:oe,getCoordinateString:ge,getVerticalCoordinateString:de,collections:{},newObject:sr,newAdditionalObject:sa,newObjectDeferred:tr,newObjectDeferredBegin:Pr,getFilters:fi,putStream:gr,events:on,scaleFactor:at,pageSize:{getWidth:function(){return Ut($)},setWidth:function(R){bt($,R)},getHeight:function(){return Pt($)},setHeight:function(R){Zt($,R)}},encryptionOptions:d,encryption:Jn,getEncryptor:Jl,output:ca,getNumberOfPages:Ln,pages:Ce,out:fe,f2:I,f3:S,getPageInfo:Ja,getPageInfoByObjId:Qt,getCurrentPageInfo:lo,getPDFVersion:g,Point:ht,Rectangle:gt,Matrix:Nt,hasHotfix:ao},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Ut($)},set:function(R){bt($,R)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Pt($)},set:function(R){Zt($,R)},enumerable:!0,configurable:!0}),Yl.call(p,qe),Ot="F1",Do(i,n),on.publish("initialized"),p}dh.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},dh.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},dh.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},dh.prototype.processOwnerPassword=function(t,e){return O5(B5(e).substr(0,5),t)},dh.prototype.encryptor=function(t,e){var n=B5(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return O5(n,r)}},Bp.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||Vn(t)!==Vn(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},zt.API={events:[]},zt.version="2.5.2";var Ir=zt.API,j4=1,Ud=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ih=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},an=function(t){return t.toFixed(2)},bc=function(t){return t.toFixed(5)};Ir.__acroform__={};var js=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},R6=function(t){return t*j4},wa=function(t){var e=new _D,n=Tt.internal.getHeight(t)||0,r=Tt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(an(r)),Number(an(n))],e},UJ=Ir.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},zJ=Ir.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},qJ=Ir.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Or=Ir.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qJ(t,e-1)},Vr=Ir.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return UJ(t,e-1)},Ur=Ir.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return zJ(t,e-1)},HJ=Ir.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],s=t[1],o=t[2],a=t[3],l={};return l.lowerLeft_X=n(i)||0,l.lowerLeft_Y=r(s+a)||0,l.upperRight_X=n(i+o)||0,l.upperRight_Y=r(s)||0,[Number(an(l.lowerLeft_X)),Number(an(l.lowerLeft_Y)),Number(an(l.upperRight_X)),Number(an(l.upperRight_Y))]},WJ=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=V5(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+an(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=wa(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},V5=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(S){return S.split(`
`)}):i.map(function(S){return[S]});var s=n,o=Tt.internal.getHeight(t)||0;o=o<0?-o:o;var a=Tt.internal.getWidth(t)||0;a=a<0?-a:a;var l=function(S,P,k){if(S+1<i.length){var F=P+" "+i[S+1][0];return Eg(F,t,k).width<=a-4}return!1};s++;e:for(;s>0;){e="",s--;var c,d,f=Eg("3",t,s).height,h=t.multiline?o-s:(o-f)/2,p=h+=2,m=0,g=0,b=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Eg(e,t,s=12).width+", FieldWidth:"+a+`
`;break}for(var x="",w=0,N=0;N<i.length;N++)if(i.hasOwnProperty(N)){var E=!1;if(i[N].length!==1&&b!==i[N].length-1){if((f+2)*(w+2)+2>o)continue e;x+=i[N][b],E=!0,g=N,N--}else{x=(x+=i[N][b]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var D=parseInt(N),j=l(D,x,s),C=N>=i.length-1;if(j&&!C){x+=" ",b=0;continue}if(j||C){if(C)g=D;else if(t.multiline&&(f+2)*(w+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(w+2)+2>o)continue e;g=D}}for(var v="",A=m;A<=g;A++){var I=i[A];if(t.multiline){if(A===g){v+=I[b]+" ",b=(b+1)%I.length;continue}if(A===m){v+=I[I.length-1]+" ";continue}}v+=I[0]+" "}switch(v=v.substr(v.length-1)==" "?v.substr(0,v.length-1):v,d=Eg(v,t,s).width,t.textAlign){case"right":c=a-d-2;break;case"center":c=(a-d)/2;break;case"left":default:c=2}e+=an(c)+" "+an(p)+` Td
`,e+="("+Ud(v)+`) Tj
`,e+=-an(c)+` 0 Td
`,p=-(s+2),d=0,m=E?g:g+1,w++,x=""}break}return r.text=e,r.fontSize=s,r},Eg=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},$J={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},GJ=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},KJ=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=n,i=t[n];e.internal.newObjectDeferredBegin(i.objId,!0),Vn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[r]}},QJ=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(ra.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify($J)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");j4=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new ND,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var s=r[i];s.objId=void 0,s.hasAnnotation&&GJ(s,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var s=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var a=r[o],l=[],c=a.Rect;if(a.Rect&&(a.Rect=HJ(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Tt.createDefaultAppearanceStream(a),Vn(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(l=a.getKeyValueListForStream()),a.Rect=c,a.hasAppearanceStream&&!a.appearanceStreamContent){var d=WJ(a);l.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(a.appearanceStreamContent){var f="";for(var h in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(h)){var p=a.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var m=p[o];typeof m=="function"&&(m=m.call(i,a)),f+="/"+o+" "+m+" ",i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m)}}else typeof(m=p)=="function"&&(m=m.call(i,a)),f+="/"+o+" "+m,i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:a.objId}),i.internal.out("endobj")}s&&KJ(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},wD=Ir.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var i="[",s=0;s<t.length;s++)switch(s!==0&&(i+=" "),Vn(t[s])){case"boolean":case"number":case"object":i+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+Ud(r(t[s].toString()))+")"):i+=t[s].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},L2=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Ud(r(t))+")"},Ra=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ra.prototype.toString=function(){return this.objId+" 0 R"},Ra.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Ra.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:wD(i,this.objId,this.scope)}):i instanceof Ra?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var _D=function(){Ra.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};js(_D,Ra);var ND=function(){Ra.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Ud(n(t))+")"}},set:function(n){t=n}})};js(ND,Ra);var ra=function t(){Ra.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Or(e,3)},set:function(x){x?this.F=Vr(e,3):this.F=Ur(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');n=x}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(x){r=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(x){r[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(x){r[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(x){r[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(x){r[3]=x}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof xx)return;s="FieldObject"+t.FieldNum++}var x=function(w){return w};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Ud(x(s))+")"},set:function(x){s=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(x){s=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/j4:c},set:function(x){c=x}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(x){d=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof xx||this instanceof tu))return L2(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ri?h:L2(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=this instanceof ri?x:x.substr(0,1)==="("?ih(x.substr(1,x.length-2)):ih(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ri?ih(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof ri?"/"+x:x}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ri?p:L2(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof ri?x:x.substr(0,1)==="("?ih(x.substr(1,x.length-2)):ih(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ri?ih(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof ri?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(x){m=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,1)},set:function(x){x?this.Ff=Vr(this.Ff,1):this.Ff=Ur(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,2)},set:function(x){x?this.Ff=Vr(this.Ff,2):this.Ff=Ur(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,3)},set:function(x){x?this.Ff=Vr(this.Ff,3):this.Ff=Ur(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');b=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(b){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};js(ra,Ra);var id=function(){ra.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return wD(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(s,o,a){a||(a=1);for(var l,c=[];l=o.exec(s);)c.push(l[a]);return c}(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,18)},set:function(n){n?this.Ff=Vr(this.Ff,18):this.Ff=Ur(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Vr(this.Ff,19):this.Ff=Ur(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,20)},set:function(n){n?(this.Ff=Vr(this.Ff,20),e.sort()):this.Ff=Ur(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,22)},set:function(n){n?this.Ff=Vr(this.Ff,22):this.Ff=Ur(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,23)},set:function(n){n?this.Ff=Vr(this.Ff,23):this.Ff=Ur(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,27)},set:function(n){n?this.Ff=Vr(this.Ff,27):this.Ff=Ur(this.Ff,27)}}),this.hasAppearanceStream=!1};js(id,ra);var sd=function(){id.call(this),this.fontName="helvetica",this.combo=!1};js(sd,id);var od=function(){sd.call(this),this.combo=!0};js(od,sd);var L0=function(){od.call(this),this.edit=!0};js(L0,od);var ri=function(){ra.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,15)},set:function(n){n?this.Ff=Vr(this.Ff,15):this.Ff=Ur(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,16)},set:function(n){n?this.Ff=Vr(this.Ff,16):this.Ff=Ur(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,17)},set:function(n){n?this.Ff=Vr(this.Ff,17):this.Ff=Ur(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,26)},set:function(n){n?this.Ff=Vr(this.Ff,26):this.Ff=Ur(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(s){return s};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Ud(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){Vn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};js(ri,ra);var M0=function(){ri.call(this),this.pushButton=!0};js(M0,ri);var ad=function(){ri.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};js(ad,ri);var xx=function(){var t,e;ra.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),r)o.push("/"+s+" ("+Ud(i(r[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Vn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Tt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};js(xx,ra),ad.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},ad.prototype.createOption=function(t){var e=new xx;return e.Parent=this,e.optionName=t,this.Kids.push(e),YJ.call(this.scope,e),e};var B0=function(){ri.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Tt.CheckBox.createAppearanceStream()};js(B0,ri);var tu=function(){ra.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,13)},set:function(e){e?this.Ff=Vr(this.Ff,13):this.Ff=Ur(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,21)},set:function(e){e?this.Ff=Vr(this.Ff,21):this.Ff=Ur(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,23)},set:function(e){e?this.Ff=Vr(this.Ff,23):this.Ff=Ur(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,24)},set:function(e){e?this.Ff=Vr(this.Ff,24):this.Ff=Ur(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,25)},set:function(e){e?this.Ff=Vr(this.Ff,25):this.Ff=Ur(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,26)},set:function(e){e?this.Ff=Vr(this.Ff,26):this.Ff=Ur(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};js(tu,ra);var O0=function(){tu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,14)},set:function(t){t?this.Ff=Vr(this.Ff,14):this.Ff=Ur(this.Ff,14)}}),this.password=!0};js(O0,tu);var Tt={CheckBox:{createAppearanceStream:function(){return{N:{On:Tt.CheckBox.YesNormal},D:{On:Tt.CheckBox.YesPushDown,Off:Tt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=wa(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),s=V5(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+an(Tt.internal.getWidth(t))+" "+an(Tt.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+an(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=wa(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],s=Tt.internal.getHeight(t),o=Tt.internal.getWidth(t),a=V5(t,t.caption);return i.push("1 g"),i.push("0 0 "+an(o)+" "+an(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+an(o-1)+" "+an(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+an(a.fontSize)+" Tf "+r),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=wa(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+an(Tt.internal.getWidth(t))+" "+an(Tt.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Tt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Tt.RadioButton.Circle.YesNormal,e.D[t]=Tt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=wa(t);e.scope=t.scope;var n=[],r=Tt.internal.getWidth(t)<=Tt.internal.getHeight(t)?Tt.internal.getWidth(t)/4:Tt.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Tt.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+bc(Tt.internal.getWidth(t)/2)+" "+bc(Tt.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=wa(t);e.scope=t.scope;var n=[],r=Tt.internal.getWidth(t)<=Tt.internal.getHeight(t)?Tt.internal.getWidth(t)/4:Tt.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Tt.internal.Bezier_C).toFixed(5)),o=Number((r*Tt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+bc(Tt.internal.getWidth(t)/2)+" "+bc(Tt.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+bc(Tt.internal.getWidth(t)/2)+" "+bc(Tt.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=wa(t);e.scope=t.scope;var n=[],r=Tt.internal.getWidth(t)<=Tt.internal.getHeight(t)?Tt.internal.getWidth(t)/4:Tt.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Tt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+bc(Tt.internal.getWidth(t)/2)+" "+bc(Tt.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Tt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Tt.RadioButton.Cross.YesNormal,e.D[t]=Tt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=wa(t);e.scope=t.scope;var n=[],r=Tt.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+an(Tt.internal.getWidth(t)-2)+" "+an(Tt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(an(r.x1.x)+" "+an(r.x1.y)+" m"),n.push(an(r.x2.x)+" "+an(r.x2.y)+" l"),n.push(an(r.x4.x)+" "+an(r.x4.y)+" m"),n.push(an(r.x3.x)+" "+an(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=wa(t);e.scope=t.scope;var n=Tt.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+an(Tt.internal.getWidth(t))+" "+an(Tt.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+an(Tt.internal.getWidth(t)-2)+" "+an(Tt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(an(n.x1.x)+" "+an(n.x1.y)+" m"),r.push(an(n.x2.x)+" "+an(n.x2.y)+" l"),r.push(an(n.x4.x)+" "+an(n.x4.y)+" m"),r.push(an(n.x3.x)+" "+an(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=wa(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+an(Tt.internal.getWidth(t))+" "+an(Tt.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};Tt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Tt.internal.getWidth(t),n=Tt.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},Tt.internal.getWidth=function(t){var e=0;return Vn(t)==="object"&&(e=R6(t.Rect[2])),e},Tt.internal.getHeight=function(t){var e=0;return Vn(t)==="object"&&(e=R6(t.Rect[3])),e};var YJ=Ir.addField=function(t){if(QJ(this,t),!(t instanceof ra))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ir.AcroFormChoiceField=id,Ir.AcroFormListBox=sd,Ir.AcroFormComboBox=od,Ir.AcroFormEditBox=L0,Ir.AcroFormButton=ri,Ir.AcroFormPushButton=M0,Ir.AcroFormRadioButton=ad,Ir.AcroFormCheckBox=B0,Ir.AcroFormTextField=tu,Ir.AcroFormPasswordField=O0,Ir.AcroFormAppearance=Tt,Ir.AcroForm={ChoiceField:id,ListBox:sd,ComboBox:od,EditBox:L0,Button:ri,PushButton:M0,RadioButton:ad,CheckBox:B0,TextField:tu,PasswordField:O0,Appearance:Tt},zt.AcroForm={ChoiceField:id,ListBox:sd,ComboBox:od,EditBox:L0,Button:ri,PushButton:M0,RadioButton:ad,CheckBox:B0,TextField:tu,PasswordField:O0,Appearance:Tt};var XJ=zt.AcroForm;function AD(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(S,P){var k,F,q,O,M,W=e;if((P=P||e)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(j(S))for(M in n)for(q=n[M],k=0;k<q.length;k+=1){for(O=!0,F=0;F<q[k].length;F+=1)if(q[k][F]!==void 0&&q[k][F]!==S[F]){O=!1;break}if(O===!0){W=M;break}}else for(M in n)for(q=n[M],k=0;k<q.length;k+=1){for(O=!0,F=0;F<q[k].length;F+=1)if(q[k][F]!==void 0&&q[k][F]!==S.charCodeAt(F)){O=!1;break}if(O===!0){W=M;break}}return W===e&&P!==e&&(W=P),W},i=function S(P){for(var k=this.internal.write,F=this.internal.putStream,q=(0,this.internal.getFilters)();q.indexOf("FlateEncode")!==-1;)q.splice(q.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var O=[];if(O.push({key:"Type",value:"/XObject"}),O.push({key:"Subtype",value:"/Image"}),O.push({key:"Width",value:P.width}),O.push({key:"Height",value:P.height}),P.colorSpace===b.INDEXED?O.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(O.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===b.DEVICE_CMYK&&O.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),O.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&O.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var M="",W=0,z=P.transparency.length;W<z;W++)M+=P.transparency[W]+" "+P.transparency[W]+" ";O.push({key:"Mask",value:"["+M+"]"})}P.sMask!==void 0&&O.push({key:"SMask",value:P.objectId+1+" 0 R"});var J=P.filter!==void 0?["/"+P.filter]:void 0;if(F({data:P.data,additionalKeyValues:O,alreadyAppliedFilters:J,objectId:P.objectId}),k("endobj"),"sMask"in P&&P.sMask!==void 0){var ne="/Predictor "+P.predictor+" /Colors 1 /BitsPerComponent "+P.bitsPerComponent+" /Columns "+P.width,V={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:ne,data:P.sMask};"filter"in P&&(V.filter=P.filter),S.call(this,V)}if(P.colorSpace===b.INDEXED){var $=this.internal.newObject();F({data:v(new Uint8Array(P.palette)),objectId:$}),k("endobj")}},s=function(){var S=this.internal.collections.addImage_images;for(var P in S)i.call(this,S[P])},o=function(){var S,P=this.internal.collections.addImage_images,k=this.internal.write;for(var F in P)k("/I"+(S=P[F]).index,S.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},l=function(){var S=this.internal.collections.addImage_images;return a.call(this),S},c=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(S){return typeof t["process"+S.toUpperCase()]=="function"},f=function(S){return Vn(S)==="object"&&S.nodeType===1},h=function(S,P){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var k=""+S.getAttribute("src");if(k.indexOf("data:image/")===0)return F0(unescape(k).split("base64,").pop());var F=t.loadFile(k,!0);if(F!==void 0)return F}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var q;switch(P){case"PNG":q="image/png";break;case"WEBP":q="image/webp";break;case"JPEG":case"JPG":default:q="image/jpeg"}return F0(S.toDataURL(q,1).split("base64,").pop())}},p=function(S){var P=this.internal.collections.addImage_images;if(P){for(var k in P)if(S===P[k].alias)return P[k]}},m=function(S,P,k){return S||P||(S=-96,P=-96),S<0&&(S=-1*k.width*72/S/this.internal.scaleFactor),P<0&&(P=-1*k.height*72/P/this.internal.scaleFactor),S===0&&(S=P*k.width/k.height),P===0&&(P=S*k.height/k.width),[S,P]},g=function(S,P,k,F,q,O){var M=m.call(this,k,F,q),W=this.internal.getCoordinateString,z=this.internal.getVerticalCoordinateString,J=l.call(this);if(k=M[0],F=M[1],J[q.index]=q,O){O*=Math.PI/180;var ne=Math.cos(O),V=Math.sin(O),$=function(X){return X.toFixed(4)},K=[$(ne),$(V),$(-1*V),$(ne),0,0,"cm"]}this.internal.write("q"),O?(this.internal.write([1,"0","0",1,W(S),z(P+F),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([W(k),"0","0",W(F),"0","0","cm"].join(" "))):this.internal.write([W(k),"0","0",W(F),W(S),z(P+F),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+q.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=t.__addimage__.sHashCode=function(S){var P,k,F=0;if(typeof S=="string")for(k=S.length,P=0;P<k;P++)F=(F<<5)-F+S.charCodeAt(P),F|=0;else if(j(S))for(k=S.byteLength/2,P=0;P<k;P++)F=(F<<5)-F+S[P],F|=0;return F},N=t.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var P=!0;return S.length===0&&(P=!1),S.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(P=!1),P},E=t.__addimage__.extractImageFromDataUrl=function(S){var P=(S=S||"").split("base64,"),k=null;if(P.length===2){var F=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(P[0]);Array.isArray(F)&&(k={mimeType:F[1],charset:F[2],data:P[1]})}return k},D=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(S){return D()&&S instanceof ArrayBuffer};var j=t.__addimage__.isArrayBufferView=function(S){return D()&&typeof Uint32Array<"u"&&(S instanceof Int8Array||S instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array)},C=t.__addimage__.binaryStringToUint8Array=function(S){for(var P=S.length,k=new Uint8Array(P),F=0;F<P;F++)k[F]=S.charCodeAt(F);return k},v=t.__addimage__.arrayBufferToBinaryString=function(S){for(var P="",k=j(S)?S:new Uint8Array(S),F=0;F<k.length;F+=8192)P+=String.fromCharCode.apply(null,k.subarray(F,F+8192));return P};t.addImage=function(){var S,P,k,F,q,O,M,W,z;if(typeof arguments[1]=="number"?(P=e,k=arguments[1],F=arguments[2],q=arguments[3],O=arguments[4],M=arguments[5],W=arguments[6],z=arguments[7]):(P=arguments[1],k=arguments[2],F=arguments[3],q=arguments[4],O=arguments[5],M=arguments[6],W=arguments[7],z=arguments[8]),Vn(S=arguments[0])==="object"&&!f(S)&&"imageData"in S){var J=S;S=J.imageData,P=J.format||P||e,k=J.x||k||0,F=J.y||F||0,q=J.w||J.width||q,O=J.h||J.height||O,M=J.alias||M,W=J.compression||W,z=J.rotation||J.angle||z}var ne=this.internal.getFilters();if(W===void 0&&ne.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(k)||isNaN(F))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var V=A.call(this,S,P,M,W);return g.call(this,k,F,q,O,V,z),this};var A=function(S,P,k,F){var q,O,M;if(typeof S=="string"&&r(S)===e){S=unescape(S);var W=I(S,!1);(W!==""||(W=t.loadFile(S,!0))!==void 0)&&(S=W)}if(f(S)&&(S=h(S,P)),P=r(S,P),!d(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((M=k)==null||M.length===0)&&(k=function(z){return typeof z=="string"||j(z)?w(z):j(z.data)?w(z.data):null}(S)),(q=p.call(this,k))||(D()&&(S instanceof Uint8Array||P==="RGBA"||(O=S,S=C(S))),q=this["process"+P.toUpperCase()](S,c.call(this),k,function(z){return z&&typeof z=="string"&&(z=z.toUpperCase()),z in t.image_compression?z:x.NONE}(F),O)),!q)throw new Error("An unknown error occurred whilst processing the image.");return q},I=t.__addimage__.convertBase64ToBinaryString=function(S,P){var k;P=typeof P!="boolean"||P;var F,q="";if(typeof S=="string"){F=(k=E(S))!==null?k.data:S;try{q=F0(F)}catch(O){if(P)throw N(F)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+O.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return q};t.getImageProperties=function(S){var P,k,F="";if(f(S)&&(S=h(S)),typeof S=="string"&&r(S)===e&&((F=I(S,!1))===""&&(F=t.loadFile(S)||""),S=F),k=r(S),!d(k))throw new Error("addImage does not support files of type '"+k+"', please ensure that a plugin for '"+k+"' support is added.");if(!D()||S instanceof Uint8Array||(S=C(S)),!(P=this["process"+k.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=k,P}})(zt.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};zt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,s,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(n.objId),c=n.pageContext.annotations,d=!1,f=0;f<c.length&&!d;f++)switch((r=c[f]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var h=0;h<c.length;h++){r=c[h];var p=this.internal.pdfEscape,m=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),w=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+p(x(r.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+p(x(w))+") >>",g.content=s;var N=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+N,r.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(g.objId,"0 R",b.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+a(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var E=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(m(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var D=this.annotations._nameMap[r.options.name];r.options.pageNumber=D.page,r.options.top=D.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(m(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var j=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+j+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,s,o){var a=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:l(n),y:c(r),w:l(n+i),h:c(r+s)},options:o,type:"link"})},t.textWithLink=function(n,r,i,s){var o,a,l=this.getTextWidth(n),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var d=this.splitTextToSize(n,a).length;o=Math.ceil(c*d)}else a=l,o=c;return this.text(n,r,i,s),i+=.2*c,s.align==="center"&&(r-=l/2),s.align==="right"&&(r-=l),this.link(r,i-c,a,o,s),l},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(zt.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(g){return e[g.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},a=t.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&i.indexOf(g.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(g){var b=0,x=n,w="",N=0;for(b=0;b<g.length;b+=1)x[g.charCodeAt(b)]!==void 0?(N++,typeof(x=x[g.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(x),x=n,N=0),b===g.length-1&&(x=n,w+=g.charAt(b-(N-1)),b-=N-1,N=0)):(x=n,w+=g.charAt(b-N),b-=N,N=0);return w};t.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&r[g.charCodeAt(0)]!==void 0};var h=t.__arabicParser__.getCorrectForm=function(g,b,x){return o(g)?s(g)===!1?-1:!c(g)||!o(b)&&!o(x)||!o(x)&&a(b)||a(g)&&!o(b)||a(g)&&l(b)||a(g)&&a(b)?0:d(g)&&o(b)&&!a(b)&&o(x)&&c(x)?3:a(g)||!o(x)?1:2:-1},p=function(g){var b=0,x=0,w=0,N="",E="",D="",j=(g=g||"").split("\\s+"),C=[];for(b=0;b<j.length;b+=1){for(C.push(""),x=0;x<j[b].length;x+=1)N=j[b][x],E=j[b][x-1],D=j[b][x+1],o(N)?(w=h(N,E,D),C[b]+=w!==-1?String.fromCharCode(e[N.charCodeAt(0)][w]):N):C[b]+=N;C[b]=f(C[b])}return C.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var g,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(b)){var w=0;for(x=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?x.push([p(b[w][0]),b[w][1],b[w][2]]):x.push([p(b[w])]);g=x}else g=p(b);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};t.events.push(["preProcessText",m])}(zt.API),zt.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(a){n=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(zt.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return r.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){r.call(this);var d=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),h=c.scaleFactor||this.internal.scaleFactor,p=0,m=0,g=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=c.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(N,E){return N.concat(b.splitTextToSize(E,x))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)p<(g=this.getStringUnitWidth(l[w],{font:f})*d)&&(p=g);return p!==0&&(m=l.length),{w:p/=h,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/h,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var c=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,p&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,n===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-d,l.y+d,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+d,{align:"center",baseline:"top",maxWidth:l.width-d-d}):this.text(l.text,l.x+d,l.y+d,{align:"left",baseline:"top",maxWidth:l.width-d-d})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,d,f,h){if(r.call(this),!d)throw new Error("No data for PDF table.");var p,m,g,b,x=[],w=[],N=[],E={},D={},j=[],C=[],v=(h=h||{}).autoSize||!1,A=h.printHeaders!==!1,I=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,S=h.margins||Object.assign({width:this.getPageWidth()},e),P=typeof h.padding=="number"?h.padding:3,k=h.headerBackgroundColor||"#c8c8c8",F=h.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=k,this.internal.__cell__.headerTextColor=F,this.setFontSize(I),f==null)w=x=Object.keys(d[0]),N=x.map(function(){return"left"});else if(Array.isArray(f)&&Vn(f[0])==="object")for(x=f.map(function(J){return J.name}),w=f.map(function(J){return J.prompt||J.name||""}),N=f.map(function(J){return J.align||"left"}),p=0;p<f.length;p+=1)D[f[p].name]=f[p].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(w=x=f,N=x.map(function(){return"left"}));if(v||Array.isArray(f)&&typeof f[0]=="string")for(p=0;p<x.length;p+=1){for(E[b=x[p]]=d.map(function(J){return J[b]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(w[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=E[b],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)j.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[b]=Math.max.apply(null,j)+P+P,j=[]}if(A){var q={};for(p=0;p<x.length;p+=1)q[x[p]]={},q[x[p]].text=w[p],q[x[p]].align=N[p];var O=a.call(this,q,D);C=x.map(function(J){return new s(l,c,D[J],O,q[J].text,void 0,q[J].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var M=f.reduce(function(J,ne){return J[ne.name]=ne.align,J},{});for(p=0;p<d.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:d[p]},this);var W=a.call(this,d[p],D);for(g=0;g<x.length;g+=1){var z=d[p][x[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:g,data:z},this),o.call(this,new s(l,c,D[x[g]],W,z,p+2,M[x[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var a=function(l,c){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(p){var m=l[p];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,c[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*f/h+d+d},this).reduce(function(p,m){return Math.max(p,m)},0)};t.setTableHeaderRow=function(l){r.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),c&&(d.y=this.internal.__cell__.margins.top||0,h.push(d)),d.lineNumber=l;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),n=!1}}(zt.API);var SD={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},ED=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],U5=AD(ED),CD=[100,200,300,400,500,600,700,800,900],JJ=AD(CD);function z5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(s){return SD[s=s||"normal"]?s:"normal"}(t.style),r=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(s){return typeof U5[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function F6(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var ZJ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},L6={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function M6(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function eZ(t,e,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},ZJ,n.genericFontFamilies||{}),s=null,o=null,a=0;a<e.length;++a)if(i[(s=z5(e[a])).family]&&(s.family=i[s.family]),t.hasOwnProperty(s.family)){o=t[s.family];break}if(!(o=o||t[r]))throw new Error("Could not find a font-family for the rule '"+M6(s)+"' and default family '"+r+"'.");if(o=function(l,c){if(c[l])return c[l];var d=U5[l],f=d<=U5.normal?-1:1,h=F6(c,ED,d,f);if(!h)throw new Error("Could not find a matching font-stretch value for "+l);return h}(s.stretch,o),o=function(l,c){if(c[l])return c[l];for(var d=SD[l],f=0;f<d.length;++f)if(c[d[f]])return c[d[f]];throw new Error("Could not find a matching font-style for "+l)}(s.style,o),!(o=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var d=JJ[l],f=F6(c,CD,d,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(s.weight,o)))throw new Error("Failed to resolve a font for the rule '"+M6(s)+"'.");return o}function B6(t){return t.trimLeft()}function tZ(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function nZ(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Cg,O6,V6,M2=["times"];(function(t){var e,n,r,i,s,o,a,l,c,d=function(V){return V=V||{},this.isStrokeTransparent=V.isStrokeTransparent||!1,this.strokeOpacity=V.strokeOpacity||1,this.strokeStyle=V.strokeStyle||"#000000",this.fillStyle=V.fillStyle||"#000000",this.isFillTransparent=V.isFillTransparent||!1,this.fillOpacity=V.fillOpacity||1,this.font=V.font||"10px sans-serif",this.textBaseline=V.textBaseline||"alphabetic",this.textAlign=V.textAlign||"left",this.lineWidth=V.lineWidth||1,this.lineJoin=V.lineJoin||"miter",this.lineCap=V.lineCap||"butt",this.path=V.path||[],this.transform=V.transform!==void 0?V.transform.clone():new l,this.globalCompositeOperation=V.globalCompositeOperation||"normal",this.globalAlpha=V.globalAlpha||1,this.clip_path=V.clip_path||[],this.currentPoint=V.currentPoint||new o,this.miterLimit=V.miterLimit||10,this.lastPoint=V.lastPoint||new o,this.lineDashOffset=V.lineDashOffset||0,this.lineDash=V.lineDash||[],this.margin=V.margin||[0,0,0,0],this.prevPageLastElemOffset=V.prevPageLastElemOffset||0,this.ignoreClearRect=typeof V.ignoreClearRect!="boolean"||V.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,l=this.internal.Matrix,c=new d}]);var f=function(V){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var $=V;Object.defineProperty(this,"pdf",{get:function(){return $}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(Ie){K=!!Ie}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(Ie){X=!!Ie}});var ae=0;Object.defineProperty(this,"posX",{get:function(){return ae},set:function(Ie){isNaN(Ie)||(ae=Ie)}});var ye=0;Object.defineProperty(this,"posY",{get:function(){return ye},set:function(Ie){isNaN(Ie)||(ye=Ie)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Ie){var fe;typeof Ie=="number"?fe=[Ie,Ie,Ie,Ie]:((fe=new Array(4))[0]=Ie[0],fe[1]=Ie.length>=2?Ie[1]:fe[0],fe[2]=Ie.length>=3?Ie[2]:fe[0],fe[3]=Ie.length>=4?Ie[3]:fe[1]),c.margin=fe}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(Ie){me=Ie}});var _e=0;Object.defineProperty(this,"lastBreak",{get:function(){return _e},set:function(Ie){_e=Ie}});var Se=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Se},set:function(Ie){Se=Ie}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Ie){Ie instanceof d&&(c=Ie)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Ie){c.path=Ie}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(Ie){Ce=Ie}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ie){var fe;fe=h(Ie),this.ctx.fillStyle=fe.style,this.ctx.isFillTransparent=fe.a===0,this.ctx.fillOpacity=fe.a,this.pdf.setFillColor(fe.r,fe.g,fe.b,{a:fe.a}),this.pdf.setTextColor(fe.r,fe.g,fe.b,{a:fe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ie){var fe=h(Ie);this.ctx.strokeStyle=fe.style,this.ctx.isStrokeTransparent=fe.a===0,this.ctx.strokeOpacity=fe.a,fe.a===0?this.pdf.setDrawColor(255,255,255):(fe.a,this.pdf.setDrawColor(fe.r,fe.g,fe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ie){["butt","round","square"].indexOf(Ie)!==-1&&(this.ctx.lineCap=Ie,this.pdf.setLineCap(Ie))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ie){isNaN(Ie)||(this.ctx.lineWidth=Ie,this.pdf.setLineWidth(Ie))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ie){["bevel","round","miter"].indexOf(Ie)!==-1&&(this.ctx.lineJoin=Ie,this.pdf.setLineJoin(Ie))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ie){isNaN(Ie)||(this.ctx.miterLimit=Ie,this.pdf.setMiterLimit(Ie))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ie){this.ctx.textBaseline=Ie}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ie){["right","end","center","left","start"].indexOf(Ie)!==-1&&(this.ctx.textAlign=Ie)}});var ze=null;function $e(Ie,fe){if(ze===null){var yt=function(nt){var qe=[];return Object.keys(nt).forEach(function(Xe){nt[Xe].forEach(function(Ye){var Je=null;switch(Ye){case"bold":Je={family:Xe,weight:"bold"};break;case"italic":Je={family:Xe,style:"italic"};break;case"bolditalic":Je={family:Xe,weight:"bold",style:"italic"};break;case"":case"normal":Je={family:Xe}}Je!==null&&(Je.ref={name:Xe,style:Ye},qe.push(Je))})}),qe}(Ie.getFontList());ze=function(nt){for(var qe={},Xe=0;Xe<nt.length;++Xe){var Ye=z5(nt[Xe]),Je=Ye.family,ut=Ye.stretch,mt=Ye.style,Dt=Ye.weight;qe[Je]=qe[Je]||{},qe[Je][ut]=qe[Je][ut]||{},qe[Je][ut][mt]=qe[Je][ut][mt]||{},qe[Je][ut][mt][Dt]=Ye}return qe}(yt.concat(fe))}return ze}var dt=null;Object.defineProperty(this,"fontFaces",{get:function(){return dt},set:function(Ie){ze=null,dt=Ie}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ie){var fe;if(this.ctx.font=Ie,(fe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ie))!==null){var yt=fe[1],nt=(fe[2],fe[3]),qe=fe[4],Xe=(fe[5],fe[6]),Ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(qe)[2];qe=Math.floor(Ye==="px"?parseFloat(qe)*this.pdf.internal.scaleFactor:Ye==="em"?parseFloat(qe)*this.pdf.getFontSize():parseFloat(qe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(qe);var Je=function(Rt){var Ot,at,cn=[],Yt=Rt.trim();if(Yt==="")return M2;if(Yt in L6)return[L6[Yt]];for(;Yt!=="";){switch(at=null,Ot=(Yt=B6(Yt)).charAt(0)){case'"':case"'":at=tZ(Yt.substring(1),Ot);break;default:at=nZ(Yt)}if(at===null||(cn.push(at[0]),(Yt=B6(at[1]))!==""&&Yt.charAt(0)!==","))return M2;Yt=Yt.replace(/^,/,"")}return cn}(Xe);if(this.fontFaces){var ut=eZ($e(this.pdf,this.fontFaces),Je.map(function(Rt){return{family:Rt,stretch:"normal",weight:nt,style:yt}}));this.pdf.setFont(ut.ref.name,ut.ref.style)}else{var mt="";(nt==="bold"||parseInt(nt,10)>=700||yt==="bold")&&(mt="bold"),yt==="italic"&&(mt+="italic"),mt.length===0&&(mt="normal");for(var Dt="",_t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Mt=0;Mt<Je.length;Mt++){if(this.pdf.internal.getFont(Je[Mt],mt,{noFallback:!0,disableWarning:!0})!==void 0){Dt=Je[Mt];break}if(mt==="bolditalic"&&this.pdf.internal.getFont(Je[Mt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Dt=Je[Mt],mt="bold";else if(this.pdf.internal.getFont(Je[Mt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Dt=Je[Mt],mt="normal";break}}if(Dt===""){for(var Ht=0;Ht<Je.length;Ht++)if(_t[Je[Ht]]){Dt=_t[Je[Ht]];break}}Dt=Dt===""?"Times":Dt,this.pdf.setFont(Dt,mt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ie){this.ctx.globalCompositeOperation=Ie}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ie){this.ctx.globalAlpha=Ie}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ie){this.ctx.lineDashOffset=Ie,ne.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ie){this.ctx.lineDash=Ie,ne.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ie){this.ctx.ignoreClearRect=!!Ie}})};f.prototype.setLineDash=function(V){this.lineDash=V},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){E.call(this,"fill",!1)},f.prototype.stroke=function(){E.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(V,$){if(isNaN(V)||isNaN($))throw ir.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new o(V,$));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(V,$)},f.prototype.closePath=function(){var V=new o(0,0),$=0;for($=this.path.length-1;$!==-1;$--)if(this.path[$].type==="begin"&&Vn(this.path[$+1])==="object"&&typeof this.path[$+1].x=="number"){V=new o(this.path[$+1].x,this.path[$+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(V.x,V.y)},f.prototype.lineTo=function(V,$){if(isNaN(V)||isNaN($))throw ir.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new o(V,$));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new o(K.x,K.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},f.prototype.quadraticCurveTo=function(V,$,K,X){if(isNaN(K)||isNaN(X)||isNaN(V)||isNaN($))throw ir.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ae=this.ctx.transform.applyToPoint(new o(K,X)),ye=this.ctx.transform.applyToPoint(new o(V,$));this.path.push({type:"qct",x1:ye.x,y1:ye.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new o(ae.x,ae.y)},f.prototype.bezierCurveTo=function(V,$,K,X,ae,ye){if(isNaN(ae)||isNaN(ye)||isNaN(V)||isNaN($)||isNaN(K)||isNaN(X))throw ir.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new o(ae,ye)),_e=this.ctx.transform.applyToPoint(new o(V,$)),Se=this.ctx.transform.applyToPoint(new o(K,X));this.path.push({type:"bct",x1:_e.x,y1:_e.y,x2:Se.x,y2:Se.y,x:me.x,y:me.y}),this.ctx.lastPoint=new o(me.x,me.y)},f.prototype.arc=function(V,$,K,X,ae,ye){if(isNaN(V)||isNaN($)||isNaN(K)||isNaN(X)||isNaN(ae))throw ir.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ye=!!ye,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new o(V,$));V=me.x,$=me.y;var _e=this.ctx.transform.applyToPoint(new o(0,K)),Se=this.ctx.transform.applyToPoint(new o(0,0));K=Math.sqrt(Math.pow(_e.x-Se.x,2)+Math.pow(_e.y-Se.y,2))}Math.abs(ae-X)>=2*Math.PI&&(X=0,ae=2*Math.PI),this.path.push({type:"arc",x:V,y:$,radius:K,startAngle:X,endAngle:ae,counterclockwise:ye})},f.prototype.arcTo=function(V,$,K,X,ae){throw new Error("arcTo not implemented.")},f.prototype.rect=function(V,$,K,X){if(isNaN(V)||isNaN($)||isNaN(K)||isNaN(X))throw ir.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(V,$),this.lineTo(V+K,$),this.lineTo(V+K,$+X),this.lineTo(V,$+X),this.lineTo(V,$),this.lineTo(V+K,$),this.lineTo(V,$)},f.prototype.fillRect=function(V,$,K,X){if(isNaN(V)||isNaN($)||isNaN(K)||isNaN(X))throw ir.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ae={};this.lineCap!=="butt"&&(ae.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ae.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(V,$,K,X),this.fill(),ae.hasOwnProperty("lineCap")&&(this.lineCap=ae.lineCap),ae.hasOwnProperty("lineJoin")&&(this.lineJoin=ae.lineJoin)}},f.prototype.strokeRect=function(V,$,K,X){if(isNaN(V)||isNaN($)||isNaN(K)||isNaN(X))throw ir.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(V,$,K,X),this.stroke())},f.prototype.clearRect=function(V,$,K,X){if(isNaN(V)||isNaN($)||isNaN(K)||isNaN(X))throw ir.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(V,$,K,X))},f.prototype.save=function(V){V=typeof V!="boolean"||V;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage($),V){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},f.prototype.restore=function(V){V=typeof V!="boolean"||V;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage($),V&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(V){var $,K,X,ae;if(V.isCanvasGradient===!0&&(V=V.getColor()),!V)return{r:0,g:0,b:0,a:0,style:V};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(V))$=0,K=0,X=0,ae=0;else{var ye=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(V);if(ye!==null)$=parseInt(ye[1]),K=parseInt(ye[2]),X=parseInt(ye[3]),ae=1;else if((ye=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(V))!==null)$=parseInt(ye[1]),K=parseInt(ye[2]),X=parseInt(ye[3]),ae=parseFloat(ye[4]);else{if(ae=1,typeof V=="string"&&V.charAt(0)!=="#"){var me=new yD(V);V=me.ok?me.toHex():"#000000"}V.length===4?($=V.substring(1,2),$+=$,K=V.substring(2,3),K+=K,X=V.substring(3,4),X+=X):($=V.substring(1,3),K=V.substring(3,5),X=V.substring(5,7)),$=parseInt($,16),K=parseInt(K,16),X=parseInt(X,16)}}return{r:$,g:K,b:X,a:ae,style:V}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(V,$,K,X){if(isNaN($)||isNaN(K)||typeof V!="string")throw ir.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!p.call(this)){var ae=W(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;P.call(this,{text:V,x:$,y:K,scale:ye,angle:ae,align:this.textAlign,maxWidth:X})}},f.prototype.strokeText=function(V,$,K,X){if(isNaN($)||isNaN(K)||typeof V!="string")throw ir.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){X=isNaN(X)?void 0:X;var ae=W(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;P.call(this,{text:V,x:$,y:K,scale:ye,renderingMode:"stroke",angle:ae,align:this.textAlign,maxWidth:X})}},f.prototype.measureText=function(V){if(typeof V!="string")throw ir.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var $=this.pdf,K=this.pdf.internal.scaleFactor,X=$.internal.getFontSize(),ae=$.getStringUnitWidth(V)*X/$.internal.scaleFactor,ye=function(me){var _e=(me=me||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return _e}}),this};return new ye({width:ae*=Math.round(96*K/72*1e4)/1e4})},f.prototype.scale=function(V,$){if(isNaN(V)||isNaN($))throw ir.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new l(V,0,0,$,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.rotate=function(V){if(isNaN(V))throw ir.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var $=new l(Math.cos(V),Math.sin(V),-Math.sin(V),Math.cos(V),0,0);this.ctx.transform=this.ctx.transform.multiply($)},f.prototype.translate=function(V,$){if(isNaN(V)||isNaN($))throw ir.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new l(1,0,0,1,V,$);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.transform=function(V,$,K,X,ae,ye){if(isNaN(V)||isNaN($)||isNaN(K)||isNaN(X)||isNaN(ae)||isNaN(ye))throw ir.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new l(V,$,K,X,ae,ye);this.ctx.transform=this.ctx.transform.multiply(me)},f.prototype.setTransform=function(V,$,K,X,ae,ye){V=isNaN(V)?1:V,$=isNaN($)?0:$,K=isNaN(K)?0:K,X=isNaN(X)?1:X,ae=isNaN(ae)?0:ae,ye=isNaN(ye)?0:ye,this.ctx.transform=new l(V,$,K,X,ae,ye)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(V,$,K,X,ae,ye,me,_e,Se){var Ce=this.pdf.getImageProperties(V),ze=1,$e=1,dt=1,Ie=1;X!==void 0&&_e!==void 0&&(dt=_e/X,Ie=Se/ae,ze=Ce.width/X*_e/X,$e=Ce.height/ae*Se/ae),ye===void 0&&(ye=$,me=K,$=0,K=0),X!==void 0&&_e===void 0&&(_e=X,Se=ae),X===void 0&&_e===void 0&&(_e=Ce.width,Se=Ce.height);for(var fe,yt=this.ctx.transform.decompose(),nt=W(yt.rotate.shx),qe=new l,Xe=(qe=(qe=(qe=qe.multiply(yt.translate)).multiply(yt.skew)).multiply(yt.scale)).applyToRectangle(new a(ye-$*dt,me-K*Ie,X*ze,ae*$e)),Ye=b.call(this,Xe),Je=[],ut=0;ut<Ye.length;ut+=1)Je.indexOf(Ye[ut])===-1&&Je.push(Ye[ut]);if(N(Je),this.autoPaging)for(var mt=Je[0],Dt=Je[Je.length-1],_t=mt;_t<Dt+1;_t++){this.pdf.setPage(_t);var Mt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ht=_t===1?this.posY+this.margin[0]:this.margin[0],Rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ot=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=_t===1?0:Rt+(_t-2)*Ot;if(this.ctx.clip_path.length!==0){var cn=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(fe,this.posX+this.margin[3],-at+Ht+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=cn}var Yt=JSON.parse(JSON.stringify(Xe));Yt=w([Yt],this.posX+this.margin[3],-at+Ht+this.ctx.prevPageLastElemOffset)[0];var Rn=(_t>mt||_t<Dt)&&g.call(this);Rn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Mt,Ot,null).clip().discardPath()),this.pdf.addImage(V,"JPEG",Yt.x,Yt.y,Yt.w,Yt.h,null,null,nt),Rn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(V,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,nt)};var b=function(V,$,K){var X=[];$=$||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ae=this.posY+this.ctx.prevPageLastElemOffset;switch(V.type){default:case"mt":case"lt":X.push(Math.floor((V.y+ae)/K)+1);break;case"arc":X.push(Math.floor((V.y+ae-V.radius)/K)+1),X.push(Math.floor((V.y+ae+V.radius)/K)+1);break;case"qct":var ye=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x,V.y);X.push(Math.floor((ye.y+ae)/K)+1),X.push(Math.floor((ye.y+ye.h+ae)/K)+1);break;case"bct":var me=J(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x2,V.y2,V.x,V.y);X.push(Math.floor((me.y+ae)/K)+1),X.push(Math.floor((me.y+me.h+ae)/K)+1);break;case"rect":X.push(Math.floor((V.y+ae)/K)+1),X.push(Math.floor((V.y+V.h+ae)/K)+1)}for(var _e=0;_e<X.length;_e+=1)for(;this.pdf.internal.getNumberOfPages()<X[_e];)x.call(this);return X},x=function(){var V=this.fillStyle,$=this.strokeStyle,K=this.font,X=this.lineCap,ae=this.lineWidth,ye=this.lineJoin;this.pdf.addPage(),this.fillStyle=V,this.strokeStyle=$,this.font=K,this.lineCap=X,this.lineWidth=ae,this.lineJoin=ye},w=function(V,$,K){for(var X=0;X<V.length;X++)switch(V[X].type){case"bct":V[X].x2+=$,V[X].y2+=K;case"qct":V[X].x1+=$,V[X].y1+=K;case"mt":case"lt":case"arc":default:V[X].x+=$,V[X].y+=K}return V},N=function(V){return V.sort(function($,K){return $-K})},E=function(V,$){for(var K,X,ae=this.fillStyle,ye=this.strokeStyle,me=this.lineCap,_e=this.lineWidth,Se=Math.abs(_e*this.ctx.transform.scaleX),Ce=this.lineJoin,ze=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),dt=[],Ie=0;Ie<$e.length;Ie++)if($e[Ie].x!==void 0)for(var fe=b.call(this,$e[Ie]),yt=0;yt<fe.length;yt+=1)dt.indexOf(fe[yt])===-1&&dt.push(fe[yt]);for(var nt=0;nt<dt.length;nt++)for(;this.pdf.internal.getNumberOfPages()<dt[nt];)x.call(this);if(N(dt),this.autoPaging)for(var qe=dt[0],Xe=dt[dt.length-1],Ye=qe;Ye<Xe+1;Ye++){this.pdf.setPage(Ye),this.fillStyle=ae,this.strokeStyle=ye,this.lineCap=me,this.lineWidth=Se,this.lineJoin=Ce;var Je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ut=Ye===1?this.posY+this.margin[0]:this.margin[0],mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_t=Ye===1?0:mt+(Ye-2)*Dt;if(this.ctx.clip_path.length!==0){var Mt=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(K,this.posX+this.margin[3],-_t+ut+this.ctx.prevPageLastElemOffset),D.call(this,V,!0),this.path=Mt}if(X=JSON.parse(JSON.stringify(ze)),this.path=w(X,this.posX+this.margin[3],-_t+ut+this.ctx.prevPageLastElemOffset),$===!1||Ye===0){var Ht=(Ye>qe||Ye<Xe)&&g.call(this);Ht&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,Dt,null).clip().discardPath()),D.call(this,V,$),Ht&&this.pdf.restoreGraphicsState()}this.lineWidth=_e}else this.lineWidth=Se,D.call(this,V,$),this.lineWidth=_e;this.path=ze},D=function(V,$){if((V!=="stroke"||$||!m.call(this))&&(V==="stroke"||$||!p.call(this))){for(var K,X,ae=[],ye=this.path,me=0;me<ye.length;me++){var _e=ye[me];switch(_e.type){case"begin":ae.push({begin:!0});break;case"close":ae.push({close:!0});break;case"mt":ae.push({start:_e,deltas:[],abs:[]});break;case"lt":var Se=ae.length;if(ye[me-1]&&!isNaN(ye[me-1].x)&&(K=[_e.x-ye[me-1].x,_e.y-ye[me-1].y],Se>0)){for(;Se>=0;Se--)if(ae[Se-1].close!==!0&&ae[Se-1].begin!==!0){ae[Se-1].deltas.push(K),ae[Se-1].abs.push(_e);break}}break;case"bct":K=[_e.x1-ye[me-1].x,_e.y1-ye[me-1].y,_e.x2-ye[me-1].x,_e.y2-ye[me-1].y,_e.x-ye[me-1].x,_e.y-ye[me-1].y],ae[ae.length-1].deltas.push(K);break;case"qct":var Ce=ye[me-1].x+2/3*(_e.x1-ye[me-1].x),ze=ye[me-1].y+2/3*(_e.y1-ye[me-1].y),$e=_e.x+2/3*(_e.x1-_e.x),dt=_e.y+2/3*(_e.y1-_e.y),Ie=_e.x,fe=_e.y;K=[Ce-ye[me-1].x,ze-ye[me-1].y,$e-ye[me-1].x,dt-ye[me-1].y,Ie-ye[me-1].x,fe-ye[me-1].y],ae[ae.length-1].deltas.push(K);break;case"arc":ae.push({deltas:[],abs:[],arc:!0}),Array.isArray(ae[ae.length-1].abs)&&ae[ae.length-1].abs.push(_e)}}X=$?null:V==="stroke"?"stroke":"fill";for(var yt=!1,nt=0;nt<ae.length;nt++)if(ae[nt].arc)for(var qe=ae[nt].abs,Xe=0;Xe<qe.length;Xe++){var Ye=qe[Xe];Ye.type==="arc"?v.call(this,Ye.x,Ye.y,Ye.radius,Ye.startAngle,Ye.endAngle,Ye.counterclockwise,void 0,$,!yt):k.call(this,Ye.x,Ye.y),yt=!0}else if(ae[nt].close===!0)this.pdf.internal.out("h"),yt=!1;else if(ae[nt].begin!==!0){var Je=ae[nt].start.x,ut=ae[nt].start.y;F.call(this,ae[nt].deltas,Je,ut),yt=!0}X&&A.call(this,X),$&&I.call(this)}},j=function(V){var $=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=$*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return V-K;case"top":return V+$-K;case"hanging":return V+$-2*K;case"middle":return V+$/2-K;case"ideographic":return V;case"alphabetic":default:return V}},C=function(V){return V+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var V=function(){};return V.colorStops=[],V.addColorStop=function($,K){this.colorStops.push([$,K])},V.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},V.isCanvasGradient=!0,V},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var v=function(V,$,K,X,ae,ye,me,_e,Se){for(var Ce=O.call(this,K,X,ae,ye),ze=0;ze<Ce.length;ze++){var $e=Ce[ze];ze===0&&(Se?S.call(this,$e.x1+V,$e.y1+$):k.call(this,$e.x1+V,$e.y1+$)),q.call(this,V,$,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}_e?I.call(this):A.call(this,me)},A=function(V){switch(V){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(V,$){this.pdf.internal.out(n(V)+" "+r($)+" m")},P=function(V){var $;switch(V.align){case"right":case"end":$="right";break;case"center":$="center";break;case"left":case"start":default:$="left"}var K=this.pdf.getTextDimensions(V.text),X=j.call(this,V.y),ae=C.call(this,X)-K.h,ye=this.ctx.transform.applyToPoint(new o(V.x,X)),me=this.ctx.transform.decompose(),_e=new l;_e=(_e=(_e=_e.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var Se,Ce,ze,$e=this.ctx.transform.applyToRectangle(new a(V.x,X,K.w,K.h)),dt=_e.applyToRectangle(new a(V.x,ae,K.w,K.h)),Ie=b.call(this,dt),fe=[],yt=0;yt<Ie.length;yt+=1)fe.indexOf(Ie[yt])===-1&&fe.push(Ie[yt]);if(N(fe),this.autoPaging)for(var nt=fe[0],qe=fe[fe.length-1],Xe=nt;Xe<qe+1;Xe++){this.pdf.setPage(Xe);var Ye=Xe===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[2],mt=ut-this.margin[0],Dt=this.pdf.internal.pageSize.width-this.margin[1],_t=Dt-this.margin[3],Mt=Xe===1?0:Je+(Xe-2)*mt;if(this.ctx.clip_path.length!==0){var Ht=this.path;Se=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(Se,this.posX+this.margin[3],-1*Mt+Ye),D.call(this,"fill",!0),this.path=Ht}var Rt=w([JSON.parse(JSON.stringify(dt))],this.posX+this.margin[3],-Mt+Ye+this.ctx.prevPageLastElemOffset)[0];V.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*V.scale),ze=this.lineWidth,this.lineWidth=ze*V.scale);var Ot=this.autoPaging!=="text";if(Ot||Rt.y+Rt.h<=ut){if(Ot||Rt.y>=Ye&&Rt.x<=Dt){var at=Ot?V.text:this.pdf.splitTextToSize(V.text,V.maxWidth||Dt-Rt.x)[0],cn=w([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Mt+Ye+this.ctx.prevPageLastElemOffset)[0],Yt=Ot&&(Xe>nt||Xe<qe)&&g.call(this);Yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_t,mt,null).clip().discardPath()),this.pdf.text(at,cn.x,cn.y,{angle:V.angle,align:$,renderingMode:V.renderingMode}),Yt&&this.pdf.restoreGraphicsState()}}else Rt.y<ut&&(this.ctx.prevPageLastElemOffset+=ut-Rt.y);V.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=ze)}else V.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*V.scale),ze=this.lineWidth,this.lineWidth=ze*V.scale),this.pdf.text(V.text,ye.x+this.posX,ye.y+this.posY,{angle:V.angle,align:$,renderingMode:V.renderingMode,maxWidth:V.maxWidth}),V.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=ze)},k=function(V,$,K,X){K=K||0,X=X||0,this.pdf.internal.out(n(V+K)+" "+r($+X)+" l")},F=function(V,$,K){return this.pdf.lines(V,$,K,null,null)},q=function(V,$,K,X,ae,ye,me,_e){this.pdf.internal.out([e(i(K+V)),e(s(X+$)),e(i(ae+V)),e(s(ye+$)),e(i(me+V)),e(s(_e+$)),"c"].join(" "))},O=function(V,$,K,X){for(var ae=2*Math.PI,ye=Math.PI/2;$>K;)$-=ae;var me=Math.abs(K-$);me<ae&&X&&(me=ae-me);for(var _e=[],Se=X?-1:1,Ce=$;me>1e-5;){var ze=Ce+Se*Math.min(me,ye);_e.push(M.call(this,V,Ce,ze)),me-=Math.abs(ze-Ce),Ce=ze}return _e},M=function(V,$,K){var X=(K-$)/2,ae=V*Math.cos(X),ye=V*Math.sin(X),me=ae,_e=-ye,Se=me*me+_e*_e,Ce=Se+me*ae+_e*ye,ze=4/3*(Math.sqrt(2*Se*Ce)-Ce)/(me*ye-_e*ae),$e=me-ze*_e,dt=_e+ze*me,Ie=$e,fe=-dt,yt=X+$,nt=Math.cos(yt),qe=Math.sin(yt);return{x1:V*Math.cos($),y1:V*Math.sin($),x2:$e*nt-dt*qe,y2:$e*qe+dt*nt,x3:Ie*nt-fe*qe,y3:Ie*qe+fe*nt,x4:V*Math.cos(K),y4:V*Math.sin(K)}},W=function(V){return 180*V/Math.PI},z=function(V,$,K,X,ae,ye){var me=V+.5*(K-V),_e=$+.5*(X-$),Se=ae+.5*(K-ae),Ce=ye+.5*(X-ye),ze=Math.min(V,ae,me,Se),$e=Math.max(V,ae,me,Se),dt=Math.min($,ye,_e,Ce),Ie=Math.max($,ye,_e,Ce);return new a(ze,dt,$e-ze,Ie-dt)},J=function(V,$,K,X,ae,ye,me,_e){var Se,Ce,ze,$e,dt,Ie,fe,yt,nt,qe,Xe,Ye,Je,ut,mt=K-V,Dt=X-$,_t=ae-K,Mt=ye-X,Ht=me-ae,Rt=_e-ye;for(Ce=0;Ce<41;Ce++)nt=(fe=(ze=V+(Se=Ce/40)*mt)+Se*((dt=K+Se*_t)-ze))+Se*(dt+Se*(ae+Se*Ht-dt)-fe),qe=(yt=($e=$+Se*Dt)+Se*((Ie=X+Se*Mt)-$e))+Se*(Ie+Se*(ye+Se*Rt-Ie)-yt),Ce==0?(Xe=nt,Ye=qe,Je=nt,ut=qe):(Xe=Math.min(Xe,nt),Ye=Math.min(Ye,qe),Je=Math.max(Je,nt),ut=Math.max(ut,qe));return new a(Math.round(Xe),Math.round(Ye),Math.round(Je-Xe),Math.round(ut-Ye))},ne=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var V,$,K=(V=this.ctx.lineDash,$=this.ctx.lineDashOffset,JSON.stringify({lineDash:V,lineDashOffset:$}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(zt.API),function(t){var e=function(s){var o,a,l,c,d,f,h,p,m,g;for(a=[],l=0,c=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;c>l;l+=4)(d=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(f=(d=((d=((d=((d=(d-(g=d%85))/85)-(m=d%85))/85)-(p=d%85))/85)-(h=d%85))/85)%85,a.push(f+33,h+33,p+33,m+33,g+33)):a.push(122);return function(b,x){for(var w=x;w>0;w--)b.pop()}(a,o.length),String.fromCharCode.apply(String,a)+"~>"},n=function(s){var o,a,l,c,d,f=String,h="length",p=255,m="charCodeAt",g="slice",b="replace";for(s[g](-2),s=s[g](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],c=0,d=(s+=o="uuuuu"[g](s[h]%5||5))[h];d>c;c+=5)a=52200625*(s[m](c)-33)+614125*(s[m](c+1)-33)+7225*(s[m](c+2)-33)+85*(s[m](c+3)-33)+(s[m](c+4)-33),l.push(p&a>>24,p&a>>16,p&a>>8,p&a);return function(x,w){for(var N=w;N>0;N--)x.pop()}(l,o[h]),f.fromCharCode.apply(f,l)},r=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var a="",l=0;l<s.length;l+=2)a+=String.fromCharCode("0x"+(s[l]+s[l+1]));return a},i=function(s){for(var o=new Uint8Array(s.length),a=s.length;a--;)o[a]=s.charCodeAt(a);return s=(o=L5(o)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};t.processDataByFilters=function(s,o){var a=0,l=s||"",c=[];for(typeof(o=o||[])=="string"&&(o=[o]),a=0;a<o.length;a+=1)switch(o[a]){case"ASCII85Decode":case"/ASCII85Decode":l=n(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=r(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=i(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[a]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(zt.API),function(t){t.loadFile=function(e,n,r){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=function(l,c,d){var f=new XMLHttpRequest,h=0,p=function(m){var g=m.length,b=[],x=String.fromCharCode;for(h=0;h<g;h+=1)b.push(x(255&m.charCodeAt(h)));return b.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?d(p(this.responseText)):d(void 0)}),f.send(null),c&&f.status===200)return p(f.responseText)}(i,s,o)}catch{}return a}(e,n,r)},t.loadImageFile=t.loadFile}(zt.API),function(t){function e(){return(Xt.html2canvas?Promise.resolve(Xt.html2canvas):I5(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(Xt.DOMPurify?Promise.resolve(Xt.DOMPurify):I5(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var a=Vn(o);return a==="undefined"?"undefined":a==="string"||o instanceof String?"string":a==="number"||o instanceof Number?"number":a==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":a==="object"?"object":"unknown"},i=function(o,a){var l=document.createElement(o);for(var c in a.className&&(l.className=a.className),a.innerHTML&&a.dompurify&&(l.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)l.style[c]=a.style[c];return l},s=function o(a){var l=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),c=o.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,o,1,[o])).set(a)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,a){return o.__proto__=a||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,a){return this.then(function(){switch(a=a||function(l){switch(r(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(n).then(function(l){return this.set({src:i("div",{innerHTML:o,dompurify:l})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function l(c,d){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)d!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(l(h,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(a){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,a(this.prop.container,l)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(a){var l=this.opt.jsPDF,c=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var h=0;h<c.length;++h){var p=c[h],m=p.src.find(function(g){return g.format==="truetype"});m&&l.addFont(m.url,p.ref.name,p.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),a(this.prop.container,f)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,a,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(o,a):this.outputPdf(o,a)},s.prototype.outputPdf=function(o,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,a)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(r(o)!=="object")return this;var a=Object.keys(o||{}).map(function(l){if(l in s.template.prop)return function(){this.prop[l]=o[l]};switch(l){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[l]=o[l]}}},this);return this.then(function(){return this.thenList(a)})},s.prototype.get=function(o,a){return this.then(function(){var l=o in s.template.prop?this.prop[o]:this.opt[o];return a?a(l):l})},s.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function a(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(o=o||zt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:a(o.inner.width,o.k),height:a(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,a,l,c){return o!=null&&(this.progress.val=o),a!=null&&(this.progress.state=a),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,a,l,c){return this.setProgress(o?this.progress.val+o:null,a||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},s.prototype.then=function(o,a){var l=this;return this.thenCore(o,a,function(c,d){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,c),f}).then(c,d).then(function(f){return l.updateProgress(1),f})})},s.prototype.thenCore=function(o,a,l){l=l||Promise.prototype.then,o&&(o=o.bind(this)),a&&(a=a.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),d=l.call(c,o,a);return s.convert(d,this.__proto__)},s.prototype.thenExternal=function(o,a){return Promise.prototype.then.call(this,o,a)},s.prototype.thenList=function(o){var a=this;return o.forEach(function(l){a=a.thenCore(l)}),a},s.prototype.catch=function(o){o&&(o=o.bind(this));var a=Promise.prototype.catch.call(this,o);return s.convert(a,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,zt.getPageSize=function(o,a,l){if(Vn(o)==="object"){var c=o;o=c.orientation,a=c.unit||a,l=c.format||l}a=a||"mm",l=l||"a4",o=(""+(o||"P")).toLowerCase();var d,f=(""+l).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+a}var p,m=0,g=0;if(h.hasOwnProperty(f))m=h[f][1]/d,g=h[f][0]/d;else try{m=l[1],g=l[0]}catch{throw new Error("Invalid format: "+l)}if(o==="p"||o==="portrait")o="p",g>m&&(p=g,g=m,m=p);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",m>g&&(p=g,g=m,m=p)}return{width:g,height:m,unit:a,k:d,orientation:o}},t.html=function(o,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(z5):null;var l=new s(a);return a.worker?l:l.from(o).doCallback()}}(zt.API),zt.API.addJS=function(t){return V6=t,this.internal.events.subscribe("postPutResources",function(){Cg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Cg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),O6=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+V6+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Cg!==void 0&&O6!==void 0&&this.internal.out("/Names <</JavaScript "+Cg+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],a=r.exec(o);if(a!=null){var l=a[1];n.internal.newObjectDeferredBegin(l,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,d=[];for(s=0;s<c;s++){var f=n.internal.newObject();d.push(f);var h=n.internal.getPageInfo(s+1);n.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=n.internal.newObject();for(n.internal.write("<< /Names [ "),s=0;s<d.length;s++)n.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+p+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,s){var o={title:i,options:s,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var o=r.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var l=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var c=0;c<r.children.length;c++)this.renderItems(r.children[c])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var s=0;s<i.children.length;s++)r.count++,this.count_r(r,i.children[s]);return r.count}}])}(zt.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,s,o,a){var l,c=this.decode.DCT_DECODE,d=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(l=function(f){for(var h,p=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},b=4;b<m;b+=2){if(b+=p,e.indexOf(f.charCodeAt(b+1))!==-1){h=256*f.charCodeAt(b+5)+f.charCodeAt(b+6),g={width:256*f.charCodeAt(b+7)+f.charCodeAt(b+8),height:h,numcomponents:f.charCodeAt(b+9)};break}p=256*f.charCodeAt(b+2)+f.charCodeAt(b+3)}return g}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}d={data:n,width:l.width,height:l.height,colorSpace:a,bitsPerComponent:8,filter:c,index:r,alias:i}}return d}}(zt.API);var sh,Pg,U6,z6,q6,rZ=function(){var t,e,n;function r(s){var o,a,l,c,d,f,h,p,m,g,b,x,w,N;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(o=this.readUInt32(),m=(function(){var E,D;for(D=[],E=0;E<4;++E)D.push(String.fromCharCode(this.data[this.pos++]));return D}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),c=this.readUInt16()||100,f.delay=1e3*d/c,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(m==="fdAT"&&(this.pos+=4,o-=4),s=(f!=null?f.data:void 0)||this.imgData,x=0;0<=o?x<o:x>o;0<=o?++x:--x)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((g=l-this.transparency.indexed.length)>0)for(w=0;0<=g?w<g:w>g;0<=g?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":h=(b=this.read(o)).indexOf(0),p=String.fromCharCode.apply(String,b.slice(0,h)),this.text[p]=String.fromCharCode.apply(String,b.slice(h+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(N=this.colorType)===4||N===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(s){var o,a;for(a=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)a.push(this.data[this.pos++]);return a},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(s){var o=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*o),l=0,c=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function d(f,h,p,m){var g,b,x,w,N,E,D,j,C,v,A,I,S,P,k,F,q,O,M,W,z,J=Math.ceil((c.width-f)/p),ne=Math.ceil((c.height-h)/m),V=c.width==J&&c.height==ne;for(P=o*J,I=V?a:new Uint8Array(P*ne),E=s.length,S=0,b=0;S<ne&&l<E;){switch(s[l++]){case 0:for(w=q=0;q<P;w=q+=1)I[b++]=s[l++];break;case 1:for(w=O=0;O<P;w=O+=1)g=s[l++],N=w<o?0:I[b-o],I[b++]=(g+N)%256;break;case 2:for(w=M=0;M<P;w=M+=1)g=s[l++],x=(w-w%o)/o,k=S&&I[(S-1)*P+x*o+w%o],I[b++]=(k+g)%256;break;case 3:for(w=W=0;W<P;w=W+=1)g=s[l++],x=(w-w%o)/o,N=w<o?0:I[b-o],k=S&&I[(S-1)*P+x*o+w%o],I[b++]=(g+Math.floor((N+k)/2))%256;break;case 4:for(w=z=0;z<P;w=z+=1)g=s[l++],x=(w-w%o)/o,N=w<o?0:I[b-o],S===0?k=F=0:(k=I[(S-1)*P+x*o+w%o],F=x&&I[(S-1)*P+(x-1)*o+w%o]),D=N+k-F,j=Math.abs(D-N),v=Math.abs(D-k),A=Math.abs(D-F),C=j<=v&&j<=A?N:v<=A?k:F,I[b++]=(g+C)%256;break;default:throw new Error("Invalid filter algorithm: "+s[l-1])}if(!V){var $=((h+S*m)*c.width+f)*o,K=S*P;for(w=0;w<J;w+=1){for(var X=0;X<o;X+=1)a[$++]=I[K++];$+=(p-1)*o}}S++}}return s=RJ(s),c.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),a},r.prototype.decodePalette=function(){var s,o,a,l,c,d,f,h,p;for(a=this.palette,d=this.transparency.indexed||[],c=new Uint8Array((d.length||0)+a.length),l=0,s=0,o=f=0,h=a.length;f<h;o=f+=3)c[l++]=a[o],c[l++]=a[o+1],c[l++]=a[o+2],c[l++]=(p=d[s++])!=null?p:255;return c},r.prototype.copyToImageData=function(s,o){var a,l,c,d,f,h,p,m,g,b,x;if(l=this.colors,g=null,a=this.hasAlphaChannel,this.palette.length&&(g=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),l=4,a=!0),m=(c=s.data||s).length,f=g||o,d=h=0,l===1)for(;d<m;)p=g?4*o[d/4]:h,b=f[p++],c[d++]=b,c[d++]=b,c[d++]=b,c[d++]=a?f[p++]:255,h=p;else for(;d<m;)p=g?4*o[d/4]:h,c[d++]=f[p++],c[d++]=f[p++],c[d++]=f[p++],c[d++]=a?f[p++]:255,h=p},r.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var i=function(){if(Object.prototype.toString.call(Xt)==="[object Window]"){try{e=Xt.document.createElement("canvas"),n=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(s){var o;if(i()===!0)return n.width=s.width,n.height=s.height,n.clearRect(0,0,s.width,s.height),n.putImageData(s,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(s){var o,a,l,c,d,f,h,p;if(this.animation){for(p=[],a=d=0,f=(h=this.animation.frames).length;d<f;a=++d)o=h[a],l=s.createImageData(o.width,o.height),c=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(l,c),o.imageData=l,p.push(o.image=t(l));return p}},r.prototype.renderFrame=function(s,o){var a,l,c;return a=(l=this.animation.frames)[o],c=l[o-1],o===0&&s.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?s.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&s.putImageData(c.imageData,c.xOffset,c.yOffset),a.blendOp===0&&s.clearRect(a.xOffset,a.yOffset,a.width,a.height),s.drawImage(a.image,a.xOffset,a.yOffset)},r.prototype.animate=function(s){var o,a,l,c,d,f,h=this;return a=0,f=this.animation,c=f.numFrames,l=f.frames,d=f.numPlays,(o=function(){var p,m;if(p=a++%c,m=l[p],h.renderFrame(s,p),c>1&&a/c<d)return h.animation._timeout=setTimeout(o,m.delay)})()},r.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},r.prototype.render=function(s){var o,a;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(a=o.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),o.putImageData(a,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function iZ(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],s=i>>7,o=1<<(7&i)+1;t[e++],t[e++];var a=null,l=null;s&&(a=e,l=o,e+=3*o);var c=!0,d=[],f=0,h=null,p=0,m=null;for(this.width=n,this.height=r;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var g=t[e++];f=t[e++]|t[e++]<<8,h=t[e++],!(1&g)&&(h=null),p=g>>2&7,e++;break;case 254:for(;;){if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var b=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,N=t[e++]|t[e++]<<8,E=t[e++],D=E>>6&1,j=1<<(7&E)+1,C=a,v=l,A=!1;E>>7&&(A=!0,C=e,v=j,e+=3*j);var I=e;for(e++;;){var S;if(!((S=t[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}d.push({x:b,y:x,width:w,height:N,has_local_palette:A,palette_offset:C,palette_size:v,data_offset:I,data_length:e-I,transparent_index:h,interlaced:!!D,delay:f,disposal:p});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,k){var F=this.frameInfo(P),q=F.width*F.height,O=new Uint8Array(q);H6(t,F.data_offset,O,q);var M=F.palette_offset,W=F.transparent_index;W===null&&(W=256);var z=F.width,J=n-z,ne=z,V=4*(F.y*n+F.x),$=4*((F.y+F.height)*n+F.x),K=V,X=4*J;F.interlaced===!0&&(X+=4*n*7);for(var ae=8,ye=0,me=O.length;ye<me;++ye){var _e=O[ye];if(ne===0&&(ne=z,(K+=X)>=$&&(X=4*J+4*n*(ae-1),K=V+(z+J)*(ae<<1),ae>>=1)),_e===W)K+=4;else{var Se=t[M+3*_e],Ce=t[M+3*_e+1],ze=t[M+3*_e+2];k[K++]=ze,k[K++]=Ce,k[K++]=Se,k[K++]=255}--ne}},this.decodeAndBlitFrameRGBA=function(P,k){var F=this.frameInfo(P),q=F.width*F.height,O=new Uint8Array(q);H6(t,F.data_offset,O,q);var M=F.palette_offset,W=F.transparent_index;W===null&&(W=256);var z=F.width,J=n-z,ne=z,V=4*(F.y*n+F.x),$=4*((F.y+F.height)*n+F.x),K=V,X=4*J;F.interlaced===!0&&(X+=4*n*7);for(var ae=8,ye=0,me=O.length;ye<me;++ye){var _e=O[ye];if(ne===0&&(ne=z,(K+=X)>=$&&(X=4*J+4*n*(ae-1),K=V+(z+J)*(ae<<1),ae>>=1)),_e===W)K+=4;else{var Se=t[M+3*_e],Ce=t[M+3*_e+1],ze=t[M+3*_e+2];k[K++]=Se,k[K++]=Ce,k[K++]=ze,k[K++]=255}--ne}}}function H6(t,e,n,r){for(var i=t[e++],s=1<<i,o=s+1,a=o+1,l=i+1,c=(1<<l)-1,d=0,f=0,h=0,p=t[e++],m=new Int32Array(4096),g=null;;){for(;d<16&&p!==0;)f|=t[e++]<<d,d+=8,p===1?p=t[e++]:--p;if(d<l)break;var b=f&c;if(f>>=l,d-=l,b!==s){if(b===o)break;for(var x=b<a?b:g,w=0,N=x;N>s;)N=m[N]>>8,++w;var E=N;if(h+w+(x!==b?1:0)>r)return void ir.log("Warning, gif stream longer than expected.");n[h++]=E;var D=h+=w;for(x!==b&&(n[h++]=E),N=x;w--;)N=m[N],n[--D]=255&N,N>>=8;g!==null&&a<4096&&(m[a++]=g<<8|E,a>=c+1&&l<12&&(++l,c=c<<1|1)),g=b}else a=o+1,c=(1<<(l=i+1))-1,g=null}return h!==r&&ir.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function B2(t){var e,n,r,i,s,o=Math.floor,a=new Array(64),l=new Array(64),c=new Array(64),d=new Array(64),f=new Array(65535),h=new Array(65535),p=new Array(64),m=new Array(64),g=[],b=0,x=7,w=new Array(64),N=new Array(64),E=new Array(64),D=new Array(256),j=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],v=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function O(V,$){for(var K=0,X=0,ae=new Array,ye=1;ye<=16;ye++){for(var me=1;me<=V[ye];me++)ae[$[X]]=[],ae[$[X]][0]=K,ae[$[X]][1]=ye,X++,K++;K*=2}return ae}function M(V){for(var $=V[0],K=V[1]-1;K>=0;)$&1<<K&&(b|=1<<x),K--,--x<0&&(b==255?(W(255),W(0)):W(b),x=7,b=0)}function W(V){g.push(V)}function z(V){W(V>>8&255),W(255&V)}function J(V,$,K,X,ae){for(var ye,me=ae[0],_e=ae[240],Se=function(qe,Xe){var Ye,Je,ut,mt,Dt,_t,Mt,Ht,Rt,Ot,at=0;for(Rt=0;Rt<8;++Rt){Ye=qe[at],Je=qe[at+1],ut=qe[at+2],mt=qe[at+3],Dt=qe[at+4],_t=qe[at+5],Mt=qe[at+6];var cn=Ye+(Ht=qe[at+7]),Yt=Ye-Ht,Rn=Je+Mt,nn=Je-Mt,An=ut+_t,Zr=ut-_t,sn=mt+Dt,ui=mt-Dt,yn=cn+sn,mr=cn-sn,Xn=Rn+An,pn=Rn-An;qe[at]=yn+Xn,qe[at+4]=yn-Xn;var Et=.707106781*(pn+mr);qe[at+2]=mr+Et,qe[at+6]=mr-Et;var on=.382683433*((yn=ui+Zr)-(pn=nn+Yt)),Hr=.5411961*yn+on,In=1.306562965*pn+on,Hn=.707106781*(Xn=Zr+nn),di=Yt+Hn,Nt=Yt-Hn;qe[at+5]=Nt+Hr,qe[at+3]=Nt-Hr,qe[at+1]=di+In,qe[at+7]=di-In,at+=8}for(at=0,Rt=0;Rt<8;++Rt){Ye=qe[at],Je=qe[at+8],ut=qe[at+16],mt=qe[at+24],Dt=qe[at+32],_t=qe[at+40],Mt=qe[at+48];var Wr=Ye+(Ht=qe[at+56]),Cn=Ye-Ht,Fn=Je+Mt,sr=Je-Mt,tr=ut+_t,Pr=ut-_t,sa=mt+Dt,Ds=mt-Dt,hi=Wr+sa,Mi=Wr-sa,wi=Fn+tr,fi=Fn-tr;qe[at]=hi+wi,qe[at+32]=hi-wi;var gr=.707106781*(fi+Mi);qe[at+16]=Mi+gr,qe[at+48]=Mi-gr;var _i=.382683433*((hi=Ds+Pr)-(fi=sr+Cn)),Bi=.5411961*hi+_i,Rs=1.306562965*fi+_i,to=.707106781*(wi=Pr+sr),no=Cn+to,To=Cn-to;qe[at+40]=To+Bi,qe[at+24]=To-Bi,qe[at+8]=no+Rs,qe[at+56]=no-Rs,at++}for(Rt=0;Rt<64;++Rt)Ot=qe[Rt]*Xe[Rt],p[Rt]=Ot>0?Ot+.5|0:Ot-.5|0;return p}(V,$),Ce=0;Ce<64;++Ce)m[C[Ce]]=Se[Ce];var ze=m[0]-K;K=m[0],ze==0?M(X[0]):(M(X[h[ye=32767+ze]]),M(f[ye]));for(var $e=63;$e>0&&m[$e]==0;)$e--;if($e==0)return M(me),K;for(var dt,Ie=1;Ie<=$e;){for(var fe=Ie;m[Ie]==0&&Ie<=$e;)++Ie;var yt=Ie-fe;if(yt>=16){dt=yt>>4;for(var nt=1;nt<=dt;++nt)M(_e);yt&=15}ye=32767+m[Ie],M(ae[(yt<<4)+h[ye]]),M(f[ye]),Ie++}return $e!=63&&M(me),K}function ne(V){V=Math.min(Math.max(V,1),100),s!=V&&(function($){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var ae=o((K[X]*$+50)/100);ae=Math.min(Math.max(ae,1),255),a[C[X]]=ae}for(var ye=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var _e=o((ye[me]*$+50)/100);_e=Math.min(Math.max(_e,1),255),l[C[me]]=_e}for(var Se=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,ze=0;ze<8;ze++)for(var $e=0;$e<8;$e++)c[Ce]=1/(a[C[Ce]]*Se[ze]*Se[$e]*8),d[Ce]=1/(l[C[Ce]]*Se[ze]*Se[$e]*8),Ce++}(V<50?Math.floor(5e3/V):Math.floor(200-2*V)),s=V)}this.encode=function(V,$){$&&ne($),g=new Array,b=0,x=7,z(65496),z(65504),z(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),z(1),z(1),W(0),W(0),function(){z(65499),z(132),W(0);for(var Je=0;Je<64;Je++)W(a[Je]);W(1);for(var ut=0;ut<64;ut++)W(l[ut])}(),function(Je,ut){z(65472),z(17),W(8),z(ut),z(Je),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(V.width,V.height),function(){z(65476),z(418),W(0);for(var Je=0;Je<16;Je++)W(v[Je+1]);for(var ut=0;ut<=11;ut++)W(A[ut]);W(16);for(var mt=0;mt<16;mt++)W(I[mt+1]);for(var Dt=0;Dt<=161;Dt++)W(S[Dt]);W(1);for(var _t=0;_t<16;_t++)W(P[_t+1]);for(var Mt=0;Mt<=11;Mt++)W(k[Mt]);W(17);for(var Ht=0;Ht<16;Ht++)W(F[Ht+1]);for(var Rt=0;Rt<=161;Rt++)W(q[Rt])}(),z(65498),z(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var K=0,X=0,ae=0;b=0,x=7,this.encode.displayName="_encode_";for(var ye,me,_e,Se,Ce,ze,$e,dt,Ie,fe=V.data,yt=V.width,nt=V.height,qe=4*yt,Xe=0;Xe<nt;){for(ye=0;ye<qe;){for(Ce=qe*Xe+ye,$e=-1,dt=0,Ie=0;Ie<64;Ie++)ze=Ce+(dt=Ie>>3)*qe+($e=4*(7&Ie)),Xe+dt>=nt&&(ze-=qe*(Xe+1+dt-nt)),ye+$e>=qe&&(ze-=ye+$e-qe+4),me=fe[ze++],_e=fe[ze++],Se=fe[ze++],w[Ie]=(j[me]+j[_e+256>>0]+j[Se+512>>0]>>16)-128,N[Ie]=(j[me+768>>0]+j[_e+1024>>0]+j[Se+1280>>0]>>16)-128,E[Ie]=(j[me+1280>>0]+j[_e+1536>>0]+j[Se+1792>>0]>>16)-128;K=J(w,c,K,e,r),X=J(N,d,X,n,i),ae=J(E,d,ae,n,i),ye+=32}Xe+=8}if(x>=0){var Ye=[];Ye[1]=x+1,Ye[0]=(1<<x+1)-1,M(Ye)}return z(65497),new Uint8Array(g)},t=t||50,function(){for(var V=String.fromCharCode,$=0;$<256;$++)D[$]=V($)}(),e=O(v,A),n=O(P,k),r=O(I,S),i=O(F,q),function(){for(var V=1,$=2,K=1;K<=15;K++){for(var X=V;X<$;X++)h[32767+X]=K,f[32767+X]=[],f[32767+X][1]=K,f[32767+X][0]=X;for(var ae=-($-1);ae<=-V;ae++)h[32767+ae]=K,f[32767+ae]=[],f[32767+ae][1]=K,f[32767+ae][0]=$-1+ae;V<<=1,$<<=1}}(),function(){for(var V=0;V<256;V++)j[V]=19595*V,j[V+256>>0]=38470*V,j[V+512>>0]=7471*V+32768,j[V+768>>0]=-11059*V,j[V+1024>>0]=-21709*V,j[V+1280>>0]=32768*V+8421375,j[V+1536>>0]=-27439*V,j[V+1792>>0]=-5329*V}(),ne(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function zo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function W6(t){function e(v){if(!v)throw Error("assert :P")}function n(v,A,I){for(var S=0;4>S;S++)if(v[A+S]!=I.charCodeAt(S))return!0;return!1}function r(v,A,I,S,P){for(var k=0;k<P;k++)v[A+k]=I[S+k]}function i(v,A,I,S){for(var P=0;P<S;P++)v[A+P]=I}function s(v){return new Int32Array(v)}function o(v,A){for(var I=[],S=0;S<v;S++)I.push(new A);return I}function a(v,A){var I=[];return function S(P,k,F){for(var q=F[k],O=0;O<q&&(P.push(F.length>k+1?[]:new A),!(F.length<k+1));O++)S(P[O],k+1,F)}(I,0,v),I}var l=function(){var v=this;function A(y,T){for(var B=1<<T-1>>>0;y&B;)B>>>=1;return B?(y&B-1)+B:y}function I(y,T,B,H,Z){e(!(H%B));do y[T+(H-=B)]=Z;while(0<H)}function S(y,T,B,H,Z){if(e(2328>=Z),512>=Z)var re=s(512);else if((re=s(Z))==null)return 0;return function(ie,se,le,ue,we,je){var De,Ee,Qe=se,Be=1<<le,Ne=s(16),Ae=s(16);for(e(we!=0),e(ue!=null),e(ie!=null),e(0<le),Ee=0;Ee<we;++Ee){if(15<ue[Ee])return 0;++Ne[ue[Ee]]}if(Ne[0]==we)return 0;for(Ae[1]=0,De=1;15>De;++De){if(Ne[De]>1<<De)return 0;Ae[De+1]=Ae[De]+Ne[De]}for(Ee=0;Ee<we;++Ee)De=ue[Ee],0<ue[Ee]&&(je[Ae[De]++]=Ee);if(Ae[15]==1)return(ue=new P).g=0,ue.value=je[0],I(ie,Qe,1,Be,ue),Be;var Ge,Ze=-1,Ke=Be-1,At=0,xt=1,Gt=1,vt=1<<le;for(Ee=0,De=1,we=2;De<=le;++De,we<<=1){if(xt+=Gt<<=1,0>(Gt-=Ne[De]))return 0;for(;0<Ne[De];--Ne[De])(ue=new P).g=De,ue.value=je[Ee++],I(ie,Qe+At,we,vt,ue),At=A(At,De)}for(De=le+1,we=2;15>=De;++De,we<<=1){if(xt+=Gt<<=1,0>(Gt-=Ne[De]))return 0;for(;0<Ne[De];--Ne[De]){if(ue=new P,(At&Ke)!=Ze){for(Qe+=vt,Ge=1<<(Ze=De)-le;15>Ze&&!(0>=(Ge-=Ne[Ze]));)++Ze,Ge<<=1;Be+=vt=1<<(Ge=Ze-le),ie[se+(Ze=At&Ke)].g=Ge+le,ie[se+Ze].value=Qe-se-Ze}ue.g=De-le,ue.value=je[Ee++],I(ie,Qe+(At>>le),we,vt,ue),At=A(At,De)}}return xt!=2*Ae[15]-1?0:Be}(y,T,B,H,Z,re)}function P(){this.value=this.g=0}function k(){this.value=this.g=0}function F(){this.G=o(5,P),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o($r,k)}function q(y,T,B,H){e(y!=null),e(T!=null),e(2147483648>H),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=T,y.pa=B,y.Jd=T,y.Yc=B+H,y.Zc=4<=H?B+H-4+1:B,ye(y)}function O(y,T){for(var B=0;0<T--;)B|=_e(y,128)<<T;return B}function M(y,T){var B=O(y,T);return me(y)?-B:B}function W(y,T,B,H){var Z,re=0;for(e(y!=null),e(T!=null),e(4294967288>H),y.Sb=H,y.Ra=0,y.u=0,y.h=0,4<H&&(H=4),Z=0;Z<H;++Z)re+=T[B+Z]<<8*Z;y.Ra=re,y.bb=H,y.oa=T,y.pa=B}function z(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<ei-8>>>0,++y.bb,y.u-=8;K(y)&&(y.h=1,y.u=0)}function J(y,T){if(e(0<=T),!y.h&&T<=ec){var B=$(y)&Zl[T];return y.u+=T,z(y),B}return y.h=1,y.u=0}function ne(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function V(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function $(y){return y.Ra>>>(y.u&ei-1)>>>0}function K(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>ei}function X(y,T){y.u=T,y.h=K(y)}function ae(y){y.u>=rl&&(e(y.u>=rl),z(y))}function ye(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function me(y){return O(y,1)}function _e(y,T){var B=y.Ca;0>y.b&&ye(y);var H=y.b,Z=B*T>>>8,re=(y.I>>>H>Z)+0;for(re?(B-=Z,y.I-=Z+1<<H>>>0):B=Z+1,H=B,Z=0;256<=H;)Z+=8,H>>=8;return H=7^Z+Vi[H],y.b-=H,y.Ca=(B<<H)-1,re}function Se(y,T,B){y[T+0]=B>>24&255,y[T+1]=B>>16&255,y[T+2]=B>>8&255,y[T+3]=B>>0&255}function Ce(y,T){return y[T+0]<<0|y[T+1]<<8}function ze(y,T){return Ce(y,T)|y[T+2]<<16}function $e(y,T){return Ce(y,T)|Ce(y,T+2)<<16}function dt(y,T){var B=1<<T;return e(y!=null),e(0<T),y.X=s(B),y.X==null?0:(y.Mb=32-T,y.Xa=T,1)}function Ie(y,T){e(y!=null),e(T!=null),e(y.Xa==T.Xa),r(T.X,0,y.X,0,1<<T.Xa)}function fe(){this.X=[],this.Xa=this.Mb=0}function yt(y,T,B,H){e(B!=null),e(H!=null);var Z=B[0],re=H[0];return Z==0&&(Z=(y*re+T/2)/T),re==0&&(re=(T*Z+y/2)/y),0>=Z||0>=re?0:(B[0]=Z,H[0]=re,1)}function nt(y,T){return y+(1<<T)-1>>>T}function qe(y,T){return((4278255360&y)+(4278255360&T)>>>0&4278255360)+((16711935&y)+(16711935&T)>>>0&16711935)>>>0}function Xe(y,T){v[T]=function(B,H,Z,re,ie,se,le){var ue;for(ue=0;ue<ie;++ue){var we=v[y](se[le+ue-1],Z,re+ue);se[le+ue]=qe(B[H+ue],we)}}}function Ye(){this.ud=this.hd=this.jd=0}function Je(y,T){return((4278124286&(y^T))>>>1)+(y&T)>>>0}function ut(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function mt(y,T){return ut(y+(y-T+.5>>1))}function Dt(y,T,B){return Math.abs(T-B)-Math.abs(y-B)}function _t(y,T,B,H,Z,re,ie){for(H=re[ie-1],B=0;B<Z;++B)re[ie+B]=H=qe(y[T+B],H)}function Mt(y,T,B,H,Z){var re;for(re=0;re<B;++re){var ie=y[T+re],se=ie>>8&255,le=16711935&(le=(le=16711935&ie)+((se<<16)+se));H[Z+re]=(4278255360&ie)+le>>>0}}function Ht(y,T){T.jd=y>>0&255,T.hd=y>>8&255,T.ud=y>>16&255}function Rt(y,T,B,H,Z,re){var ie;for(ie=0;ie<H;++ie){var se=T[B+ie],le=se>>>8,ue=se,we=255&(we=(we=se>>>16)+((y.jd<<24>>24)*(le<<24>>24)>>>5));ue=255&(ue=(ue=ue+((y.hd<<24>>24)*(le<<24>>24)>>>5))+((y.ud<<24>>24)*(we<<24>>24)>>>5)),Z[re+ie]=(4278255360&se)+(we<<16)+ue}}function Ot(y,T,B,H,Z){v[T]=function(re,ie,se,le,ue,we,je,De,Ee){for(le=je;le<De;++le)for(je=0;je<Ee;++je)ue[we++]=Z(se[H(re[ie++])])},v[y]=function(re,ie,se,le,ue,we,je){var De=8>>re.b,Ee=re.Ea,Qe=re.K[0],Be=re.w;if(8>De)for(re=(1<<re.b)-1,Be=(1<<De)-1;ie<se;++ie){var Ne,Ae=0;for(Ne=0;Ne<Ee;++Ne)Ne&re||(Ae=H(le[ue++])),we[je++]=Z(Qe[Ae&Be]),Ae>>=De}else v["VP8LMapColor"+B](le,ue,Qe,Be,we,je,ie,se,Ee)}}function at(y,T,B,H,Z){for(B=T+B;T<B;){var re=y[T++];H[Z++]=re>>16&255,H[Z++]=re>>8&255,H[Z++]=re>>0&255}}function cn(y,T,B,H,Z){for(B=T+B;T<B;){var re=y[T++];H[Z++]=re>>16&255,H[Z++]=re>>8&255,H[Z++]=re>>0&255,H[Z++]=re>>24&255}}function Yt(y,T,B,H,Z){for(B=T+B;T<B;){var re=(ie=y[T++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;H[Z++]=re,H[Z++]=ie}}function Rn(y,T,B,H,Z){for(B=T+B;T<B;){var re=(ie=y[T++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;H[Z++]=re,H[Z++]=ie}}function nn(y,T,B,H,Z){for(B=T+B;T<B;){var re=y[T++];H[Z++]=re>>0&255,H[Z++]=re>>8&255,H[Z++]=re>>16&255}}function An(y,T,B,H,Z,re){if(re==0)for(B=T+B;T<B;)Se(H,((re=y[T++])[0]>>24|re[1]>>8&65280|re[2]<<8&16711680|re[3]<<24)>>>0),Z+=32;else r(H,Z,y,T,B)}function Zr(y,T){v[T][0]=v[y+"0"],v[T][1]=v[y+"1"],v[T][2]=v[y+"2"],v[T][3]=v[y+"3"],v[T][4]=v[y+"4"],v[T][5]=v[y+"5"],v[T][6]=v[y+"6"],v[T][7]=v[y+"7"],v[T][8]=v[y+"8"],v[T][9]=v[y+"9"],v[T][10]=v[y+"10"],v[T][11]=v[y+"11"],v[T][12]=v[y+"12"],v[T][13]=v[y+"13"],v[T][14]=v[y+"0"],v[T][15]=v[y+"0"]}function sn(y){return y==ky||y==Ty||y==_m||y==Iy}function ui(){this.eb=[],this.size=this.A=this.fb=0}function yn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function mr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ui,this.f.kb=new yn,this.sd=null}function Xn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function pn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Et(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function on(y,T){var B=y.T,H=T.ba.f.RGBA,Z=H.eb,re=H.fb+y.ka*H.A,ie=go[T.ba.S],se=y.y,le=y.O,ue=y.f,we=y.N,je=y.ea,De=y.W,Ee=T.cc,Qe=T.dc,Be=T.Mc,Ne=T.Nc,Ae=y.ka,Ge=y.ka+y.T,Ze=y.U,Ke=Ze+1>>1;for(Ae==0?ie(se,le,null,null,ue,we,je,De,ue,we,je,De,Z,re,null,null,Ze):(ie(T.ec,T.fc,se,le,Ee,Qe,Be,Ne,ue,we,je,De,Z,re-H.A,Z,re,Ze),++B);Ae+2<Ge;Ae+=2)Ee=ue,Qe=we,Be=je,Ne=De,we+=y.Rc,De+=y.Rc,re+=2*H.A,ie(se,(le+=2*y.fa)-y.fa,se,le,Ee,Qe,Be,Ne,ue,we,je,De,Z,re-H.A,Z,re,Ze);return le+=y.fa,y.j+Ge<y.o?(r(T.ec,T.fc,se,le,Ze),r(T.cc,T.dc,ue,we,Ke),r(T.Mc,T.Nc,je,De,Ke),B--):1&Ge||ie(se,le,null,null,ue,we,je,De,ue,we,je,De,Z,re+H.A,null,null,Ze),B}function Hr(y,T,B){var H=y.F,Z=[y.J];if(H!=null){var re=y.U,ie=T.ba.S,se=ie==wm||ie==_m;T=T.ba.f.RGBA;var le=[0],ue=y.ka;le[0]=y.T,y.Kb&&(ue==0?--le[0]:(--ue,Z[0]-=y.width),y.j+y.ka+y.T==y.o&&(le[0]=y.o-y.j-ue));var we=T.eb;ue=T.fb+ue*T.A,y=lr(H,Z[0],y.width,re,le,we,ue+(se?0:3),T.A),e(B==le),y&&sn(ie)&&po(we,ue,se,re,le,T.A)}return 0}function In(y){var T=y.ma,B=T.ba.S,H=11>B,Z=B==vm||B==bm||B==wm||B==Py||B==12||sn(B);if(T.memory=null,T.Ib=null,T.Jb=null,T.Nd=null,!ma(T.Oa,y,Z?11:12))return 0;if(Z&&sn(B)&&Oe(),y.da)alert("todo:use_scaling");else{if(H){if(T.Ib=Et,y.Kb){if(B=y.U+1>>1,T.memory=s(y.U+2*B),T.memory==null)return 0;T.ec=T.memory,T.fc=0,T.cc=T.ec,T.dc=T.fc+y.U,T.Mc=T.cc,T.Nc=T.dc+B,T.Ib=on,Oe()}}else alert("todo:EmitYUV");Z&&(T.Jb=Hr,H&&ve())}if(H&&!q4){for(y=0;256>y;++y)XD[y]=89858*(y-128)+Am>>Nm,eR[y]=-22014*(y-128)+Am,ZD[y]=-45773*(y-128),JD[y]=113618*(y-128)+Am>>Nm;for(y=Pf;y<Ry;++y)T=76283*(y-16)+Am>>Nm,tR[y-Pf]=Pn(T,255),nR[y-Pf]=Pn(T+8>>4,15);q4=1}return 1}function Hn(y){var T=y.ma,B=y.U,H=y.T;return e(!(1&y.ka)),0>=B||0>=H?0:(B=T.Ib(y,T),T.Jb!=null&&T.Jb(y,T,B),T.Dc+=B,1)}function di(y){y.ma.memory=null}function Nt(y,T,B,H){return J(y,8)!=47?0:(T[0]=J(y,14)+1,B[0]=J(y,14)+1,H[0]=J(y,1),J(y,3)!=0?0:!y.h)}function Wr(y,T){if(4>y)return y+1;var B=y-2>>1;return(2+(1&y)<<B)+J(T,B)+1}function Cn(y,T){return 120<T?T-120:1<=(B=((B=MD[T-1])>>4)*y+(8-(15&B)))?B:1;var B}function Fn(y,T,B){var H=$(B),Z=y[T+=255&H].g-8;return 0<Z&&(X(B,B.u+8),H=$(B),T+=y[T].value,T+=H&(1<<Z)-1),X(B,B.u+y[T].g),y[T].value}function sr(y,T,B){return B.g+=y.g,B.value+=y.value<<T>>>0,e(8>=B.g),y.g}function tr(y,T,B){var H=y.xc;return e((T=H==0?0:y.vc[y.md*(B>>H)+(T>>H)])<y.Wb),y.Ya[T]}function Pr(y,T,B,H){var Z=y.ab,re=y.c*T,ie=y.C;T=ie+T;var se=B,le=H;for(H=y.Ta,B=y.Ua;0<Z--;){var ue=y.gc[Z],we=ie,je=T,De=se,Ee=le,Qe=(le=H,se=B,ue.Ea);switch(e(we<je),e(je<=ue.nc),ue.hc){case 2:_u(De,Ee,(je-we)*Qe,le,se);break;case 0:var Be=we,Ne=je,Ae=le,Ge=se,Ze=(vt=ue).Ea;Be==0&&(tc(De,Ee,null,null,1,Ae,Ge),_t(De,Ee+1,0,0,Ze-1,Ae,Ge+1),Ee+=Ze,Ge+=Ze,++Be);for(var Ke=1<<vt.b,At=Ke-1,xt=nt(Ze,vt.b),Gt=vt.K,vt=vt.w+(Be>>vt.b)*xt;Be<Ne;){var Bn=Gt,Wn=vt,kn=1;for(or(De,Ee,Ae,Ge-Ze,1,Ae,Ge);kn<Ze;){var bn=(kn&~At)+Ke;bn>Ze&&(bn=Ze),(0,Mo[Bn[Wn++]>>8&15])(De,Ee+ +kn,Ae,Ge+kn-Ze,bn-kn,Ae,Ge+kn),kn=bn}Ee+=Ze,Ge+=Ze,++Be&At||(vt+=xt)}je!=ue.nc&&r(le,se-Qe,le,se+(je-we-1)*Qe,Qe);break;case 1:for(Qe=De,Ne=Ee,Ze=(De=ue.Ea)-(Ge=De&~(Ae=(Ee=1<<ue.b)-1)),Be=nt(De,ue.b),Ke=ue.K,ue=ue.w+(we>>ue.b)*Be;we<je;){for(At=Ke,xt=ue,Gt=new Ye,vt=Ne+Ge,Bn=Ne+De;Ne<vt;)Ht(At[xt++],Gt),Nu(Gt,Qe,Ne,Ee,le,se),Ne+=Ee,se+=Ee;Ne<Bn&&(Ht(At[xt++],Gt),Nu(Gt,Qe,Ne,Ze,le,se),Ne+=Ze,se+=Ze),++we&Ae||(ue+=Be)}break;case 3:if(De==le&&Ee==se&&0<ue.b){for(Ne=le,De=Qe=se+(je-we)*Qe-(Ge=(je-we)*nt(ue.Ea,ue.b)),Ee=le,Ae=se,Be=[],Ge=(Ze=Ge)-1;0<=Ge;--Ge)Be[Ge]=Ee[Ae+Ge];for(Ge=Ze-1;0<=Ge;--Ge)Ne[De+Ge]=Be[Ge];xs(ue,we,je,le,Qe,le,se)}else xs(ue,we,je,De,Ee,le,se)}se=H,le=B}le!=B&&r(H,B,se,le,re)}function sa(y,T){var B=y.V,H=y.Ba+y.c*y.C,Z=T-y.C;if(e(T<=y.l.o),e(16>=Z),0<Z){var re=y.l,ie=y.Ta,se=y.Ua,le=re.width;if(Pr(y,Z,B,H),Z=se=[se],e((B=y.C)<(H=T)),e(re.v<re.va),H>re.o&&(H=re.o),B<re.j){var ue=re.j-B;B=re.j,Z[0]+=ue*le}if(B>=H?B=0:(Z[0]+=4*re.v,re.ka=B-re.j,re.U=re.va-re.v,re.T=H-B,B=1),B){if(se=se[0],11>(B=y.ca).S){var we=B.f.RGBA,je=(H=B.S,Z=re.U,re=re.T,ue=we.eb,we.A),De=re;for(we=we.fb+y.Ma*we.A;0<De--;){var Ee=ie,Qe=se,Be=Z,Ne=ue,Ae=we;switch(H){case ym:ys(Ee,Qe,Be,Ne,Ae);break;case vm:is(Ee,Qe,Be,Ne,Ae);break;case ky:is(Ee,Qe,Be,Ne,Ae),po(Ne,Ae,0,Be,1,0);break;case D4:ol(Ee,Qe,Be,Ne,Ae);break;case bm:An(Ee,Qe,Be,Ne,Ae,1);break;case Ty:An(Ee,Qe,Be,Ne,Ae,1),po(Ne,Ae,0,Be,1,0);break;case wm:An(Ee,Qe,Be,Ne,Ae,0);break;case _m:An(Ee,Qe,Be,Ne,Ae,0),po(Ne,Ae,1,Be,1,0);break;case Py:ic(Ee,Qe,Be,Ne,Ae);break;case Iy:ic(Ee,Qe,Be,Ne,Ae),ar(Ne,Ae,Be,1,0);break;case R4:sl(Ee,Qe,Be,Ne,Ae);break;default:e(0)}se+=le,we+=je}y.Ma+=re}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=B.height)}}y.C=T,e(y.C<=y.i)}function Ds(y){var T;if(0<y.ua)return 0;for(T=0;T<y.Wb;++T){var B=y.Ya[T].G,H=y.Ya[T].H;if(0<B[1][H[1]+0].g||0<B[2][H[2]+0].g||0<B[3][H[3]+0].g)return 0}return 1}function hi(y,T,B,H,Z,re){if(y.Z!=0){var ie=y.qd,se=y.rd;for(e(lc[y.Z]!=null);T<B;++T)lc[y.Z](ie,se,H,Z,H,Z,re),ie=H,se=Z,Z+=re;y.qd=ie,y.rd=se}}function Mi(y,T){var B=y.l.ma,H=B.Z==0||B.Z==1?y.l.j:y.C;if(H=y.C<H?H:y.C,e(T<=y.l.o),T>H){var Z=y.l.width,re=B.ca,ie=B.tb+Z*H,se=y.V,le=y.Ba+y.c*H,ue=y.gc;e(y.ab==1),e(ue[0].hc==3),il(ue[0],H,T,se,le,re,ie),hi(B,H,T,re,ie,Z)}y.C=y.Ma=T}function wi(y,T,B,H,Z,re,ie){var se=y.$/H,le=y.$%H,ue=y.m,we=y.s,je=B+y.$,De=je;Z=B+H*Z;var Ee=B+H*re,Qe=280+we.ua,Be=y.Pb?se:16777216,Ne=0<we.ua?we.Wa:null,Ae=we.wc,Ge=je<Ee?tr(we,le,se):null;e(y.C<re),e(Ee<=Z);var Ze=!1;e:for(;;){for(;Ze||je<Ee;){var Ke=0;if(se>=Be){var At=je-B;e((Be=y).Pb),Be.wd=Be.m,Be.xd=At,0<Be.s.ua&&Ie(Be.s.Wa,Be.s.vb),Be=se+OD}if(le&Ae||(Ge=tr(we,le,se)),e(Ge!=null),Ge.Qb&&(T[je]=Ge.qb,Ze=!0),!Ze)if(ae(ue),Ge.jc){Ke=ue,At=T;var xt=je,Gt=Ge.pd[$(Ke)&$r-1];e(Ge.jc),256>Gt.g?(X(Ke,Ke.u+Gt.g),At[xt]=Gt.value,Ke=0):(X(Ke,Ke.u+Gt.g-256),e(256<=Gt.value),Ke=Gt.value),Ke==0&&(Ze=!0)}else Ke=Fn(Ge.G[0],Ge.H[0],ue);if(ue.h)break;if(Ze||256>Ke){if(!Ze)if(Ge.nd)T[je]=(Ge.qb|Ke<<8)>>>0;else{if(ae(ue),Ze=Fn(Ge.G[1],Ge.H[1],ue),ae(ue),At=Fn(Ge.G[2],Ge.H[2],ue),xt=Fn(Ge.G[3],Ge.H[3],ue),ue.h)break;T[je]=(xt<<24|Ze<<16|Ke<<8|At)>>>0}if(Ze=!1,++je,++le>=H&&(le=0,++se,ie!=null&&se<=re&&!(se%16)&&ie(y,se),Ne!=null))for(;De<je;)Ke=T[De++],Ne.X[(506832829*Ke&4294967295)>>>Ne.Mb]=Ke}else if(280>Ke){if(Ke=Wr(Ke-256,ue),At=Fn(Ge.G[4],Ge.H[4],ue),ae(ue),At=Cn(H,At=Wr(At,ue)),ue.h)break;if(je-B<At||Z-je<Ke)break e;for(xt=0;xt<Ke;++xt)T[je+xt]=T[je+xt-At];for(je+=Ke,le+=Ke;le>=H;)le-=H,++se,ie!=null&&se<=re&&!(se%16)&&ie(y,se);if(e(je<=Z),le&Ae&&(Ge=tr(we,le,se)),Ne!=null)for(;De<je;)Ke=T[De++],Ne.X[(506832829*Ke&4294967295)>>>Ne.Mb]=Ke}else{if(!(Ke<Qe))break e;for(Ze=Ke-280,e(Ne!=null);De<je;)Ke=T[De++],Ne.X[(506832829*Ke&4294967295)>>>Ne.Mb]=Ke;Ke=je,e(!(Ze>>>(At=Ne).Xa)),T[Ke]=At.X[Ze],Ze=!0}Ze||e(ue.h==K(ue))}if(y.Pb&&ue.h&&je<Z)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&Ie(y.s.vb,y.s.Wa);else{if(ue.h)break e;ie!=null&&ie(y,se>re?re:se),y.a=0,y.$=je-B}return 1}return y.a=3,0}function fi(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var T=y.Wa;T!=null&&(T.X=null),y.vb=null,e(y!=null)}function gr(){var y=new Ct;return y==null?null:(y.a=0,y.xb=M4,Zr("Predictor","VP8LPredictors"),Zr("Predictor","VP8LPredictors_C"),Zr("PredictorAdd","VP8LPredictorsAdd"),Zr("PredictorAdd","VP8LPredictorsAdd_C"),_u=Mt,Nu=Rt,ys=at,is=cn,ic=Yt,sl=Rn,ol=nn,v.VP8LMapColor32b=nc,v.VP8LMapColor8b=rc,y)}function _i(y,T,B,H,Z){var re=1,ie=[y],se=[T],le=H.m,ue=H.s,we=null,je=0;e:for(;;){if(B)for(;re&&J(le,1);){var De=ie,Ee=se,Qe=H,Be=1,Ne=Qe.m,Ae=Qe.gc[Qe.ab],Ge=J(Ne,2);if(Qe.Oc&1<<Ge)re=0;else{switch(Qe.Oc|=1<<Ge,Ae.hc=Ge,Ae.Ea=De[0],Ae.nc=Ee[0],Ae.K=[null],++Qe.ab,e(4>=Qe.ab),Ge){case 0:case 1:Ae.b=J(Ne,3)+2,Be=_i(nt(Ae.Ea,Ae.b),nt(Ae.nc,Ae.b),0,Qe,Ae.K),Ae.K=Ae.K[0];break;case 3:var Ze,Ke=J(Ne,8)+1,At=16<Ke?0:4<Ke?1:2<Ke?2:3;if(De[0]=nt(Ae.Ea,At),Ae.b=At,Ze=Be=_i(Ke,1,0,Qe,Ae.K)){var xt,Gt=Ke,vt=Ae,Bn=1<<(8>>vt.b),Wn=s(Bn);if(Wn==null)Ze=0;else{var kn=vt.K[0],bn=vt.w;for(Wn[0]=vt.K[0][0],xt=1;xt<1*Gt;++xt)Wn[xt]=qe(kn[bn+xt],Wn[xt-1]);for(;xt<4*Bn;++xt)Wn[xt]=0;vt.K[0]=null,vt.K[0]=Wn,Ze=1}}Be=Ze;break;case 2:break;default:e(0)}re=Be}}if(ie=ie[0],se=se[0],re&&J(le,1)&&!(re=1<=(je=J(le,4))&&11>=je)){H.a=3;break e}var rr;if(rr=re)t:{var Zn,hn,Gr,vs=H,Kr=ie,bs=se,$n=je,zs=B,qs=vs.m,pi=vs.s,Si=[null],os=1,xo=0,xa=BD[$n];n:for(;;){if(zs&&J(qs,1)){var mi=J(qs,3)+2,ul=nt(Kr,mi),Pu=nt(bs,mi),$d=ul*Pu;if(!_i(ul,Pu,0,vs,Si))break n;for(Si=Si[0],pi.xc=mi,Zn=0;Zn<$d;++Zn){var cc=Si[Zn]>>8&65535;Si[Zn]=cc,cc>=os&&(os=cc+1)}}if(qs.h)break n;for(hn=0;5>hn;++hn){var Tr=F4[hn];!hn&&0<$n&&(Tr+=1<<$n),xo<Tr&&(xo=Tr)}var Fy=o(os*xa,P),$4=os,G4=o($4,F);if(G4==null)var Em=null;else e(65536>=$4),Em=G4;var kf=s(xo);if(Em==null||kf==null||Fy==null){vs.a=1;break n}var Cm=Fy;for(Zn=Gr=0;Zn<os;++Zn){var Oo=Em[Zn],Gd=Oo.G,Kd=Oo.H,K4=0,Pm=1,Q4=0;for(hn=0;5>hn;++hn){Tr=F4[hn],Gd[hn]=Cm,Kd[hn]=Gr,!hn&&0<$n&&(Tr+=1<<$n);i:{var km,Ly=Tr,Tm=vs,Tf=kf,sR=Cm,oR=Gr,My=0,uc=Tm.m,aR=J(uc,1);if(i(Tf,0,0,Ly),aR){var lR=J(uc,1)+1,cR=J(uc,1),Y4=J(uc,cR==0?1:8);Tf[Y4]=1,lR==2&&(Tf[Y4=J(uc,8)]=1);var Im=1}else{var X4=s(19),J4=J(uc,4)+4;if(19<J4){Tm.a=3;var jm=0;break i}for(km=0;km<J4;++km)X4[LD[km]]=J(uc,3);var By=void 0,If=void 0,Z4=Tm,uR=X4,Dm=Ly,e3=Tf,Oy=0,dc=Z4.m,t3=8,n3=o(128,P);r:for(;S(n3,0,7,uR,19);){if(J(dc,1)){var dR=2+2*J(dc,3);if((By=2+J(dc,dR))>Dm)break r}else By=Dm;for(If=0;If<Dm&&By--;){ae(dc);var r3=n3[0+(127&$(dc))];X(dc,dc.u+r3.g);var Qd=r3.value;if(16>Qd)e3[If++]=Qd,Qd!=0&&(t3=Qd);else{var hR=Qd==16,i3=Qd-16,fR=RD[i3],s3=J(dc,DD[i3])+fR;if(If+s3>Dm)break r;for(var pR=hR?t3:0;0<s3--;)e3[If++]=pR}}Oy=1;break r}Oy||(Z4.a=3),Im=Oy}(Im=Im&&!uc.h)&&(My=S(sR,oR,8,Tf,Ly)),Im&&My!=0?jm=My:(Tm.a=3,jm=0)}if(jm==0)break n;if(Pm&&FD[hn]==1&&(Pm=Cm[Gr].g==0),K4+=Cm[Gr].g,Gr+=jm,3>=hn){var jf,Vy=kf[0];for(jf=1;jf<Tr;++jf)kf[jf]>Vy&&(Vy=kf[jf]);Q4+=Vy}}if(Oo.nd=Pm,Oo.Qb=0,Pm&&(Oo.qb=(Gd[3][Kd[3]+0].value<<24|Gd[1][Kd[1]+0].value<<16|Gd[2][Kd[2]+0].value)>>>0,K4==0&&256>Gd[0][Kd[0]+0].value&&(Oo.Qb=1,Oo.qb+=Gd[0][Kd[0]+0].value<<8)),Oo.jc=!Oo.Qb&&6>Q4,Oo.jc){var Rm,dl=Oo;for(Rm=0;Rm<$r;++Rm){var hc=Rm,fc=dl.pd[hc],Fm=dl.G[0][dl.H[0]+hc];256<=Fm.value?(fc.g=Fm.g+256,fc.value=Fm.value):(fc.g=0,fc.value=0,hc>>=sr(Fm,8,fc),hc>>=sr(dl.G[1][dl.H[1]+hc],16,fc),hc>>=sr(dl.G[2][dl.H[2]+hc],0,fc),sr(dl.G[3][dl.H[3]+hc],24,fc))}}}pi.vc=Si,pi.Wb=os,pi.Ya=Em,pi.yc=Fy,rr=1;break t}rr=0}if(!(re=rr)){H.a=3;break e}if(0<je){if(ue.ua=1<<je,!dt(ue.Wa,je)){H.a=1,re=0;break e}}else ue.ua=0;var Uy=H,o3=ie,mR=se,zy=Uy.s,qy=zy.xc;if(Uy.c=o3,Uy.i=mR,zy.md=nt(o3,qy),zy.wc=qy==0?-1:(1<<qy)-1,B){H.xb=$D;break e}if((we=s(ie*se))==null){H.a=1,re=0;break e}re=(re=wi(H,we,0,ie,se,se,null))&&!le.h;break e}return re?(Z!=null?Z[0]=we:(e(we==null),e(B)),H.$=0,B||fi(ue)):fi(ue),re}function Bi(y,T){var B=y.c*y.i,H=B+T+16*T;return e(y.c<=T),y.V=s(H),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+B+T,1)}function Rs(y,T){var B=y.C,H=T-B,Z=y.V,re=y.Ba+y.c*B;for(e(T<=y.l.o);0<H;){var ie=16<H?16:H,se=y.l.ma,le=y.l.width,ue=le*ie,we=se.ca,je=se.tb+le*B,De=y.Ta,Ee=y.Ua;Pr(y,ie,Z,re),Mr(De,Ee,we,je,ue),hi(se,B,B+ie,we,je,le),H-=ie,Z+=ie*y.c,B+=ie}e(B==T),y.C=y.Ma=T}function to(){this.ub=this.yd=this.td=this.Rb=0}function no(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function To(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function $l(){this.Yb=function(){var y=[];return function T(B,H,Z){for(var re=Z[H],ie=0;ie<re&&(B.push(Z.length>H+1?[]:0),!(Z.length<H+1));ie++)T(B[ie],H+1,Z)}(y,0,[3,11]),y}()}function oa(){this.jb=s(3),this.Wc=a([4,8],$l),this.Xc=a([4,17],$l)}function Wa(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Fs(){this.ld=this.La=this.dd=this.tc=0}function ro(){this.Na=this.la=0}function Ls(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function io(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Gl(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fs),this.Y=0,this.ya=Array(new io),this.aa=0,this.l=new Io}function $a(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Kl(){this.cb=this.a=0,this.sc="",this.m=new ne,this.Od=new to,this.Kc=new no,this.ed=new Wa,this.Qa=new To,this.Ic=this.$c=this.Aa=0,this.D=new Gl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ne),this.ia=0,this.pb=o(4,Ls),this.Pa=new oa,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new $a),this.Hd=0,this.rb=Array(new ro),this.sb=0,this.wa=Array(new Fs),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new io),this.L=this.aa=0,this.gd=a([4,2],Fs),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Io(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ga(){var y=new Kl;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,Cf||(Cf=Ql)),y}function nr(y,T,B){return y.a==0&&(y.a=T,y.sc=B,y.cb=0),0}function Ka(y,T,B){return 3<=B&&y[T+0]==157&&y[T+1]==1&&y[T+2]==42}function Qa(y,T){if(y==null)return 0;if(y.a=0,y.sc="OK",T==null)return nr(y,2,"null VP8Io passed to VP8GetHeaders()");var B=T.data,H=T.w,Z=T.ha;if(4>Z)return nr(y,7,"Truncated header.");var re=B[H+0]|B[H+1]<<8|B[H+2]<<16,ie=y.Od;if(ie.Rb=!(1&re),ie.td=re>>1&7,ie.yd=re>>4&1,ie.ub=re>>5,3<ie.td)return nr(y,3,"Incorrect keyframe parameters.");if(!ie.yd)return nr(y,4,"Frame not displayable.");H+=3,Z-=3;var se=y.Kc;if(ie.Rb){if(7>Z)return nr(y,7,"cannot parse picture header");if(!Ka(B,H,Z))return nr(y,3,"Bad code word");se.c=16383&(B[H+4]<<8|B[H+3]),se.Td=B[H+4]>>6,se.i=16383&(B[H+6]<<8|B[H+5]),se.Ud=B[H+6]>>6,H+=7,Z-=7,y.za=se.c+15>>4,y.Ub=se.i+15>>4,T.width=se.c,T.height=se.i,T.Da=0,T.j=0,T.v=0,T.va=T.width,T.o=T.height,T.da=0,T.ib=T.width,T.hb=T.height,T.U=T.width,T.T=T.height,i((re=y.Pa).jb,0,255,re.jb.length),e((re=y.Qa)!=null),re.Cb=0,re.Bb=0,re.Fb=1,i(re.Zb,0,0,re.Zb.length),i(re.Lb,0,0,re.Lb)}if(ie.ub>Z)return nr(y,7,"bad partition length");q(re=y.m,B,H,ie.ub),H+=ie.ub,Z-=ie.ub,ie.Rb&&(se.Ld=me(re),se.Kd=me(re)),se=y.Qa;var le,ue=y.Pa;if(e(re!=null),e(se!=null),se.Cb=me(re),se.Cb){if(se.Bb=me(re),me(re)){for(se.Fb=me(re),le=0;4>le;++le)se.Zb[le]=me(re)?M(re,7):0;for(le=0;4>le;++le)se.Lb[le]=me(re)?M(re,6):0}if(se.Bb)for(le=0;3>le;++le)ue.jb[le]=me(re)?O(re,8):255}else se.Bb=0;if(re.Ka)return nr(y,3,"cannot parse segment header");if((se=y.ed).zd=me(re),se.Tb=O(re,6),se.wb=O(re,3),se.Pc=me(re),se.Pc&&me(re)){for(ue=0;4>ue;++ue)me(re)&&(se.vd[ue]=M(re,6));for(ue=0;4>ue;++ue)me(re)&&(se.od[ue]=M(re,6))}if(y.L=se.Tb==0?0:se.zd?1:2,re.Ka)return nr(y,3,"cannot parse filter header");var we=Z;if(Z=le=H,H=le+we,se=we,y.Xb=(1<<O(y.m,2))-1,we<3*(ue=y.Xb))B=7;else{for(le+=3*ue,se-=3*ue,we=0;we<ue;++we){var je=B[Z+0]|B[Z+1]<<8|B[Z+2]<<16;je>se&&(je=se),q(y.Jc[+we],B,le,je),le+=je,se-=je,Z+=3}q(y.Jc[+ue],B,le,se),B=le<H?0:5}if(B!=0)return nr(y,B,"cannot parse partitions");for(B=O(le=y.m,7),Z=me(le)?M(le,4):0,H=me(le)?M(le,4):0,se=me(le)?M(le,4):0,ue=me(le)?M(le,4):0,le=me(le)?M(le,4):0,we=y.Qa,je=0;4>je;++je){if(we.Cb){var De=we.Zb[je];we.Fb||(De+=B)}else{if(0<je){y.pb[je]=y.pb[0];continue}De=B}var Ee=y.pb[je];Ee.Sc[0]=jy[Pn(De+Z,127)],Ee.Sc[1]=Dy[Pn(De+0,127)],Ee.Eb[0]=2*jy[Pn(De+H,127)],Ee.Eb[1]=101581*Dy[Pn(De+se,127)]>>16,8>Ee.Eb[1]&&(Ee.Eb[1]=8),Ee.Qc[0]=jy[Pn(De+ue,117)],Ee.Qc[1]=Dy[Pn(De+le,127)],Ee.lc=De+le}if(!ie.Rb)return nr(y,4,"Not a key frame.");for(me(re),ie=y.Pa,B=0;4>B;++B){for(Z=0;8>Z;++Z)for(H=0;3>H;++H)for(se=0;11>se;++se)ue=_e(re,HD[B][Z][H][se])?O(re,8):zD[B][Z][H][se],ie.Wc[B][Z].Yb[H][se]=ue;for(Z=0;17>Z;++Z)ie.Xc[B][Z]=ie.Wc[B][WD[Z]]}return y.kc=me(re),y.kc&&(y.Bd=O(re,8)),y.cb=1}function Ql(y,T,B,H,Z,re,ie){var se=T[Z].Yb[B];for(B=0;16>Z;++Z){if(!_e(y,se[B+0]))return Z;for(;!_e(y,se[B+1]);)if(se=T[++Z].Yb[0],B=0,Z==16)return 16;var le=T[Z+1].Yb;if(_e(y,se[B+2])){var ue=y,we=0;if(_e(ue,(De=se)[(je=B)+3]))if(_e(ue,De[je+6])){for(se=0,je=2*(we=_e(ue,De[je+8]))+(De=_e(ue,De[je+9+we])),we=0,De=VD[je];De[se];++se)we+=we+_e(ue,De[se]);we+=3+(8<<je)}else _e(ue,De[je+7])?(we=7+2*_e(ue,165),we+=_e(ue,145)):we=5+_e(ue,159);else we=_e(ue,De[je+4])?3+_e(ue,De[je+5]):2;se=le[2]}else we=1,se=le[1];le=ie+UD[Z],0>(ue=y).b&&ye(ue);var je,De=ue.b,Ee=(je=ue.Ca>>1)-(ue.I>>De)>>31;--ue.b,ue.Ca+=Ee,ue.Ca|=1,ue.I-=(je+1&Ee)<<De,re[le]=((we^Ee)-Ee)*H[(0<Z)+0]}return 16}function Ya(y){var T=y.rb[y.sb-1];T.la=0,T.Na=0,i(y.zc,0,0,y.zc.length),y.ja=0}function Yl(y,T){if(y==null)return 0;if(T==null)return nr(y,2,"NULL VP8Io parameter in VP8Decode().");if(!y.cb&&!Qa(y,T))return 0;if(e(y.cb),T.ac==null||T.ac(T)){T.ob&&(y.L=0);var B=Sm[y.L];if(y.L==2?(y.yb=0,y.zb=0):(y.yb=T.v-B>>4,y.zb=T.j-B>>4,0>y.yb&&(y.yb=0),0>y.zb&&(y.zb=0)),y.Va=T.o+15+B>>4,y.Hb=T.va+15+B>>4,y.Hb>y.za&&(y.Hb=y.za),y.Va>y.Ub&&(y.Va=y.Ub),0<y.L){var H=y.ed;for(B=0;4>B;++B){var Z;if(y.Qa.Cb){var re=y.Qa.Lb[B];y.Qa.Fb||(re+=H.Tb)}else re=H.Tb;for(Z=0;1>=Z;++Z){var ie=y.gd[B][Z],se=re;if(H.Pc&&(se+=H.vd[0],Z&&(se+=H.od[0])),0<(se=0>se?0:63<se?63:se)){var le=se;0<H.wb&&(le=4<H.wb?le>>2:le>>1)>9-H.wb&&(le=9-H.wb),1>le&&(le=1),ie.dd=le,ie.tc=2*se+le,ie.ld=40<=se?2:15<=se?1:0}else ie.tc=0;ie.La=Z}}}B=0}else nr(y,6,"Frame setup failed"),B=y.a;if(B=B==0){if(B){y.$c=0,0<y.Aa||(y.Ic=iR);e:{B=y.Ic,H=4*(le=y.za);var ue=32*le,we=le+1,je=0<y.L?le*(0<y.Aa?2:1):0,De=(y.Aa==2?2:1)*le;if((ie=H+832+(Z=3*(16*B+Sm[y.L])/2*ue)+(re=y.Fa!=null&&0<y.Fa.length?y.Kc.c*y.Kc.i:0))!=ie)B=0;else{if(ie>y.Vb){if(y.Vb=0,y.Ec=s(ie),y.Fc=0,y.Ec==null){B=nr(y,1,"no memory during frame initialization.");break e}y.Vb=ie}ie=y.Ec,se=y.Fc,y.Ac=ie,y.Bc=se,se+=H,y.Gd=o(ue,$a),y.Hd=0,y.rb=o(we+1,ro),y.sb=1,y.wa=je?o(je,Fs):null,y.Y=0,y.D.Nb=0,y.D.wa=y.wa,y.D.Y=y.Y,0<y.Aa&&(y.D.Y+=le),e(!0),y.oc=ie,y.pc=se,se+=832,y.ya=o(De,io),y.aa=0,y.D.ya=y.ya,y.D.aa=y.aa,y.Aa==2&&(y.D.aa+=le),y.R=16*le,y.B=8*le,le=(ue=Sm[y.L])*y.R,ue=ue/2*y.B,y.sa=ie,y.ta=se+le,y.qa=y.sa,y.ra=y.ta+16*B*y.R+ue,y.Ha=y.qa,y.Ia=y.ra+8*B*y.B+ue,y.$c=0,se+=Z,y.mb=re?ie:null,y.nb=re?se:null,e(se+re<=y.Fc+y.Vb),Ya(y),i(y.Ac,y.Bc,0,H),B=1}}if(B){if(T.ka=0,T.y=y.sa,T.O=y.ta,T.f=y.qa,T.N=y.ra,T.ea=y.Ha,T.Vd=y.Ia,T.fa=y.R,T.Rc=y.B,T.F=null,T.J=0,!gm){for(B=-255;255>=B;++B)ti[255+B]=0>B?-B:B;for(B=-1020;1020>=B;++B)ll[1020+B]=-128>B?-128:127<B?127:B;for(B=-112;112>=B;++B)Ef[112+B]=-16>B?-16:15<B?15:B;for(B=-255;510>=B;++B)Wd[255+B]=0>B?0:255<B?255:B;gm=1}zd=oo,al=aa,Nf=Xa,ss=Ln,ho=so,Lr=Do,qd=Fe,mm=Le,Af=et,Au=it,Su=Ve,sc=rt,Eu=He,Hd=tt,Cu=Y,oc=te,Sf=oe,fo=ge,Bo[0]=ns,Bo[1]=bu,Bo[2]=lo,Bo[3]=Za,Bo[4]=Ro,Bo[5]=co,Bo[6]=Ai,Bo[7]=ua,Bo[8]=da,Bo[9]=Fo,ac[0]=ao,ac[1]=wu,ac[2]=gs,ac[3]=la,ac[4]=Jn,ac[5]=Jl,ac[6]=Ja,cl[0]=Bs,cl[1]=Xl,cl[2]=ha,cl[3]=Ms,cl[4]=jn,cl[5]=fa,cl[6]=el,B=1}else B=0}B&&(B=function(Ee,Qe){for(Ee.M=0;Ee.M<Ee.Va;++Ee.M){var Be,Ne=Ee.Jc[Ee.M&Ee.Xb],Ae=Ee.m,Ge=Ee;for(Be=0;Be<Ge.za;++Be){var Ze=Ae,Ke=Ge,At=Ke.Ac,xt=Ke.Bc+4*Be,Gt=Ke.zc,vt=Ke.ya[Ke.aa+Be];if(Ke.Qa.Bb?vt.$b=_e(Ze,Ke.Pa.jb[0])?2+_e(Ze,Ke.Pa.jb[2]):_e(Ze,Ke.Pa.jb[1]):vt.$b=0,Ke.kc&&(vt.Ad=_e(Ze,Ke.Bd)),vt.Za=!_e(Ze,145)+0,vt.Za){var Bn=vt.Ob,Wn=0;for(Ke=0;4>Ke;++Ke){var kn,bn=Gt[0+Ke];for(kn=0;4>kn;++kn){bn=qD[At[xt+kn]][bn];for(var rr=L4[_e(Ze,bn[0])];0<rr;)rr=L4[2*rr+_e(Ze,bn[rr])];bn=-rr,At[xt+kn]=bn}r(Bn,Wn,At,xt,4),Wn+=4,Gt[0+Ke]=bn}}else bn=_e(Ze,156)?_e(Ze,128)?1:3:_e(Ze,163)?2:0,vt.Ob[0]=bn,i(At,xt,bn,4),i(Gt,0,bn,4);vt.Dd=_e(Ze,142)?_e(Ze,114)?_e(Ze,183)?1:3:2:0}if(Ge.m.Ka)return nr(Ee,7,"Premature end-of-partition0 encountered.");for(;Ee.ja<Ee.za;++Ee.ja){if(Ge=Ne,Ze=(Ae=Ee).rb[Ae.sb-1],At=Ae.rb[Ae.sb+Ae.ja],Be=Ae.ya[Ae.aa+Ae.ja],xt=Ae.kc?Be.Ad:0)Ze.la=At.la=0,Be.Za||(Ze.Na=At.Na=0),Be.Hc=0,Be.Gc=0,Be.ia=0;else{var Zn,hn;if(Ze=At,At=Ge,xt=Ae.Pa.Xc,Gt=Ae.ya[Ae.aa+Ae.ja],vt=Ae.pb[Gt.$b],Ke=Gt.ad,Bn=0,Wn=Ae.rb[Ae.sb-1],bn=kn=0,i(Ke,Bn,0,384),Gt.Za)var Gr=0,vs=xt[3];else{rr=s(16);var Kr=Ze.Na+Wn.Na;if(Kr=Cf(At,xt[1],Kr,vt.Eb,0,rr,0),Ze.Na=Wn.Na=(0<Kr)+0,1<Kr)zd(rr,0,Ke,Bn);else{var bs=rr[0]+3>>3;for(rr=0;256>rr;rr+=16)Ke[Bn+rr]=bs}Gr=1,vs=xt[0]}var $n=15&Ze.la,zs=15&Wn.la;for(rr=0;4>rr;++rr){var qs=1&zs;for(bs=hn=0;4>bs;++bs)$n=$n>>1|(qs=(Kr=Cf(At,vs,Kr=qs+(1&$n),vt.Sc,Gr,Ke,Bn))>Gr)<<7,hn=hn<<2|(3<Kr?3:1<Kr?2:Ke[Bn+0]!=0),Bn+=16;$n>>=4,zs=zs>>1|qs<<7,kn=(kn<<8|hn)>>>0}for(vs=$n,Gr=zs>>4,Zn=0;4>Zn;Zn+=2){for(hn=0,$n=Ze.la>>4+Zn,zs=Wn.la>>4+Zn,rr=0;2>rr;++rr){for(qs=1&zs,bs=0;2>bs;++bs)Kr=qs+(1&$n),$n=$n>>1|(qs=0<(Kr=Cf(At,xt[2],Kr,vt.Qc,0,Ke,Bn)))<<3,hn=hn<<2|(3<Kr?3:1<Kr?2:Ke[Bn+0]!=0),Bn+=16;$n>>=2,zs=zs>>1|qs<<5}bn|=hn<<4*Zn,vs|=$n<<4<<Zn,Gr|=(240&zs)<<Zn}Ze.la=vs,Wn.la=Gr,Gt.Hc=kn,Gt.Gc=bn,Gt.ia=43690&bn?0:vt.ia,xt=!(kn|bn)}if(0<Ae.L&&(Ae.wa[Ae.Y+Ae.ja]=Ae.gd[Be.$b][Be.Za],Ae.wa[Ae.Y+Ae.ja].La|=!xt),Ge.Ka)return nr(Ee,7,"Premature end-of-file encountered.")}if(Ya(Ee),Ae=Qe,Ge=1,Be=(Ne=Ee).D,Ze=0<Ne.L&&Ne.M>=Ne.zb&&Ne.M<=Ne.Va,Ne.Aa==0)e:{if(Be.M=Ne.M,Be.uc=Ze,uo(Ne,Be),Ge=1,Be=(hn=Ne.D).Nb,Ze=(bn=Sm[Ne.L])*Ne.R,At=bn/2*Ne.B,rr=16*Be*Ne.R,bs=8*Be*Ne.B,xt=Ne.sa,Gt=Ne.ta-Ze+rr,vt=Ne.qa,Ke=Ne.ra-At+bs,Bn=Ne.Ha,Wn=Ne.Ia-At+bs,zs=($n=hn.M)==0,kn=$n>=Ne.Va-1,Ne.Aa==2&&uo(Ne,hn),hn.uc)for(qs=(Kr=Ne).D.M,e(Kr.D.uc),hn=Kr.yb;hn<Kr.Hb;++hn){Gr=hn,vs=qs;var pi=(Si=(Tr=Kr).D).Nb;Zn=Tr.R;var Si=Si.wa[Si.Y+Gr],os=Tr.sa,xo=Tr.ta+16*pi*Zn+16*Gr,xa=Si.dd,mi=Si.tc;if(mi!=0)if(e(3<=mi),Tr.L==1)0<Gr&&oc(os,xo,Zn,mi+4),Si.La&&fo(os,xo,Zn,mi),0<vs&&Cu(os,xo,Zn,mi+4),Si.La&&Sf(os,xo,Zn,mi);else{var ul=Tr.B,Pu=Tr.qa,$d=Tr.ra+8*pi*ul+8*Gr,cc=Tr.Ha,Tr=Tr.Ia+8*pi*ul+8*Gr;pi=Si.ld,0<Gr&&(mm(os,xo,Zn,mi+4,xa,pi),Au(Pu,$d,cc,Tr,ul,mi+4,xa,pi)),Si.La&&(sc(os,xo,Zn,mi,xa,pi),Hd(Pu,$d,cc,Tr,ul,mi,xa,pi)),0<vs&&(qd(os,xo,Zn,mi+4,xa,pi),Af(Pu,$d,cc,Tr,ul,mi+4,xa,pi)),Si.La&&(Su(os,xo,Zn,mi,xa,pi),Eu(Pu,$d,cc,Tr,ul,mi,xa,pi))}}if(Ne.ia&&alert("todo:DitherRow"),Ae.put!=null){if(hn=16*$n,$n=16*($n+1),zs?(Ae.y=Ne.sa,Ae.O=Ne.ta+rr,Ae.f=Ne.qa,Ae.N=Ne.ra+bs,Ae.ea=Ne.Ha,Ae.W=Ne.Ia+bs):(hn-=bn,Ae.y=xt,Ae.O=Gt,Ae.f=vt,Ae.N=Ke,Ae.ea=Bn,Ae.W=Wn),kn||($n-=bn),$n>Ae.o&&($n=Ae.o),Ae.F=null,Ae.J=null,Ne.Fa!=null&&0<Ne.Fa.length&&hn<$n&&(Ae.J=Zt(Ne,Ae,hn,$n-hn),Ae.F=Ne.mb,Ae.F==null&&Ae.F.length==0)){Ge=nr(Ne,3,"Could not decode alpha data.");break e}hn<Ae.j&&(bn=Ae.j-hn,hn=Ae.j,e(!(1&bn)),Ae.O+=Ne.R*bn,Ae.N+=Ne.B*(bn>>1),Ae.W+=Ne.B*(bn>>1),Ae.F!=null&&(Ae.J+=Ae.width*bn)),hn<$n&&(Ae.O+=Ae.v,Ae.N+=Ae.v>>1,Ae.W+=Ae.v>>1,Ae.F!=null&&(Ae.J+=Ae.v),Ae.ka=hn-Ae.j,Ae.U=Ae.va-Ae.v,Ae.T=$n-hn,Ge=Ae.put(Ae))}Be+1!=Ne.Ic||kn||(r(Ne.sa,Ne.ta-Ze,xt,Gt+16*Ne.R,Ze),r(Ne.qa,Ne.ra-At,vt,Ke+8*Ne.B,At),r(Ne.Ha,Ne.Ia-At,Bn,Wn+8*Ne.B,At))}if(!Ge)return nr(Ee,6,"Output aborted.")}return 1}(y,T)),T.bc!=null&&T.bc(T),B&=1}return B?(y.cb=0,B):0}function Oi(y,T,B,H,Z){Z=y[T+B+32*H]+(Z>>3),y[T+B+32*H]=-256&Z?0>Z?0:255:Z}function jo(y,T,B,H,Z,re){Oi(y,T,0,B,H+Z),Oi(y,T,1,B,H+re),Oi(y,T,2,B,H-re),Oi(y,T,3,B,H-Z)}function xr(y){return(20091*y>>16)+y}function Ni(y,T,B,H){var Z,re=0,ie=s(16);for(Z=0;4>Z;++Z){var se=y[T+0]+y[T+8],le=y[T+0]-y[T+8],ue=(35468*y[T+4]>>16)-xr(y[T+12]),we=xr(y[T+4])+(35468*y[T+12]>>16);ie[re+0]=se+we,ie[re+1]=le+ue,ie[re+2]=le-ue,ie[re+3]=se-we,re+=4,T++}for(Z=re=0;4>Z;++Z)se=(y=ie[re+0]+4)+ie[re+8],le=y-ie[re+8],ue=(35468*ie[re+4]>>16)-xr(ie[re+12]),Oi(B,H,0,0,se+(we=xr(ie[re+4])+(35468*ie[re+12]>>16))),Oi(B,H,1,0,le+ue),Oi(B,H,2,0,le-ue),Oi(B,H,3,0,se-we),re++,H+=32}function Do(y,T,B,H){var Z=y[T+0]+4,re=35468*y[T+4]>>16,ie=xr(y[T+4]),se=35468*y[T+1]>>16;jo(B,H,0,Z+ie,y=xr(y[T+1]),se),jo(B,H,1,Z+re,y,se),jo(B,H,2,Z-re,y,se),jo(B,H,3,Z-ie,y,se)}function aa(y,T,B,H,Z){Ni(y,T,B,H),Z&&Ni(y,T+16,B,H+4)}function Xa(y,T,B,H){al(y,T+0,B,H,1),al(y,T+32,B,H+128,1)}function Ln(y,T,B,H){var Z;for(y=y[T+0]+4,Z=0;4>Z;++Z)for(T=0;4>T;++T)Oi(B,H,T,Z,y)}function so(y,T,B,H){y[T+0]&&ss(y,T+0,B,H),y[T+16]&&ss(y,T+16,B,H+4),y[T+32]&&ss(y,T+32,B,H+128),y[T+48]&&ss(y,T+48,B,H+128+4)}function oo(y,T,B,H){var Z,re=s(16);for(Z=0;4>Z;++Z){var ie=y[T+0+Z]+y[T+12+Z],se=y[T+4+Z]+y[T+8+Z],le=y[T+4+Z]-y[T+8+Z],ue=y[T+0+Z]-y[T+12+Z];re[0+Z]=ie+se,re[8+Z]=ie-se,re[4+Z]=ue+le,re[12+Z]=ue-le}for(Z=0;4>Z;++Z)ie=(y=re[0+4*Z]+3)+re[3+4*Z],se=re[1+4*Z]+re[2+4*Z],le=re[1+4*Z]-re[2+4*Z],ue=y-re[3+4*Z],B[H+0]=ie+se>>3,B[H+16]=ue+le>>3,B[H+32]=ie-se>>3,B[H+48]=ue-le>>3,H+=64}function ms(y,T,B){var H,Z=T-32,re=Us,ie=255-y[Z-1];for(H=0;H<B;++H){var se,le=re,ue=ie+y[T-1];for(se=0;se<B;++se)y[T+se]=le[ue+y[Z+se]];T+=32}}function bu(y,T){ms(y,T,4)}function Xl(y,T){ms(y,T,8)}function wu(y,T){ms(y,T,16)}function gs(y,T){var B;for(B=0;16>B;++B)r(y,T+32*B,y,T-32,16)}function la(y,T){var B;for(B=16;0<B;--B)i(y,T,y[T-1],16),T+=32}function ca(y,T,B){var H;for(H=0;16>H;++H)i(T,B+32*H,y,16)}function ao(y,T){var B,H=16;for(B=0;16>B;++B)H+=y[T-1+32*B]+y[T+B-32];ca(H>>5,y,T)}function Jn(y,T){var B,H=8;for(B=0;16>B;++B)H+=y[T-1+32*B];ca(H>>4,y,T)}function Jl(y,T){var B,H=8;for(B=0;16>B;++B)H+=y[T+B-32];ca(H>>4,y,T)}function Ja(y,T){ca(128,y,T)}function Qt(y,T,B){return y+2*T+B+2>>2}function lo(y,T){var B,H=T-32;for(H=new Uint8Array([Qt(y[H-1],y[H+0],y[H+1]),Qt(y[H+0],y[H+1],y[H+2]),Qt(y[H+1],y[H+2],y[H+3]),Qt(y[H+2],y[H+3],y[H+4])]),B=0;4>B;++B)r(y,T+32*B,H,0,H.length)}function Za(y,T){var B=y[T-1],H=y[T-1+32],Z=y[T-1+64],re=y[T-1+96];Se(y,T+0,16843009*Qt(y[T-1-32],B,H)),Se(y,T+32,16843009*Qt(B,H,Z)),Se(y,T+64,16843009*Qt(H,Z,re)),Se(y,T+96,16843009*Qt(Z,re,re))}function ns(y,T){var B,H=4;for(B=0;4>B;++B)H+=y[T+B-32]+y[T-1+32*B];for(H>>=3,B=0;4>B;++B)i(y,T+32*B,H,4)}function Ro(y,T){var B=y[T-1+0],H=y[T-1+32],Z=y[T-1+64],re=y[T-1-32],ie=y[T+0-32],se=y[T+1-32],le=y[T+2-32],ue=y[T+3-32];y[T+0+96]=Qt(H,Z,y[T-1+96]),y[T+1+96]=y[T+0+64]=Qt(B,H,Z),y[T+2+96]=y[T+1+64]=y[T+0+32]=Qt(re,B,H),y[T+3+96]=y[T+2+64]=y[T+1+32]=y[T+0+0]=Qt(ie,re,B),y[T+3+64]=y[T+2+32]=y[T+1+0]=Qt(se,ie,re),y[T+3+32]=y[T+2+0]=Qt(le,se,ie),y[T+3+0]=Qt(ue,le,se)}function Ai(y,T){var B=y[T+1-32],H=y[T+2-32],Z=y[T+3-32],re=y[T+4-32],ie=y[T+5-32],se=y[T+6-32],le=y[T+7-32];y[T+0+0]=Qt(y[T+0-32],B,H),y[T+1+0]=y[T+0+32]=Qt(B,H,Z),y[T+2+0]=y[T+1+32]=y[T+0+64]=Qt(H,Z,re),y[T+3+0]=y[T+2+32]=y[T+1+64]=y[T+0+96]=Qt(Z,re,ie),y[T+3+32]=y[T+2+64]=y[T+1+96]=Qt(re,ie,se),y[T+3+64]=y[T+2+96]=Qt(ie,se,le),y[T+3+96]=Qt(se,le,le)}function co(y,T){var B=y[T-1+0],H=y[T-1+32],Z=y[T-1+64],re=y[T-1-32],ie=y[T+0-32],se=y[T+1-32],le=y[T+2-32],ue=y[T+3-32];y[T+0+0]=y[T+1+64]=re+ie+1>>1,y[T+1+0]=y[T+2+64]=ie+se+1>>1,y[T+2+0]=y[T+3+64]=se+le+1>>1,y[T+3+0]=le+ue+1>>1,y[T+0+96]=Qt(Z,H,B),y[T+0+64]=Qt(H,B,re),y[T+0+32]=y[T+1+96]=Qt(B,re,ie),y[T+1+32]=y[T+2+96]=Qt(re,ie,se),y[T+2+32]=y[T+3+96]=Qt(ie,se,le),y[T+3+32]=Qt(se,le,ue)}function ua(y,T){var B=y[T+0-32],H=y[T+1-32],Z=y[T+2-32],re=y[T+3-32],ie=y[T+4-32],se=y[T+5-32],le=y[T+6-32],ue=y[T+7-32];y[T+0+0]=B+H+1>>1,y[T+1+0]=y[T+0+64]=H+Z+1>>1,y[T+2+0]=y[T+1+64]=Z+re+1>>1,y[T+3+0]=y[T+2+64]=re+ie+1>>1,y[T+0+32]=Qt(B,H,Z),y[T+1+32]=y[T+0+96]=Qt(H,Z,re),y[T+2+32]=y[T+1+96]=Qt(Z,re,ie),y[T+3+32]=y[T+2+96]=Qt(re,ie,se),y[T+3+64]=Qt(ie,se,le),y[T+3+96]=Qt(se,le,ue)}function Fo(y,T){var B=y[T-1+0],H=y[T-1+32],Z=y[T-1+64],re=y[T-1+96];y[T+0+0]=B+H+1>>1,y[T+2+0]=y[T+0+32]=H+Z+1>>1,y[T+2+32]=y[T+0+64]=Z+re+1>>1,y[T+1+0]=Qt(B,H,Z),y[T+3+0]=y[T+1+32]=Qt(H,Z,re),y[T+3+32]=y[T+1+64]=Qt(Z,re,re),y[T+3+64]=y[T+2+64]=y[T+0+96]=y[T+1+96]=y[T+2+96]=y[T+3+96]=re}function da(y,T){var B=y[T-1+0],H=y[T-1+32],Z=y[T-1+64],re=y[T-1+96],ie=y[T-1-32],se=y[T+0-32],le=y[T+1-32],ue=y[T+2-32];y[T+0+0]=y[T+2+32]=B+ie+1>>1,y[T+0+32]=y[T+2+64]=H+B+1>>1,y[T+0+64]=y[T+2+96]=Z+H+1>>1,y[T+0+96]=re+Z+1>>1,y[T+3+0]=Qt(se,le,ue),y[T+2+0]=Qt(ie,se,le),y[T+1+0]=y[T+3+32]=Qt(B,ie,se),y[T+1+32]=y[T+3+64]=Qt(H,B,ie),y[T+1+64]=y[T+3+96]=Qt(Z,H,B),y[T+1+96]=Qt(re,Z,H)}function ha(y,T){var B;for(B=0;8>B;++B)r(y,T+32*B,y,T-32,8)}function Ms(y,T){var B;for(B=0;8>B;++B)i(y,T,y[T-1],8),T+=32}function rs(y,T,B){var H;for(H=0;8>H;++H)i(T,B+32*H,y,8)}function Bs(y,T){var B,H=8;for(B=0;8>B;++B)H+=y[T+B-32]+y[T-1+32*B];rs(H>>4,y,T)}function fa(y,T){var B,H=4;for(B=0;8>B;++B)H+=y[T+B-32];rs(H>>3,y,T)}function jn(y,T){var B,H=4;for(B=0;8>B;++B)H+=y[T-1+32*B];rs(H>>3,y,T)}function el(y,T){rs(128,y,T)}function pa(y,T,B){var H=y[T-B],Z=y[T+0],re=3*(Z-H)+Cy[1020+y[T-2*B]-y[T+B]],ie=xm[112+(re+4>>3)];y[T-B]=Us[255+H+xm[112+(re+3>>3)]],y[T+0]=Us[255+Z-ie]}function tl(y,T,B,H){var Z=y[T+0],re=y[T+B];return mo[255+y[T-2*B]-y[T-B]]>H||mo[255+re-Z]>H}function Lo(y,T,B,H){return 4*mo[255+y[T-B]-y[T+0]]+mo[255+y[T-2*B]-y[T+B]]<=H}function L(y,T,B,H,Z){var re=y[T-3*B],ie=y[T-2*B],se=y[T-B],le=y[T+0],ue=y[T+B],we=y[T+2*B],je=y[T+3*B];return 4*mo[255+se-le]+mo[255+ie-ue]>H?0:mo[255+y[T-4*B]-re]<=Z&&mo[255+re-ie]<=Z&&mo[255+ie-se]<=Z&&mo[255+je-we]<=Z&&mo[255+we-ue]<=Z&&mo[255+ue-le]<=Z}function Y(y,T,B,H){var Z=2*H+1;for(H=0;16>H;++H)Lo(y,T+H,B,Z)&&pa(y,T+H,B)}function te(y,T,B,H){var Z=2*H+1;for(H=0;16>H;++H)Lo(y,T+H*B,1,Z)&&pa(y,T+H*B,1)}function oe(y,T,B,H){var Z;for(Z=3;0<Z;--Z)Y(y,T+=4*B,B,H)}function ge(y,T,B,H){var Z;for(Z=3;0<Z;--Z)te(y,T+=4,B,H)}function de(y,T,B,H,Z,re,ie,se){for(re=2*re+1;0<Z--;){if(L(y,T,B,re,ie))if(tl(y,T,B,se))pa(y,T,B);else{var le=y,ue=T,we=B,je=le[ue-2*we],De=le[ue-we],Ee=le[ue+0],Qe=le[ue+we],Be=le[ue+2*we],Ne=27*(Ge=Cy[1020+3*(Ee-De)+Cy[1020+je-Qe]])+63>>7,Ae=18*Ge+63>>7,Ge=9*Ge+63>>7;le[ue-3*we]=Us[255+le[ue-3*we]+Ge],le[ue-2*we]=Us[255+je+Ae],le[ue-we]=Us[255+De+Ne],le[ue+0]=Us[255+Ee-Ne],le[ue+we]=Us[255+Qe-Ae],le[ue+2*we]=Us[255+Be-Ge]}T+=H}}function xe(y,T,B,H,Z,re,ie,se){for(re=2*re+1;0<Z--;){if(L(y,T,B,re,ie))if(tl(y,T,B,se))pa(y,T,B);else{var le=y,ue=T,we=B,je=le[ue-we],De=le[ue+0],Ee=le[ue+we],Qe=xm[112+((Be=3*(De-je))+4>>3)],Be=xm[112+(Be+3>>3)],Ne=Qe+1>>1;le[ue-2*we]=Us[255+le[ue-2*we]+Ne],le[ue-we]=Us[255+je+Be],le[ue+0]=Us[255+De-Qe],le[ue+we]=Us[255+Ee-Ne]}T+=H}}function Fe(y,T,B,H,Z,re){de(y,T,B,1,16,H,Z,re)}function Le(y,T,B,H,Z,re){de(y,T,1,B,16,H,Z,re)}function Ve(y,T,B,H,Z,re){var ie;for(ie=3;0<ie;--ie)xe(y,T+=4*B,B,1,16,H,Z,re)}function rt(y,T,B,H,Z,re){var ie;for(ie=3;0<ie;--ie)xe(y,T+=4,1,B,16,H,Z,re)}function et(y,T,B,H,Z,re,ie,se){de(y,T,Z,1,8,re,ie,se),de(B,H,Z,1,8,re,ie,se)}function it(y,T,B,H,Z,re,ie,se){de(y,T,1,Z,8,re,ie,se),de(B,H,1,Z,8,re,ie,se)}function He(y,T,B,H,Z,re,ie,se){xe(y,T+4*Z,Z,1,8,re,ie,se),xe(B,H+4*Z,Z,1,8,re,ie,se)}function tt(y,T,B,H,Z,re,ie,se){xe(y,T+4,1,Z,8,re,ie,se),xe(B,H+4,1,Z,8,re,ie,se)}function ht(){this.ba=new mr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new pn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function St(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function $t(){this.ua=0,this.Wa=new fe,this.vb=new fe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new F,this.yc=new P}function Ct(){this.xb=this.a=0,this.l=new Io,this.ca=new mr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new V,this.Pb=0,this.wd=new V,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new $t,this.ab=0,this.gc=o(4,St),this.Oc=0}function st(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Io,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ut(y,T,B,H,Z,re,ie){for(y=y==null?0:y[T+0],T=0;T<ie;++T)Z[re+T]=y+B[H+T]&255,y=Z[re+T]}function bt(y,T,B,H,Z,re,ie){var se;if(y==null)Ut(null,null,B,H,Z,re,ie);else for(se=0;se<ie;++se)Z[re+se]=y[T+se]+B[H+se]&255}function Pt(y,T,B,H,Z,re,ie){if(y==null)Ut(null,null,B,H,Z,re,ie);else{var se,le=y[T+0],ue=le,we=le;for(se=0;se<ie;++se)ue=we+(le=y[T+se])-ue,we=B[H+se]+(-256&ue?0>ue?0:255:ue)&255,ue=le,Z[re+se]=we}}function Zt(y,T,B,H){var Z=T.width,re=T.o;if(e(y!=null&&T!=null),0>B||0>=H||B+H>re)return null;if(!y.Cc){if(y.ga==null){var ie;if(y.ga=new st,(ie=y.ga==null)||(ie=T.width*T.o,e(y.Gb.length==0),y.Gb=s(ie),y.Uc=0,y.Gb==null?ie=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,ie=1),ie=!ie),!ie){ie=y.ga;var se=y.Fa,le=y.P,ue=y.qc,we=y.mb,je=y.nb,De=le+1,Ee=ue-1,Qe=ie.l;if(e(se!=null&&we!=null&&T!=null),lc[0]=null,lc[1]=Ut,lc[2]=bt,lc[3]=Pt,ie.ca=we,ie.tb=je,ie.c=T.width,ie.i=T.height,e(0<ie.c&&0<ie.i),1>=ue)T=0;else if(ie.$a=se[le+0]>>0&3,ie.Z=se[le+0]>>2&3,ie.Lc=se[le+0]>>4&3,le=se[le+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||le)T=0;else if(Qe.put=Hn,Qe.ac=In,Qe.bc=di,Qe.ma=ie,Qe.width=T.width,Qe.height=T.height,Qe.Da=T.Da,Qe.v=T.v,Qe.va=T.va,Qe.j=T.j,Qe.o=T.o,ie.$a)e:{e(ie.$a==1),T=gr();t:for(;;){if(T==null){T=0;break e}if(e(ie!=null),ie.mc=T,T.c=ie.c,T.i=ie.i,T.l=ie.l,T.l.ma=ie,T.l.width=ie.c,T.l.height=ie.i,T.a=0,W(T.m,se,De,Ee),!_i(ie.c,ie.i,1,T,null)||(T.ab==1&&T.gc[0].hc==3&&Ds(T.s)?(ie.ic=1,se=T.c*T.i,T.Ta=null,T.Ua=0,T.V=s(se),T.Ba=0,T.V==null?(T.a=1,T=0):T=1):(ie.ic=0,T=Bi(T,ie.c)),!T))break t;T=1;break e}ie.mc=null,T=0}else T=Ee>=ie.c*ie.i;ie=!T}if(ie)return null;y.ga.Lc!=1?y.Ga=0:H=re-B}e(y.ga!=null),e(B+H<=re);e:{if(T=(se=y.ga).c,re=se.l.o,se.$a==0){if(De=y.rc,Ee=y.Vc,Qe=y.Fa,le=y.P+1+B*T,ue=y.mb,we=y.nb+B*T,e(le<=y.P+y.qc),se.Z!=0)for(e(lc[se.Z]!=null),ie=0;ie<H;++ie)lc[se.Z](De,Ee,Qe,le,ue,we,T),De=ue,Ee=we,we+=T,le+=T;else for(ie=0;ie<H;++ie)r(ue,we,Qe,le,T),De=ue,Ee=we,we+=T,le+=T;y.rc=De,y.Vc=Ee}else{if(e(se.mc!=null),T=B+H,e((ie=se.mc)!=null),e(T<=ie.i),ie.C>=T)T=1;else if(se.ic||ve(),se.ic){se=ie.V,De=ie.Ba,Ee=ie.c;var Be=ie.i,Ne=(Qe=1,le=ie.$/Ee,ue=ie.$%Ee,we=ie.m,je=ie.s,ie.$),Ae=Ee*Be,Ge=Ee*T,Ze=je.wc,Ke=Ne<Ge?tr(je,ue,le):null;e(Ne<=Ae),e(T<=Be),e(Ds(je));t:for(;;){for(;!we.h&&Ne<Ge;){if(ue&Ze||(Ke=tr(je,ue,le)),e(Ke!=null),ae(we),256>(Be=Fn(Ke.G[0],Ke.H[0],we)))se[De+Ne]=Be,++Ne,++ue>=Ee&&(ue=0,++le<=T&&!(le%16)&&Mi(ie,le));else{if(!(280>Be)){Qe=0;break t}Be=Wr(Be-256,we);var At,xt=Fn(Ke.G[4],Ke.H[4],we);if(ae(we),!(Ne>=(xt=Cn(Ee,xt=Wr(xt,we)))&&Ae-Ne>=Be)){Qe=0;break t}for(At=0;At<Be;++At)se[De+Ne+At]=se[De+Ne+At-xt];for(Ne+=Be,ue+=Be;ue>=Ee;)ue-=Ee,++le<=T&&!(le%16)&&Mi(ie,le);Ne<Ge&&ue&Ze&&(Ke=tr(je,ue,le))}e(we.h==K(we))}Mi(ie,le>T?T:le);break t}!Qe||we.h&&Ne<Ae?(Qe=0,ie.a=we.h?5:3):ie.$=Ne,T=Qe}else T=wi(ie,ie.V,ie.Ba,ie.c,ie.i,T,Rs);if(!T){H=0;break e}}B+H>=re&&(y.Cc=1),H=1}if(!H)return null;if(y.Cc&&((H=y.ga)!=null&&(H.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+B*Z}function R(y,T,B,H,Z,re){for(;0<Z--;){var ie,se=y,le=T+(B?1:0),ue=y,we=T+(B?0:3);for(ie=0;ie<H;++ie){var je=ue[we+4*ie];je!=255&&(je*=32897,se[le+4*ie+0]=se[le+4*ie+0]*je>>23,se[le+4*ie+1]=se[le+4*ie+1]*je>>23,se[le+4*ie+2]=se[le+4*ie+2]*je>>23)}T+=re}}function Q(y,T,B,H,Z){for(;0<H--;){var re;for(re=0;re<B;++re){var ie=y[T+2*re+0],se=15&(ue=y[T+2*re+1]),le=4369*se,ue=(240&ue|ue>>4)*le>>16;y[T+2*re+0]=(240&ie|ie>>4)*le>>16&240|(15&ie|ie<<4)*le>>16>>4&15,y[T+2*re+1]=240&ue|se}T+=Z}}function ce(y,T,B,H,Z,re,ie,se){var le,ue,we=255;for(ue=0;ue<Z;++ue){for(le=0;le<H;++le){var je=y[T+le];re[ie+4*le]=je,we&=je}T+=B,ie+=se}return we!=255}function pe(y,T,B,H,Z){var re;for(re=0;re<Z;++re)B[H+re]=y[T+re]>>8}function ve(){po=R,ar=Q,lr=ce,Mr=pe}function Te(y,T,B){v[y]=function(H,Z,re,ie,se,le,ue,we,je,De,Ee,Qe,Be,Ne,Ae,Ge,Ze){var Ke,At=Ze-1>>1,xt=se[le+0]|ue[we+0]<<16,Gt=je[De+0]|Ee[Qe+0]<<16;e(H!=null);var vt=3*xt+Gt+131074>>2;for(T(H[Z+0],255&vt,vt>>16,Be,Ne),re!=null&&(vt=3*Gt+xt+131074>>2,T(re[ie+0],255&vt,vt>>16,Ae,Ge)),Ke=1;Ke<=At;++Ke){var Bn=se[le+Ke]|ue[we+Ke]<<16,Wn=je[De+Ke]|Ee[Qe+Ke]<<16,kn=xt+Bn+Gt+Wn+524296,bn=kn+2*(Bn+Gt)>>3;vt=bn+xt>>1,xt=(kn=kn+2*(xt+Wn)>>3)+Bn>>1,T(H[Z+2*Ke-1],255&vt,vt>>16,Be,Ne+(2*Ke-1)*B),T(H[Z+2*Ke-0],255&xt,xt>>16,Be,Ne+(2*Ke-0)*B),re!=null&&(vt=kn+Gt>>1,xt=bn+Wn>>1,T(re[ie+2*Ke-1],255&vt,vt>>16,Ae,Ge+(2*Ke-1)*B),T(re[ie+2*Ke+0],255&xt,xt>>16,Ae,Ge+(2*Ke+0)*B)),xt=Bn,Gt=Wn}1&Ze||(vt=3*xt+Gt+131074>>2,T(H[Z+Ze-1],255&vt,vt>>16,Be,Ne+(Ze-1)*B),re!=null&&(vt=3*Gt+xt+131074>>2,T(re[ie+Ze-1],255&vt,vt>>16,Ae,Ge+(Ze-1)*B)))}}function Oe(){go[ym]=GD,go[vm]=B4,go[D4]=KD,go[bm]=O4,go[wm]=V4,go[Py]=U4,go[R4]=QD,go[ky]=B4,go[Ty]=O4,go[_m]=V4,go[Iy]=U4}function Me(y){return y&~YD?0>y?0:255:y>>z4}function _(y,T){return Me((19077*y>>8)+(26149*T>>8)-14234)}function U(y,T,B){return Me((19077*y>>8)-(6419*T>>8)-(13320*B>>8)+8708)}function G(y,T){return Me((19077*y>>8)+(33050*T>>8)-17685)}function ee(y,T,B,H,Z){H[Z+0]=_(y,B),H[Z+1]=U(y,T,B),H[Z+2]=G(y,T)}function be(y,T,B,H,Z){H[Z+0]=G(y,T),H[Z+1]=U(y,T,B),H[Z+2]=_(y,B)}function Pe(y,T,B,H,Z){var re=U(y,T,B);T=re<<3&224|G(y,T)>>3,H[Z+0]=248&_(y,B)|re>>5,H[Z+1]=T}function We(y,T,B,H,Z){var re=240&G(y,T)|15;H[Z+0]=240&_(y,B)|U(y,T,B)>>4,H[Z+1]=re}function Ft(y,T,B,H,Z){H[Z+0]=255,ee(y,T,B,H,Z+1)}function rn(y,T,B,H,Z){be(y,T,B,H,Z),H[Z+3]=255}function Wt(y,T,B,H,Z){ee(y,T,B,H,Z),H[Z+3]=255}function Pn(y,T){return 0>y?0:y>T?T:y}function Mn(y,T,B){v[y]=function(H,Z,re,ie,se,le,ue,we,je){for(var De=we+(-2&je)*B;we!=De;)T(H[Z+0],re[ie+0],se[le+0],ue,we),T(H[Z+1],re[ie+0],se[le+0],ue,we+B),Z+=2,++ie,++le,we+=2*B;1&je&&T(H[Z+0],re[ie+0],se[le+0],ue,we)}}function Os(y,T,B){return B==0?y==0?T==0?6:5:T==0?4:0:B}function kr(y,T,B,H,Z){switch(y>>>30){case 3:al(T,B,H,Z,0);break;case 2:Lr(T,B,H,Z);break;case 1:ss(T,B,H,Z)}}function uo(y,T){var B,H,Z=T.M,re=T.Nb,ie=y.oc,se=y.pc+40,le=y.oc,ue=y.pc+584,we=y.oc,je=y.pc+600;for(B=0;16>B;++B)ie[se+32*B-1]=129;for(B=0;8>B;++B)le[ue+32*B-1]=129,we[je+32*B-1]=129;for(0<Z?ie[se-1-32]=le[ue-1-32]=we[je-1-32]=129:(i(ie,se-32-1,127,21),i(le,ue-32-1,127,9),i(we,je-32-1,127,9)),H=0;H<y.za;++H){var De=T.ya[T.aa+H];if(0<H){for(B=-1;16>B;++B)r(ie,se+32*B-4,ie,se+32*B+12,4);for(B=-1;8>B;++B)r(le,ue+32*B-4,le,ue+32*B+4,4),r(we,je+32*B-4,we,je+32*B+4,4)}var Ee=y.Gd,Qe=y.Hd+H,Be=De.ad,Ne=De.Hc;if(0<Z&&(r(ie,se-32,Ee[Qe].y,0,16),r(le,ue-32,Ee[Qe].f,0,8),r(we,je-32,Ee[Qe].ea,0,8)),De.Za){var Ae=ie,Ge=se-32+16;for(0<Z&&(H>=y.za-1?i(Ae,Ge,Ee[Qe].y[15],4):r(Ae,Ge,Ee[Qe+1].y,0,4)),B=0;4>B;B++)Ae[Ge+128+B]=Ae[Ge+256+B]=Ae[Ge+384+B]=Ae[Ge+0+B];for(B=0;16>B;++B,Ne<<=2)Ae=ie,Ge=se+H4[B],Bo[De.Ob[B]](Ae,Ge),kr(Ne,Be,16*+B,Ae,Ge)}else if(Ae=Os(H,Z,De.Ob[0]),ac[Ae](ie,se),Ne!=0)for(B=0;16>B;++B,Ne<<=2)kr(Ne,Be,16*+B,ie,se+H4[B]);for(B=De.Gc,Ae=Os(H,Z,De.Dd),cl[Ae](le,ue),cl[Ae](we,je),Ne=Be,Ae=le,Ge=ue,255&(De=B>>0)&&(170&De?Nf(Ne,256,Ae,Ge):ho(Ne,256,Ae,Ge)),De=we,Ne=je,255&(B>>=8)&&(170&B?Nf(Be,320,De,Ne):ho(Be,320,De,Ne)),Z<y.Ub-1&&(r(Ee[Qe].y,0,ie,se+480,16),r(Ee[Qe].f,0,le,ue+224,8),r(Ee[Qe].ea,0,we,je+224,8)),B=8*re*y.B,Ee=y.sa,Qe=y.ta+16*H+16*re*y.R,Be=y.qa,De=y.ra+8*H+B,Ne=y.Ha,Ae=y.Ia+8*H+B,B=0;16>B;++B)r(Ee,Qe+B*y.R,ie,se+32*B,16);for(B=0;8>B;++B)r(Be,De+B*y.B,le,ue+32*B,8),r(Ne,Ae+B*y.B,we,je+32*B,8)}}function Vs(y,T,B,H,Z,re,ie,se,le){var ue=[0],we=[0],je=0,De=le!=null?le.kd:0,Ee=le??new gt;if(y==null||12>B)return 7;Ee.data=y,Ee.w=T,Ee.ha=B,T=[T],B=[B],Ee.gb=[Ee.gb];e:{var Qe=T,Be=B,Ne=Ee.gb;if(e(y!=null),e(Be!=null),e(Ne!=null),Ne[0]=0,12<=Be[0]&&!n(y,Qe[0],"RIFF")){if(n(y,Qe[0]+8,"WEBP")){Ne=3;break e}var Ae=$e(y,Qe[0]+4);if(12>Ae||4294967286<Ae){Ne=3;break e}if(De&&Ae>Be[0]-8){Ne=7;break e}Ne[0]=Ae,Qe[0]+=12,Be[0]-=12}Ne=0}if(Ne!=0)return Ne;for(Ae=0<Ee.gb[0],B=B[0];;){e:{var Ge=y;Be=T,Ne=B;var Ze=ue,Ke=we,At=Qe=[0];if((vt=je=[je])[0]=0,8>Ne[0])Ne=7;else{if(!n(Ge,Be[0],"VP8X")){if($e(Ge,Be[0]+4)!=10){Ne=3;break e}if(18>Ne[0]){Ne=7;break e}var xt=$e(Ge,Be[0]+8),Gt=1+ze(Ge,Be[0]+12);if(2147483648<=Gt*(Ge=1+ze(Ge,Be[0]+15))){Ne=3;break e}At!=null&&(At[0]=xt),Ze!=null&&(Ze[0]=Gt),Ke!=null&&(Ke[0]=Ge),Be[0]+=18,Ne[0]-=18,vt[0]=1}Ne=0}}if(je=je[0],Qe=Qe[0],Ne!=0)return Ne;if(Be=!!(2&Qe),!Ae&&je)return 3;if(re!=null&&(re[0]=!!(16&Qe)),ie!=null&&(ie[0]=Be),se!=null&&(se[0]=0),ie=ue[0],Qe=we[0],je&&Be&&le==null){Ne=0;break}if(4>B){Ne=7;break}if(Ae&&je||!Ae&&!je&&!n(y,T[0],"ALPH")){B=[B],Ee.na=[Ee.na],Ee.P=[Ee.P],Ee.Sa=[Ee.Sa];e:{xt=y,Ne=T,Ae=B;var vt=Ee.gb;Ze=Ee.na,Ke=Ee.P,At=Ee.Sa,Gt=22,e(xt!=null),e(Ae!=null),Ge=Ne[0];var Bn=Ae[0];for(e(Ze!=null),e(At!=null),Ze[0]=null,Ke[0]=null,At[0]=0;;){if(Ne[0]=Ge,Ae[0]=Bn,8>Bn){Ne=7;break e}var Wn=$e(xt,Ge+4);if(4294967286<Wn){Ne=3;break e}var kn=8+Wn+1&-2;if(Gt+=kn,0<vt&&Gt>vt){Ne=3;break e}if(!n(xt,Ge,"VP8 ")||!n(xt,Ge,"VP8L")){Ne=0;break e}if(Bn[0]<kn){Ne=7;break e}n(xt,Ge,"ALPH")||(Ze[0]=xt,Ke[0]=Ge+8,At[0]=Wn),Ge+=kn,Bn-=kn}}if(B=B[0],Ee.na=Ee.na[0],Ee.P=Ee.P[0],Ee.Sa=Ee.Sa[0],Ne!=0)break}B=[B],Ee.Ja=[Ee.Ja],Ee.xa=[Ee.xa];e:if(vt=y,Ne=T,Ae=B,Ze=Ee.gb[0],Ke=Ee.Ja,At=Ee.xa,xt=Ne[0],Ge=!n(vt,xt,"VP8 "),Gt=!n(vt,xt,"VP8L"),e(vt!=null),e(Ae!=null),e(Ke!=null),e(At!=null),8>Ae[0])Ne=7;else{if(Ge||Gt){if(vt=$e(vt,xt+4),12<=Ze&&vt>Ze-12){Ne=3;break e}if(De&&vt>Ae[0]-8){Ne=7;break e}Ke[0]=vt,Ne[0]+=8,Ae[0]-=8,At[0]=Gt}else At[0]=5<=Ae[0]&&vt[xt+0]==47&&!(vt[xt+4]>>5),Ke[0]=Ae[0];Ne=0}if(B=B[0],Ee.Ja=Ee.Ja[0],Ee.xa=Ee.xa[0],T=T[0],Ne!=0)break;if(4294967286<Ee.Ja)return 3;if(se==null||Be||(se[0]=Ee.xa?2:1),ie=[ie],Qe=[Qe],Ee.xa){if(5>B){Ne=7;break}se=ie,De=Qe,Be=re,y==null||5>B?y=0:5<=B&&y[T+0]==47&&!(y[T+4]>>5)?(Ae=[0],vt=[0],Ze=[0],W(Ke=new V,y,T,B),Nt(Ke,Ae,vt,Ze)?(se!=null&&(se[0]=Ae[0]),De!=null&&(De[0]=vt[0]),Be!=null&&(Be[0]=Ze[0]),y=1):y=0):y=0}else{if(10>B){Ne=7;break}se=Qe,y==null||10>B||!Ka(y,T+3,B-3)?y=0:(De=y[T+0]|y[T+1]<<8|y[T+2]<<16,Be=16383&(y[T+7]<<8|y[T+6]),y=16383&(y[T+9]<<8|y[T+8]),1&De||3<(De>>1&7)||!(De>>4&1)||De>>5>=Ee.Ja||!Be||!y?y=0:(ie&&(ie[0]=Be),se&&(se[0]=y),y=1))}if(!y||(ie=ie[0],Qe=Qe[0],je&&(ue[0]!=ie||we[0]!=Qe)))return 3;le!=null&&(le[0]=Ee,le.offset=T-le.w,e(4294967286>T-le.w),e(le.offset==le.ha-B));break}return Ne==0||Ne==7&&je&&le==null?(re!=null&&(re[0]|=Ee.na!=null&&0<Ee.na.length),H!=null&&(H[0]=ie),Z!=null&&(Z[0]=Qe),0):Ne}function ma(y,T,B){var H=T.width,Z=T.height,re=0,ie=0,se=H,le=Z;if(T.Da=y!=null&&0<y.Da,T.Da&&(se=y.cd,le=y.bd,re=y.v,ie=y.j,11>B||(re&=-2,ie&=-2),0>re||0>ie||0>=se||0>=le||re+se>H||ie+le>Z))return 0;if(T.v=re,T.j=ie,T.va=re+se,T.o=ie+le,T.U=se,T.T=le,T.da=y!=null&&0<y.da,T.da){if(!yt(se,le,B=[y.ib],re=[y.hb]))return 0;T.ib=B[0],T.hb=re[0]}return T.ob=y!=null&&y.ob,T.Kb=y==null||!y.Sd,T.da&&(T.ob=T.ib<3*H/4&&T.hb<3*Z/4,T.Kb=0),1}function ga(y){if(y==null)return 2;if(11>y.S){var T=y.f.RGBA;T.fb+=(y.height-1)*T.A,T.A=-T.A}else T=y.f.kb,y=y.height,T.O+=(y-1)*T.fa,T.fa=-T.fa,T.N+=(y-1>>1)*T.Ab,T.Ab=-T.Ab,T.W+=(y-1>>1)*T.Db,T.Db=-T.Db,T.F!=null&&(T.J+=(y-1)*T.lb,T.lb=-T.lb);return 0}function nl(y,T,B,H){if(H==null||0>=y||0>=T)return 2;if(B!=null){if(B.Da){var Z=B.cd,re=B.bd,ie=-2&B.v,se=-2&B.j;if(0>ie||0>se||0>=Z||0>=re||ie+Z>y||se+re>T)return 2;y=Z,T=re}if(B.da){if(!yt(y,T,Z=[B.ib],re=[B.hb]))return 2;y=Z[0],T=re[0]}}H.width=y,H.height=T;e:{var le=H.width,ue=H.height;if(y=H.S,0>=le||0>=ue||!(y>=ym&&13>y))y=2;else{if(0>=H.Rd&&H.sd==null){ie=re=Z=T=0;var we=(se=le*W4[y])*ue;if(11>y||(re=(ue+1)/2*(T=(le+1)/2),y==12&&(ie=(Z=le)*ue)),(ue=s(we+2*re+ie))==null){y=1;break e}H.sd=ue,11>y?((le=H.f.RGBA).eb=ue,le.fb=0,le.A=se,le.size=we):((le=H.f.kb).y=ue,le.O=0,le.fa=se,le.Fd=we,le.f=ue,le.N=0+we,le.Ab=T,le.Cd=re,le.ea=ue,le.W=0+we+re,le.Db=T,le.Ed=re,y==12&&(le.F=ue,le.J=0+we+2*re),le.Tc=ie,le.lb=Z)}if(T=1,Z=H.S,re=H.width,ie=H.height,Z>=ym&&13>Z)if(11>Z)y=H.f.RGBA,T&=(se=Math.abs(y.A))*(ie-1)+re<=y.size,T&=se>=re*W4[Z],T&=y.eb!=null;else{y=H.f.kb,se=(re+1)/2,we=(ie+1)/2,le=Math.abs(y.fa),ue=Math.abs(y.Ab);var je=Math.abs(y.Db),De=Math.abs(y.lb),Ee=De*(ie-1)+re;T&=le*(ie-1)+re<=y.Fd,T&=ue*(we-1)+se<=y.Cd,T=(T&=je*(we-1)+se<=y.Ed)&le>=re&ue>=se&je>=se,T&=y.y!=null,T&=y.f!=null,T&=y.ea!=null,Z==12&&(T&=De>=re,T&=Ee<=y.Tc,T&=y.F!=null)}else T=0;y=T?0:2}}return y!=0||B!=null&&B.fd&&(y=ga(H)),y}var $r=64,Zl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ec=24,ei=32,rl=8,Vi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Xe("Predictor0","PredictorAdd0"),v.Predictor0=function(){return 4278190080},v.Predictor1=function(y){return y},v.Predictor2=function(y,T,B){return T[B+0]},v.Predictor3=function(y,T,B){return T[B+1]},v.Predictor4=function(y,T,B){return T[B-1]},v.Predictor5=function(y,T,B){return Je(Je(y,T[B+1]),T[B+0])},v.Predictor6=function(y,T,B){return Je(y,T[B-1])},v.Predictor7=function(y,T,B){return Je(y,T[B+0])},v.Predictor8=function(y,T,B){return Je(T[B-1],T[B+0])},v.Predictor9=function(y,T,B){return Je(T[B+0],T[B+1])},v.Predictor10=function(y,T,B){return Je(Je(y,T[B-1]),Je(T[B+0],T[B+1]))},v.Predictor11=function(y,T,B){var H=T[B+0];return 0>=Dt(H>>24&255,y>>24&255,(T=T[B-1])>>24&255)+Dt(H>>16&255,y>>16&255,T>>16&255)+Dt(H>>8&255,y>>8&255,T>>8&255)+Dt(255&H,255&y,255&T)?H:y},v.Predictor12=function(y,T,B){var H=T[B+0];return(ut((y>>24&255)+(H>>24&255)-((T=T[B-1])>>24&255))<<24|ut((y>>16&255)+(H>>16&255)-(T>>16&255))<<16|ut((y>>8&255)+(H>>8&255)-(T>>8&255))<<8|ut((255&y)+(255&H)-(255&T)))>>>0},v.Predictor13=function(y,T,B){var H=T[B-1];return(mt((y=Je(y,T[B+0]))>>24&255,H>>24&255)<<24|mt(y>>16&255,H>>16&255)<<16|mt(y>>8&255,H>>8&255)<<8|mt(y>>0&255,H>>0&255))>>>0};var tc=v.PredictorAdd0;v.PredictorAdd1=_t,Xe("Predictor2","PredictorAdd2"),Xe("Predictor3","PredictorAdd3"),Xe("Predictor4","PredictorAdd4"),Xe("Predictor5","PredictorAdd5"),Xe("Predictor6","PredictorAdd6"),Xe("Predictor7","PredictorAdd7"),Xe("Predictor8","PredictorAdd8"),Xe("Predictor9","PredictorAdd9"),Xe("Predictor10","PredictorAdd10"),Xe("Predictor11","PredictorAdd11"),Xe("Predictor12","PredictorAdd12"),Xe("Predictor13","PredictorAdd13");var or=v.PredictorAdd2;Ot("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),Ot("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var _u,xs=v.ColorIndexInverseTransform,nc=v.MapARGB,il=v.VP8LColorIndexInverseTransformAlpha,rc=v.MapAlpha,Mo=v.VP8LPredictorsAdd=[];Mo.length=16,(v.VP8LPredictors=[]).length=16,(v.VP8LPredictorsAdd_C=[]).length=16,(v.VP8LPredictors_C=[]).length=16;var Nu,ys,is,ic,sl,ol,zd,al,Lr,Nf,ss,ho,qd,mm,Af,Au,Su,sc,Eu,Hd,Cu,oc,Sf,fo,po,ar,lr,Mr,ti=s(511),ll=s(2041),Ef=s(225),Wd=s(767),gm=0,Cy=ll,xm=Ef,Us=Wd,mo=ti,ym=0,vm=1,D4=2,bm=3,wm=4,Py=5,R4=6,ky=7,Ty=8,_m=9,Iy=10,DD=[2,3,7],RD=[3,3,11],F4=[280,256,256,256,40],FD=[0,1,1,1,0],LD=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],MD=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],BD=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],OD=8,jy=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Dy=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Cf=null,VD=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],UD=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],L4=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],zD=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],qD=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],HD=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],WD=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ac=[],Bo=[],cl=[],$D=1,M4=2,lc=[],go=[];Te("UpsampleRgbLinePair",ee,3),Te("UpsampleBgrLinePair",be,3),Te("UpsampleRgbaLinePair",Wt,4),Te("UpsampleBgraLinePair",rn,4),Te("UpsampleArgbLinePair",Ft,4),Te("UpsampleRgba4444LinePair",We,2),Te("UpsampleRgb565LinePair",Pe,2);var GD=v.UpsampleRgbLinePair,KD=v.UpsampleBgrLinePair,B4=v.UpsampleRgbaLinePair,O4=v.UpsampleBgraLinePair,V4=v.UpsampleArgbLinePair,U4=v.UpsampleRgba4444LinePair,QD=v.UpsampleRgb565LinePair,Nm=16,Am=1<<Nm-1,Pf=-227,Ry=482,z4=6,YD=(256<<z4)-1,q4=0,XD=s(256),JD=s(256),ZD=s(256),eR=s(256),tR=s(Ry-Pf),nR=s(Ry-Pf);Mn("YuvToRgbRow",ee,3),Mn("YuvToBgrRow",be,3),Mn("YuvToRgbaRow",Wt,4),Mn("YuvToBgraRow",rn,4),Mn("YuvToArgbRow",Ft,4),Mn("YuvToRgba4444Row",We,2),Mn("YuvToRgb565Row",Pe,2);var H4=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Sm=[0,2,8],rR=[8,7,6,4,4,2,2,2,1,1,1,1],iR=1;this.WebPDecodeRGBA=function(y,T,B,H,Z){var re=vm,ie=new ht,se=new mr;ie.ba=se,se.S=re,se.width=[se.width],se.height=[se.height];var le=se.width,ue=se.height,we=new Xn;if(we==null||y==null)var je=2;else e(we!=null),je=Vs(y,T,B,we.width,we.height,we.Pd,we.Qd,we.format,null);if(je!=0?le=0:(le!=null&&(le[0]=we.width[0]),ue!=null&&(ue[0]=we.height[0]),le=1),le){se.width=se.width[0],se.height=se.height[0],H!=null&&(H[0]=se.width),Z!=null&&(Z[0]=se.height);e:{if(H=new Io,(Z=new gt).data=y,Z.w=T,Z.ha=B,Z.kd=1,T=[0],e(Z!=null),((y=Vs(Z.data,Z.w,Z.ha,null,null,null,T,null,Z))==0||y==7)&&T[0]&&(y=4),(T=y)==0){if(e(ie!=null),H.data=Z.data,H.w=Z.w+Z.offset,H.ha=Z.ha-Z.offset,H.put=Hn,H.ac=In,H.bc=di,H.ma=ie,Z.xa){if((y=gr())==null){ie=1;break e}if(function(De,Ee){var Qe=[0],Be=[0],Ne=[0];t:for(;;){if(De==null)return 0;if(Ee==null)return De.a=2,0;if(De.l=Ee,De.a=0,W(De.m,Ee.data,Ee.w,Ee.ha),!Nt(De.m,Qe,Be,Ne)){De.a=3;break t}if(De.xb=M4,Ee.width=Qe[0],Ee.height=Be[0],!_i(Qe[0],Be[0],1,De,null))break t;return 1}return e(De.a!=0),0}(y,H)){if(H=(T=nl(H.width,H.height,ie.Oa,ie.ba))==0){t:{H=y;n:for(;;){if(H==null){H=0;break t}if(e(H.s.yc!=null),e(H.s.Ya!=null),e(0<H.s.Wb),e((B=H.l)!=null),e((Z=B.ma)!=null),H.xb!=0){if(H.ca=Z.ba,H.tb=Z.tb,e(H.ca!=null),!ma(Z.Oa,B,bm)){H.a=2;break n}if(!Bi(H,B.width)||B.da)break n;if((B.da||sn(H.ca.S))&&ve(),11>H.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),H.ca.f.kb.F!=null&&ve()),H.Pb&&0<H.s.ua&&H.s.vb.X==null&&!dt(H.s.vb,H.s.Wa.Xa)){H.a=1;break n}H.xb=0}if(!wi(H,H.V,H.Ba,H.c,H.i,B.o,sa))break n;Z.Dc=H.Ma,H=1;break t}e(H.a!=0),H=0}H=!H}H&&(T=y.a)}else T=y.a}else{if((y=new Ga)==null){ie=1;break e}if(y.Fa=Z.na,y.P=Z.P,y.qc=Z.Sa,Qa(y,H)){if((T=nl(H.width,H.height,ie.Oa,ie.ba))==0){if(y.Aa=0,B=ie.Oa,e((Z=y)!=null),B!=null){if(0<(le=0>(le=B.Md)?0:100<le?255:255*le/100)){for(ue=we=0;4>ue;++ue)12>(je=Z.pb[ue]).lc&&(je.ia=le*rR[0>je.lc?0:je.lc]>>3),we|=je.ia;we&&(alert("todo:VP8InitRandom"),Z.ia=1)}Z.Ga=B.Id,100<Z.Ga?Z.Ga=100:0>Z.Ga&&(Z.Ga=0)}Yl(y,H)||(T=y.a)}}else T=y.a}T==0&&ie.Oa!=null&&ie.Oa.fd&&(T=ga(ie.ba))}ie=T}re=ie!=0?null:11>re?se.f.RGBA.eb:se.f.kb.y}else re=null;return re};var W4=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(v,A){for(var I="",S=0;S<4;S++)I+=String.fromCharCode(v[A++]);return I}function d(v,A){return(v[A+0]<<0|v[A+1]<<8|v[A+2]<<16)>>>0}function f(v,A){return(v[A+0]<<0|v[A+1]<<8|v[A+2]<<16|v[A+3]<<24)>>>0}new l;var h=[0],p=[0],m=[],g=new l,b=t,x=function(v,A){var I={},S=0,P=!1,k=0,F=0;if(I.frames=[],!function($,K,X,ae){for(var ye=0;ye<ae;ye++)if($[K+ye]!=X.charCodeAt(ye))return!0;return!1}(v,A,"RIFF",4)){var q,O;for(f(v,A+=4),A+=8;A<v.length;){var M=c(v,A),W=f(v,A+=4);A+=4;var z=W+(1&W);switch(M){case"VP8 ":case"VP8L":I.frames[S]===void 0&&(I.frames[S]={}),(V=I.frames[S]).src_off=P?F:A-8,V.src_size=k+W+8,S++,P&&(P=!1,k=0,F=0);break;case"VP8X":(V=I.header={}).feature_flags=v[A];var J=A+4;V.canvas_width=1+d(v,J),J+=3,V.canvas_height=1+d(v,J),J+=3;break;case"ALPH":P=!0,k=z+8,F=A-8;break;case"ANIM":(V=I.header).bgcolor=f(v,A),J=A+4,V.loop_count=(q=v)[(O=J)+0]<<0|q[O+1]<<8,J+=2;break;case"ANMF":var ne,V;(V=I.frames[S]={}).offset_x=2*d(v,A),A+=3,V.offset_y=2*d(v,A),A+=3,V.width=1+d(v,A),A+=3,V.height=1+d(v,A),A+=3,V.duration=d(v,A),A+=3,ne=v[A++],V.dispose=1&ne,V.blend=ne>>1&1}M!="ANMF"&&(A+=z)}return I}}(b,0);x.response=b,x.rgbaoutput=!0,x.dataurl=!1;var w=x.header?x.header:null,N=x.frames?x.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],p=[w.canvas_width];for(var E=0;E<N.length&&N[E].blend!=0;E++);}var D=N[0],j=g.WebPDecodeRGBA(b,D.src_off,D.src_size,p,h);D.rgba=j,D.imgwidth=p[0],D.imgheight=h[0];for(var C=0;C<p[0]*h[0]*4;C++)m[C]=j[C];return this.width=p,this.height=h,this.data=m,this}(function(t){var e=function(){return typeof L5=="function"},n=function(h,p,m,g){var b=4,x=o;switch(g){case t.image_compression.FAST:b=1,x=s;break;case t.image_compression.MEDIUM:b=6,x=a;break;case t.image_compression.SLOW:b=9,x=l}h=r(h,p,m,x);var w=L5(h,{level:b});return t.__addimage__.arrayBufferToBinaryString(w)},r=function(h,p,m,g){for(var b,x,w,N=h.length/p,E=new Uint8Array(h.length+N),D=d(),j=0;j<N;j+=1){if(w=j*p,b=h.subarray(w,w+p),g)E.set(g(b,m,x),w+j);else{for(var C,v=D.length,A=[];C<v;C+=1)A[C]=D[C](b,m,x);var I=f(A.concat());E.set(A[I],w+j)}x=b}return E},i=function(h){var p=Array.apply([],h);return p.unshift(0),p},s=function(h,p){var m,g=[],b=h.length;g[0]=1;for(var x=0;x<b;x+=1)m=h[x-p]||0,g[x+1]=h[x]-m+256&255;return g},o=function(h,p,m){var g,b=[],x=h.length;b[0]=2;for(var w=0;w<x;w+=1)g=m&&m[w]||0,b[w+1]=h[w]-g+256&255;return b},a=function(h,p,m){var g,b,x=[],w=h.length;x[0]=3;for(var N=0;N<w;N+=1)g=h[N-p]||0,b=m&&m[N]||0,x[N+1]=h[N]+256-(g+b>>>1)&255;return x},l=function(h,p,m){var g,b,x,w,N=[],E=h.length;N[0]=4;for(var D=0;D<E;D+=1)g=h[D-p]||0,b=m&&m[D]||0,x=m&&m[D-p]||0,w=c(g,b,x),N[D+1]=h[D]-w+256&255;return N},c=function(h,p,m){if(h===p&&p===m)return h;var g=Math.abs(p-m),b=Math.abs(h-m),x=Math.abs(h+p-m-m);return g<=b&&g<=x?h:b<=x?p:m},d=function(){return[i,s,o,a,l]},f=function(h){var p=h.map(function(m){return m.reduce(function(g,b){return g+Math.abs(b)},0)});return p.indexOf(Math.min.apply(null,p))};t.processPNG=function(h,p,m,g){var b,x,w,N,E,D,j,C,v,A,I,S,P,k,F,q=this.decode.FLATE_DECODE,O="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(w=new rZ(h)).imgData,x=w.bits,b=w.colorSpace,E=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){v=(C=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,I=new Uint8Array(v*w.colors),A=new Uint8Array(v);var M,W=w.pixelBitlength-w.bits;for(k=0,F=0;k<v;k++){for(P=C[k],M=0;M<W;)I[F++]=P>>>M&255,M+=w.bits;A[k]=P>>>M&255}}if(w.bits===16){v=(C=new Uint32Array(w.decodePixels().buffer)).length,I=new Uint8Array(v*(32/w.pixelBitlength)*w.colors),A=new Uint8Array(v*(32/w.pixelBitlength)),S=w.colors>1,k=0,F=0;for(var z=0;k<v;)P=C[k++],I[F++]=P>>>0&255,S&&(I[F++]=P>>>16&255,P=C[k++],I[F++]=P>>>0&255),A[z++]=P>>>16&255;x=8}g!==t.image_compression.NONE&&e()?(h=n(I,w.width*w.colors,w.colors,g),j=n(A,w.width,1,g)):(h=I,j=A,q=void 0)}if(w.colorType===3&&(b=this.color_spaces.INDEXED,D=w.palette,w.transparency.indexed)){var J=w.transparency.indexed,ne=0;for(k=0,v=J.length;k<v;++k)ne+=J[k];if((ne/=255)===v-1&&J.indexOf(0)!==-1)N=[J.indexOf(0)];else if(ne!==v){for(C=w.decodePixels(),A=new Uint8Array(C.length),k=0,v=C.length;k<v;k++)A[k]=J[C[k]];j=n(A,w.width,1)}}var V=function($){var K;switch($){case t.image_compression.FAST:K=11;break;case t.image_compression.MEDIUM:K=13;break;case t.image_compression.SLOW:K=14;break;default:K=12}return K}(g);return q===this.decode.FLATE_DECODE&&(O="/Predictor "+V+" "),O+="/Colors "+E+" /BitsPerComponent "+x+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(j&&this.__addimage__.isArrayBuffer(j)||this.__addimage__.isArrayBufferView(j))&&(j=this.__addimage__.arrayBufferToBinaryString(j)),{alias:m,data:h,index:p,filter:q,decodeParameters:O,transparency:N,palette:D,sMask:j,predictor:V,width:w.width,height:w.height,bitsPerComponent:x,colorSpace:b}}}})(zt.API),function(t){t.processGIF89A=function(e,n,r,i){var s=new iZ(e),o=s.width,a=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:o,height:a},d=new B2(100).encode(c,100);return t.processJPEG.call(this,d,n,r,i)},t.processGIF87A=t.processGIF89A}(zt.API),zo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){ir.log("bit decode error:"+n)}},zo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var l=this.palette[s>>7-a&1];this.data[o+4*a]=l.blue,this.data[o+4*a+1]=l.green,this.data[o+4*a+2]=l.red,this.data[o+4*a+3]=255}n!==0&&(this.pos+=4-n)}},zo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,a=s>>4,l=15&s,c=this.palette[a];if(this.data[o]=c.blue,this.data[o+1]=c.green,this.data[o+2]=c.red,this.data[o+3]=255,2*i+1>=this.width)break;c=this.palette[l],this.data[o+4]=c.blue,this.data[o+4+1]=c.green,this.data[o+4+2]=c.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},zo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},zo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,a=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,c=s>>15?255:0,d=r*this.width*4+4*i;this.data[d]=l,this.data[d+1]=a,this.data[d+2]=o,this.data[d+3]=c}this.pos+=t}},zo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&e)/e*255|0,l=(o>>5&n)/n*255|0,c=(o>>11)/e*255|0,d=i*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=a,this.data[d+3]=255}this.pos+=t}},zo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},zo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=o}},zo.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var s=new zo(e,!1),o=s.width,a=s.height,l={data:s.getData(),width:o,height:a},c=new B2(100).encode(l,100);return t.processJPEG.call(this,c,n,r,i)}}(zt.API),W6.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var s=new W6(e),o=s.width,a=s.height,l={data:s.getData(),width:o,height:a},c=new B2(100).encode(l,100);return t.processJPEG.call(this,c,n,r,i)}}(zt.API),zt.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),a=0,l=0,c=0;c<i;c+=4){var d=r[c],f=r[c+1],h=r[c+2],p=r[c+3];s[a++]=d,s[a++]=f,s[a++]=h,o[l++]=p}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},zt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},sh=zt.API,Pg=sh.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,l=a.fof?a.fof:1,c=e.kerning?e.kerning:i.metadata.Unicode.kerning,d=c.fof?c.fof:1,f=e.doKerning!==!1,h=0,p=t.length,m=0,g=a[0]||l,b=[];for(n=0;n<p;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?b.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/s)||0)/1e3):(h=f&&Vn(c[r])==="object"&&!isNaN(parseInt(c[r][m],10))?c[r][m]/d:0,b.push((a[r]||g)/l+h)),m=r;return b},U6=sh.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return sh.processArabic&&(t=sh.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:Pg.apply(this,arguments).reduce(function(s,o){return s+o},0)},z6=function(t,e,n,r){for(var i=[],s=0,o=t.length,a=0;s!==o&&a+e[s]<n;)a+=e[s],s++;i.push(t.slice(0,s));var l=s;for(a=0;s!==o;)a+e[s]>r&&(i.push(t.slice(l,s)),a=0,l=s),a+=e[s],s++;return l!==s&&i.push(t.slice(l,s)),i},q6=function(t,e,n){n||(n={});var r,i,s,o,a,l,c,d=[],f=[d],h=n.textIndent||0,p=0,m=0,g=t.split(" "),b=Pg.apply(this,[" ",n])[0];if(l=n.lineIndent===-1?g[0].length+2:n.lineIndent||0){var x=Array(l).join(" "),w=[];g.map(function(E){(E=E.split(/\s*\n/)).length>1?w=w.concat(E.map(function(D,j){return(j&&D.length?`
`:"")+D})):w.push(E[0])}),g=w,l=U6.apply(this,[x,n])}for(s=0,o=g.length;s<o;s++){var N=0;if(r=g[s],l&&r[0]==`
`&&(r=r.substr(1),N=1),h+p+(m=(i=Pg.apply(this,[r,n])).reduce(function(E,D){return E+D},0))>e||N){if(m>e){for(a=z6.apply(this,[r,i,e-(h+p),e]),d.push(a.shift()),d=[a.pop()];a.length;)f.push([a.shift()]);m=i.slice(r.length-(d[0]?d[0].length:0)).reduce(function(E,D){return E+D},0)}else d=[r];f.push(d),h=m+l,p=b}else d.push(r),h+=p+m,p=b}return c=l?function(E,D){return(D?x:"")+E.join(" ")}:function(E){return E.join(" ")},f.map(c)},sh.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var a,l,c=[];for(a=0,l=r.length;a<l;a++)c=c.concat(q6.apply(this,[r[a],o,s]));return c},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",n={},r={},i=0;i<e.length;i++)n[e[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=e[i];var s=function(f){return"0x"+parseInt(f,10).toString(16)},o=t.__fontmetrics__.compress=function(f){var h,p,m,g,b=["{"];for(var x in f){if(h=f[x],isNaN(parseInt(x,10))?p="'"+x+"'":(x=parseInt(x,10),p=(p=s(x).slice(2)).slice(0,-1)+r[p.slice(-1)]),typeof h=="number")h<0?(m=s(h).slice(3),g="-"):(m=s(h).slice(2),g=""),m=g+m.slice(0,-1)+r[m.slice(-1)];else{if(Vn(h)!=="object")throw new Error("Don't know what to do with value type "+Vn(h)+".");m=o(h)}b.push(p+m)}return b.push("}"),b.join("")},a=t.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,p,m,g,b={},x=1,w=b,N=[],E="",D="",j=f.length-1,C=1;C<j;C+=1)(g=f[C])=="'"?h?(m=h.join(""),h=void 0):h=[]:h?h.push(g):g=="{"?(N.push([w,m]),w={},m=void 0):g=="}"?((p=N.pop())[0][p[1]]=w,m=void 0,w=p[0]):g=="-"?x=-1:m===void 0?n.hasOwnProperty(g)?(E+=n[g],m=parseInt(E,16)*x,x=1,E=""):E+=g:n.hasOwnProperty(g)?(D+=n[g],w[m]=parseInt(D,16)*x,x=1,m=void 0,D=""):D+=g;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},d={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(f){var h=f.font,p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode={},h.metadata.Unicode.widths=p.widths,h.metadata.Unicode.kerning=p.kerning);var m=c.Unicode[h.postScriptName];m&&(h.metadata.Unicode.encoding=m,h.encoding=m.codePages[0])}])}(zt.API),function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=n.charCodeAt(s);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(F0(a)),o.metadata=t.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(zt),function(t){function e(){return(Xt.canvg?Promise.resolve(Xt.canvg):I5(()=>import("./index.es-CUliIkyC.js"),[])).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}zt.API.addSvgAsImage=function(n,r,i,s,o,a,l,c){if(isNaN(r)||isNaN(i))throw ir.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(o))throw ir.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=s,d.height=o;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(m){return m.fromString(f,n,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){p.addImage(d.toDataURL("image/jpeg",1),r,i,s,o,l,c)})}}(),zt.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},zt.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),l=[],c=0,d=0,f=0;function h(m,g){var b,x=!1;for(b=0;b<m.length;b+=1)m[b]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=a.length;for(f=0;f<p;f+=1)n[a[f]].value=n[a[f]].defaultValue,n[a[f]].explicitSet=!1}if(Vn(t)==="object"){for(i in t)if(s=t[i],h(a,i)&&s!==void 0){if(n[i].type==="boolean"&&typeof s=="boolean")n[i].value=s;else if(n[i].type==="name"&&h(n[i].valueSet,s))n[i].value=s;else if(n[i].type==="integer"&&Number.isInteger(s))n[i].value=s;else if(n[i].type==="array"){for(c=0;c<s.length;c+=1)if(r=!0,s[c].length===1&&typeof s[c][0]=="number")l.push(String(s[c]-1));else if(s[c].length>1){for(d=0;d<s[c].length;d+=1)typeof s[c][d]!="number"&&(r=!1);r===!0&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}n[i].value="["+l.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in n)n[m].explicitSet===!0&&(n[m].type==="name"?g.push("/"+m+" /"+n[m].value):g.push("/"+m+" "+n[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=s.length+o.length+a.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(i+s+o+a+l),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(zt.API),function(t){var e=t.API,n=e.pdfEscape16=function(s,o){for(var a,l=o.metadata.Unicode.widths,c=["","0","00","000","0000"],d=[""],f=0,h=s.length;f<h;++f){if(a=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=s.charCodeAt(f),l.indexOf(a)==-1&&(l.push(a),l.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return d.join("");a=a.toString(16),d.push(c[4-a.length],a)}return d.join("")},r=function(s){var o,a,l,c,d,f,h;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,h=(a=Object.keys(s).sort(function(p,m){return p-m})).length;f<h;f++)o=a[f],l.length>=100&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(c=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),l.push("<"+o+"><"+c+">"));return l.length&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var a=o.font,l=o.out,c=o.newObject,d=o.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="Identity-H"){for(var f=a.metadata.Unicode.widths,h=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",m=0;m<h.length;m++)p+=String.fromCharCode(h[m]);var g=c();d({data:p,addLength1:!0,objectId:g}),l("endobj");var b=c();d({data:r(a.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var x=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+hh(a.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),l("/Flags "+a.metadata.flags),l("/StemV "+a.metadata.stemV),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l(">>"),l("endobj");var w=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+hh(a.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+t.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+a.encoding+")"),l(">>"),l(">>"),l("endobj"),a.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+hh(a.fontName)),l("/Encoding /"+a.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),a.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var a=o.font,l=o.out,c=o.newObject,d=o.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var f=a.metadata.rawData,h="",p=0;p<f.length;p++)h+=String.fromCharCode(f[p]);var m=c();d({data:h,addLength1:!0,objectId:m}),l("endobj");var g=c();d({data:r(a.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var b=c();l("<<"),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l("/StemV "+a.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+m+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),l("/FontName /"+hh(a.fontName)),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l(">>"),l("endobj"),a.objectNumber=c();for(var x=0;x<a.metadata.hmtx.widths.length;x++)a.metadata.hmtx.widths[x]=parseInt(a.metadata.hmtx.widths[x]*(1e3/a.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+hh(a.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),l("endobj"),a.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,a=s.text||"",l=s.x,c=s.y,d=s.options||{},f=s.mutex||{},h=f.pdfEscape,p=f.activeFontKey,m=f.fonts,g=p,b="",x=0,w="",N=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:a,x:l,y:c,options:d,mutex:f};for(w=a,g=p,Array.isArray(a)&&(w=a[0]),x=0;x<w.length;x+=1)m[g].metadata.hasOwnProperty("cmap")&&(o=m[g].metadata.cmap.unicode.codeMap[w[x].charCodeAt(0)]),o||w[x].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?b+=w[x]:b+="";var E="";return parseInt(g.slice(1))<14||N==="WinAnsiEncoding"?E=h(b,g).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(E=n(b,m[g])),f.isHex=!0,{text:E,x:l,y:c,options:d,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",a=[],l={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var c=0;for(c=0;c<o.length;c+=1)Array.isArray(o[c])&&o[c].length===3?a.push([i(Object.assign({},l,{text:o[c][0]})).text,o[c][1],o[c][2]]):a.push(i(Object.assign({},l,{text:o[c]})).text);s.text=a}else s.text=i(Object.assign({},l,{text:o})).text}])}(zt),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(zt.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,s,o,a,l,c,d,f=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,N=0;this.__bidiEngine__={};var E=function(S){var P=S.charCodeAt(),k=P>>8,F=g[k];return F!==void 0?f[256*F+(255&P)]:k===252||k===253?"AL":x.test(k)?"L":k===8?"R":"N"},D=function(S){for(var P,k=0;k<S.length;k++){if((P=E(S.charAt(k)))==="L")return!1;if(P==="R")return!0}return!1},j=function(S,P,k,F){var q,O,M,W,z=P[F];switch(z){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(z="AN");break;case"AL":w=!0,z="R";break;case"WS":z="N";break;case"CS":F<1||F+1>=P.length||(q=k[F-1])!=="EN"&&q!=="AN"||(O=P[F+1])!=="EN"&&O!=="AN"?z="N":w&&(O="AN"),z=O===q?O:"N";break;case"ES":z=(q=F>0?k[F-1]:"B")==="EN"&&F+1<P.length&&P[F+1]==="EN"?"EN":"N";break;case"ET":if(F>0&&k[F-1]==="EN"){z="EN";break}if(w){z="N";break}for(M=F+1,W=P.length;M<W&&P[M]==="ET";)M++;z=M<W&&P[M]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(W=P.length,M=F+1;M<W&&P[M]==="NSM";)M++;if(M<W){var J=S[F],ne=J>=1425&&J<=2303||J===64286;if(q=P[M],ne&&(q==="R"||q==="AL")){z="R";break}}}z=F<1||(q=P[F-1])==="B"?"N":k[F-1];break;case"B":w=!1,i=!0,z=N;break;case"S":s=!0,z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":z="N"}return z},C=function(S,P,k){var F=S.split("");return k&&v(F,k,{hiLevel:N}),F.reverse(),P&&P.reverse(),F.join("")},v=function(S,P,k){var F,q,O,M,W,z=-1,J=S.length,ne=0,V=[],$=N?p:h,K=[];for(w=!1,i=!1,s=!1,q=0;q<J;q++)K[q]=E(S[q]);for(O=0;O<J;O++){if(W=ne,V[O]=j(S,K,V,O),F=240&(ne=$[W][m[V[O]]]),ne&=15,P[O]=M=$[ne][5],F>0)if(F===16){for(q=z;q<O;q++)P[q]=1;z=-1}else z=-1;if($[ne][6])z===-1&&(z=O);else if(z>-1){for(q=z;q<O;q++)P[q]=M;z=-1}K[O]==="B"&&(P[O]=0),k.hiLevel|=M}s&&function(X,ae,ye){for(var me=0;me<ye;me++)if(X[me]==="S"){ae[me]=N;for(var _e=me-1;_e>=0&&X[_e]==="WS";_e--)ae[_e]=N}}(K,P,J)},A=function(S,P,k,F,q){if(!(q.hiLevel<S)){if(S===1&&N===1&&!i)return P.reverse(),void(k&&k.reverse());for(var O,M,W,z,J=P.length,ne=0;ne<J;){if(F[ne]>=S){for(W=ne+1;W<J&&F[W]>=S;)W++;for(z=ne,M=W-1;z<M;z++,M--)O=P[z],P[z]=P[M],P[M]=O,k&&(O=k[z],k[z]=k[M],k[M]=O);ne=W}ne++}}},I=function(S,P,k){var F=S.split(""),q={hiLevel:N};return k||(k=[]),v(F,k,q),function(O,M,W){if(W.hiLevel!==0&&d)for(var z,J=0;J<O.length;J++)M[J]===1&&(z=b.indexOf(O[J]))>=0&&(O[J]=b[z+1])}(F,k,q),A(2,F,P,k,q),A(1,F,P,k,q),F.join("")};return this.__bidiEngine__.doBidiReorder=function(S,P,k){if(function(q,O){if(O)for(var M=0;M<q.length;M++)O[M]=M;a===void 0&&(a=D(q)),c===void 0&&(c=D(q))}(S,P),o||!l||c)if(o&&l&&a^c)N=a?1:0,S=C(S,P,k);else if(!o&&l&&c)N=a?1:0,S=I(S,P,k),S=C(S,P);else if(!o||a||l||c){if(o&&!l&&a^c)S=C(S,P),a?(N=0,S=I(S,P,k)):(N=1,S=I(S,P,k),S=C(S,P));else if(o&&a&&!l&&c)N=1,S=I(S,P,k),S=C(S,P);else if(!o&&!l&&a^c){var F=d;a?(N=1,S=I(S,P,k),N=0,d=!1,S=I(S,P,k),d=F):(N=0,S=I(S,P,k),S=C(S,P),N=1,d=!1,S=I(S,P,k),d=F,S=C(S,P))}}else N=0,S=I(S,P,k);else N=a?1:0,S=I(S,P,k);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,l=S.isOutputVisual,a=S.isInputRtl,c=S.isOutputRtl,d=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text,s=(r.x,r.y,r.options||{}),o=(r.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,n.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(o=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?o.push([n.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):o.push([n.doBidiReorder(i[a])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(zt),zt.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new du(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new vZ(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new sZ(this.contents),this.head=new aZ(this),this.name=new hZ(this),this.cmap=new PD(this),this.toUnicode={},this.hhea=new lZ(this),this.maxp=new fZ(this),this.hmtx=new pZ(this),this.post=new uZ(this),this.os2=new cZ(this),this.loca=new yZ(this),this.glyf=new mZ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,l,c;for(c=[],o=0,a=(l=this.bbox).length;o<a;o++)e=l[o],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,s,o,a;for(o=0,s=0,a=(e=""+e).length;0<=a?s<a:s>a;s=0<=a?++s:--s)i=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var ia,du=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,s,o,a,l;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),a=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^a)+(255^l)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*s+65536*o+256*a+l},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,s;for(s=[],r=0,i=e.length;r<i;r++)n=e[r],s.push(this.writeByte(n));return s},t}(),sZ=function(){var t;function e(n){var r,i,s;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,s,o,a,l,c,d,f,h,p,m,g;for(g in p=Object.keys(n).length,l=Math.log(2),f=16*Math.floor(Math.log(p)/l),o=Math.floor(f/l),d=16*p-f,(i=new du).writeInt(this.scalarType),i.writeShort(p),i.writeShort(f),i.writeShort(o),i.writeShort(d),s=16*p,c=i.pos+s,a=null,m=[],n)for(h=n[g],i.writeString(g),i.writeInt(t(h)),i.writeInt(c),i.writeInt(h.length),m=m.concat(h),g==="head"&&(a=c),c+=h.length;c%4;)m.push(0),c++;return i.write(m),r=2981146554-t(i.data),i.pos=a+8,i.writeUInt32(r),i.data},t=function(n){var r,i,s,o;for(n=kD.call(n);n.length%4;)n.push(0);for(s=new du(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=s.readUInt32();return 4294967295&i},e}(),oZ={}.hasOwnProperty,Ha=function(t,e){for(var n in e)oZ.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};ia=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var aZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="head",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},e.prototype.encode=function(n){var r;return(r=new du).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(n),r.writeShort(this.glyphDataFormat),r.data},e}(),$6=function(){function t(e,n){var r,i,s,o,a,l,c,d,f,h,p,m,g,b,x,w,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(p=e.readUInt16(),h=p/2,e.pos+=6,s=function(){var E,D;for(D=[],l=E=0;0<=h?E<h:E>h;l=0<=h?++E:--E)D.push(e.readUInt16());return D}(),e.pos+=2,g=function(){var E,D;for(D=[],l=E=0;0<=h?E<h:E>h;l=0<=h?++E:--E)D.push(e.readUInt16());return D}(),c=function(){var E,D;for(D=[],l=E=0;0<=h?E<h:E>h;l=0<=h?++E:--E)D.push(e.readUInt16());return D}(),d=function(){var E,D;for(D=[],l=E=0;0<=h?E<h:E>h;l=0<=h?++E:--E)D.push(e.readUInt16());return D}(),i=(this.length-e.pos+this.offset)/2,a=function(){var E,D;for(D=[],l=E=0;0<=i?E<i:E>i;l=0<=i?++E:--E)D.push(e.readUInt16());return D}(),l=x=0,N=s.length;x<N;l=++x)for(b=s[l],r=w=m=g[l];m<=b?w<=b:w>=b;r=m<=b?++w:--w)d[l]===0?o=r+c[l]:(o=a[d[l]/2+(r-m)-(h-l)]||0)!==0&&(o+=c[l]),this.codeMap[r]=65535&o}e.pos=f}return t.encode=function(e,n){var r,i,s,o,a,l,c,d,f,h,p,m,g,b,x,w,N,E,D,j,C,v,A,I,S,P,k,F,q,O,M,W,z,J,ne,V,$,K,X,ae,ye,me,_e,Se,Ce,ze;switch(F=new du,o=Object.keys(e).sort(function($e,dt){return $e-dt}),n){case"macroman":for(g=0,b=function(){var $e=[];for(m=0;m<256;++m)$e.push(0);return $e}(),w={0:0},s={},q=0,z=o.length;q<z;q++)w[_e=e[i=o[q]]]==null&&(w[_e]=++g),s[i]={old:e[i],new:w[e[i]]},b[i]=w[e[i]];return F.writeUInt16(1),F.writeUInt16(0),F.writeUInt32(12),F.writeUInt16(0),F.writeUInt16(262),F.writeUInt16(0),F.write(b),{charMap:s,subtable:F.data,maxGlyphID:g+1};case"unicode":for(P=[],f=[],N=0,w={},r={},x=c=null,O=0,J=o.length;O<J;O++)w[D=e[i=o[O]]]==null&&(w[D]=++N),r[i]={old:D,new:w[D]},a=w[D]-i,x!=null&&a===c||(x&&f.push(x),P.push(i),c=a),x=i;for(x&&f.push(x),f.push(65535),P.push(65535),I=2*(A=P.length),v=2*Math.pow(Math.log(A)/Math.LN2,2),h=Math.log(v/2)/Math.LN2,C=2*A-v,l=[],j=[],p=[],m=M=0,ne=P.length;M<ne;m=++M){if(S=P[m],d=f[m],S===65535){l.push(0),j.push(0);break}if(S-(k=r[S].new)>=32768)for(l.push(0),j.push(2*(p.length+A-m)),i=W=S;S<=d?W<=d:W>=d;i=S<=d?++W:--W)p.push(r[i].new);else l.push(k-S),j.push(0)}for(F.writeUInt16(3),F.writeUInt16(1),F.writeUInt32(12),F.writeUInt16(4),F.writeUInt16(16+8*A+2*p.length),F.writeUInt16(0),F.writeUInt16(I),F.writeUInt16(v),F.writeUInt16(h),F.writeUInt16(C),ye=0,V=f.length;ye<V;ye++)i=f[ye],F.writeUInt16(i);for(F.writeUInt16(0),me=0,$=P.length;me<$;me++)i=P[me],F.writeUInt16(i);for(Se=0,K=l.length;Se<K;Se++)a=l[Se],F.writeUInt16(a);for(Ce=0,X=j.length;Ce<X;Ce++)E=j[Ce],F.writeUInt16(E);for(ze=0,ae=p.length;ze<ae;ze++)g=p[ze],F.writeUInt16(g);return{charMap:r,subtable:F.data,maxGlyphID:N+1}}},t}(),PD=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="cmap",e.prototype.parse=function(n){var r,i,s;for(n.pos=this.offset,this.version=n.readUInt16(),s=n.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=s?i<s:i>s;i=0<=s?++i:--i)r=new $6(n,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(n,r){var i,s;return r==null&&(r="macroman"),i=$6.encode(n,r),(s=new du).writeUInt16(0),s.writeUInt16(1),i.table=s.data.concat(i.subtable),i},e}(),lZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="hhea",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},e}(),cZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="OS/2",e.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(n.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(n.readInt());return i}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(n.readInt());return i}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},e}(),uZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="post",e.prototype.parse=function(n){var r,i,s;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var o;for(i=n.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],s=[];n.pos<this.offset+this.length;)r=n.readByte(),s.push(this.names.push(n.readString(r)));return s;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=(function(){var a,l,c;for(c=[],o=a=0,l=this.file.maxp.numGlyphs;0<=l?a<l:a>l;o=0<=l?++a:--a)c.push(n.readUInt32());return c}).call(this)}},e}(),dZ=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},hZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="name",e.prototype.parse=function(n){var r,i,s,o,a,l,c,d,f,h,p;for(n.pos=this.offset,n.readShort(),r=n.readShort(),l=n.readShort(),i=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)i.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+l+n.readShort()});for(c={},o=f=0,h=i.length;f<h;o=++f)s=i[o],n.pos=s.offset,d=n.readString(s.length),a=new dZ(d,s),c[p=s.nameID]==null&&(c[p]=[]),c[s.nameID].push(a);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),fZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="maxp",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},e}(),pZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="hmtx",e.prototype.parse=function(n){var r,i,s,o,a,l,c;for(n.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,f;for(f=[],r=d=0;0<=s?d<s:d>s;r=0<=s?++d:--d)f.push(n.readInt16());return f}(),this.widths=(function(){var d,f,h,p;for(p=[],d=0,f=(h=this.metrics).length;d<f;d++)o=h[d],p.push(o.advance);return p}).call(this),i=this.widths[this.widths.length-1],c=[],r=a=0;0<=s?a<s:a>s;r=0<=s?++a:--a)c.push(this.widths.push(i));return c},e.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},e}(),kD=[].slice,mZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(n){var r,i,s,o,a,l,c,d,f,h;return n in this.cache?this.cache[n]:(o=this.file.loca,r=this.file.contents,i=o.indexOf(n),(s=o.lengthOf(n))===0?this.cache[n]=null:(r.pos=this.offset+i,a=(l=new du(r.read(s))).readShort(),d=l.readShort(),h=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[n]=a===-1?new xZ(l,d,h,c,f):new gZ(l,a,d,h,c,f),this.cache[n]))},e.prototype.encode=function(n,r,i){var s,o,a,l,c;for(a=[],o=[],l=0,c=r.length;l<c;l++)s=n[r[l]],o.push(a.length),s&&(a=a.concat(s.encode(i)));return o.push(a.length),{table:a,offsets:o}},e}(),gZ=function(){function t(e,n,r,i,s,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),xZ=function(){function t(e,n,r,i,s){var o,a;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new du(kD.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),yZ=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ha(e,ia),e.prototype.tag="loca",e.prototype.parse=function(n){var r,i;return n.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=2)o.push(2*n.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],i=0,s=this.length;i<s;i+=4)o.push(n.readUInt32());return o}).call(this)},e.prototype.indexOf=function(n){return this.offsets[n]},e.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},e.prototype.encode=function(n,r){for(var i=new Uint32Array(this.offsets.length),s=0,o=0,a=0;a<i.length;++a)if(i[a]=s,o<r.length&&r[o]==a){++o,i[a]=s;var l=this.offsets[a],c=this.offsets[a+1]-l;c>0&&(s+=c)}for(var d=new Array(4*i.length),f=0;f<i.length;++f)d[4*f+3]=255&i[f],d[4*f+2]=(65280&i[f])>>8,d[4*f+1]=(16711680&i[f])>>16,d[4*f]=(4278190080&i[f])>>24;return d},e}(),vZ=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,s;for(n in i=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,s,o,a,l;for(i={},o=0,a=e.length;o<a;o++)i[s=e[o]]=this.font.glyf.glyphFor(s);for(s in n=[],i)(r=i[s])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(s in l=this.glyphsFor(n))r=l[s],i[s]=r;return i},t.prototype.encode=function(e,n){var r,i,s,o,a,l,c,d,f,h,p,m,g,b,x;for(i in r=PD.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},x=r.charMap)p[(l=x[i]).old]=l.new;for(m in h=r.maxGlyphID,o)m in p||(p[m]=h++);return d=function(w){var N,E;for(N in E={},w)E[w[N]]=N;return E}(p),f=Object.keys(d).sort(function(w,N){return w-N}),g=function(){var w,N,E;for(E=[],w=0,N=f.length;w<N;w++)a=f[w],E.push(d[a]);return E}(),s=this.font.glyf.encode(o,g,p),c=this.font.loca.encode(s.offsets,g),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},t}();zt.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,s,o;if(Array.isArray(n))return"["+function(){var a,l,c;for(c=[],a=0,l=n.length;a<l;a++)r=n[a],c.push(e.convert(r));return c}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in s=["<<"],n)o=n[i],s.push("/"+i+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+n},e}();const bZ=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:XJ,AcroFormAppearance:Tt,AcroFormButton:ri,AcroFormCheckBox:B0,AcroFormChoiceField:id,AcroFormComboBox:od,AcroFormEditBox:L0,AcroFormListBox:sd,AcroFormPasswordField:O0,AcroFormPushButton:M0,AcroFormRadioButton:ad,AcroFormTextField:tu,GState:Bp,ShadingPattern:Fc,TilingPattern:Yu,default:zt,jsPDF:zt},Symbol.toStringTag,{value:"Module"}));var wZ={exports:{}};const _Z=J6(bZ);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(t,e){(function(r,i){t.exports=i(function(){try{return _Z}catch{}}())})(typeof globalThis<"u"?globalThis:typeof dn<"u"?dn:typeof window<"u"?window:typeof self<"u"?self:dn,function(n){return function(){var r={172:function(a,l){var c=this&&this.__extends||function(){var h=function(p,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,b){g.__proto__=b}||function(g,b){for(var x in b)Object.prototype.hasOwnProperty.call(b,x)&&(g[x]=b[x])},h(p,m)};return function(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(p,m);function g(){this.constructor=p}p.prototype=m===null?Object.create(m):(g.prototype=m.prototype,new g)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var d=function(){function h(p,m,g){this.table=m,this.pageNumber=m.pageNumber,this.pageCount=this.pageNumber,this.settings=m.settings,this.cursor=g,this.doc=p.getDocument()}return h}();l.HookData=d;var f=function(h){c(p,h);function p(m,g,b,x,w,N){var E=h.call(this,m,g,N)||this;return E.cell=b,E.row=x,E.column=w,E.section=x.section,E}return p}(d);l.CellHookData=f},340:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0});var d=c(4),f=c(136),h=c(744),p=c(776),m=c(664),g=c(972);function b(x){x.API.autoTable=function(){for(var w=[],N=0;N<arguments.length;N++)w[N]=arguments[N];var E;w.length===1?E=w[0]:(console.error("Use of deprecated autoTable initiation"),E=w[2]||{},E.columns=w[0],E.body=w[1]);var D=(0,p.parseInput)(this,E),j=(0,g.createTable)(this,D);return(0,m.drawTable)(this,j),this},x.API.lastAutoTable=!1,x.API.previousAutoTable=!1,x.API.autoTable.previous=!1,x.API.autoTableText=function(w,N,E,D){(0,f.default)(w,N,E,D,this)},x.API.autoTableSetDefaults=function(w){return h.DocHandler.setDefaults(w,this),this},x.autoTableSetDefaults=function(w,N){h.DocHandler.setDefaults(w,N)},x.API.autoTableHtmlToJson=function(w,N){var E;if(N===void 0&&(N=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var D=new h.DocHandler(this),j=(0,d.parseHtml)(D,w,window,N,!1),C=j.head,v=j.body,A=((E=C[0])===null||E===void 0?void 0:E.map(function(I){return I.content}))||[];return{columns:A,rows:v,data:v}},x.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var w=this.lastAutoTable;return w&&w.finalY?w.finalY:0},x.API.autoTableAddPageContent=function(w){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),x.API.autoTable.globalDefaults||(x.API.autoTable.globalDefaults={}),x.API.autoTable.globalDefaults.addPageContent=w,this},x.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=b},136:function(a,l){Object.defineProperty(l,"__esModule",{value:!0});function c(d,f,h,p,m){p=p||{};var g=1.15,b=m.internal.scaleFactor,x=m.internal.getFontSize()/b,w=m.getLineHeightFactor?m.getLineHeightFactor():g,N=x*w,E=/\r\n|\r|\n/g,D="",j=1;if((p.valign==="middle"||p.valign==="bottom"||p.halign==="center"||p.halign==="right")&&(D=typeof d=="string"?d.split(E):d,j=D.length||1),h+=x*(2-g),p.valign==="middle"?h-=j/2*N:p.valign==="bottom"&&(h-=j*N),p.halign==="center"||p.halign==="right"){var C=x;if(p.halign==="center"&&(C*=.5),D&&j>=1){for(var v=0;v<D.length;v++)m.text(D[v],f-m.getStringUnitWidth(D[v])*C,h),h+=N;return m}f-=m.getStringUnitWidth(d)*C}return p.halign==="justify"?m.text(d,f,h,{maxWidth:p.maxWidth||100,align:"justify"}):m.text(d,f,h),m}l.default=c},420:function(a,l){Object.defineProperty(l,"__esModule",{value:!0}),l.getPageAvailableWidth=l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function c(m,g,b){b.applyStyles(g,!0);var x=Array.isArray(m)?m:[m],w=x.map(function(N){return b.getTextWidth(N)}).reduce(function(N,E){return Math.max(N,E)},0);return w}l.getStringWidth=c;function d(m,g,b,x){var w=g.settings.tableLineWidth,N=g.settings.tableLineColor;m.applyStyles({lineWidth:w,lineColor:N});var E=f(w,!1);E&&m.rect(b.x,b.y,g.getWidth(m.pageSize().width),x.y-b.y,E)}l.addTableBorder=d;function f(m,g){var b=m>0,x=g||g===0;return b&&x?"DF":b?"S":x?"F":null}l.getFillStyle=f;function h(m,g){var b,x,w,N;if(m=m||g,Array.isArray(m)){if(m.length>=4)return{top:m[0],right:m[1],bottom:m[2],left:m[3]};if(m.length===3)return{top:m[0],right:m[1],bottom:m[2],left:m[1]};if(m.length===2)return{top:m[0],right:m[1],bottom:m[0],left:m[1]};m.length===1?m=m[0]:m=g}return typeof m=="object"?(typeof m.vertical=="number"&&(m.top=m.vertical,m.bottom=m.vertical),typeof m.horizontal=="number"&&(m.right=m.horizontal,m.left=m.horizontal),{left:(b=m.left)!==null&&b!==void 0?b:g,top:(x=m.top)!==null&&x!==void 0?x:g,right:(w=m.right)!==null&&w!==void 0?w:g,bottom:(N=m.bottom)!==null&&N!==void 0?N:g}):(typeof m!="number"&&(m=g),{top:m,right:m,bottom:m,left:m})}l.parseSpacing=h;function p(m,g){var b=h(g.settings.margin,0);return m.pageSize().width-(b.left+b.right)}l.getPageAvailableWidth=p},796:function(a,l){var c=this&&this.__extends||function(){var p=function(m,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,x){b.__proto__=x}||function(b,x){for(var w in x)Object.prototype.hasOwnProperty.call(x,w)&&(b[w]=x[w])},p(m,g)};return function(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");p(m,g);function b(){this.constructor=m}m.prototype=g===null?Object.create(g):(b.prototype=g.prototype,new b)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=void 0;var d=function(p){c(m,p);function m(g){var b=p.call(this)||this;return b._element=g,b}return m}(Array);l.HtmlRowInput=d;function f(p){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/p,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=f;function h(p){var m={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return m[p]}l.getTheme=h},903:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var d=c(420);function f(b,x,w,N,E){var D={},j=1.3333333333333333,C=p(x,function(z){return E.getComputedStyle(z).backgroundColor});C!=null&&(D.fillColor=C);var v=p(x,function(z){return E.getComputedStyle(z).color});v!=null&&(D.textColor=v);var A=g(N,w);A&&(D.cellPadding=A);var I="borderTopColor",S=j*w,P=N.borderTopWidth;if(N.borderBottomWidth===P&&N.borderRightWidth===P&&N.borderLeftWidth===P){var k=(parseFloat(P)||0)/S;k&&(D.lineWidth=k)}else D.lineWidth={top:(parseFloat(N.borderTopWidth)||0)/S,right:(parseFloat(N.borderRightWidth)||0)/S,bottom:(parseFloat(N.borderBottomWidth)||0)/S,left:(parseFloat(N.borderLeftWidth)||0)/S},D.lineWidth.top||(D.lineWidth.right?I="borderRightColor":D.lineWidth.bottom?I="borderBottomColor":D.lineWidth.left&&(I="borderLeftColor"));var F=p(x,function(z){return E.getComputedStyle(z)[I]});F!=null&&(D.lineColor=F);var q=["left","right","center","justify"];q.indexOf(N.textAlign)!==-1&&(D.halign=N.textAlign),q=["middle","bottom","top"],q.indexOf(N.verticalAlign)!==-1&&(D.valign=N.verticalAlign);var O=parseInt(N.fontSize||"");isNaN(O)||(D.fontSize=O/j);var M=h(N);M&&(D.fontStyle=M);var W=(N.fontFamily||"").toLowerCase();return b.indexOf(W)!==-1&&(D.font=W),D}l.parseCss=f;function h(b){var x="";return(b.fontWeight==="bold"||b.fontWeight==="bolder"||parseInt(b.fontWeight)>=700)&&(x="bold"),(b.fontStyle==="italic"||b.fontStyle==="oblique")&&(x+="italic"),x}function p(b,x){var w=m(b,x);if(!w)return null;var N=w.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!N||!Array.isArray(N))return null;var E=[parseInt(N[1]),parseInt(N[2]),parseInt(N[3])],D=parseInt(N[4]);return D===0||isNaN(E[0])||isNaN(E[1])||isNaN(E[2])?null:E}function m(b,x){var w=x(b);return w==="rgba(0, 0, 0, 0)"||w==="transparent"||w==="initial"||w==="inherit"?b.parentElement==null?null:m(b.parentElement,x):w}function g(b,x){var w=[b.paddingTop,b.paddingRight,b.paddingBottom,b.paddingLeft],N=96/(72/x),E=(parseInt(b.lineHeight)-parseInt(b.fontSize))/x/2,D=w.map(function(C){return parseInt(C||"0")/N}),j=(0,d.parseSpacing)(D,0);return E>j.top&&(j.top=E),E>j.bottom&&(j.bottom=E),j}},744:function(a,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var c={},d=function(){function f(h){this.jsPDFDocument=h,this.userStyles={textColor:h.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:h.internal.getFontSize(),fontStyle:h.internal.getFont().fontStyle,font:h.internal.getFont().fontName,lineWidth:h.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:h.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return f.setDefaults=function(h,p){p===void 0&&(p=null),p?p.__autoTableDocumentDefaults=h:c=h},f.unifyColor=function(h){return Array.isArray(h)?h:typeof h=="number"?[h,h,h]:typeof h=="string"?[h]:null},f.prototype.applyStyles=function(h,p){var m,g,b;p===void 0&&(p=!1),h.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(h.fontStyle);var x=this.jsPDFDocument.internal.getFont(),w=x.fontStyle,N=x.fontName;if(h.font&&(N=h.font),h.fontStyle){w=h.fontStyle;var E=this.getFontList()[N];E&&E.indexOf(w)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(E[0]),w=E[0])}if(this.jsPDFDocument.setFont(N,w),h.fontSize&&this.jsPDFDocument.setFontSize(h.fontSize),!p){var D=f.unifyColor(h.fillColor);D&&(m=this.jsPDFDocument).setFillColor.apply(m,D),D=f.unifyColor(h.textColor),D&&(g=this.jsPDFDocument).setTextColor.apply(g,D),D=f.unifyColor(h.lineColor),D&&(b=this.jsPDFDocument).setDrawColor.apply(b,D),typeof h.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(h.lineWidth)}},f.prototype.splitTextToSize=function(h,p,m){return this.jsPDFDocument.splitTextToSize(h,p,m)},f.prototype.rect=function(h,p,m,g,b){return this.jsPDFDocument.rect(h,p,m,g,b)},f.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},f.prototype.getTextWidth=function(h){return this.jsPDFDocument.getTextWidth(h)},f.prototype.getDocument=function(){return this.jsPDFDocument},f.prototype.setPage=function(h){this.jsPDFDocument.setPage(h)},f.prototype.addPage=function(){return this.jsPDFDocument.addPage()},f.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},f.prototype.getGlobalOptions=function(){return c||{}},f.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},f.prototype.pageSize=function(){var h=this.jsPDFDocument.internal.pageSize;return h.width==null&&(h={width:h.getWidth(),height:h.getHeight()}),h},f.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},f.prototype.getLineHeightFactor=function(){var h=this.jsPDFDocument;return h.getLineHeightFactor?h.getLineHeightFactor():1.15},f.prototype.getLineHeight=function(h){return h/this.scaleFactor()*this.getLineHeightFactor()},f.prototype.pageNumber=function(){var h=this.jsPDFDocument.internal.getCurrentPageInfo();return h?h.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},f}();l.DocHandler=d},4:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var d=c(903),f=c(796);function h(g,b,x,w,N){var E,D;w===void 0&&(w=!1),N===void 0&&(N=!1);var j;typeof b=="string"?j=x.document.querySelector(b):j=b;var C=Object.keys(g.getFontList()),v=g.scaleFactor(),A=[],I=[],S=[];if(!j)return console.error("Html table could not be found with input: ",b),{head:A,body:I,foot:S};for(var P=0;P<j.rows.length;P++){var k=j.rows[P],F=(D=(E=k==null?void 0:k.parentElement)===null||E===void 0?void 0:E.tagName)===null||D===void 0?void 0:D.toLowerCase(),q=p(C,v,x,k,w,N);q&&(F==="thead"?A.push(q):F==="tfoot"?S.push(q):I.push(q))}return{head:A,body:I,foot:S}}l.parseHtml=h;function p(g,b,x,w,N,E){for(var D=new f.HtmlRowInput(w),j=0;j<w.cells.length;j++){var C=w.cells[j],v=x.getComputedStyle(C);if(N||v.display!=="none"){var A=void 0;E&&(A=(0,d.parseCss)(g,C,b,v,x)),D.push({rowSpan:C.rowSpan,colSpan:C.colSpan,styles:A,_element:C,content:m(C)})}}var I=x.getComputedStyle(w);if(D.length>0&&(N||I.display!=="none"))return D}function m(g){var b=g.cloneNode(!0);return b.innerHTML=b.innerHTML.replace(/\n/g,"").replace(/ +/g," "),b.innerHTML=b.innerHTML.split(/<br.*?>/).map(function(x){return x.trim()}).join(`
`),b.innerText||b.textContent||""}},776:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var d=c(4),f=c(356),h=c(420),p=c(744),m=c(792);function g(j,C){var v=new p.DocHandler(j),A=v.getDocumentOptions(),I=v.getGlobalOptions();(0,m.default)(v,I,A,C);var S=(0,f.assign)({},I,A,C),P;typeof window<"u"&&(P=window);var k=b(I,A,C),F=x(I,A,C),q=w(v,S),O=E(v,S,P);return{id:C.tableId,content:O,hooks:F,styles:k,settings:q}}l.parseInput=g;function b(j,C,v){for(var A={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},I=function(F){if(F==="columnStyles"){var q=j[F],O=C[F],M=v[F];A.columnStyles=(0,f.assign)({},q,O,M)}else{var W=[j,C,v],z=W.map(function(J){return J[F]||{}});A[F]=(0,f.assign)({},z[0],z[1],z[2])}},S=0,P=Object.keys(A);S<P.length;S++){var k=P[S];I(k)}return A}function x(j,C,v){for(var A=[j,C,v],I={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},S=0,P=A;S<P.length;S++){var k=P[S];k.didParseCell&&I.didParseCell.push(k.didParseCell),k.willDrawCell&&I.willDrawCell.push(k.willDrawCell),k.didDrawCell&&I.didDrawCell.push(k.didDrawCell),k.willDrawPage&&I.willDrawPage.push(k.willDrawPage),k.didDrawPage&&I.didDrawPage.push(k.didDrawPage)}return I}function w(j,C){var v,A,I,S,P,k,F,q,O,M,W,z,J=(0,h.parseSpacing)(C.margin,40/j.scaleFactor()),ne=(v=N(j,C.startY))!==null&&v!==void 0?v:J.top,V;C.showFoot===!0?V="everyPage":C.showFoot===!1?V="never":V=(A=C.showFoot)!==null&&A!==void 0?A:"everyPage";var $;C.showHead===!0?$="everyPage":C.showHead===!1?$="never":$=(I=C.showHead)!==null&&I!==void 0?I:"everyPage";var K=(S=C.useCss)!==null&&S!==void 0?S:!1,X=C.theme||(K?"plain":"striped"),ae=!!C.horizontalPageBreak,ye=(P=C.horizontalPageBreakRepeat)!==null&&P!==void 0?P:null;return{includeHiddenHtml:(k=C.includeHiddenHtml)!==null&&k!==void 0?k:!1,useCss:K,theme:X,startY:ne,margin:J,pageBreak:(F=C.pageBreak)!==null&&F!==void 0?F:"auto",rowPageBreak:(q=C.rowPageBreak)!==null&&q!==void 0?q:"auto",tableWidth:(O=C.tableWidth)!==null&&O!==void 0?O:"auto",showHead:$,showFoot:V,tableLineWidth:(M=C.tableLineWidth)!==null&&M!==void 0?M:0,tableLineColor:(W=C.tableLineColor)!==null&&W!==void 0?W:200,horizontalPageBreak:ae,horizontalPageBreakRepeat:ye,horizontalPageBreakBehaviour:(z=C.horizontalPageBreakBehaviour)!==null&&z!==void 0?z:"afterAllRows"}}function N(j,C){var v=j.getLastAutoTable(),A=j.scaleFactor(),I=j.pageNumber(),S=!1;if(v&&v.startPageNumber){var P=v.startPageNumber+v.pageNumber-1;S=P===I}return typeof C=="number"?C:(C==null||C===!1)&&S&&(v==null?void 0:v.finalY)!=null?v.finalY+20/A:null}function E(j,C,v){var A=C.head||[],I=C.body||[],S=C.foot||[];if(C.html){var P=C.includeHiddenHtml;if(v){var k=(0,d.parseHtml)(j,C.html,v,P,C.useCss)||{};A=k.head||A,I=k.body||A,S=k.foot||A}else console.error("Cannot parse html in non browser environment")}var F=C.columns||D(A,I,S);return{columns:F,head:A,body:I,foot:S}}function D(j,C,v){var A=j[0]||C[0]||v[0]||[],I=[];return Object.keys(A).filter(function(S){return S!=="_element"}).forEach(function(S){var P=1,k;Array.isArray(A)?k=A[parseInt(S)]:k=A[S],typeof k=="object"&&!Array.isArray(k)&&(P=(k==null?void 0:k.colSpan)||1);for(var F=0;F<P;F++){var q=void 0;Array.isArray(A)?q=I.length:q=S+(F>0?"_".concat(F):"");var O={dataKey:q};I.push(O)}}),I}},792:function(a,l){Object.defineProperty(l,"__esModule",{value:!0});function c(f,h,p,m){for(var g=function(N){N&&typeof N!="object"&&console.error("The options parameter should be of type object, is: "+typeof N),typeof N.extendWidth<"u"&&(N.tableWidth=N.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof N.margins<"u"&&(typeof N.margin>"u"&&(N.margin=N.margins),console.error("Use of deprecated option: margins, use margin instead.")),N.startY&&typeof N.startY!="number"&&(console.error("Invalid value for startY option",N.startY),delete N.startY),!N.didDrawPage&&(N.afterPageContent||N.beforePageContent||N.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),N.didDrawPage=function(S){f.applyStyles(f.userStyles),N.beforePageContent&&N.beforePageContent(S),f.applyStyles(f.userStyles),N.afterPageContent&&N.afterPageContent(S),f.applyStyles(f.userStyles),N.afterPageAdd&&S.pageNumber>1&&S.afterPageAdd(S),f.applyStyles(f.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(S){N[S]&&console.error('The "'.concat(S,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(S){var P=S[0],k=S[1];N[k]&&(console.error("Use of deprecated option ".concat(k,". Use ").concat(P," instead")),N[P]=N[k])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(S){var P=typeof S=="string"?S:S[0],k=typeof S=="string"?S:S[1];typeof N[P]<"u"&&(typeof N.styles[k]>"u"&&(N.styles[k]=N[P]),console.error("Use of deprecated option: "+P+", use the style "+k+" instead."))});for(var E=0,D=["styles","bodyStyles","headStyles","footStyles"];E<D.length;E++){var j=D[E];d(N[j]||{})}for(var C=N.columnStyles||{},v=0,A=Object.keys(C);v<A.length;v++){var I=A[v];d(C[I]||{})}},b=0,x=[h,p,m];b<x.length;b++){var w=x[b];g(w)}}l.default=c;function d(f){f.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),f.minCellHeight||(f.minCellHeight=f.rowHeight)):f.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),f.cellWidth||(f.cellWidth=f.columnWidth))}},260:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var d=c(796),f=c(172),h=c(420),p=function(){function x(w,N){this.pageNumber=1,this.pageCount=1,this.id=w.id,this.settings=w.settings,this.styles=w.styles,this.hooks=w.hooks,this.columns=N.columns,this.head=N.head,this.body=N.body,this.foot=N.foot}return x.prototype.getHeadHeight=function(w){return this.head.reduce(function(N,E){return N+E.getMaxCellHeight(w)},0)},x.prototype.getFootHeight=function(w){return this.foot.reduce(function(N,E){return N+E.getMaxCellHeight(w)},0)},x.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},x.prototype.callCellHooks=function(w,N,E,D,j,C){for(var v=0,A=N;v<A.length;v++){var I=A[v],S=new f.CellHookData(w,this,E,D,j,C),P=I(S)===!1;if(E.text=Array.isArray(E.text)?E.text:[E.text],P)return!1}return!0},x.prototype.callEndPageHooks=function(w,N){w.applyStyles(w.userStyles);for(var E=0,D=this.hooks.didDrawPage;E<D.length;E++){var j=D[E];j(new f.HookData(w,this,N))}},x.prototype.callWillDrawPageHooks=function(w,N){for(var E=0,D=this.hooks.willDrawPage;E<D.length;E++){var j=D[E];j(new f.HookData(w,this,N))}},x.prototype.getWidth=function(w){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var N=this.columns.reduce(function(D,j){return D+j.wrappedWidth},0);return N}else{var E=this.settings.margin;return w-E.left-E.right}},x}();l.Table=p;var m=function(){function x(w,N,E,D,j){j===void 0&&(j=!1),this.height=0,this.raw=w,w instanceof d.HtmlRowInput&&(this.raw=w._element,this.element=w._element),this.index=N,this.section=E,this.cells=D,this.spansMultiplePages=j}return x.prototype.getMaxCellHeight=function(w){var N=this;return w.reduce(function(E,D){var j;return Math.max(E,((j=N.cells[D.index])===null||j===void 0?void 0:j.height)||0)},0)},x.prototype.hasRowSpan=function(w){var N=this;return w.filter(function(E){var D=N.cells[E.index];return D?D.rowSpan>1:!1}).length>0},x.prototype.canEntireRowFit=function(w,N){return this.getMaxCellHeight(N)<=w},x.prototype.getMinimumRowHeight=function(w,N){var E=this;return w.reduce(function(D,j){var C=E.cells[j.index];if(!C)return 0;var v=N.getLineHeight(C.styles.fontSize),A=C.padding("vertical"),I=A+v;return I>D?I:D},0)},x}();l.Row=m;var g=function(){function x(w,N,E){var D,j;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=N,this.section=E,this.raw=w;var C=w;w!=null&&typeof w=="object"&&!Array.isArray(w)?(this.rowSpan=w.rowSpan||1,this.colSpan=w.colSpan||1,C=(j=(D=w.content)!==null&&D!==void 0?D:w.title)!==null&&j!==void 0?j:w,w._element&&(this.raw=w._element)):(this.rowSpan=1,this.colSpan=1);var v=C!=null?""+C:"",A=/\r\n|\r|\n/g;this.text=v.split(A)}return x.prototype.getTextPos=function(){var w;if(this.styles.valign==="top")w=this.y+this.padding("top");else if(this.styles.valign==="bottom")w=this.y+this.height-this.padding("bottom");else{var N=this.height-this.padding("vertical");w=this.y+N/2+this.padding("top")}var E;if(this.styles.halign==="right")E=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var D=this.width-this.padding("horizontal");E=this.x+D/2+this.padding("left")}else E=this.x+this.padding("left");return{x:E,y:w}},x.prototype.getContentHeight=function(w,N){N===void 0&&(N=1.15);var E=Array.isArray(this.text)?this.text.length:1,D=this.styles.fontSize/w*N,j=E*D+this.padding("vertical");return Math.max(j,this.styles.minCellHeight)},x.prototype.padding=function(w){var N=(0,h.parseSpacing)(this.styles.cellPadding,0);return w==="vertical"?N.top+N.bottom:w==="horizontal"?N.left+N.right:N[w]},x}();l.Cell=g;var b=function(){function x(w,N,E){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=w,this.raw=N,this.index=E}return x.prototype.getMaxCustomCellWidth=function(w){for(var N=0,E=0,D=w.allRows();E<D.length;E++){var j=D[E],C=j.cells[this.index];C&&typeof C.styles.cellWidth=="number"&&(N=Math.max(N,C.styles.cellWidth))}return N},x}();l.Column=b},356:function(a,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function c(d,f,h,p,m){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var g=Object(d),b=1;b<arguments.length;b++){var x=arguments[b];if(x!=null)for(var w in x)Object.prototype.hasOwnProperty.call(x,w)&&(g[w]=x[w])}return g}l.assign=c},972:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var d=c(744),f=c(260),h=c(324),p=c(796),m=c(356);function g(j,C){var v=new d.DocHandler(j),A=b(C,v.scaleFactor()),I=new f.Table(C,A);return(0,h.calculateWidths)(v,I),v.applyStyles(v.userStyles),I}l.createTable=g;function b(j,C){var v=j.content,A=E(v.columns);if(v.head.length===0){var I=w(A,"head");I&&v.head.push(I)}if(v.foot.length===0){var I=w(A,"foot");I&&v.foot.push(I)}var S=j.settings.theme,P=j.styles;return{columns:A,head:x("head",v.head,A,P,S,C),body:x("body",v.body,A,P,S,C),foot:x("foot",v.foot,A,P,S,C)}}function x(j,C,v,A,I,S){var P={},k=C.map(function(F,q){for(var O=0,M={},W=0,z=0,J=0,ne=v;J<ne.length;J++){var V=ne[J];if(P[V.index]==null||P[V.index].left===0)if(z===0){var $=void 0;Array.isArray(F)?$=F[V.index-W-O]:$=F[V.dataKey];var K={};typeof $=="object"&&!Array.isArray($)&&(K=($==null?void 0:$.styles)||{});var X=D(j,V,q,I,A,S,K),ae=new f.Cell($,X,j);M[V.dataKey]=ae,M[V.index]=ae,z=ae.colSpan-1,P[V.index]={left:ae.rowSpan-1,times:z}}else z--,W++;else P[V.index].left--,z=P[V.index].times,O++}return new f.Row(F,q,j,M)});return k}function w(j,C){var v={};return j.forEach(function(A){if(A.raw!=null){var I=N(C,A.raw);I!=null&&(v[A.dataKey]=I)}}),Object.keys(v).length>0?v:null}function N(j,C){if(j==="head"){if(typeof C=="object")return C.header||C.title||null;if(typeof C=="string"||typeof C=="number")return C}else if(j==="foot"&&typeof C=="object")return C.footer;return null}function E(j){return j.map(function(C,v){var A,I,S;return typeof C=="object"?S=(I=(A=C.dataKey)!==null&&A!==void 0?A:C.key)!==null&&I!==void 0?I:v:S=v,new f.Column(S,C,v)})}function D(j,C,v,A,I,S,P){var k=(0,p.getTheme)(A),F;j==="head"?F=I.headStyles:j==="body"?F=I.bodyStyles:j==="foot"&&(F=I.footStyles);var q=(0,m.assign)({},k.table,k[j],I.styles,F),O=I.columnStyles[C.dataKey]||I.columnStyles[C.index]||{},M=j==="body"?O:{},W=j==="body"&&v%2===0?(0,m.assign)({},k.alternateRow,I.alternateRowStyles):{},z=(0,p.defaultStyles)(S),J=(0,m.assign)({},z,q,W,M);return(0,m.assign)(J,P)}},664:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var d=c(420),f=c(260),h=c(744),p=c(356),m=c(136),g=c(224);function b(O,M){var W=M.settings,z=W.startY,J=W.margin,ne={x:J.left,y:z},V=M.getHeadHeight(M.columns)+M.getFootHeight(M.columns),$=z+J.bottom+V;if(W.pageBreak==="avoid"){var K=M.body,X=K.reduce(function(me,_e){return me+_e.height},0);$+=X}var ae=new h.DocHandler(O);(W.pageBreak==="always"||W.startY!=null&&$>ae.pageSize().height)&&(q(ae),ne.y=J.top),M.callWillDrawPageHooks(ae,ne);var ye=(0,p.assign)({},ne);M.startPageNumber=ae.pageNumber(),W.horizontalPageBreak?x(ae,M,ye,ne):(ae.applyStyles(ae.userStyles),(W.showHead==="firstPage"||W.showHead==="everyPage")&&M.head.forEach(function(me){return I(ae,M,me,ne,M.columns)}),ae.applyStyles(ae.userStyles),M.body.forEach(function(me,_e){var Se=_e===M.body.length-1;A(ae,M,me,Se,ye,ne,M.columns)}),ae.applyStyles(ae.userStyles),(W.showFoot==="lastPage"||W.showFoot==="everyPage")&&M.foot.forEach(function(me){return I(ae,M,me,ne,M.columns)})),(0,d.addTableBorder)(ae,M,ye,ne),M.callEndPageHooks(ae,ne),M.finalY=ne.y,O.lastAutoTable=M,O.previousAutoTable=M,O.autoTable&&(O.autoTable.previous=M),ae.applyStyles(ae.userStyles)}l.drawTable=b;function x(O,M,W,z){var J=(0,g.calculateAllColumnsCanFitInPage)(O,M),ne=M.settings;if(ne.horizontalPageBreakBehaviour==="afterAllRows")J.forEach(function(X,ae){O.applyStyles(O.userStyles),ae>0?F(O,M,W,z,X.columns,!0):w(O,M,z,X.columns),N(O,M,W,z,X.columns),D(O,M,z,X.columns)});else for(var V=-1,$=J[0],K=function(){var X=V;if($){O.applyStyles(O.userStyles);var ae=$.columns;V>=0?F(O,M,W,z,ae,!0):w(O,M,z,ae),X=E(O,M,V+1,z,ae),D(O,M,z,ae)}var ye=X-V;J.slice(1).forEach(function(me){O.applyStyles(O.userStyles),F(O,M,W,z,me.columns,!0),E(O,M,V+1,z,me.columns,ye),D(O,M,z,me.columns)}),V=X};V<M.body.length-1;)K()}function w(O,M,W,z){var J=M.settings;O.applyStyles(O.userStyles),(J.showHead==="firstPage"||J.showHead==="everyPage")&&M.head.forEach(function(ne){return I(O,M,ne,W,z)})}function N(O,M,W,z,J){O.applyStyles(O.userStyles),M.body.forEach(function(ne,V){var $=V===M.body.length-1;A(O,M,ne,$,W,z,J)})}function E(O,M,W,z,J,ne){O.applyStyles(O.userStyles),ne=ne??M.body.length;var V=Math.min(W+ne,M.body.length),$=-1;return M.body.slice(W,V).forEach(function(K,X){var ae=W+X===M.body.length-1,ye=k(O,M,ae,z);K.canEntireRowFit(ye,J)&&(I(O,M,K,z,J),$=W+X)}),$}function D(O,M,W,z){var J=M.settings;O.applyStyles(O.userStyles),(J.showFoot==="lastPage"||J.showFoot==="everyPage")&&M.foot.forEach(function(ne){return I(O,M,ne,W,z)})}function j(O,M,W){var z=W.getLineHeight(O.styles.fontSize),J=O.padding("vertical"),ne=Math.floor((M-J)/z);return Math.max(0,ne)}function C(O,M,W,z){var J={};O.spansMultiplePages=!0,O.height=0;for(var ne=0,V=0,$=W.columns;V<$.length;V++){var K=$[V],X=O.cells[K.index];if(X){Array.isArray(X.text)||(X.text=[X.text]);var ae=new f.Cell(X.raw,X.styles,X.section);ae=(0,p.assign)(ae,X),ae.text=[];var ye=j(X,M,z);X.text.length>ye&&(ae.text=X.text.splice(ye,X.text.length));var me=z.scaleFactor(),_e=z.getLineHeightFactor();X.contentHeight=X.getContentHeight(me,_e),X.contentHeight>=M&&(X.contentHeight=M,ae.styles.minCellHeight-=M),X.contentHeight>O.height&&(O.height=X.contentHeight),ae.contentHeight=ae.getContentHeight(me,_e),ae.contentHeight>ne&&(ne=ae.contentHeight),J[K.index]=ae}}var Se=new f.Row(O.raw,-1,O.section,J,!0);Se.height=ne;for(var Ce=0,ze=W.columns;Ce<ze.length;Ce++){var K=ze[Ce],ae=Se.cells[K.index];ae&&(ae.height=Se.height);var X=O.cells[K.index];X&&(X.height=O.height)}return Se}function v(O,M,W,z){var J=O.pageSize().height,ne=z.settings.margin,V=ne.top+ne.bottom,$=J-V;M.section==="body"&&($-=z.getHeadHeight(z.columns)+z.getFootHeight(z.columns));var K=M.getMinimumRowHeight(z.columns,O),X=K<W;if(K>$)return console.error("Will not be able to print row ".concat(M.index," correctly since it's minimum height is larger than page height")),!0;if(!X)return!1;var ae=M.hasRowSpan(z.columns),ye=M.getMaxCellHeight(z.columns)>$;return ye?(ae&&console.error("The content of row ".concat(M.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(ae||z.settings.rowPageBreak==="avoid")}function A(O,M,W,z,J,ne,V){var $=k(O,M,z,ne);if(W.canEntireRowFit($,V))I(O,M,W,ne,V);else if(v(O,W,$,M)){var K=C(W,$,M,O);I(O,M,W,ne,V),F(O,M,J,ne,V),A(O,M,K,z,J,ne,V)}else F(O,M,J,ne,V),A(O,M,W,z,J,ne,V)}function I(O,M,W,z,J){z.x=M.settings.margin.left;for(var ne=0,V=J;ne<V.length;ne++){var $=V[ne],K=W.cells[$.index];if(!K){z.x+=$.width;continue}O.applyStyles(K.styles),K.x=z.x,K.y=z.y;var X=M.callCellHooks(O,M.hooks.willDrawCell,K,W,$,z);if(X===!1){z.x+=$.width;continue}S(O,K,z);var ae=K.getTextPos();(0,m.default)(K.text,ae.x,ae.y,{halign:K.styles.halign,valign:K.styles.valign,maxWidth:Math.ceil(K.width-K.padding("left")-K.padding("right"))},O.getDocument()),M.callCellHooks(O,M.hooks.didDrawCell,K,W,$,z),z.x+=$.width}z.y+=W.height}function S(O,M,W){var z=M.styles;if(O.getDocument().setFillColor(O.getDocument().getFillColor()),typeof z.lineWidth=="number"){var J=(0,d.getFillStyle)(z.lineWidth,z.fillColor);J&&O.rect(M.x,W.y,M.width,M.height,J)}else typeof z.lineWidth=="object"&&(z.fillColor&&O.rect(M.x,W.y,M.width,M.height,"F"),P(O,M,W,z.lineWidth))}function P(O,M,W,z){var J,ne,V,$;z.top&&(J=W.x,ne=W.y,V=W.x+M.width,$=W.y,z.right&&(V+=.5*z.right),z.left&&(J-=.5*z.left),K(z.top,J,ne,V,$)),z.bottom&&(J=W.x,ne=W.y+M.height,V=W.x+M.width,$=W.y+M.height,z.right&&(V+=.5*z.right),z.left&&(J-=.5*z.left),K(z.bottom,J,ne,V,$)),z.left&&(J=W.x,ne=W.y,V=W.x,$=W.y+M.height,z.top&&(ne-=.5*z.top),z.bottom&&($+=.5*z.bottom),K(z.left,J,ne,V,$)),z.right&&(J=W.x+M.width,ne=W.y,V=W.x+M.width,$=W.y+M.height,z.top&&(ne-=.5*z.top),z.bottom&&($+=.5*z.bottom),K(z.right,J,ne,V,$));function K(X,ae,ye,me,_e){O.getDocument().setLineWidth(X),O.getDocument().line(ae,ye,me,_e,"S")}}function k(O,M,W,z){var J=M.settings.margin.bottom,ne=M.settings.showFoot;return(ne==="everyPage"||ne==="lastPage"&&W)&&(J+=M.getFootHeight(M.columns)),O.pageSize().height-z.y-J}function F(O,M,W,z,J,ne){J===void 0&&(J=[]),ne===void 0&&(ne=!1),O.applyStyles(O.userStyles),M.settings.showFoot==="everyPage"&&!ne&&M.foot.forEach(function($){return I(O,M,$,z,J)}),M.callEndPageHooks(O,z);var V=M.settings.margin;(0,d.addTableBorder)(O,M,W,z),q(O),M.pageNumber++,M.pageCount++,z.x=V.left,z.y=V.top,W.y=V.top,M.callWillDrawPageHooks(O,z),M.settings.showHead==="everyPage"&&(M.head.forEach(function($){return I(O,M,$,z,J)}),O.applyStyles(O.userStyles))}l.addPage=F;function q(O){var M=O.pageNumber();O.setPage(M+1);var W=O.pageNumber();return W===M?(O.addPage(),!0):!1}},224:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.calculateAllColumnsCanFitInPage=void 0;var d=c(420);function f(p,m,g){var b;g===void 0&&(g={});var x=(0,d.getPageAvailableWidth)(p,m),w=new Map,N=[],E=[],D=[];m.settings.horizontalPageBreakRepeat,Array.isArray(m.settings.horizontalPageBreakRepeat)?D=m.settings.horizontalPageBreakRepeat:(typeof m.settings.horizontalPageBreakRepeat=="string"||typeof m.settings.horizontalPageBreakRepeat=="number")&&(D=[m.settings.horizontalPageBreakRepeat]),D.forEach(function(A){var I=m.columns.find(function(S){return S.dataKey===A||S.index===A});I&&!w.has(I.index)&&(w.set(I.index,!0),N.push(I.index),E.push(m.columns[I.index]),x-=I.wrappedWidth)});for(var j=!0,C=(b=g==null?void 0:g.start)!==null&&b!==void 0?b:0;C<m.columns.length;){if(w.has(C)){C++;continue}var v=m.columns[C].wrappedWidth;if(j||x>=v)j=!1,N.push(C),E.push(m.columns[C]),x-=v;else break;C++}return{colIndexes:N,columns:E,lastIndex:C-1}}function h(p,m){for(var g=[],b=0;b<m.columns.length;b++){var x=f(p,m,{start:b});x.columns.length&&(g.push(x),b=x.lastIndex)}return g}l.calculateAllColumnsCanFitInPage=h},324:function(a,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var d=c(420);function f(N,E){h(N,E);var D=[],j=0;E.columns.forEach(function(v){var A=v.getMaxCustomCellWidth(E);A?v.width=A:(v.width=v.wrappedWidth,D.push(v)),j+=v.width});var C=E.getWidth(N.pageSize().width)-j;C&&(C=p(D,C,function(v){return Math.max(v.minReadableWidth,v.minWidth)})),C&&(C=p(D,C,function(v){return v.minWidth})),C=Math.abs(C),!E.settings.horizontalPageBreak&&C>.1/N.scaleFactor()&&(C=C<1?C:Math.round(C),console.warn("Of the table content, ".concat(C," units width could not fit page"))),g(E),b(E,N),m(E)}l.calculateWidths=f;function h(N,E){var D=N.scaleFactor(),j=E.settings.horizontalPageBreak,C=(0,d.getPageAvailableWidth)(N,E);E.allRows().forEach(function(v){for(var A=0,I=E.columns;A<I.length;A++){var S=I[A],P=v.cells[S.index];if(P){var k=E.hooks.didParseCell;E.callCellHooks(N,k,P,v,S,null);var F=P.padding("horizontal");P.contentWidth=(0,d.getStringWidth)(P.text,P.styles,N)+F;var q=(0,d.getStringWidth)(P.text.join(" ").split(/[^\S\u00A0]+/),P.styles,N);if(P.minReadableWidth=q+P.padding("horizontal"),typeof P.styles.cellWidth=="number")P.minWidth=P.styles.cellWidth,P.wrappedWidth=P.styles.cellWidth;else if(P.styles.cellWidth==="wrap"||j===!0)P.contentWidth>C?(P.minWidth=C,P.wrappedWidth=C):(P.minWidth=P.contentWidth,P.wrappedWidth=P.contentWidth);else{var O=10/D;P.minWidth=P.styles.minCellWidth||O,P.wrappedWidth=P.contentWidth,P.minWidth>P.wrappedWidth&&(P.wrappedWidth=P.minWidth)}}}}),E.allRows().forEach(function(v){for(var A=0,I=E.columns;A<I.length;A++){var S=I[A],P=v.cells[S.index];if(P&&P.colSpan===1)S.wrappedWidth=Math.max(S.wrappedWidth,P.wrappedWidth),S.minWidth=Math.max(S.minWidth,P.minWidth),S.minReadableWidth=Math.max(S.minReadableWidth,P.minReadableWidth);else{var k=E.styles.columnStyles[S.dataKey]||E.styles.columnStyles[S.index]||{},F=k.cellWidth||k.minCellWidth;F&&typeof F=="number"&&(S.minWidth=F,S.wrappedWidth=F)}P&&(P.colSpan>1&&!S.minWidth&&(S.minWidth=P.minWidth),P.colSpan>1&&!S.wrappedWidth&&(S.wrappedWidth=P.minWidth))}})}function p(N,E,D){for(var j=E,C=N.reduce(function(O,M){return O+M.wrappedWidth},0),v=0;v<N.length;v++){var A=N[v],I=A.wrappedWidth/C,S=j*I,P=A.width+S,k=D(A),F=P<k?k:P;E-=F-A.width,A.width=F}if(E=Math.round(E*1e10)/1e10,E){var q=N.filter(function(O){return E<0?O.width>D(O):!0});q.length&&(E=p(q,E,D))}return E}l.resizeColumns=p;function m(N){for(var E={},D=1,j=N.allRows(),C=0;C<j.length;C++)for(var v=j[C],A=0,I=N.columns;A<I.length;A++){var S=I[A],P=E[S.index];if(D>1)D--,delete v.cells[S.index];else if(P)P.cell.height+=v.height,D=P.cell.colSpan,delete v.cells[S.index],P.left--,P.left<=1&&delete E[S.index];else{var k=v.cells[S.index];if(!k)continue;if(k.height=v.height,k.rowSpan>1){var F=j.length-C,q=k.rowSpan>F?F:k.rowSpan;E[S.index]={cell:k,left:q,row:v}}}}}function g(N){for(var E=N.allRows(),D=0;D<E.length;D++)for(var j=E[D],C=null,v=0,A=0,I=0;I<N.columns.length;I++){var S=N.columns[I];if(A-=1,A>1&&N.columns[I+1])v+=S.width,delete j.cells[S.index];else if(C){var P=C;delete j.cells[S.index],C=null,P.width=S.width+v}else{var P=j.cells[S.index];if(!P)continue;if(A=P.colSpan,v=0,P.colSpan>1){C=P,v+=S.width;continue}P.width=S.width+v}}}function b(N,E){for(var D={count:0,height:0},j=0,C=N.allRows();j<C.length;j++){for(var v=C[j],A=0,I=N.columns;A<I.length;A++){var S=I[A],P=v.cells[S.index];if(P){E.applyStyles(P.styles,!0);var k=P.width-P.padding("horizontal");if(P.styles.overflow==="linebreak")P.text=E.splitTextToSize(P.text,k+1/E.scaleFactor(),{fontSize:P.styles.fontSize});else if(P.styles.overflow==="ellipsize")P.text=x(P.text,k,P.styles,E,"...");else if(P.styles.overflow==="hidden")P.text=x(P.text,k,P.styles,E,"");else if(typeof P.styles.overflow=="function"){var F=P.styles.overflow(P.text,k);typeof F=="string"?P.text=[F]:P.text=F}P.contentHeight=P.getContentHeight(E.scaleFactor(),E.getLineHeightFactor());var q=P.contentHeight/P.rowSpan;P.rowSpan>1&&D.count*D.height<q*P.rowSpan?D={height:q,count:P.rowSpan}:D&&D.count>0&&D.height>q&&(q=D.height),q>v.height&&(v.height=q)}}D.count--}}function x(N,E,D,j,C){return N.map(function(v){return w(v,E,D,j,C)})}l.ellipsize=x;function w(N,E,D,j,C){var v=1e4*j.scaleFactor();if(E=Math.ceil(E*v)/v,E>=(0,d.getStringWidth)(N,D,j))return N;for(;E<(0,d.getStringWidth)(N+C,D,j)&&!(N.length<=1);)N=N.substring(0,N.length-1);return N.trim()+C}},964:function(a){if(typeof n>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}a.exports=n}},i={};function s(a){var l=i[a];if(l!==void 0)return l.exports;var c=i[a]={exports:{}};return r[a].call(c.exports,c,c.exports,s),c.exports}var o={};return function(){var a=o;Object.defineProperty(a,"__esModule",{value:!0}),a.Cell=a.Column=a.Row=a.Table=a.CellHookData=a.__drawTable=a.__createTable=a.applyPlugin=void 0;var l=s(340),c=s(776),d=s(664),f=s(972),h=s(260);Object.defineProperty(a,"Table",{enumerable:!0,get:function(){return h.Table}});var p=s(172);Object.defineProperty(a,"CellHookData",{enumerable:!0,get:function(){return p.CellHookData}});var m=s(260);Object.defineProperty(a,"Cell",{enumerable:!0,get:function(){return m.Cell}}),Object.defineProperty(a,"Column",{enumerable:!0,get:function(){return m.Column}}),Object.defineProperty(a,"Row",{enumerable:!0,get:function(){return m.Row}});function g(E){(0,l.default)(E)}a.applyPlugin=g;function b(E,D){var j=(0,c.parseInput)(E,D),C=(0,f.createTable)(E,j);(0,d.drawTable)(E,C)}function x(E,D){var j=(0,c.parseInput)(E,D);return(0,f.createTable)(E,j)}a.__createTable=x;function w(E,D){(0,d.drawTable)(E,D)}a.__drawTable=w;try{var N=s(964);N.jsPDF&&(N=N.jsPDF),g(N)}catch{}a.default=b}(),o}()})})(wZ);const NZ=({agencyName:t,company:e})=>{const[n,r]=he.useState([]),[i,s]=he.useState(!0),[o,a]=he.useState(null),[l,c]=he.useState("all");he.useEffect(()=>{e&&t&&(async()=>{try{const p=mn(en(ot,"controleStock"),pt("company","==",e),pt("agencyName","==",t),pt("timestamp",">=",new Date(Date.now()-2592e6))),g=(await On(p)).docs.map(b=>({id:b.id,...b.data(),timestamp:b.data().timestamp.toDate()})).sort((b,x)=>x.timestamp.getTime()-b.timestamp.getTime());r(g)}catch(p){console.error("Error fetching controls:",p),ke.error("Erreur lors du chargement de l'historique")}finally{s(!1)}})()},[e,t]);const d=async h=>{var p,m,g;try{const b=new zt;if(b.setFontSize(16),b.text(`Contrôle de stock - ${Kt(h.timestamp,"dd/MM/yyyy HH:mm",{locale:zn})}`,14,20),b.setFontSize(12),b.text(`Entreprise: ${h.company}`,14,30),b.text(`Agence: ${h.agencyName}`,14,37),b.text(`Contrôlé par: ${h.userName}`,14,44),h.department&&b.text(`Département: ${h.department}`,14,51),b.autoTable({startY:h.department?58:51,head:[["Produit","Stock Initial","Stock Théorique","Stock Réel","Écart","Date de saisie"]],body:h.produits.map(x=>[x.productName,x.stockInitial,x.stockTheorique,x.stockReel,x.ecart,x.dateHeureSaisie]),styles:{fontSize:8},headStyles:{fillColor:[139,69,19]}}),h.physicalCash!==void 0){const x=b.lastAutoTable.finalY||60;b.text("Contrôle de caisse",14,x+20),b.autoTable({startY:x+25,head:[["Description","Montant"]],body:[["Montant théorique",`${(p=h.theoreticalAmount)==null?void 0:p.toFixed(2)} FCFA`],["Montant en caisse",`${(m=h.physicalCash)==null?void 0:m.toFixed(2)} FCFA`],["Différence",`${(g=h.cashDifference)==null?void 0:g.toFixed(2)} FCFA`]],styles:{fontSize:10},headStyles:{fillColor:[139,69,19]},margin:{left:14},tableWidth:100})}b.save(`controle-stock-${h.department||""}-${Kt(h.timestamp,"dd-MM-yyyy-HH-mm")}.pdf`),ke.success("PDF généré avec succès")}catch(b){console.error("Error generating PDF:",b),ke.error("Erreur lors de la génération du PDF")}},f=n.filter(h=>l==="all"?!0:h.department===l);return i?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-xl font-bold text-[#8B4513]",children:"Historique des contrôles"}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>c("all"),className:`px-4 py-2 rounded-lg transition-colors ${l==="all"?"bg-gray-800 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tous"}),u.jsxs("button",{onClick:()=>c("Boulangerie"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${l==="Boulangerie"?"bg-orange-500 text-white":"bg-orange-50 text-orange-700 hover:bg-orange-100"}`,children:[u.jsx(dm,{className:"h-4 w-4 mr-2"}),"Boulangerie"]}),u.jsxs("button",{onClick:()=>c("Boutique"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${l==="Boutique"?"bg-blue-500 text-white":"bg-blue-50 text-blue-700 hover:bg-blue-100"}`,children:[u.jsx(dy,{className:"h-4 w-4 mr-2"}),"Boutique"]})]})]}),f.length===0?u.jsx("div",{className:"text-center py-8 text-gray-500",children:l==="all"?"Aucun contrôle enregistré":`Aucun contrôle enregistré pour le département ${l}`}):u.jsx("div",{className:"space-y-4",children:f.map(h=>{var p,m,g;return u.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("p",{className:"font-medium text-gray-900",children:Kt(h.timestamp,"dd MMMM yyyy à HH:mm",{locale:zn})}),h.department&&u.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${h.department==="Boulangerie"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:h.department})]}),u.jsxs("p",{className:"text-sm text-gray-500",children:[h.produits.length," produit",h.produits.length>1?"s":""," contrôlé",h.produits.length>1?"s":""]}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Par: ",h.userName]})]}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>a(h===o?null:h),className:"p-2 text-gray-600 hover:text-[#8B4513] transition-colors",title:"Voir les détails",children:u.jsx(uy,{className:"h-5 w-5"})}),u.jsx("button",{onClick:()=>d(h),className:"p-2 text-gray-600 hover:text-[#8B4513] transition-colors",title:"Télécharger PDF",children:u.jsx(wp,{className:"h-5 w-5"})})]})]}),(o==null?void 0:o.id)===h.id&&u.jsx("div",{className:"mt-4",children:u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-100",children:[u.jsx("th",{className:"px-4 py-2",children:"Produit"}),u.jsx("th",{className:"px-4 py-2",children:"Département"}),u.jsx("th",{className:"px-4 py-2",children:"Stock Initial"}),u.jsx("th",{className:"px-4 py-2",children:"Stock Théorique"}),u.jsx("th",{className:"px-4 py-2",children:"Stock Réel"}),u.jsx("th",{className:"px-4 py-2",children:"Écart"}),u.jsx("th",{className:"px-4 py-2",children:"Date de saisie"})]})}),u.jsx("tbody",{children:h.produits.map((b,x)=>u.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 font-medium",children:b.productName}),u.jsx("td",{className:"px-4 py-2",children:b.department&&u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.department==="Boulangerie"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:b.department})}),u.jsx("td",{className:"px-4 py-2",children:b.stockInitial}),u.jsx("td",{className:"px-4 py-2",children:b.stockTheorique}),u.jsx("td",{className:"px-4 py-2",children:b.stockReel}),u.jsx("td",{className:"px-4 py-2",children:u.jsxs("span",{className:`font-medium ${b.ecart>0?"text-green-600":b.ecart<0?"text-red-600":"text-gray-600"}`,children:[b.ecart>0?"✅ +":b.ecart<0?"❌ ":"",b.ecart]})}),u.jsx("td",{className:"px-4 py-2",children:b.dateHeureSaisie})]},x))})]})}),h.physicalCash!==void 0&&u.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg",children:[u.jsx("h3",{className:"font-medium mb-2",children:"Contrôle de caisse"}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Montant théorique"}),u.jsxs("p",{className:"font-medium",children:[(p=h.theoreticalAmount)==null?void 0:p.toFixed(2)," FCFA"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Montant en caisse"}),u.jsxs("p",{className:"font-medium",children:[(m=h.physicalCash)==null?void 0:m.toFixed(2)," FCFA"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Différence"}),u.jsxs("p",{className:`font-medium ${(h.cashDifference||0)>0?"text-green-600":(h.cashDifference||0)<0?"text-red-600":"text-gray-600"}`,children:[(h.cashDifference||0)>0?"+":"",(g=h.cashDifference)==null?void 0:g.toFixed(2)," FCFA"]})]})]})]})]})})]},h.id)})})]})},AZ=()=>{const{user:t,loading:e}=Li(),[n,r]=he.useState([]),[i,s]=he.useState([]),[o,a]=he.useState(!0),[l,c]=he.useState(!1),[d,f]=he.useState(""),[h,p]=he.useState(""),[m,g]=he.useState(0),[b,x]=he.useState("Boulangerie");he.useEffect(()=>{!e&&t&&(async()=>{var v,A;if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName))){a(!0);try{const I=mn(en(ot,"products"),pt("company","==",t.company),oi("name","asc")),S=mn(en(ot,"controleStock"),pt("company","==",t.company),pt("agencyName","==",t.agencyName),oi("timestamp","desc")),P=mn(en(ot,"avaries"),pt("company","==",t.company),pt("agencyName","==",t.agencyName)),[k,F,q]=await Promise.all([On(I),On(S),On(P)]),O=k.docs.map(V=>({id:V.id,...V.data()})),M=F.docs[0],W=M?M.data():null,z=((A=(v=W==null?void 0:W.timestamp)==null?void 0:v.toDate)==null?void 0:A.call(v))||new Date(0),J=q.docs.map(V=>V.data()).filter(V=>{var K,X;const $=(X=(K=V.timestamp)==null?void 0:K.toDate)==null?void 0:X.call(K);return $&&$>z}),ne=O.map(V=>{var _e,Se;const $=(_e=W==null?void 0:W.produits)==null?void 0:_e.find(Ce=>Ce.productId===V.id),K=($==null?void 0:$.stockReel)??0,X=((Se=V.stockParAgence)==null?void 0:Se[t.agencyName])??0,ae=K-X,me=J.filter(Ce=>Ce.productId===V.id).reduce((Ce,ze)=>Ce+(ze.quantity||0),0);return{productId:V.id,productName:V.name,reference:V.reference,initialStock:K,theoreticalStock:X,actualStock:null,entryTime:null,isEditable:!0,difference:null,quantitySoldTheoretical:ae,quantitySoldReal:null,theoreticalAmount:ae*V.price,realAmount:null,avaries:me,department:V.department||"Boulangerie"}});r(O),s(ne)}catch(I){console.error(I),ke.error("Erreur de chargement")}finally{a(!1)}}})()},[t,e]);const w=(C,v)=>{s(A=>A.map(I=>{if(I.productId===C){const S=v===""?null:parseInt(v),P=n.find(M=>M.id===C),k=(P==null?void 0:P.price)||0;if(S===null)return{...I,actualStock:null,entryTime:null,difference:null,quantitySoldReal:null,realAmount:null};const F=S-I.theoreticalStock,q=I.initialStock-S,O=q*k;return{...I,actualStock:S,entryTime:Kt(new Date,"dd/MM/yyyy HH:mm",{locale:zn}),difference:F,quantitySoldReal:q,realAmount:O,isEditable:!0}}return I}))},N=C=>C.reduce((v,A)=>({theoreticalSales:v.theoreticalSales+A.quantitySoldTheoretical,theoreticalAmount:v.theoreticalAmount+A.theoreticalAmount,realSales:v.realSales+(A.quantitySoldReal||0),realAmount:v.realAmount+(A.realAmount||0)}),{theoreticalSales:0,theoreticalAmount:0,realSales:0,realAmount:0});he.useEffect(()=>{const C=i.filter(I=>I.department===b),v=N(C),A=parseFloat(h)||0;g(A-v.realAmount)},[h,i,b]);const E=async()=>{if(!(t!=null&&t.company)||!(t!=null&&t.agencyName)){ke.error("Informations entreprise ou agence manquantes");return}const C=i.filter(v=>v.department===b&&v.actualStock!==null);if(C.length===0){ke.error("Aucune saisie à enregistrer");return}c(!0);try{const v=N(C),A=parseFloat(h)||0,I={timestamp:Bt.now(),company:t.company,agencyName:t.agencyName,userId:t.id,userName:`${t.firstName} ${t.lastName}`,department:b,produits:C.map(S=>({productId:S.productId,productName:S.productName,stockInitial:S.initialStock,stockTheorique:S.theoreticalStock,stockReel:S.actualStock,dateHeureSaisie:S.entryTime,ecart:S.difference,department:S.department})),physicalCash:A,theoreticalAmount:v.realAmount,cashDifference:A-v.realAmount};await Ld(en(ot,"controleStock"),I),ke.success("Contrôle de stock enregistré avec succès"),s(S=>S.map(P=>P.department===b?{...P,actualStock:null,entryTime:null,difference:null,quantitySoldReal:null,realAmount:null}:P)),p("")}catch(v){console.error("Error saving stock control:",v),ke.error("Erreur lors de l'enregistrement")}finally{c(!1)}},D=i.filter(C=>{const v=C.department===b,A=d===""||C.productName.toLowerCase().includes(d.toLowerCase())||C.reference.toLowerCase().includes(d.toLowerCase());return v&&A}),j=N(D);return!(t!=null&&t.company)||!(t!=null&&t.agencyName)?u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Informations entreprise ou agence manquantes"})}):u.jsxs("div",{className:"p-6",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Contrôle de stock"}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Sélectionner un département"}),u.jsxs("div",{className:"flex space-x-4",children:[u.jsxs("button",{onClick:()=>x("Boulangerie"),className:`flex items-center px-6 py-3 rounded-lg transition-all ${b==="Boulangerie"?"bg-orange-100 text-orange-800 shadow-md transform scale-105":"bg-gray-100 text-gray-700 hover:bg-orange-50"}`,children:[u.jsx(dm,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Boulangerie"}),u.jsx("span",{className:"ml-2 bg-white px-2 py-1 rounded-full text-xs font-bold",children:i.filter(C=>C.department==="Boulangerie").length})]}),u.jsxs("button",{onClick:()=>x("Boutique"),className:`flex items-center px-6 py-3 rounded-lg transition-all ${b==="Boutique"?"bg-blue-100 text-blue-800 shadow-md transform scale-105":"bg-gray-100 text-gray-700 hover:bg-blue-50"}`,children:[u.jsx(dy,{className:"h-5 w-5 mr-2"}),u.jsx("span",{children:"Boutique"}),u.jsx("span",{className:"ml-2 bg-white px-2 py-1 rounded-full text-xs font-bold",children:i.filter(C=>C.department==="Boutique").length})]})]})]}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${b==="Boulangerie"?"bg-orange-500":"bg-blue-500"}`}),u.jsxs("span",{className:"font-medium text-gray-800",children:["Contrôle de stock : Département ",b]}),u.jsxs("span",{className:"ml-2 bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm font-medium",children:[D.length," produit",D.length>1?"s":""]})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:u.jsxs("div",{className:"relative",children:[u.jsx(Wl,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"text",placeholder:`Rechercher un produit dans ${b}...`,className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",value:d,onChange:C=>f(C.target.value)})]})}),o?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx(Un,{className:"animate-spin w-6 h-6 text-gray-600"})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow-md p-4 mb-6",children:u.jsxs("table",{className:"min-w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-gray-100 text-left",children:[u.jsx("th",{className:"px-4 py-3 text-gray-600 font-semibold rounded-tl-lg",children:"Produit"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Stock initial"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Stock théorique"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Quantité vendue (théorique)"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Montant théorique"}),u.jsx("th",{className:"px-4 py-3 text-center text-gray-600 font-semibold",children:"Stock réel"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Quantité vendue (réelle)"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Montant réel"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold",children:"Écart"}),u.jsx("th",{className:"px-4 py-3 text-gray-600 font-semibold",children:"Date de saisie"}),u.jsx("th",{className:"px-4 py-3 text-right text-gray-600 font-semibold rounded-tr-lg",children:"Avaries"})]})}),u.jsxs("tbody",{children:[D.length===0?u.jsx("tr",{children:u.jsxs("td",{colSpan:11,className:"px-4 py-6 text-center text-gray-500",children:["Aucun produit trouvé pour le département ",b,d&&` correspondant à "${d}"`]})}):D.map(C=>u.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-gray-900",children:C.productName}),u.jsxs("div",{className:"text-xs text-gray-500",children:["Réf: ",C.reference]})]})}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.initialStock}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.theoreticalStock}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.quantitySoldTheoretical}),u.jsxs("td",{className:"px-4 py-3 text-right",children:[C.theoreticalAmount.toFixed(0)," FCFA"]}),u.jsx("td",{className:"px-4 py-3",children:u.jsx("div",{className:"flex justify-center",children:u.jsx("input",{type:"number",value:C.actualStock??"",onChange:v=>w(C.productId,v.target.value),disabled:!C.isEditable,className:"w-24 p-2 text-center border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-[#8B4513] focus:border-[#8B4513] hover:border-gray-400 transition-colors disabled:bg-gray-100 disabled:cursor-not-allowed",min:"0",placeholder:"Saisir..."})})}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.quantitySoldReal!==null?C.quantitySoldReal:"-"}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.realAmount!==null?`${C.realAmount.toFixed(0)} FCFA`:"-"}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.difference!==null&&u.jsxs("span",{className:`font-medium ${C.difference>0?"text-green-600":C.difference<0?"text-red-600":"text-gray-500"}`,children:[C.difference>0?"+":"",C.difference]})}),u.jsx("td",{className:"px-4 py-3",children:C.entryTime||"-"}),u.jsx("td",{className:"px-4 py-3 text-right",children:C.avaries})]},C.productId)),D.length>0&&u.jsxs("tr",{className:"bg-gray-50 font-bold",children:[u.jsx("td",{className:"px-4 py-3 rounded-bl-lg",children:"Total"}),u.jsx("td",{className:"px-4 py-3 text-right",children:"-"}),u.jsx("td",{className:"px-4 py-3 text-right",children:"-"}),u.jsx("td",{className:"px-4 py-3 text-right",children:j.theoreticalSales}),u.jsxs("td",{className:"px-4 py-3 text-right",children:[j.theoreticalAmount.toFixed(0)," FCFA"]}),u.jsx("td",{className:"px-4 py-3",children:"-"}),u.jsx("td",{className:"px-4 py-3 text-right",children:j.realSales}),u.jsxs("td",{className:"px-4 py-3 text-right",children:[j.realAmount.toFixed(0)," FCFA"]}),u.jsx("td",{className:"px-4 py-3 text-right",children:"-"}),u.jsx("td",{className:"px-4 py-3",children:"-"}),u.jsx("td",{className:"px-4 py-3 text-right rounded-br-lg",children:"-"})]})]})]})}),u.jsxs("div",{className:"mt-6 bg-white p-6 rounded-lg shadow-md",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Montant en caisse physique (FCFA)"}),u.jsx("input",{type:"number",value:h,onChange:C=>p(C.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",placeholder:"Entrez le montant..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Différence avec le montant théorique"}),u.jsxs("div",{className:`text-xl font-bold ${m>0?"text-green-600":m<0?"text-red-600":"text-gray-600"}`,children:[m>0?"+":"",m.toFixed(0)," FCFA"]})]})]}),u.jsx("div",{className:"flex justify-end space-x-4",children:u.jsx("button",{onClick:E,disabled:l||D.every(C=>C.actualStock===null),className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:l?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):u.jsxs(u.Fragment,{children:[u.jsx(hm,{className:"h-5 w-5 mr-2"}),"Enregistrer le contrôle"]})})})]}),t&&u.jsx(NZ,{agencyName:t.agencyName,company:t.company})]})]})},SZ=({saleId:t,onClose:e})=>{const[n,r]=Ko.useState(null),[i,s]=Ko.useState(!0),[o,a]=Ko.useState(null);Ko.useEffect(()=>{(async()=>{try{const d=await ps(ln(ot,"ventes",t));if(!d.exists())throw new Error("Vente non trouvée");const f=d.data();r({...f,timestamp:f.timestamp.toDate()})}catch(d){console.error("Error fetching sale:",d),a(d instanceof Error?d.message:"Erreur lors du chargement des données")}finally{s(!1)}})()},[t]);const l=async()=>{if(n)try{await fj(n.productName.map((c,d)=>({product:{id:`${d}`,name:c,price:n.unitPrice[d],category:"pains",image:"",reference:"",allergens:[],stock:0,isFavorite:!1,minStock:0,freshWeight:0,department:"Boulangerie"},quantity:n.quantity[d]})),n.totalAmount,n.totalAmount/1.1925,n.totalAmount-n.totalAmount/1.1925,n.cashReceived,n.changeDue,n.company,n.agency),ke.success("Impression du ticket en cours")}catch(c){console.error("Error printing receipt:",c),ke.error("Erreur lors de l'impression")}};return i?u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsx("div",{className:"bg-white rounded-lg p-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#8B4513]"})})}):o||!n?u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-8",children:[u.jsx("p",{className:"text-red-600",children:o||"Données non disponibles"}),u.jsx("button",{onClick:e,className:"mt-4 px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Fermer"})]})}):u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center sticky top-0 z-10",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Détails de la Vente"}),u.jsx("button",{onClick:e,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-8",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700 mb-2",children:"Date de Facturation"}),u.jsx("p",{children:Kt(n.timestamp,"dd MMMM yyyy à HH:mm",{locale:zn})})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700 mb-2",children:"Enregistré par"}),u.jsx("p",{children:n.recordedBy})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700 mb-2",children:"Société"}),u.jsx("p",{children:n.company})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700 mb-2",children:"Agence"}),u.jsx("p",{children:n.agency})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Détails des Produits"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-100",children:[u.jsx("th",{className:"px-6 py-3 text-gray-600",children:"Produit"}),u.jsx("th",{className:"px-6 py-3 text-right text-gray-600",children:"Quantité"}),u.jsx("th",{className:"px-6 py-3 text-right text-gray-600",children:"Prix Unit."}),u.jsx("th",{className:"px-6 py-3 text-right text-gray-600",children:"Total"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:n.productName.map((c,d)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:c}),u.jsx("td",{className:"px-6 py-4 text-right",children:n.quantity[d]}),u.jsxs("td",{className:"px-6 py-4 text-right",children:[n.unitPrice[d].toFixed(0)," Fcfa"]}),u.jsxs("td",{className:"px-6 py-4 text-right",children:[(n.quantity[d]*n.unitPrice[d]).toFixed(0)," Fcfa"]})]},d))}),u.jsxs("tfoot",{className:"bg-gray-50",children:[u.jsxs("tr",{children:[u.jsx("td",{colSpan:3,className:"px-6 py-4 font-bold text-right",children:"Total HT:"}),u.jsxs("td",{className:"px-6 py-4 font-bold text-right",children:[(n.totalAmount/1.1925).toFixed(0)," Fcfa"]})]}),u.jsxs("tr",{children:[u.jsx("td",{colSpan:3,className:"px-6 py-4 font-bold text-right",children:"TVA (19.25%):"}),u.jsxs("td",{className:"px-6 py-4 font-bold text-right",children:[(n.totalAmount-n.totalAmount/1.1925).toFixed(0)," Fcfa"]})]}),u.jsxs("tr",{children:[u.jsx("td",{colSpan:3,className:"px-6 py-4 font-bold text-right",children:"Total TTC:"}),u.jsxs("td",{className:"px-6 py-4 font-bold text-right",children:[n.totalAmount.toFixed(0)," Fcfa"]})]}),u.jsxs("tr",{children:[u.jsx("td",{colSpan:3,className:"px-6 py-4 text-right",children:"Montant reçu:"}),u.jsxs("td",{className:"px-6 py-4 text-right",children:[n.cashReceived.toFixed(0)," Fcfa"]})]}),u.jsxs("tr",{children:[u.jsx("td",{colSpan:3,className:"px-6 py-4 text-right",children:"Monnaie rendue:"}),u.jsxs("td",{className:"px-6 py-4 text-right",children:[n.changeDue.toFixed(0)," Fcfa"]})]})]})]})})]}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[u.jsxs("button",{onClick:l,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] flex items-center",children:[u.jsx(bf,{className:"h-5 w-5 mr-2"}),"Imprimer"]}),u.jsx("button",{onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Fermer"})]})]})]})})},EZ=()=>{const{user:t,loading:e}=Li(),[n,r]=he.useState([]),[i,s]=he.useState(!0),[o,a]=he.useState(null),[l,c]=he.useState(""),[d,f]=he.useState(""),[h,p]=he.useState("");he.useEffect(()=>{if(e||!(t!=null&&t.agencyName)||!(t!=null&&t.company))return;let w;return(async()=>{try{let E=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",t.agencyName));if(d&&h){const D=new Date(d);D.setHours(0,0,0,0);const j=new Date(h);j.setHours(23,59,59,999),E=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",t.agencyName),pt("timestamp",">=",Bt.fromDate(D)),pt("timestamp","<=",Bt.fromDate(j)),oi("timestamp","desc"))}else E=mn(E,oi("timestamp","desc"));w=Ic(E,D=>{const j=D.docs.map(C=>({id:C.id,...C.data(),timestamp:C.data().timestamp.toDate()}));r(j),s(!1)},D=>{console.error("Error fetching sales:",D),ke.error("Erreur lors du chargement des ventes"),s(!1)})}catch(E){console.error("Error setting up sales listener:",E),ke.error("Erreur lors du chargement des ventes"),s(!1)}})(),()=>{w&&w()}},[t==null?void 0:t.agencyName,t==null?void 0:t.company,d,h,e]);const m=(t==null?void 0:t.role)==="ADMINISTRATEUR",g=async w=>{if(!m){ke.error("Action non autorisée");return}if(window.confirm("Êtes-vous sûr de vouloir supprimer cette vente ?"))try{await ry(ln(ot,"ventes",w)),ke.success("Vente supprimée avec succès"),o===w&&a(null)}catch(N){console.error("Error deleting sale:",N),ke.error("Erreur lors de la suppression")}},b=()=>{const w=new zt;w.setFontSize(16),w.text("Rapport des Ventes",14,20),w.setFontSize(12),w.text(`Agence: ${(t==null?void 0:t.agencyName)||""}`,14,30),d&&h&&w.text(`Période: du ${Kt(new Date(d),"dd/MM/yyyy")} au ${Kt(new Date(h),"dd/MM/yyyy")}`,14,40);const N=x.map(E=>[Kt(new Date(E.timestamp),"dd/MM/yyyy HH:mm",{locale:zn}),E.productName.join(", "),E.quantity.reduce((D,j)=>D+j,0),`${E.totalAmount} Fcfa`]);w.autoTable({startY:d&&h?45:35,head:[["Date","Articles","Quantités","Montant"]],body:N,styles:{fontSize:8},headStyles:{fillColor:[139,69,19]}}),w.save(`rapport-ventes-${t==null?void 0:t.agencyName}.pdf`),ke.success("Rapport PDF généré avec succès")},x=n.filter(w=>{const N=l.toLowerCase();return w.productName.some(E=>E.toLowerCase().includes(N))});return i?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):t!=null&&t.agencyName?u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Gestion des Ventes"}),u.jsxs("button",{onClick:b,className:"bg-[#8B4513] text-white px-4 py-2 rounded-lg flex items-center hover:bg-[#663300]",children:[u.jsx(wp,{className:"h-5 w-5 mr-2"}),"Exporter PDF"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Wl,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Rechercher une vente...",className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:l,onChange:w=>c(w.target.value)})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Cd,{className:"h-5 w-5 text-gray-400"}),u.jsx("input",{type:"date",value:d,onChange:w=>f(w.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-gray-500",children:"au"}),u.jsx("input",{type:"date",value:h,onChange:w=>p(w.target.value),className:"p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]"})]})]})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Articles"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Quantités"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Montant"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Actions"})]})}),u.jsx("tbody",{children:i?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center",children:u.jsx(Un,{className:"h-6 w-6 animate-spin mx-auto text-[#8B4513]"})})}):x.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Aucune vente trouvée"})}):x.map(w=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:Kt(new Date(w.timestamp),"dd/MM/yyyy HH:mm",{locale:zn})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("ul",{className:"list-disc list-inside",children:w.productName.map((N,E)=>u.jsx("li",{children:N},E))})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("ul",{className:"list-none",children:w.quantity.map((N,E)=>u.jsx("li",{children:N},E))})}),u.jsxs("td",{className:"px-6 py-4",children:[w.totalAmount," Fcfa"]}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>a(w.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Voir les détails",children:u.jsx(uy,{className:"h-5 w-5"})}),m&&u.jsx("button",{onClick:()=>g(w.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Supprimer",children:u.jsx(hy,{className:"h-5 w-5"})})]})})]},w.id))})]})})]}),o&&u.jsx(SZ,{saleId:o,onClose:()=>a(null)})]}):u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Aucune agence associée à votre compte"})})},CZ=({onClose:t})=>{const{user:e}=Li(),[n,r]=he.useState(!1),[i,s]=he.useState({description:"",amount:"",date:new Date().toISOString().split("T")[0],type:"operational"}),o=async a=>{if(a.preventDefault(),!e)return;const l=parseFloat(i.amount);if(isNaN(l)||l<=0){ke.error("Le montant doit être un nombre positif");return}r(!0);try{const c={id:lf(),description:i.description.trim(),amount:l,date:Bt.fromDate(new Date(i.date)),type:i.type,userId:e.id,userName:`${e.firstName} ${e.lastName}`,company:e.company,agencyName:e.agencyName,createdAt:Bt.now(),updatedAt:Bt.now()};await Ld(en(ot,"expenses"),c),ke.success("Dépense enregistrée avec succès"),t()}catch(c){console.error("Error adding expense:",c),ke.error("Erreur lors de l'enregistrement de la dépense")}finally{r(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Nouvelle Dépense"}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:o,className:"p-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Type de Dépense"}),u.jsxs("select",{value:i.type,onChange:a=>s({...i,type:a.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"operational",children:"Opérationnelle"}),u.jsx("option",{value:"maintenance",children:"Maintenance"}),u.jsx("option",{value:"supplies",children:"Fournitures"}),u.jsx("option",{value:"other",children:"Autre"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Date"}),u.jsx("input",{type:"date",value:i.date,onChange:a=>s({...i,date:a.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Montant (Fcfa)"}),u.jsx("input",{type:"number",value:i.amount,onChange:a=>s({...i,amount:a.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,min:"0",step:"0.01",placeholder:"0.00"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Description"}),u.jsx("textarea",{value:i.description,onChange:a=>s({...i,description:a.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,rows:4,placeholder:"Description détaillée de la dépense..."})]})]}),u.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:n,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:n?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer"})]})]})]})})},PZ=()=>{const{user:t}=Li(),[e,n]=he.useState(!1),[r,i]=he.useState([]),[s,o]=he.useState(!0),[a,l]=he.useState({start:"",end:""}),[c,d]=he.useState("");he.useEffect(()=>{(async()=>{if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName)))try{let g=mn(en(ot,"expenses"),pt("company","==",t.company),pt("agencyName","==",t.agencyName),oi("date","desc"));const x=(await On(g)).docs.map(w=>({id:w.id,...w.data(),date:w.data().date.toDate()}));i(x)}catch(g){console.error("Error fetching expenses:",g),ke.error("Erreur lors du chargement des dépenses")}finally{o(!1)}})()},[t]);const f=r.filter(m=>{const g=m.description.toLowerCase().includes(c.toLowerCase()),b=new Date(m.date),x=(!a.start||b>=new Date(a.start))&&(!a.end||b<=new Date(a.end));return g&&x}),h=f.reduce((m,g)=>m+g.amount,0),p=()=>{const m=new zt;m.setFontSize(16),m.text("Rapport des Dépenses",14,20),m.setFontSize(12),m.text(`Agence: ${(t==null?void 0:t.agencyName)||""}`,14,30),a.start&&a.end&&m.text(`Période: du ${Kt(new Date(a.start),"dd/MM/yyyy")} au ${Kt(new Date(a.end),"dd/MM/yyyy")}`,14,40);const g=f.map(x=>[Kt(new Date(x.date),"dd/MM/yyyy HH:mm",{locale:zn}),x.description,x.type==="operational"?"Opérationnelle":x.type==="maintenance"?"Maintenance":x.type==="supplies"?"Fournitures":"Autre",`${Math.round(x.amount).toLocaleString()} Fcfa`]);m.autoTable({startY:a.start&&a.end?45:35,head:[["Date","Description","Type","Montant"]],body:g,styles:{fontSize:8},headStyles:{fillColor:[139,69,19]}});const b=m.lastAutoTable.finalY||60;m.text(`Total des dépenses: ${Math.round(h).toLocaleString()} Fcfa`,14,b+10),m.save(`rapport-depenses-${t==null?void 0:t.agencyName}-${Kt(new Date,"dd-MM-yyyy")}.pdf`),ke.success("Rapport PDF généré avec succès")};return u.jsxs("div",{className:"p-6 bg-gray-50",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Gestion des Dépenses"}),u.jsxs("button",{onClick:()=>n(!0),className:"bg-[#8B4513] text-white px-6 py-3 rounded-xl flex items-center hover:bg-[#663300] transition-colors shadow-lg hover:shadow-xl",children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Nouvelle Dépense"]})]}),u.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:[u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[u.jsx("div",{className:"flex-grow",children:u.jsxs("div",{className:"relative",children:[u.jsx(Wl,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher une dépense...",className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",value:c,onChange:m=>d(m.target.value)})]})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Cd,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"date",className:"pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",value:a.start,onChange:m=>l(g=>({...g,start:m.target.value}))})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Cd,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"date",className:"pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",value:a.end,onChange:m=>l(g=>({...g,end:m.target.value}))})]}),u.jsxs("button",{onClick:p,className:"flex items-center px-4 py-2 bg-[#8B4513] text-white rounded-xl hover:bg-[#663300] transition-colors shadow-md",children:[u.jsx(cy,{className:"h-5 w-5 mr-2"}),"Exporter PDF"]})]})]}),u.jsx("div",{className:"bg-[#8B4513]/5 rounded-xl p-4 mb-6",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-600",children:"Total des dépenses:"}),u.jsxs("span",{className:"text-2xl font-bold text-[#8B4513]",children:[Math.round(h).toLocaleString()," Fcfa"]})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b border-gray-200",children:[u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Date"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Description"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Type"}),u.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600",children:"Montant"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Utilisateur"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:f.map(m=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[u.jsx("td",{className:"px-6 py-4 text-sm",children:Kt(m.date,"dd MMM yyyy",{locale:zn})}),u.jsx("td",{className:"px-6 py-4 text-sm",children:m.description}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${m.type==="operational"?"bg-blue-100 text-blue-800":m.type==="maintenance"?"bg-yellow-100 text-yellow-800":m.type==="supplies"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:m.type==="operational"?"Opérationnelle":m.type==="maintenance"?"Maintenance":m.type==="supplies"?"Fournitures":"Autre"})}),u.jsxs("td",{className:"px-6 py-4 text-right font-medium",children:[Math.round(m.amount).toLocaleString()," Fcfa"]}),u.jsx("td",{className:"px-6 py-4 text-sm",children:m.userName})]},m.id))})]})})]}),e&&u.jsx(CZ,{onClose:()=>n(!1)})]})};_f.register(Fp,Lp,qh,Da,P4,k4,C4,kh,o1,E4);const kZ=({agencyName:t,onClose:e})=>{const{user:n}=Li(),[r,i]=he.useState(!0),[s,o]=he.useState(null),[a,l]=he.useState({start:Ap(new Date,30),end:new Date}),[c,d]=he.useState("overview"),f=[{label:"7 derniers jours",days:7},{label:"30 derniers jours",days:30},{label:"3 derniers mois",days:90},{label:"6 derniers mois",days:180}],h=async(N,E)=>{if(n!=null&&n.company){i(!0);try{const D=mn(en(ot,"ventes"),pt("company","==",n.company),pt("agency","==",t),pt("timestamp",">=",N),pt("timestamp","<=",E),oi("timestamp","desc")),j=mn(en(ot,"fichesProduction"),pt("company","==",n.company),pt("agency","==",t),pt("dateProduction",">=",N),pt("dateProduction","<=",E),oi("dateProduction","desc")),C=mn(en(ot,"expenses"),pt("company","==",n.company),pt("agencyName","==",t),pt("date",">=",N),pt("date","<=",E),oi("date","desc")),[v,A,I]=await Promise.all([On(D),On(j),On(C)]),S=v.docs.map(Se=>({...Se.data(),timestamp:Se.data().timestamp.toDate()})),P=A.docs.map(Se=>({...Se.data(),dateProduction:Se.data().dateProduction.toDate()})),k=I.docs.map(Se=>({...Se.data(),date:Se.data().date.toDate()})),F=S.reduce((Se,Ce)=>Se+Ce.totalAmount,0),q=P.reduce((Se,Ce)=>Se+Ce.coutMatieres,0),O=k.reduce((Se,Ce)=>Se+Ce.amount,0),M=q+O,W=F-M,z=F>0?W/F*100:0,J=P.reduce((Se,Ce)=>Se+Ce.coutMatieres,0),ne=k.filter(Se=>Se.type==="operational").reduce((Se,Ce)=>Se+Ce.amount,0),V=k.filter(Se=>Se.type==="supplies").reduce((Se,Ce)=>Se+Ce.amount,0),$=k.filter(Se=>Se.type==="maintenance").reduce((Se,Ce)=>Se+Ce.amount,0),K=new Map;S.forEach(Se=>{const Ce=Kt(Se.timestamp,"yyyy-MM-dd");K.has(Ce)||K.set(Ce,{revenue:0,costs:0,profit:0}),K.get(Ce).revenue+=Se.totalAmount}),P.forEach(Se=>{const Ce=Kt(Se.dateProduction,"yyyy-MM-dd");K.has(Ce)||K.set(Ce,{revenue:0,costs:0,profit:0}),K.get(Ce).costs+=Se.coutMatieres}),k.forEach(Se=>{const Ce=Kt(Se.date,"yyyy-MM-dd");K.has(Ce)||K.set(Ce,{revenue:0,costs:0,profit:0}),K.get(Ce).costs+=Se.amount});const X=Array.from(K.entries()).map(([Se,Ce])=>({date:Se,revenue:Ce.revenue,costs:Ce.costs,profit:Ce.revenue-Ce.costs})).sort((Se,Ce)=>Se.date.localeCompare(Ce.date)),ae=new Map;P.forEach(Se=>{var Ce;(Ce=Se.productsProduced)==null||Ce.forEach(ze=>{ae.has(ze.productName)||ae.set(ze.productName,{quantity:0,revenue:0});const $e=ae.get(ze.productName);$e.quantity+=ze.quantity,$e.revenue+=ze.quantity*ze.unitPrice})});const ye=Array.from(ae.entries()).map(([Se,Ce])=>({product:Se,quantity:Ce.quantity,revenue:Ce.revenue})),me=ye.reduce((Se,Ce)=>Se+Ce.quantity,0),_e=ye.length;o({revenue:F,costs:M,profit:W,profitMargin:z,unitsProduced:me,productTypes:_e,costBreakdown:{materials:J,labor:ne,operating:V,overhead:$},dailyData:X,productionData:ye})}catch(D){console.error("Error fetching agency details:",D),ke.error("Erreur lors du chargement des détails de l'agence")}finally{i(!1)}}};he.useEffect(()=>{h(a.start,a.end)},[a,t,n==null?void 0:n.company]);const p=N=>{const E=new Date,D=Ap(E,N);l({start:D,end:E})},m=N=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF",minimumFractionDigits:0,maximumFractionDigits:0}).format(N),g={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{family:"'Inter', sans-serif",size:12}}},tooltip:{backgroundColor:"rgba(255, 255, 255, 0.95)",titleColor:"#1f2937",bodyColor:"#6b7280",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:12}},scales:{x:{grid:{display:!1},ticks:{font:{family:"'Inter', sans-serif",size:11}}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{family:"'Inter', sans-serif",size:11},callback:function(N){return m(Number(N))}}}}},b={labels:(s==null?void 0:s.dailyData.map(N=>Kt(new Date(N.date),"dd/MM")))||[],datasets:[{label:"Chiffre d'affaires",data:(s==null?void 0:s.dailyData.map(N=>N.revenue))||[],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4},{label:"Coûts",data:(s==null?void 0:s.dailyData.map(N=>N.costs))||[],borderColor:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",fill:!0,tension:.4},{label:"Profit",data:(s==null?void 0:s.dailyData.map(N=>N.profit))||[],borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",fill:!0,tension:.4}]},x={labels:["Matières premières","Main-d'œuvre","Frais d'exploitation","Frais généraux"],datasets:[{data:[(s==null?void 0:s.costBreakdown.materials)||0,(s==null?void 0:s.costBreakdown.labor)||0,(s==null?void 0:s.costBreakdown.operating)||0,(s==null?void 0:s.costBreakdown.overhead)||0],backgroundColor:["#ef4444","#3b82f6","#f59e0b","#8b5cf6"],borderWidth:0}]},w={labels:(s==null?void 0:s.productionData.slice(0,10).map(N=>N.product))||[],datasets:[{label:"Quantité produite",data:(s==null?void 0:s.productionData.slice(0,10).map(N=>N.quantity))||[],backgroundColor:"rgba(59, 130, 246, 0.8)",borderRadius:8}]};return r?u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-2xl",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600 text-center",children:"Chargement des données..."})]})}):u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-7xl h-[95vh] flex flex-col overflow-hidden",children:[u.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 text-white p-6 flex-shrink-0",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:e,className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:u.jsx(ly,{className:"h-6 w-6"})}),u.jsxs("div",{children:[u.jsxs("h1",{className:"text-2xl font-bold",children:["Détails de l'agence - ",t]}),u.jsxs("p",{className:"text-blue-100 mt-1",children:[Kt(a.start,"dd MMMM yyyy",{locale:zn})," - ",Kt(a.end,"dd MMMM yyyy",{locale:zn})]})]})]}),u.jsx("button",{className:"p-2 hover:bg-white/20 rounded-xl transition-colors",children:u.jsx(cy,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"mt-6 flex flex-wrap items-center gap-4",children:[u.jsxs("div",{className:"flex items-center space-x-2 bg-white/20 rounded-xl px-4 py-2",children:[u.jsx(Cd,{className:"h-5 w-5"}),u.jsx("span",{className:"font-medium",children:"Période :"}),u.jsx("input",{type:"date",value:Kt(a.start,"yyyy-MM-dd"),onChange:N=>l(E=>({...E,start:new Date(N.target.value)})),className:"bg-transparent border-none text-white placeholder-white/70 focus:outline-none"}),u.jsx("span",{children:"-"}),u.jsx("input",{type:"date",value:Kt(a.end,"yyyy-MM-dd"),onChange:N=>l(E=>({...E,end:new Date(N.target.value)})),className:"bg-transparent border-none text-white placeholder-white/70 focus:outline-none"})]}),u.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(N=>u.jsx("button",{onClick:()=>p(N.days),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded-lg text-sm font-medium transition-colors",children:N.label},N.days))})]})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400",children:[u.jsx("div",{className:"p-6 bg-gray-50",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Chiffre d'affaires"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m((s==null?void 0:s.revenue)||0)}),u.jsxs("div",{className:"flex items-center mt-2",children:[u.jsx(Np,{className:"h-4 w-4 text-green-500 mr-1"}),u.jsx("span",{className:"text-sm text-green-600 font-medium",children:"+12.5% vs hier"})]})]}),u.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:u.jsx(J1,{className:"h-6 w-6 text-blue-600"})})]})}),u.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Coûts de production"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m((s==null?void 0:s.costs)||0)}),u.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[s!=null&&s.revenue?(s.costs/s.revenue*100).toFixed(1):0,"% du CA"]})]}),u.jsx("div",{className:"p-3 bg-red-100 rounded-xl",children:u.jsx(c5,{className:"h-6 w-6 text-red-600"})})]})}),u.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Unités produites"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(s==null?void 0:s.unitsProduced)||0}),u.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[(s==null?void 0:s.productTypes)||0," produits différents"]})]}),u.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:u.jsx(ji,{className:"h-6 w-6 text-orange-600"})})]})}),u.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Marge bénéficiaire"}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[((s==null?void 0:s.profitMargin)||0).toFixed(1),"%"]}),u.jsxs("p",{className:"text-sm text-green-600 font-medium mt-2",children:[m((s==null?void 0:s.profit)||0)," profit"]})]}),u.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:u.jsx(jv,{className:"h-6 w-6 text-green-600"})})]})})]})}),u.jsx("div",{className:"px-6 bg-white border-b border-gray-200 sticky top-0 z-10",children:u.jsx("div",{className:"flex space-x-8",children:[{id:"overview",label:"Vue d'ensemble",icon:c5},{id:"costs",label:"Répartition des Coûts",icon:jv},{id:"production",label:"Détails Production",icon:ji},{id:"trends",label:"Tendances",icon:Np}].map(N=>u.jsxs("button",{onClick:()=>d(N.id),className:`flex items-center space-x-2 py-4 px-2 border-b-2 font-medium text-sm transition-colors ${c===N.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[u.jsx(N.icon,{className:"h-5 w-5"}),u.jsx("span",{children:N.label})]},N.id))})}),u.jsxs("div",{className:"p-6",children:[c==="overview"&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(J1,{className:"h-5 w-5 text-blue-600 mr-2"}),"Répartition des Coûts de Production"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-xl",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),u.jsx("span",{className:"font-medium text-gray-700",children:"Matières premières"}),u.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"Coût des ingrédients"})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"font-bold text-gray-900",children:m((s==null?void 0:s.costBreakdown.materials)||0)}),u.jsxs("div",{className:"text-sm text-gray-500",children:[s!=null&&s.costs?(s.costBreakdown.materials/s.costs*100).toFixed(1):0,"%"]})]})]}),u.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-xl",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-3"}),u.jsx("span",{className:"font-medium text-gray-700",children:"Coûts de main-d'œuvre"}),u.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"Salaires et charges"})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"font-bold text-gray-900",children:m((s==null?void 0:s.costBreakdown.labor)||0)}),u.jsxs("div",{className:"text-sm text-gray-500",children:[s!=null&&s.costs?(s.costBreakdown.labor/s.costs*100).toFixed(1):0,"%"]})]})]}),u.jsxs("div",{className:"flex justify-between items-center p-3 bg-yellow-50 rounded-xl",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),u.jsx("span",{className:"font-medium text-gray-700",children:"Frais d'exploitation"}),u.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"Fournitures et consommables"})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"font-bold text-gray-900",children:m((s==null?void 0:s.costBreakdown.operating)||0)}),u.jsxs("div",{className:"text-sm text-gray-500",children:[s!=null&&s.costs?(s.costBreakdown.operating/s.costs*100).toFixed(1):0,"%"]})]})]}),u.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-xl",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full mr-3"}),u.jsx("span",{className:"font-medium text-gray-700",children:"Frais généraux"}),u.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"Maintenance et autres"})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"font-bold text-gray-900",children:m((s==null?void 0:s.costBreakdown.overhead)||0)}),u.jsxs("div",{className:"text-sm text-gray-500",children:[s!=null&&s.costs?(s.costBreakdown.overhead/s.costs*100).toFixed(1):0,"%"]})]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(jv,{className:"h-5 w-5 text-purple-600 mr-2"}),"Répartition Visuelle des Coûts"]}),u.jsx("div",{className:"h-80",children:u.jsx(N6,{data:x,options:g})}),u.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-2"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Matières premières"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-2"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Main-d'œuvre"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Frais d'exploitation"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full mr-2"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Frais généraux"})]})]})]})]}),c==="costs"&&u.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Analyse Détaillée des Coûts"}),u.jsx("div",{className:"h-96",children:u.jsx(N6,{data:x,options:g})})]}),c==="production"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Production par Produit"}),u.jsx("div",{className:"h-80",children:u.jsx(sJ,{data:w,options:g})})]}),u.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Détails de Production"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b border-gray-200",children:[u.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Produit"}),u.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Quantité"}),u.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"Chiffre d'affaires"}),u.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"CA par unité"})]})}),u.jsx("tbody",{children:s==null?void 0:s.productionData.map((N,E)=>u.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[u.jsx("td",{className:"py-3 px-4 font-medium",children:N.product}),u.jsx("td",{className:"py-3 px-4 text-right",children:N.quantity}),u.jsx("td",{className:"py-3 px-4 text-right font-medium",children:m(N.revenue)}),u.jsx("td",{className:"py-3 px-4 text-right",children:m(N.revenue/N.quantity)})]},E))})]})})]})]}),c==="trends"&&u.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Évolution des Performances"}),u.jsx("div",{className:"h-96",children:u.jsx(R0,{data:b,options:g})})]})]})]})]})})};_f.register(Fp,Lp,qh,Da,P4,k4,C4,E4,kh);const TZ=()=>{const{user:t}=Li(),[e,n]=he.useState([]),[r,i]=he.useState(!0),[s,o]=he.useState(!0),[a,l]=he.useState({start:Kt(Ap(new Date,7),"yyyy-MM-dd"),end:Kt(new Date,"yyyy-MM-dd")}),[c,d]=he.useState([]),[f,h]=he.useState({visible:!1,data:null}),[p,m]=he.useState([]),[g,b]=he.useState(null),[x,w]=he.useState(!1),[N,E]=he.useState({totalToday:0,totalYesterday:0,percentageChange:0,distributionData:{labels:[],values:[]}}),[D,j]=he.useState(null),C=()=>{try{const k=new zt,F=Kt(new Date,"dd/MM/yyyy");k.setFontSize(18),k.text("Rapport des Ventes par Agence",14,20),k.setFontSize(12),k.text(`Date du rapport: ${F}`,14,30);const q=e.map(M=>[M.name,`${Math.round(M.todaySales).toLocaleString()} Fcfa`,`${Math.round(M.yesterdaySales).toLocaleString()} Fcfa`,`${M.percentageChange>=0?"+":""}${M.percentageChange.toFixed(1)}%`]);k.autoTable({head:[["Agence","Ventes du jour","Ventes d'hier","Variation"]],body:q,startY:40,styles:{fontSize:10,cellPadding:5},headStyles:{fillColor:[139,69,19],textColor:255}});const O=k.lastAutoTable.finalY||150;k.setFontSize(12),k.text("Totaux:",14,O+10),k.text(`Total des ventes du jour: ${Math.round(N.totalToday).toLocaleString()} Fcfa`,14,O+20),k.text(`Total des ventes d'hier: ${Math.round(N.totalYesterday).toLocaleString()} Fcfa`,14,O+30),k.text(`Variation totale: ${N.percentageChange>=0?"+":""}${N.percentageChange.toFixed(1)}%`,14,O+40),k.save(`rapport-ventes-${Kt(new Date,"yyyy-MM-dd")}.pdf`),ke.success("Le rapport PDF a été généré avec succès")}catch(k){console.error("Error generating PDF:",k),ke.error("Erreur lors de la génération du PDF")}},v=()=>{try{const k=new zt,F=Kt(new Date,"dd/MM/yyyy HH:mm");k.setFontSize(18),k.text("État des Stocks par Agence",14,20),k.setFontSize(12),k.text(`Rapport généré le ${F}`,14,30),k.text(`Entreprise: ${(t==null?void 0:t.company)||""}`,14,40);const q=p.map(O=>[O.name,...e.map(M=>{const W=O.stockParAgence[M.name];return W===0?"Aucun stock":(W==null?void 0:W.toLocaleString())||"Aucun stock"})]);k.autoTable({head:[["Produit",...e.map(O=>O.name)]],body:q,startY:50,styles:{fontSize:10,cellPadding:5},headStyles:{fillColor:[139,69,19],textColor:255},columnStyles:{0:{cellWidth:60}}}),k.save(`etat-stocks-${Kt(new Date,"yyyy-MM-dd-HH-mm")}.pdf`),ke.success("Le rapport des stocks a été généré avec succès")}catch(k){console.error("Error generating inventory PDF:",k),ke.error("Erreur lors de la génération du PDF des stocks")}};he.useEffect(()=>{if(!(t!=null&&t.company))return;(async()=>{try{const F=mn(en(ot,"users"),pt("company","==",t.company),oi("agencyName")),q=await On(F),O=Array.from(new Set(q.docs.map(V=>V.data().agencyName).filter(Boolean))),M=await Promise.all(O.map(async V=>{const $=new Date,K=Ap($,1),X=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",V),pt("timestamp",">=",sx($)),pt("timestamp","<=",ox($))),ae=mn(en(ot,"ventes"),pt("company","==",t.company),pt("agency","==",V),pt("timestamp",">=",sx(K)),pt("timestamp","<=",ox(K))),[ye,me]=await Promise.all([On(X),On(ae)]),_e=Array(24).fill(0),Se=Array(24).fill(0);ye.docs.forEach($e=>{const dt=$e.data().timestamp.toDate().getHours();_e[dt]+=$e.data().totalAmount}),me.docs.forEach($e=>{const dt=$e.data().timestamp.toDate().getHours();Se[dt]+=$e.data().totalAmount});const Ce=ye.docs.reduce(($e,dt)=>$e+dt.data().totalAmount,0),ze=me.docs.reduce(($e,dt)=>$e+dt.data().totalAmount,0);return{id:V,name:V,todaySales:Ce,yesterdaySales:ze,percentageChange:ze?(Ce-ze)/ze*100:0,hourlyData:_e,yesterdayHourlyData:Se}}));n(M),d(O);const W=M.reduce((V,$)=>V+$.todaySales,0),z=M.reduce((V,$)=>V+$.yesterdaySales,0),J=z?(W-z)/z*100:0,ne={labels:M.map(V=>V.name),values:M.map(V=>V.todaySales)};E({totalToday:W,totalYesterday:z,percentageChange:J,distributionData:ne})}catch(F){console.error("Error fetching agencies:",F),ke.error("Erreur lors du chargement des données")}finally{i(!1)}})()},[t==null?void 0:t.company]),he.useEffect(()=>{if(!(t!=null&&t.company))return;o(!0),b(null),(async()=>{try{const F=mn(en(ot,"products"),pt("company","==",t.company),oi("name")),O=(await On(F)).docs.map(M=>({id:M.id,name:M.data().name,stockParAgence:M.data().stockParAgence||{}}));m(O)}catch(F){console.error("Error fetching inventory:",F),b("Erreur lors du chargement des stocks")}finally{o(!1)}})()},[t==null?void 0:t.company]);const A={responsive:!0,maintainAspectRatio:!f.visible,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"top"},tooltip:{callbacks:{label:k=>`${k.dataset.label}: ${k.parsed.y.toLocaleString()} Fcfa`}}},scales:{y:{beginAtZero:!0,ticks:{callback:k=>`${k.toLocaleString()} Fcfa`}}}},I={responsive:!0,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:k=>{const F=k.raw,q=k.dataset.data.reduce((M,W)=>M+W,0),O=(F/q*100).toFixed(1);return`${k.label}: ${O}% (${F.toLocaleString()} Fcfa)`}}}}},S=k=>{var F,q;if(f.visible)h({visible:!1,data:null});else{const O={labels:Array.from({length:24},(M,W)=>`${W}h`),datasets:k?[{label:"Aujourd'hui",data:((F=e.find(M=>M.name===k))==null?void 0:F.hourlyData)||[],borderColor:"#9333EA",backgroundColor:"rgba(147, 51, 234, 0.1)",fill:!0,tension:.4},{label:"Hier",data:((q=e.find(M=>M.name===k))==null?void 0:q.yesterdayHourlyData)||[],borderColor:"#6366F1",backgroundColor:"rgba(99, 102, 241, 0.1)",borderDash:[5,5],fill:!0,tension:.4}]:e.filter(M=>c.includes(M.id)).map((M,W)=>({label:M.name,data:M.hourlyData,borderColor:`hsl(${W*360/e.length}, 70%, 50%)`,backgroundColor:`hsla(${W*360/e.length}, 70%, 50%, 0.1)`,fill:!0,tension:.4}))};h({visible:!0,data:O,agency:k})}},P=k=>{j(k)};return r?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Administration Centralisée"}),u.jsx("div",{className:"flex gap-4",children:u.jsxs("button",{onClick:C,className:"flex items-center px-4 py-2 bg-[#8B4513] text-white rounded-lg hover:bg-[#663300] transition-colors",children:[u.jsx(cy,{className:"h-5 w-5 mr-2"}),"Exporter PDF"]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Chiffre d'affaires du jour"}),u.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(N.totalToday).toLocaleString()," Fcfa"]}),u.jsx("div",{className:"mt-2 flex items-center",children:N.percentageChange!==0&&u.jsxs(u.Fragment,{children:[N.percentageChange>0?u.jsx(Np,{className:"h-5 w-5 text-green-500 mr-1"}):u.jsx(d5,{className:"h-5 w-5 text-red-500 mr-1"}),u.jsxs("span",{className:N.percentageChange>0?"text-green-500":"text-red-500",children:[Math.abs(N.percentageChange).toFixed(1),"% par rapport à hier"]})]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Chiffre d'affaires d'hier"}),u.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(N.totalYesterday).toLocaleString()," Fcfa"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Distribution des revenus"}),u.jsx("div",{className:"h-[200px]",children:u.jsx(oJ,{data:{labels:N.distributionData.labels,datasets:[{data:N.distributionData.values,backgroundColor:N.distributionData.labels.map((k,F)=>`hsl(${F*360/N.distributionData.labels.length}, 70%, 50%)`)}]},options:I},`pie-${N.distributionData.values.join("-")}`)})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:e.map(k=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(t4,{className:"h-6 w-6 text-[#8B4513] mr-2"}),u.jsx("button",{onClick:()=>P(k.name),className:"font-bold text-lg hover:text-[#8B4513] transition-colors cursor-pointer",children:k.name})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>P(k.name),className:"p-2 text-gray-600 hover:text-[#8B4513] transition-colors",title:"Voir les détails",children:u.jsx(uy,{className:"h-5 w-5"})}),u.jsxs("div",{className:`flex items-center ${k.percentageChange>=0?"text-green-600":"text-red-600"}`,children:[k.percentageChange>=0?u.jsx(Np,{className:"h-5 w-5 mr-1"}):u.jsx(d5,{className:"h-5 w-5 mr-1"}),u.jsxs("span",{children:[Math.abs(k.percentageChange).toFixed(1),"%"]})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600",children:"Ventes du jour:"}),u.jsxs("span",{className:"float-right font-bold",children:[Math.round(k.todaySales).toLocaleString()," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600",children:"Ventes d'hier:"}),u.jsxs("span",{className:"float-right",children:[Math.round(k.yesterdaySales).toLocaleString()," Fcfa"]})]})]}),u.jsx("div",{className:"mt-4 h-32 cursor-pointer",onClick:()=>S(k.name),children:u.jsx(R0,{data:{labels:Array.from({length:24},(F,q)=>`${q}h`),datasets:[{label:"Aujourd'hui",data:k.hourlyData,borderColor:"#9333EA",backgroundColor:"rgba(147, 51, 234, 0.1)",fill:!0,tension:.4},{label:"Hier",data:k.yesterdayHourlyData,borderColor:"#6366F1",backgroundColor:"rgba(99, 102, 241, 0.1)",borderDash:[5,5],fill:!0,tension:.4}]},options:A},`line-${k.name}-${k.hourlyData.join("-")}`)})]},k.id))}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("button",{onClick:()=>w(!x),className:"flex items-center text-[#8B4513] hover:text-[#663300] font-bold text-xl",children:[u.jsx("h3",{children:"État des Stocks par Agence"}),x?u.jsx(DI,{className:"h-6 w-6 ml-2"}):u.jsx(jI,{className:"h-6 w-6 ml-2"})]}),x&&u.jsxs("button",{onClick:v,className:"flex items-center px-4 py-2 bg-[#8B4513] text-white rounded-lg hover:bg-[#663300]",children:[u.jsx(bf,{className:"h-5 w-5 mr-2"}),"Imprimer PDF"]})]}),x&&(s?u.jsx("div",{className:"flex justify-center items-center h-32",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):g?u.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg",children:g}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3 text-left text-gray-500 font-medium",children:"Produit"}),e.map(k=>u.jsx("th",{className:"px-6 py-3 text-right text-gray-500 font-medium",children:k.name},k.id))]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(k=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 font-medium",children:k.name}),e.map(F=>{var q;return u.jsx("td",{className:"px-6 py-4 text-right",children:k.stockParAgence[F.name]===0?u.jsx("span",{className:"text-red-600",children:"No stock"}):((q=k.stockParAgence[F.name])==null?void 0:q.toLocaleString())||"No stock"},F.id)})]},k.id))})]})}))]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Agences"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(k=>u.jsxs("label",{className:"inline-flex items-center",children:[u.jsx("input",{type:"checkbox",checked:c.includes(k.id),onChange:F=>{F.target.checked?d([...c,k.id]):d(c.filter(q=>q!==k.id))},className:"rounded border-gray-300 text-[#8B4513] focus:ring-[#8B4513]"}),u.jsx("span",{className:"ml-2",children:k.name})]},k.id))})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Date de début"}),u.jsxs("div",{className:"relative",children:[u.jsx(Cd,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"date",value:a.start,onChange:k=>l({...a,start:k.target.value}),className:"pl-10 p-2 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Date de fin"}),u.jsxs("div",{className:"relative",children:[u.jsx(Cd,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"date",value:a.end,onChange:k=>l({...a,end:k.target.value}),className:"pl-10 p-2 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]"})]})]})]})]}),u.jsx("div",{className:"h-[400px] cursor-pointer",onClick:()=>S(),children:u.jsx(R0,{data:{labels:Array.from({length:24},(k,F)=>`${F}h`),datasets:e.filter(k=>c.includes(k.id)).map((k,F)=>({label:k.name,data:k.hourlyData,borderColor:`hsl(${F*360/e.length}, 70%, 50%)`,backgroundColor:`hsla(${F*360/e.length}, 70%, 50%, 0.1)`,fill:!0,tension:.4}))},options:A},`line-all-${c.join("-")}`)})]}),f.visible&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg w-[95vw] h-[90vh] p-6 relative",children:[u.jsx("button",{onClick:()=>h({visible:!1,data:null}),className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})}),u.jsx("h3",{className:"text-xl font-bold mb-4",children:f.agency?`Évolution des ventes - ${f.agency}`:"Comparaison des ventes par agence"}),u.jsx("div",{className:"h-[calc(90vh-100px)]",children:u.jsx(R0,{data:f.data,options:A},`fullscreen-${f.agency||"all"}`)})]})}),D&&u.jsx(kZ,{agencyName:D,onClose:()=>j(null)})]})},TD=async t=>{const e=new zt;e.setFontSize(20),e.setFont("helvetica","bold"),e.text("BON DE LIVRAISON / TRANSFERT",105,20,{align:"center"}),e.setFontSize(12),e.setFont("helvetica","normal"),e.text(t.company,20,35);const n=IZ(t.movementType);e.setFontSize(14),e.setFont("helvetica","bold"),e.text(`${n} - DÉPARTEMENT ${t.department.toUpperCase()}`,20,50),e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Référence: ${t.referenceNumber}`,20,60),e.text(`Date: ${Kt(t.date,"dd/MM/yyyy HH:mm",{locale:zn})}`,120,60);let r=75;const i=jZ(t),s=DZ(t);e.setFont("helvetica","bold"),e.text("EXPÉDITEUR:",20,r),e.setFont("helvetica","normal"),e.text(i,50,r),r+=10,e.setFont("helvetica","bold"),e.text("DESTINATAIRE:",20,r),e.setFont("helvetica","normal"),e.text(s,50,r),r+=15,e.setFont("helvetica","bold"),e.text("DÉTAILS DU TRANSPORT",20,r),r+=10,e.setFont("helvetica","normal"),e.text(`Opérateur: ${t.operatorName}`,20,r),e.text(`Véhicule: ${t.vehicleRegistration}`,120,r),r+=10,t.supplyCode&&(e.text(`Code d'approvisionnement: ${t.supplyCode}`,20,r),r+=10),r+=10;const o=t.products.map(d=>[d.productName,d.quantity.toString(),d.unit]);if(o.push(["TOTAL",t.totalQuantity.toString(),"-"]),e.autoTable({startY:r,head:[["Produit","Quantité","Unité"]],body:o,styles:{fontSize:10,cellPadding:5},headStyles:{fillColor:[139,69,19],textColor:255,fontStyle:"bold"},footStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold"},columnStyles:{0:{cellWidth:100},1:{cellWidth:40,halign:"right"},2:{cellWidth:30,halign:"center"}}}),t.comments){const d=e.lastAutoTable.finalY+20;e.setFont("helvetica","bold"),e.text("COMMENTAIRES:",20,d),e.setFont("helvetica","normal");const f=e.splitTextToSize(t.comments,170);e.text(f,20,d+10)}const a=e.internal.pageSize.height,l=a-60;e.setFont("helvetica","bold"),e.text("SIGNATURES",20,l),e.setFont("helvetica","normal"),e.text("Expéditeur:",20,l+15),e.text("Date: _______________",20,l+25),e.text("Signature:",20,l+35),e.rect(60,l+30,60,15),e.text("Destinataire:",130,l+15),e.text("Date: _______________",130,l+25),e.text("Signature:",130,l+35),e.rect(170,l+30,60,15),e.setFontSize(8),e.text(`Document généré le ${Kt(new Date,"dd/MM/yyyy HH:mm",{locale:zn})}`,20,a-10),e.text(`Par: ${t.createdByName}`,120,a-10);const c=`mouvement-${t.referenceNumber}-${Kt(t.date,"yyyy-MM-dd")}.pdf`;e.save(c)},IZ=t=>{switch(t){case"factory_supply":return"APPROVISIONNEMENT USINE";case"incoming_transfer":return"TRANSFERT ENTRANT";case"outgoing_transfer":return"TRANSFERT SORTANT";default:return t.toUpperCase()}},jZ=t=>{switch(t.movementType){case"factory_supply":return"USINE DE PRODUCTION";case"incoming_transfer":return t.sourceAgency||"AGENCE SOURCE";case"outgoing_transfer":return t.agency;default:return"NON DÉFINI"}},DZ=t=>{switch(t.movementType){case"factory_supply":case"incoming_transfer":return t.agency;case"outgoing_transfer":return t.destinationAgency||"AGENCE DESTINATION";default:return"NON DÉFINI"}},RZ=({onClose:t,onMovementAdded:e})=>{const{user:n}=Li(),[r,i]=he.useState(!1),[s,o]=he.useState([]),[a,l]=he.useState([]),[c,d]=he.useState("Boulangerie"),[f,h]=he.useState({movementType:"factory_supply",referenceNumber:`MOV-${Date.now()}`,date:new Date().toISOString().slice(0,16),operatorName:"",vehicleRegistration:"",supplyCode:"",sourceAgency:"",destinationAgency:"",comments:""}),[p,m]=he.useState([{productId:"",productName:"",quantity:0,unit:"kg"}]);he.useEffect(()=>{(async()=>{if(n!=null&&n.company)try{const A=mn(en(ot,"products"),pt("company","==",n.company)),S=(await On(A)).docs.map(q=>({id:q.id,...q.data()}));o(S);const P=mn(en(ot,"users"),pt("company","==",n.company)),k=await On(P),F=Array.from(new Set(k.docs.map(q=>q.data().agencyName).filter(Boolean))).map(q=>({id:q,name:q}));l(F)}catch(A){console.error("Error fetching data:",A),ke.error("Erreur lors du chargement des données")}})()},[n==null?void 0:n.company]);const g=s.filter(v=>v.department===c),b=v=>{const A=p.map((I,S)=>S!==v?I.productId:null).filter(Boolean);return g.filter(I=>!A.includes(I.id))},x=()=>{m([...p,{productId:"",productName:"",quantity:0,unit:"kg"}])},w=v=>{p.length>1&&m(p.filter((A,I)=>I!==v))},N=(v,A,I)=>{const S=[...p];if(A==="productId"){const P=g.find(k=>k.id===I);S[v]={...S[v],productId:I,productName:(P==null?void 0:P.name)||""}}else S[v]={...S[v],[A]:I};m(S)},E=()=>{if(!c)return ke.error("Veuillez sélectionner un département"),!1;if(!f.operatorName.trim())return ke.error("Le nom de l'opérateur est requis"),!1;if(!f.vehicleRegistration.trim())return ke.error("L'immatriculation du véhicule est requise"),!1;if(f.movementType==="factory_supply"&&!f.supplyCode.trim())return ke.error("Le code d'approvisionnement est requis pour les livraisons usine"),!1;if(f.movementType==="incoming_transfer"&&!f.sourceAgency)return ke.error("L'agence source est requise pour les transferts entrants"),!1;if(f.movementType==="outgoing_transfer"&&!f.destinationAgency)return ke.error("L'agence de destination est requise pour les transferts sortants"),!1;const v=p.filter(S=>S.productId&&S.quantity>0);if(v.length===0)return ke.error("Au moins un produit avec une quantité positive est requis"),!1;const A=v.map(S=>S.productId),I=new Set(A);return A.length!==I.size?(ke.error("Un même produit ne peut être sélectionné qu'une seule fois"),!1):!0},D=async v=>{if(n!=null&&n.agencyName)try{await cm(ot,async A=>{(await Promise.all(v.map(async P=>{const k=ln(ot,"products",P.productId),F=await A.get(k);return{ref:k,doc:F,productLine:P}}))).map(({ref:P,doc:k,productLine:F})=>{if(!k.exists())throw new Error(`Produit non trouvé: ${F.productName}`);const O=k.data().stockParAgence||{};let M=0;switch(f.movementType){case"factory_supply":case"incoming_transfer":M=F.quantity;break;case"outgoing_transfer":M=-F.quantity;break}const W=O[n.agencyName]||0,z=Math.max(0,W+M);return O[n.agencyName]=z,{ref:P,updates:{stockParAgence:O,updatedAt:Bt.now()}}}).forEach(({ref:P,updates:k})=>{A.update(P,k)})}),ke.success("Stock mis à jour avec succès")}catch(A){throw console.error("Error updating stock:",A),ke.error("Erreur lors de la mise à jour du stock"),A}},j=async v=>{if(v.preventDefault(),!(!n||!E())){i(!0);try{const A=p.filter(k=>k.productId&&k.quantity>0),I=A.reduce((k,F)=>k+F.quantity,0),S={movementType:f.movementType,department:c,referenceNumber:f.referenceNumber,date:Bt.fromDate(new Date(f.date)),operatorName:f.operatorName.trim(),vehicleRegistration:f.vehicleRegistration.trim().toUpperCase(),supplyCode:f.supplyCode.trim(),sourceAgency:f.sourceAgency,destinationAgency:f.destinationAgency,comments:f.comments.trim(),products:A,totalQuantity:I,status:"pending",createdBy:n.id,createdByName:`${n.firstName} ${n.lastName}`,company:n.company,agency:n.agencyName,createdAt:Bt.now()},P=await Ld(en(ot,"stockMovements"),S);await D(A),await TD({...S,id:P.id,date:new Date(f.date),createdAt:new Date}),ke.success("Mouvement de stock créé avec succès"),e(),t()}catch(A){console.error("Error creating movement:",A),ke.error("Erreur lors de la création du mouvement")}finally{i(!1)}}},C=()=>{switch(f.movementType){case"factory_supply":return u.jsx(of,{className:"h-5 w-5"});case"incoming_transfer":return u.jsx(ji,{className:"h-5 w-5"});case"outgoing_transfer":return u.jsx(af,{className:"h-5 w-5"});default:return u.jsx(ji,{className:"h-5 w-5"})}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-6 flex justify-between items-center sticky top-0 z-10",children:[u.jsxs("div",{className:"flex items-center",children:[C(),u.jsx("h2",{className:"font-bold text-xl ml-2",children:"Nouveau Mouvement de Stock"})]}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full transition-colors",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:j,className:"p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-4",children:["Département concerné ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{value:"Boulangerie",label:"Boulangerie",icon:ji,color:"orange"},{value:"Boutique",label:"Boutique",icon:ji,color:"blue"}].map(v=>{const A=v.icon,I=c===v.value;return u.jsxs("label",{className:`flex items-center p-4 border-2 rounded-xl cursor-pointer transition-all ${I?`border-${v.color}-500 bg-${v.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[u.jsx("input",{type:"radio",name:"department",value:v.value,checked:I,onChange:S=>{d(S.target.value),m([{productId:"",productName:"",quantity:0,unit:"kg"}])},className:"sr-only",required:!0}),u.jsx(A,{className:`h-6 w-6 mr-3 ${I?`text-${v.color}-600`:"text-gray-400"}`}),u.jsxs("div",{children:[u.jsx("span",{className:`font-medium ${I?`text-${v.color}-900`:"text-gray-700"}`,children:v.label}),u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[g.length," produit",g.length>1?"s":""," disponible",g.length>1?"s":""]})]})]},v.value)})})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-4",children:"Type de mouvement"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{value:"factory_supply",label:"Approvisionnement Usine",icon:of,color:"purple"},{value:"incoming_transfer",label:"Transfert Entrant",icon:ji,color:"green"},{value:"outgoing_transfer",label:"Transfert Sortant",icon:af,color:"blue"}].map(v=>{const A=v.icon,I=f.movementType===v.value;return u.jsxs("label",{className:`flex items-center p-4 border-2 rounded-xl cursor-pointer transition-all ${I?`border-${v.color}-500 bg-${v.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[u.jsx("input",{type:"radio",name:"movementType",value:v.value,checked:I,onChange:S=>h({...f,movementType:S.target.value}),className:"sr-only"}),u.jsx(A,{className:`h-6 w-6 mr-3 ${I?`text-${v.color}-600`:"text-gray-400"}`}),u.jsx("span",{className:`font-medium ${I?`text-${v.color}-900`:"text-gray-700"}`,children:v.label})]},v.value)})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Numéro de référence ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",value:f.referenceNumber,onChange:v=>h({...f,referenceNumber:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Date et heure ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"datetime-local",value:f.date,onChange:v=>h({...f,date:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Nom de l'opérateur ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",value:f.operatorName,onChange:v=>h({...f,operatorName:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Nom complet de l'opérateur"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Immatriculation véhicule ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",value:f.vehicleRegistration,onChange:v=>h({...f,vehicleRegistration:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Ex: AB-123-CD"})]})]}),f.movementType==="factory_supply"&&u.jsxs("div",{className:"mb-8",children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Code d'approvisionnement ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",value:f.supplyCode,onChange:v=>h({...f,supplyCode:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Code fourni par l'usine"})]}),f.movementType==="incoming_transfer"&&u.jsxs("div",{className:"mb-8",children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Agence source ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{value:f.sourceAgency,onChange:v=>h({...f,sourceAgency:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"",children:"Sélectionner l'agence source"}),a.filter(v=>v.name!==(n==null?void 0:n.agencyName)).map(v=>u.jsx("option",{value:v.name,children:v.name},v.id))]})]}),f.movementType==="outgoing_transfer"&&u.jsxs("div",{className:"mb-8",children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Agence de destination ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{value:f.destinationAgency,onChange:v=>h({...f,destinationAgency:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"",children:"Sélectionner l'agence de destination"}),a.filter(v=>v.name!==(n==null?void 0:n.agencyName)).map(v=>u.jsx("option",{value:v.name,children:v.name},v.id))]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"font-bold text-lg text-[#8B4513]",children:["Produits (",c,")"]}),u.jsxs("button",{type:"button",onClick:x,className:"flex items-center px-4 py-2 bg-[#8B4513] text-white rounded-lg hover:bg-[#663300] transition-colors",disabled:!c,children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Ajouter un produit"]})]}),!c&&u.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4",children:u.jsx("p",{className:"text-yellow-700",children:"Veuillez d'abord sélectionner un département pour voir les produits disponibles."})}),u.jsx("div",{className:"space-y-4",children:p.map((v,A)=>{const I=b(A);return u.jsxs("div",{className:"flex gap-4 items-end p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Produit"}),u.jsxs("select",{value:v.productId,onChange:S=>N(A,"productId",S.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,disabled:!c,children:[u.jsx("option",{value:"",children:"Sélectionner un produit"}),I.map(S=>u.jsxs("option",{value:S.id,children:[S.name," - ",S.reference]},S.id))]}),I.length===0&&c&&u.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Tous les produits de ce département ont déjà été sélectionnés"})]}),u.jsxs("div",{className:"w-32",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Quantité"}),u.jsx("input",{type:"number",value:v.quantity,onChange:S=>N(A,"quantity",parseFloat(S.target.value)||0),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",min:"0",step:"0.01",required:!0})]}),u.jsxs("div",{className:"w-24",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Unité"}),u.jsxs("select",{value:v.unit,onChange:S=>N(A,"unit",S.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",children:[u.jsx("option",{value:"kg",children:"kg"}),u.jsx("option",{value:"g",children:"g"}),u.jsx("option",{value:"L",children:"L"}),u.jsx("option",{value:"mL",children:"mL"}),u.jsx("option",{value:"unité",children:"unité"}),u.jsx("option",{value:"carton",children:"carton"}),u.jsx("option",{value:"palette",children:"palette"})]})]}),u.jsx("button",{type:"button",onClick:()=>w(A),disabled:p.length===1,className:"p-3 text-red-500 hover:bg-red-50 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:u.jsx(_p,{className:"h-5 w-5"})})]},A)})})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Commentaires / Notes"}),u.jsx("textarea",{value:f.comments,onChange:v=>h({...f,comments:v.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",rows:4,placeholder:"Informations supplémentaires, instructions spéciales..."})]}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100 transition-colors",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:r||!c,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center transition-colors",children:r?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Création..."]}):u.jsxs(u.Fragment,{children:[u.jsx(hm,{className:"h-5 w-5 mr-2"}),"Créer le mouvement"]})})]})]})]})})},FZ=({movement:t,onClose:e})=>{const n=()=>{switch(t.movementType){case"factory_supply":return u.jsx(of,{className:"h-6 w-6"});case"incoming_transfer":return u.jsx(ji,{className:"h-6 w-6"});case"outgoing_transfer":return u.jsx(af,{className:"h-6 w-6"});default:return u.jsx(ji,{className:"h-6 w-6"})}},r=()=>{switch(t.movementType){case"factory_supply":return"Approvisionnement Usine";case"incoming_transfer":return"Transfert Entrant";case"outgoing_transfer":return"Transfert Sortant";default:return t.movementType}},i=()=>{switch(t.status){case"pending":return"bg-yellow-100 text-yellow-800";case"in_transit":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},s=()=>{switch(t.status){case"pending":return"En attente";case"in_transit":return"En transit";case"completed":return"Terminé";case"cancelled":return"Annulé";default:return t.status}},o=async()=>{try{await TD(t),ke.success("Document PDF généré avec succès")}catch(l){console.error("Error generating PDF:",l),ke.error("Erreur lors de la génération du PDF")}},a=()=>{switch(t.movementType){case"factory_supply":return`Usine → ${t.agency}`;case"incoming_transfer":return`${t.sourceAgency} → ${t.agency}`;case"outgoing_transfer":return`${t.agency} → ${t.destinationAgency}`;default:return""}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-auto",children:[u.jsxs("div",{className:"bg-gradient-to-r from-[#8B4513] to-[#663300] text-white p-6 flex justify-between items-center sticky top-0 z-10",children:[u.jsxs("div",{className:"flex items-center",children:[n(),u.jsxs("div",{className:"ml-3",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Détails du Mouvement"}),u.jsx("p",{className:"text-white/80",children:t.referenceNumber})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:o,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",title:"Imprimer le document",children:u.jsx(bf,{className:"h-6 w-6"})}),u.jsx("button",{onClick:e,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:u.jsx(Cr,{className:"h-6 w-6"})})]})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 mb-8",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx("div",{className:"text-center",children:u.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[u.jsx("div",{className:"flex items-center justify-center mb-2",children:n()}),u.jsx("h3",{className:"font-semibold text-gray-900",children:r()}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a()})]})}),u.jsx("div",{className:"text-center",children:u.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[u.jsx(Cd,{className:"h-6 w-6 mx-auto mb-2 text-blue-600"}),u.jsx("h3",{className:"font-semibold text-gray-900",children:Kt(t.date,"dd MMMM yyyy",{locale:zn})}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Kt(t.date,"HH:mm",{locale:zn})})]})}),u.jsx("div",{className:"text-center",children:u.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[u.jsx("div",{className:"flex items-center justify-center mb-2",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${i()}`,children:s()})}),u.jsx("p",{className:"text-sm text-gray-600",children:"Statut du mouvement"})]})})]})}),t.department&&u.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 mb-8",children:[u.jsxs("h3",{className:"font-bold text-lg text-gray-900 mb-4 flex items-center",children:[u.jsx(ji,{className:"h-5 w-5 mr-2 text-[#8B4513]"}),"Département"]}),u.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${t.department==="Boulangerie"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:t.department})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[u.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[u.jsxs("h3",{className:"font-bold text-lg text-gray-900 mb-6 flex items-center",children:[u.jsx(wp,{className:"h-5 w-5 mr-2 text-[#8B4513]"}),"Informations Générales"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[u.jsx("span",{className:"text-gray-600",children:"Référence:"}),u.jsx("span",{className:"font-mono font-medium",children:t.referenceNumber})]}),u.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[u.jsx("span",{className:"text-gray-600",children:"Opérateur:"}),u.jsx("span",{className:"font-medium",children:t.operatorName})]}),u.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[u.jsx("span",{className:"text-gray-600",children:"Véhicule:"}),u.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:t.vehicleRegistration})]}),t.supplyCode&&u.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[u.jsx("span",{className:"text-gray-600",children:"Code approvisionnement:"}),u.jsx("span",{className:"font-mono font-medium",children:t.supplyCode})]}),u.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[u.jsx("span",{className:"text-gray-600",children:"Créé par:"}),u.jsx("span",{className:"font-medium",children:t.createdByName})]}),u.jsxs("div",{className:"flex justify-between items-center py-2",children:[u.jsx("span",{className:"text-gray-600",children:"Date de création:"}),u.jsx("span",{className:"text-sm",children:Kt(t.createdAt,"dd/MM/yyyy HH:mm",{locale:zn})})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[u.jsxs("h3",{className:"font-bold text-lg text-gray-900 mb-6 flex items-center",children:[u.jsx(af,{className:"h-5 w-5 mr-2 text-[#8B4513]"}),"Détails du Transport"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Itinéraire"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full mx-auto mb-1"}),u.jsx("span",{className:"text-sm font-medium",children:t.movementType==="factory_supply"?"Usine":t.movementType==="incoming_transfer"?t.sourceAgency:t.agency})]}),u.jsx("div",{className:"flex-1 h-0.5 bg-gray-300 mx-4"}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mx-auto mb-1"}),u.jsx("span",{className:"text-sm font-medium",children:t.movementType==="outgoing_transfer"?t.destinationAgency:t.agency})]})]})]}),u.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[u.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Quantité Totale"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[t.totalQuantity.toLocaleString()," unités"]}),u.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[t.products.length," produit",t.products.length>1?"s":""," différent",t.products.length>1?"s":""]})]})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 mb-8",children:[u.jsxs("h3",{className:"font-bold text-lg text-gray-900 mb-6 flex items-center",children:[u.jsx(ji,{className:"h-5 w-5 mr-2 text-[#8B4513]"}),"Liste des Produits"]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-600",children:"Produit"}),u.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-600",children:"Quantité"}),u.jsx("th",{className:"px-6 py-3 text-center text-sm font-semibold text-gray-600",children:"Unité"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:t.products.map((l,c)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:l.productName}),u.jsx("td",{className:"px-6 py-4 text-right font-medium",children:l.quantity.toLocaleString()}),u.jsx("td",{className:"px-6 py-4 text-center",children:u.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-sm",children:l.unit})})]},c))}),u.jsx("tfoot",{children:u.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[u.jsx("td",{className:"px-6 py-4",children:"Total"}),u.jsx("td",{className:"px-6 py-4 text-right",children:t.totalQuantity.toLocaleString()}),u.jsx("td",{className:"px-6 py-4 text-center",children:"-"})]})})]})})]}),t.comments&&u.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 mb-8",children:[u.jsxs("h3",{className:"font-bold text-lg text-gray-900 mb-4 flex items-center",children:[u.jsx(wp,{className:"h-5 w-5 mr-2 text-[#8B4513]"}),"Commentaires"]}),u.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:u.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.comments})})]}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[u.jsxs("button",{onClick:o,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] transition-colors flex items-center",children:[u.jsx(cy,{className:"h-5 w-5 mr-2"}),"Télécharger PDF"]}),u.jsx("button",{onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100 transition-colors",children:"Fermer"})]})]})]})})},LZ=()=>{const{user:t}=Li(),[e,n]=he.useState([]),[r,i]=he.useState(!0),[s,o]=he.useState(!1),[a,l]=he.useState(!1),[c,d]=he.useState(null),[f,h]=he.useState(""),[p,m]=he.useState("all"),[g,b]=he.useState("all"),[x,w]=he.useState("all"),[N,E]=he.useState({start:"",end:""});he.useEffect(()=>{(async()=>{if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName))){i(!0);try{const q=mn(en(ot,"stockMovements"),pt("company","==",t.company)),W=(await On(q)).docs.map(z=>({id:z.id,...z.data(),date:z.data().date.toDate(),createdAt:z.data().createdAt.toDate()})).filter(z=>z.movementType==="factory_supply"&&z.agency===t.agencyName||z.movementType==="incoming_transfer"&&z.agency===t.agencyName||z.movementType==="outgoing_transfer"&&z.agency===t.agencyName||z.movementType==="incoming_transfer"&&z.sourceAgency===t.agencyName||z.movementType==="outgoing_transfer"&&z.destinationAgency===t.agencyName);W.sort((z,J)=>J.createdAt.getTime()-z.createdAt.getTime()),n(W)}catch(q){console.error("Error fetching movements:",q),ke.error("Erreur lors du chargement des mouvements")}finally{i(!1)}}})()},[t]);const D=F=>{switch(F){case"factory_supply":return u.jsx(of,{className:"h-5 w-5"});case"incoming_transfer":return u.jsx(lS,{className:"h-5 w-5"});case"outgoing_transfer":return u.jsx(ly,{className:"h-5 w-5"});default:return u.jsx(ji,{className:"h-5 w-5"})}},j=F=>{switch(F){case"factory_supply":return"Approvisionnement Usine";case"incoming_transfer":return"Transfert Entrant";case"outgoing_transfer":return"Transfert Sortant";default:return F}},C=F=>{switch(F){case"pending":return"bg-yellow-100 text-yellow-800";case"in_transit":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},v=F=>{switch(F){case"pending":return"En attente";case"in_transit":return"En transit";case"completed":return"Terminé";case"cancelled":return"Annulé";default:return F}},A=F=>{switch(F){case"Boulangerie":return"bg-orange-100 text-orange-800";case"Boutique":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},I=F=>{const q=t==null?void 0:t.agencyName;switch(F.movementType){case"factory_supply":return`Usine → ${F.agency}`;case"incoming_transfer":return F.agency===q?`${F.sourceAgency} → ${F.agency}`:`${F.sourceAgency} → ${F.agency}`;case"outgoing_transfer":return F.agency===q?`${F.agency} → ${F.destinationAgency}`:`${F.agency} → ${F.destinationAgency}`;default:return""}},S=e.filter(F=>{const q=F.referenceNumber.toLowerCase().includes(f.toLowerCase())||F.operatorName.toLowerCase().includes(f.toLowerCase())||F.vehicleRegistration.toLowerCase().includes(f.toLowerCase()),O=p==="all"||F.movementType===p,M=g==="all"||F.status===g,W=x==="all"||F.department===x,z=new Date(F.date),J=(!N.start||z>=new Date(N.start))&&(!N.end||z<=new Date(N.end));return q&&O&&M&&W&&J}),P=F=>{d(F),l(!0)},k=()=>{(async()=>{if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName)))try{const q=mn(en(ot,"stockMovements"),pt("company","==",t.company)),W=(await On(q)).docs.map(z=>({id:z.id,...z.data(),date:z.data().date.toDate(),createdAt:z.data().createdAt.toDate()})).filter(z=>z.movementType==="factory_supply"&&z.agency===t.agencyName||z.movementType==="incoming_transfer"&&z.agency===t.agencyName||z.movementType==="outgoing_transfer"&&z.agency===t.agencyName||z.movementType==="incoming_transfer"&&z.sourceAgency===t.agencyName||z.movementType==="outgoing_transfer"&&z.destinationAgency===t.agencyName);W.sort((z,J)=>J.createdAt.getTime()-z.createdAt.getTime()),n(W)}catch(q){console.error("Error fetching movements:",q)}})()};return!(t!=null&&t.company)||!(t!=null&&t.agencyName)?u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Informations entreprise ou agence manquantes"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Mouvements de Stock"}),u.jsxs("p",{className:"text-gray-600 mt-1",children:["Agence: ",t.agencyName]})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-[#8B4513] text-white px-6 py-3 rounded-xl flex items-center hover:bg-[#663300] transition-colors shadow-lg hover:shadow-xl",children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Nouveau Mouvement"]})]}),u.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-8",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Wl,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Rechercher...",className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",value:f,onChange:F=>h(F.target.value)})]}),u.jsxs("select",{value:p,onChange:F=>m(F.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",children:[u.jsx("option",{value:"all",children:"Tous les types"}),u.jsx("option",{value:"factory_supply",children:"Approvisionnement Usine"}),u.jsx("option",{value:"incoming_transfer",children:"Transfert Entrant"}),u.jsx("option",{value:"outgoing_transfer",children:"Transfert Sortant"})]}),u.jsxs("select",{value:g,onChange:F=>b(F.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",children:[u.jsx("option",{value:"all",children:"Tous les statuts"}),u.jsx("option",{value:"pending",children:"En attente"}),u.jsx("option",{value:"in_transit",children:"En transit"}),u.jsx("option",{value:"completed",children:"Terminé"}),u.jsx("option",{value:"cancelled",children:"Annulé"})]}),u.jsxs("select",{value:x,onChange:F=>w(F.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513]focus:border-transparent",children:[u.jsx("option",{value:"all",children:"Tous les départements"}),u.jsx("option",{value:"Boulangerie",children:"Boulangerie"}),u.jsx("option",{value:"Boutique",children:"Boutique"})]}),u.jsx("input",{type:"date",value:N.start,onChange:F=>E(q=>({...q,start:F.target.value})),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",placeholder:"Date début"}),u.jsx("input",{type:"date",value:N.end,onChange:F=>E(q=>({...q,end:F.target.value})),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#8B4513] focus:border-transparent",placeholder:"Date fin"})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[u.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl p-6 text-white",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-blue-100 text-sm",children:"Total Mouvements"}),u.jsx("p",{className:"text-2xl font-bold",children:S.length})]}),u.jsx(ji,{className:"h-8 w-8 text-blue-200"})]})}),u.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-2xl p-6 text-white",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-green-100 text-sm",children:"Terminés"}),u.jsx("p",{className:"text-2xl font-bold",children:S.filter(F=>F.status==="completed").length})]}),u.jsx(lS,{className:"h-8 w-8 text-green-200"})]})}),u.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-2xl p-6 text-white",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-yellow-100 text-sm",children:"En Transit"}),u.jsx("p",{className:"text-2xl font-bold",children:S.filter(F=>F.status==="in_transit").length})]}),u.jsx(af,{className:"h-8 w-8 text-yellow-200"})]})}),u.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-2xl p-6 text-white",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-purple-100 text-sm",children:"En Attente"}),u.jsx("p",{className:"text-2xl font-bold",children:S.filter(F=>F.status==="pending").length})]}),u.jsx(of,{className:"h-8 w-8 text-purple-200"})]})})]}),u.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Type"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Département"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Référence"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Date"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Opérateur"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Véhicule"}),u.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600",children:"Agences"}),u.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-600",children:"Produits"}),u.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-600",children:"Statut"}),u.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-600",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:r?u.jsx("tr",{children:u.jsx("td",{colSpan:10,className:"px-6 py-12 text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#8B4513]"}),u.jsx("span",{className:"ml-2 text-gray-500",children:"Chargement..."})]})})}):S.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:10,className:"px-6 py-12 text-center text-gray-500",children:"Aucun mouvement trouvé"})}):S.map(F=>u.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:`p-2 rounded-lg mr-3 ${F.movementType==="factory_supply"?"bg-purple-100 text-purple-600":F.movementType==="incoming_transfer"?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"}`,children:D(F.movementType)}),u.jsx("span",{className:"text-sm font-medium",children:j(F.movementType)})]})}),u.jsx("td",{className:"px-6 py-4",children:F.department&&u.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${A(F.department)}`,children:F.department})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"font-mono text-sm font-medium text-gray-900",children:F.referenceNumber})}),u.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:Kt(F.date,"dd/MM/yyyy HH:mm",{locale:zn})}),u.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:F.operatorName}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:F.vehicleRegistration})}),u.jsx("td",{className:"px-6 py-4 text-sm",children:I(F)}),u.jsx("td",{className:"px-6 py-4 text-center",children:u.jsxs("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs font-medium",children:[F.products.length," produit",F.products.length>1?"s":""]})}),u.jsx("td",{className:"px-6 py-4 text-center",children:u.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${C(F.status)}`,children:v(F.status)})}),u.jsx("td",{className:"px-6 py-4 text-center",children:u.jsx("button",{onClick:()=>P(F),className:"p-2 text-gray-600 hover:text-[#8B4513] hover:bg-gray-100 rounded-lg transition-colors",title:"Voir les détails",children:u.jsx(uy,{className:"h-5 w-5"})})})]},F.id))})]})})}),s&&u.jsx(RZ,{onClose:()=>o(!1),onMovementAdded:k}),a&&c&&u.jsx(FZ,{movement:c,onClose:()=>{l(!1),d(null)}})]})},MZ=()=>{const[t,e]=he.useState("dashboard"),n=()=>{switch(t){case"dashboard":return u.jsx(A6,{});case"products":return u.jsx(hJ,{});case"users":return u.jsx(xJ,{});case"settings":return u.jsx("div",{className:"p-6",children:u.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Paramètres"})});case"transactions":return u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Historique des Transactions"}),u.jsx(vJ,{})]});case"stock":return u.jsx(AZ,{});case"sales":return u.jsx(EZ,{});case"expenses":return u.jsx(PZ,{});case"centralized":return u.jsx(TZ,{});case"movements":return u.jsx(LZ,{});default:return u.jsx(A6,{})}};return u.jsxs("div",{className:"flex h-full",children:[u.jsxs("div",{className:"w-64 bg-[#8B4513] text-white",children:[u.jsx("div",{className:"p-4 border-b border-[#663300]",children:u.jsx("h2",{className:"font-bold text-xl",children:"Administration"})}),u.jsx("nav",{className:"p-4",children:u.jsxs("ul",{className:"space-y-2",children:[u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="dashboard"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("dashboard"),children:[u.jsx(uH,{className:"h-5 w-5"}),u.jsx("span",{children:"Tableau de Bord"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="centralized"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("centralized"),children:[u.jsx(t4,{className:"h-5 w-5"}),u.jsx("span",{children:"Admin. Centralisée"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="products"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("products"),children:[u.jsx(BI,{className:"h-5 w-5"}),u.jsx("span",{children:"Produits"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="stock"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("stock"),children:[u.jsx(RI,{className:"h-5 w-5"}),u.jsx("span",{children:"Contrôle Stock"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="movements"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("movements"),children:[u.jsx(af,{className:"h-5 w-5"}),u.jsx("span",{children:"Mouvements Stock"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="sales"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("sales"),children:[u.jsx(J1,{className:"h-5 w-5"}),u.jsx("span",{children:"Ventes"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="expenses"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("expenses"),children:[u.jsx(bH,{className:"h-5 w-5"}),u.jsx("span",{children:"Dépenses"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="transactions"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("transactions"),children:[u.jsx(aH,{className:"h-5 w-5"}),u.jsx("span",{children:"Transactions"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="users"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("users"),children:[u.jsx(vH,{className:"h-5 w-5"}),u.jsx("span",{children:"Utilisateurs"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="settings"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("settings"),children:[u.jsx(OI,{className:"h-5 w-5"}),u.jsx("span",{children:"Paramètres"})]})})]})})]}),u.jsx("div",{className:"flex-grow bg-gray-100 overflow-auto",children:n()})]})},G6=["kg","g","L","mL","unité","sachet","boîte"],BZ=({onClose:t,onMaterialAdded:e})=>{const[n,r]=he.useState({nom:"",uniteMessure:G6[0],prixUnitaire:""}),[i,s]=he.useState(!1),o=()=>{const l="MP",c=Date.now().toString().slice(-6),d=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`${l}${c}${d}`},a=async l=>{if(l.preventDefault(),!fn.currentUser)return;const c=parseFloat(n.prixUnitaire);if(isNaN(c)||c<=0){ke.error("Le prix unitaire doit être un nombre positif");return}s(!0);try{const d=await ps(ln(ot,"users",fn.currentUser.uid)),f=d.exists()?d.data().company:void 0;if(!f)throw new Error("Erreur: Informations entreprise manquantes");const h=Bt.now();await Ld(en(ot,"matieresPremiere"),{code:o(),nom:n.nom.trim(),uniteMessure:n.uniteMessure,prixUnitaire:c,entrepriseId:fn.currentUser.uid,dateCreation:h,derniereMiseAJour:h,creePar:fn.currentUser.uid,company:f,historiquePrix:[{prix:c,date:h,justification:"Prix initial"}]}),ke.success("Matière première ajoutée avec succès"),e(),t()}catch(d){console.error("Erreur lors de l'ajout:",d),ke.error("Erreur lors de l'ajout de la matière première")}finally{s(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Nouvelle Matière Première"}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:a,className:"p-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Désignation"}),u.jsx("input",{type:"text",value:n.nom,onChange:l=>r({...n,nom:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Ex: Farine de blé T55"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Unité de mesure"}),u.jsx("select",{value:n.uniteMessure,onChange:l=>r({...n,uniteMessure:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:G6.map(l=>u.jsx("option",{value:l,children:l},l))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Prix unitaire initial (Fcfa)"}),u.jsx("input",{type:"number",value:n.prixUnitaire,onChange:l=>r({...n,prixUnitaire:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,min:"0",step:"0.01",placeholder:`Prix par ${n.uniteMessure}`})]})]}),u.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:i,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:i?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer"})]})]})]})})},OZ=({material:t,onClose:e,onPriceUpdated:n})=>{const[r,i]=he.useState(""),[s,o]=he.useState(""),[a,l]=he.useState(!1),[c,d]=he.useState(!1),f=async h=>{h.preventDefault();const p=parseFloat(r);if(isNaN(p)||p<=0){ke.error("Le prix doit être un nombre positif");return}if(!s.trim()){ke.error("La justification est requise");return}l(!0);try{const m=Bt.now();await na(ln(ot,"matieresPremiere",t.id),{prixUnitaire:p,derniereMiseAJour:m,historiquePrix:lI({prix:p,date:m,justification:s.trim()})}),ke.success("Prix mis à jour avec succès"),n(),e()}catch(m){console.error("Erreur lors de la mise à jour:",m),ke.error("Erreur lors de la mise à jour du prix")}finally{l(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Modifier le Prix"}),u.jsx("button",{onClick:e,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"font-medium text-gray-900",children:t.nom}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Code: ",t.code]}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Prix actuel: ",t.prixUnitaire," Fcfa/",t.uniteMessure]})]}),u.jsxs("form",{onSubmit:f,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Nouveau prix (Fcfa)"}),u.jsx("input",{type:"number",value:r,onChange:h=>i(h.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,min:"0",step:"0.01",placeholder:`Prix par ${t.uniteMessure}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Justification du changement"}),u.jsx("textarea",{value:s,onChange:h=>o(h.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,rows:3,placeholder:"Raison du changement de prix..."})]}),t.historiquePrix&&u.jsxs("div",{children:[u.jsxs("button",{type:"button",onClick:()=>d(!c),className:"flex items-center text-[#8B4513] hover:text-[#663300]",children:[u.jsx(LI,{className:"h-4 w-4 mr-2"}),c?"Masquer l'historique":"Voir l'historique"]}),c&&u.jsx("div",{className:"mt-4 max-h-40 overflow-y-auto",children:u.jsxs("table",{className:"w-full text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-50",children:[u.jsx("th",{className:"px-4 py-2",children:"Date"}),u.jsx("th",{className:"px-4 py-2",children:"Prix"}),u.jsx("th",{className:"px-4 py-2",children:"Justification"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:t.historiquePrix.map((h,p)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2",children:Kt(h.date.toDate(),"dd/MM/yyyy HH:mm",{locale:zn})}),u.jsxs("td",{className:"px-4 py-2",children:[h.prix," Fcfa/",t.uniteMessure]}),u.jsx("td",{className:"px-4 py-2",children:h.justification})]},p))})]})})]}),u.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:a,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:a?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Mettre à jour"})]})]})]})]})})},VZ=({material:t,onClose:e,onDeleted:n})=>{const[r,i]=he.useState(""),[s,o]=he.useState(!1),a=async()=>{if(fn.currentUser){if(r!==t.nom){ke.error("Le nom de la matière première ne correspond pas");return}o(!0);try{await ry(ln(ot,"matieresPremiere",t.id)),ke.success("Matière première supprimée avec succès"),n(),e()}catch(l){console.error("Erreur lors de la suppression:",l),ke.error("Erreur lors de la suppression")}finally{o(!1)}}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-red-600 text-white p-4 flex justify-between items-center",children:[u.jsxs("h2",{className:"font-bold text-xl flex items-center",children:[u.jsx(II,{className:"h-6 w-6 mr-2"}),"Supprimer la Matière Première"]}),u.jsx("button",{onClick:e,className:"text-white hover:bg-red-700 p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"bg-red-50 text-red-800 p-4 rounded-lg mb-6",children:[u.jsx("p",{className:"font-bold mb-2",children:"⚠️ Cette action est irréversible"}),u.jsx("p",{className:"text-sm",children:"La suppression de cette matière première effacera définitivement toutes les données associées, y compris l'historique des prix et les références dans les fiches de production."})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"font-medium text-gray-900",children:t.nom}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Code: ",t.code]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("label",{className:"block text-gray-700 font-medium mb-2",children:["Pour confirmer, tapez le nom exact de la matière première :",u.jsxs("span",{className:"font-bold text-red-600",children:[" ",t.nom]})]}),u.jsx("input",{type:"text",value:r,onChange:l=>i(l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500",placeholder:"Nom de la matière première"})]}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{onClick:a,disabled:s||r!==t.nom,className:"px-6 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:s?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Suppression..."]}):"Supprimer"})]})]})]})})},K6=()=>{const[t,e]=he.useState([]),[n,r]=he.useState(!0),[i,s]=he.useState(!1),[o,a]=he.useState(!1),[l,c]=he.useState(!1),[d,f]=he.useState(null),[h,p]=he.useState(""),[m,g]=he.useState({key:"dateCreation",direction:"desc"});he.useEffect(()=>{if(!fn.currentUser)return;(async()=>{try{const D=ln(ot,"users",fn.currentUser.uid),j=await ps(D),C=j.exists()?j.data().company:null;if(!C){ke.error("Erreur: Informations entreprise manquantes"),r(!1);return}const v=mn(en(ot,"matieresPremiere"),pt("company","==",C),oi(m.key,m.direction)),A=Ic(v,I=>{const S=I.docs.map(P=>{var k;return{id:P.id,...P.data(),dateCreation:P.data().dateCreation.toDate(),derniereMiseAJour:((k=P.data().derniereMiseAJour)==null?void 0:k.toDate())||P.data().dateCreation.toDate()}});e(S),r(!1)},I=>{console.error("Erreur lors du chargement des matières premières:",I),r(!1)});return()=>A()}catch(D){console.error("Erreur lors du chargement des matières premières:",D),r(!1)}})()},[m]);const b=E=>{g(D=>({key:E,direction:D.key===E&&D.direction==="asc"?"desc":"asc"}))},x=t.filter(E=>(E.nom||"").toLowerCase().includes(h.toLowerCase())||(E.code||"").toLowerCase().includes(h.toLowerCase())),w=E=>{f(E),a(!0)},N=E=>{f(E),c(!0)};return n?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Matières Premières"}),u.jsxs("button",{className:"bg-[#8B4513] text-white px-4 py-2 rounded-lg flex items-center hover:bg-[#663300]",onClick:()=>s(!0),children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Nouvelle Matière"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"mb-6 relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Wl,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Rechercher par nom ou code...",className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:h,onChange:E=>p(E.target.value)})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3",children:u.jsxs("button",{className:"text-gray-500 font-medium flex items-center",onClick:()=>b("code"),children:["Code",u.jsx(lg,{className:"h-4 w-4 ml-1"})]})}),u.jsx("th",{className:"px-6 py-3",children:u.jsxs("button",{className:"text-gray-500 font-medium flex items-center",onClick:()=>b("nom"),children:["Désignation",u.jsx(lg,{className:"h-4 w-4 ml-1"})]})}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Unité"}),u.jsx("th",{className:"px-6 py-3",children:u.jsxs("button",{className:"text-gray-500 font-medium flex items-center",onClick:()=>b("prixUnitaire"),children:["Prix Unitaire",u.jsx(lg,{className:"h-4 w-4 ml-1"})]})}),u.jsx("th",{className:"px-6 py-3",children:u.jsxs("button",{className:"text-gray-500 font-medium flex items-center",onClick:()=>b("derniereMiseAJour"),children:["Dernière M.A.J",u.jsx(lg,{className:"h-4 w-4 ml-1"})]})}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-200",children:[x.map(E=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 font-medium",children:E.code}),u.jsx("td",{className:"px-6 py-4",children:E.nom}),u.jsx("td",{className:"px-6 py-4",children:E.uniteMessure}),u.jsxs("td",{className:"px-6 py-4",children:[E.prixUnitaire," Fcfa/",E.uniteMessure]}),u.jsx("td",{className:"px-6 py-4",children:Kt(E.derniereMiseAJour,"dd/MM/yyyy HH:mm",{locale:zn})}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:()=>w(E),className:"text-[#8B4513] hover:text-[#663300] font-medium",children:"Modifier prix"}),u.jsx("button",{onClick:()=>N(E),className:"text-red-600 hover:text-red-800",title:"Supprimer",children:u.jsx(hy,{className:"h-5 w-5"})})]})})]},E.id)),x.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"Aucune matière première trouvée"})})]})]})})]}),i&&u.jsx(BZ,{onClose:()=>s(!1),onMaterialAdded:()=>{}}),o&&d&&u.jsx(OZ,{material:d,onClose:()=>{a(!1),f(null)},onPriceUpdated:()=>{}}),l&&d&&u.jsx(VZ,{material:d,onClose:()=>{c(!1),f(null)},onDeleted:()=>{}})]})},UZ=({data:t,onConfirm:e,onEdit:n,onClose:r})=>{const[i,s]=he.useState(!1),[o,a]=he.useState(!1),[l,c]=he.useState(null);Ko.useEffect(()=>{(async()=>{if(fn.currentUser)try{const p=await ps(ln(ot,"users",fn.currentUser.uid));if(!p.exists())throw new Error("User data not found");const m=p.data();if(!m.company||!m.agencyName)throw new Error("Company or agency information missing");c({company:m.company,agencyName:m.agencyName})}catch(p){console.error("Error fetching user data:",p),ke.error("Erreur lors du chargement des données utilisateur")}})()},[]);const d=async()=>{if(!o){a(!0);try{await e()}catch(h){console.error("Error during confirmation:",h),ke.error("Erreur lors de l'enregistrement"),a(!1)}}},f=h=>h.unit==="g"?"g":"kg";return i?u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-8",children:[u.jsx(Un,{className:"animate-spin h-8 w-8 text-[#8B4513] mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement des données..."})]})}):u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center sticky top-0 z-10",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Fiche de Production"}),u.jsx("button",{onClick:r,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"mb-8 border-b pb-6",children:u.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Date de Production"}),u.jsx("p",{children:Kt(new Date(t.dateProduction),"dd MMMM yyyy",{locale:zn})})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Responsable"}),u.jsx("p",{children:t.responsable})]})]})}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Matières Premières Utilisées"}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-gray-600",children:[u.jsx("th",{className:"py-2",children:"Matière Première"}),u.jsx("th",{className:"py-2 text-right",children:"Quantité"}),u.jsx("th",{className:"py-2 text-right",children:"Prix Unitaire"}),u.jsx("th",{className:"py-2 text-right",children:"Total"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-200",children:[t.materialsUsed.map((h,p)=>u.jsxs("tr",{children:[u.jsx("td",{className:"py-2",children:h.materialName}),u.jsxs("td",{className:"py-2 text-right",children:[h.quantity.toFixed(2)," ",f(h)]}),u.jsxs("td",{className:"py-2 text-right",children:[h.unitPrice.toFixed(2)," Fcfa/",f(h)]}),u.jsxs("td",{className:"py-2 text-right",children:[(h.quantity*h.unitPrice).toFixed(2)," Fcfa"]})]},p)),u.jsxs("tr",{className:"font-bold",children:[u.jsx("td",{className:"py-2",children:"Total"}),u.jsxs("td",{className:"py-2 text-right",children:[t.totals.materialsTotalWeight.toFixed(2)," kg"]}),u.jsx("td",{className:"py-2"}),u.jsxs("td",{className:"py-2 text-right",children:[t.totals.materialsTotalCost.toFixed(2)," Fcfa"]})]})]})]})})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Produits Fabriqués"}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-gray-600",children:[u.jsx("th",{className:"py-2",children:"Produit"}),u.jsx("th",{className:"py-2 text-right",children:"Quantité"}),u.jsx("th",{className:"py-2 text-right",children:"Poids Unitaire"}),u.jsx("th",{className:"py-2 text-right",children:"Poids Total"}),u.jsx("th",{className:"py-2 text-right",children:"Prix Unitaire"}),u.jsx("th",{className:"py-2 text-right",children:"Total"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-200",children:[t.productsProduced.map((h,p)=>u.jsxs("tr",{children:[u.jsx("td",{className:"py-2",children:h.productName}),u.jsx("td",{className:"py-2 text-right",children:h.quantity}),u.jsxs("td",{className:"py-2 text-right",children:[h.weightPerUnit.toFixed(3)," kg"]}),u.jsxs("td",{className:"py-2 text-right",children:[(h.quantity*h.weightPerUnit).toFixed(2)," kg"]}),u.jsxs("td",{className:"py-2 text-right",children:[h.unitPrice.toFixed(2)," Fcfa"]}),u.jsxs("td",{className:"py-2 text-right",children:[(h.quantity*h.unitPrice).toFixed(2)," Fcfa"]})]},p)),u.jsxs("tr",{className:"font-bold",children:[u.jsx("td",{className:"py-2",children:"Total"}),u.jsx("td",{className:"py-2 text-right",children:t.totals.productionTotalQuantity}),u.jsx("td",{className:"py-2"}),u.jsxs("td",{className:"py-2 text-right",children:[t.totals.productionTotalWeight.toFixed(2)," kg"]}),u.jsx("td",{className:"py-2"}),u.jsxs("td",{className:"py-2 text-right",children:[t.totals.productionTotalAmount.toFixed(2)," Fcfa"]})]})]})]})})]}),u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-8",children:[u.jsx("h4",{className:"font-bold mb-4",children:"Synthèse de Production"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Poids total matières:"}),u.jsxs("p",{className:"font-bold",children:[t.totals.materialsTotalWeight.toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Poids total production:"}),u.jsxs("p",{className:"font-bold",children:[t.totals.productionTotalWeight.toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Différence de poids:"}),u.jsxs("p",{className:`font-bold ${t.totals.weightDifference>0?"text-green-600":t.totals.weightDifference<0?"text-red-600":""}`,children:[t.totals.weightDifference>0?"+":"",t.totals.weightDifference.toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Coût total matières:"}),u.jsxs("p",{className:"font-bold",children:[t.totals.materialsTotalCost.toFixed(2)," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Valeur totale production:"}),u.jsxs("p",{className:"font-bold",children:[t.totals.productionTotalAmount.toFixed(2)," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Taux de rentabilité:"}),u.jsxs("p",{className:`font-bold ${t.totals.profitabilityRate>30?"text-green-600":"text-red-600"}`,children:[t.totals.profitabilityRate.toFixed(2),"%"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Marge brute:"}),u.jsxs("p",{className:"font-bold",children:[(t.totals.productionTotalAmount-t.totals.materialsTotalCost).toFixed(2)," Fcfa"]})]})]})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("button",{onClick:n,disabled:o,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100 flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(ly,{className:"h-5 w-5 mr-2"}),"Modifier"]}),u.jsx("button",{onClick:d,disabled:o,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed",children:o?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Traitement en cours..."]}):u.jsxs(u.Fragment,{children:[u.jsx(bf,{className:"h-5 w-5 mr-2"}),"Enregistrer et Imprimer"]})})]})]})]})})},zZ=t=>{const e=Kt(new Date(t.dateProduction),"dd MMMM yyyy",{locale:zn}),n=r=>r.unit==="g"?"g":"kg";return`
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>Fiche de Production - ${t.numero}</title>
      <style>
        @page {
          size: landscape;
          margin: 1cm;
        }
        body {
          font-family: 'Arial', sans-serif;
          margin: 0;
          padding: 0;
          color: #333;
        }
        .container {
          max-width: 100%;
          margin: 0 auto;
          padding: 20px;
        }
        .header {
          text-align: center;
          margin-bottom: 20px;
        }
        .header h1 {
          margin: 0;
          color: #8B4513;
          font-size: 24px;
        }
        .header p {
          margin: 5px 0;
        }
        .info {
          display: flex;
          justify-content: space-between;
          margin-bottom: 20px;
        }
        .info-item {
          flex: 1;
        }
        .info-item h3 {
          margin: 0 0 5px 0;
          font-size: 14px;
        }
        .info-item p {
          margin: 0;
          font-size: 14px;
        }
        .columns {
          display: flex;
          gap: 20px;
        }
        .column {
          flex: 1;
        }
        table {
          width: 100%;
          border-collapse: collapse;
          margin-bottom: 20px;
          font-size: 12px;
        }
        th, td {
          border: 1px solid #ddd;
          padding: 8px;
          text-align: left;
        }
        th {
          background-color: #f3f4f6;
          font-weight: bold;
        }
        .text-right {
          text-align: right;
        }
        .summary {
          background-color: #f9fafb;
          padding: 15px;
          border-radius: 8px;
          margin-top: 20px;
          font-size: 12px;
        }
        .summary-grid {
          display: grid;
          grid-template-columns: repeat(7, 1fr);
          gap: 10px;
        }
        .summary-item {
          display: flex;
          flex-direction: column;
        }
        .summary-label {
          color: #4b5563;
          font-size: 11px;
        }
        .summary-value {
          font-weight: bold;
          font-size: 12px;
        }
        .green {
          color: #059669;
        }
        .red {
          color: #dc2626;
        }
        h2 {
          color: #8B4513;
          font-size: 16px;
          margin-top: 0;
          margin-bottom: 10px;
        }
      </style>
    </head>
    <body>
      <div class="container">
        <div class="header">
          <h1>FICHE DE PRODUCTION</h1>
          <p>${t.company||"EGREC BOULANGERIE"}</p>
          <p>N° ${t.numero} - Agence: ${t.agency}</p>
          <p>Date: ${e} - Responsable: ${t.responsable}</p>
        </div>

        <div class="columns">
          <div class="column">
            <h2>Matières Premières Utilisées</h2>
            <table>
              <thead>
                <tr>
                  <th>Désignation</th>
                  <th class="text-right">Quantité</th>
                  <th class="text-right">Prix Unit.</th>
                  <th class="text-right">Total</th>
                </tr>
              </thead>
              <tbody>
                ${t.materialsUsed.map(r=>`
                  <tr>
                    <td>${r.materialName||""}</td>
                    <td class="text-right">${r.quantity.toFixed(2)} ${n(r)}</td>
                    <td class="text-right">${r.unitPrice.toFixed(2)} Fcfa/${n(r)}</td>
                    <td class="text-right">${(r.quantity*r.unitPrice).toFixed(2)} Fcfa</td>
                  </tr>
                `).join("")}
                <tr>
                  <td><strong>Total</strong></td>
                  <td class="text-right"><strong>${t.totals.materialsTotalWeight.toFixed(2)} kg</strong></td>
                  <td class="text-right"></td>
                  <td class="text-right"><strong>${t.totals.materialsTotalCost.toFixed(2)} Fcfa</strong></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="column">
            <h2>Produits Fabriqués</h2>
            <table>
              <thead>
                <tr>
                  <th>Produit</th>
                  <th class="text-right">Quantité</th>
                  <th class="text-right">Poids Unit.</th>
                  <th class="text-right">Prix Unit.</th>
                  <th class="text-right">Total</th>
                </tr>
              </thead>
              <tbody>
                ${t.productsProduced.map(r=>`
                  <tr>
                    <td>${r.productName||""}</td>
                    <td class="text-right">${r.quantity}</td>
                    <td class="text-right">${r.weightPerUnit.toFixed(2)} kg</td>
                    <td class="text-right">${r.unitPrice.toFixed(2)} Fcfa</td>
                    <td class="text-right">${(r.quantity*r.unitPrice).toFixed(2)} Fcfa</td>
                  </tr>
                `).join("")}
                <tr>
                  <td><strong>Total</strong></td>
                  <td class="text-right"><strong>${t.totals.productionTotalQuantity}</strong></td>
                  <td class="text-right"><strong>${t.totals.productionTotalWeight.toFixed(2)} kg</strong></td>
                  <td class="text-right"></td>
                  <td class="text-right"><strong>${t.totals.productionTotalAmount.toFixed(2)} Fcfa</strong></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="summary">
          <div class="summary-grid">
            <div class="summary-item">
              <span class="summary-label">Poids matières</span>
              <span class="summary-value">${t.totals.materialsTotalWeight.toFixed(2)} kg</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Poids production</span>
              <span class="summary-value">${t.totals.productionTotalWeight.toFixed(2)} kg</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Différence</span>
              <span class="summary-value ${t.totals.weightDifference>0?"green":t.totals.weightDifference<0?"red":""}">
                ${t.totals.weightDifference>0?"+":""}${t.totals.weightDifference.toFixed(2)} kg
              </span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Coût matières</span>
              <span class="summary-value">${t.totals.materialsTotalCost.toFixed(2)} Fcfa</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Valeur production</span>
              <span class="summary-value">${t.totals.productionTotalAmount.toFixed(2)} Fcfa</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Rentabilité</span>
              <span class="summary-value ${t.totals.profitabilityRate>30?"green":"red"}">
                ${t.totals.profitabilityRate.toFixed(2)}%
              </span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Rendement</span>
              <span class="summary-value">
                ${(t.totals.productionTotalWeight/t.totals.materialsTotalWeight*100).toFixed(2)}%
              </span>
            </div>
          </div>
        </div>
      </div>
    </body>
    </html>
  `},ID=async t=>{var e;try{const n=zZ(t),r=document.createElement("iframe");r.style.position="fixed",r.style.right="0",r.style.bottom="0",r.style.width="0",r.style.height="0",r.style.border="0",document.body.appendChild(r);const i=(e=r.contentWindow)==null?void 0:e.document;if(!i)throw new Error("Failed to access iframe document");return i.open(),i.write(n),i.close(),setTimeout(()=>{var s;try{(s=r.contentWindow)==null||s.print(),setTimeout(()=>{document.body.removeChild(r)},1e3)}catch(o){throw console.error("Print error:",o),document.body.removeChild(r),o}},500),!0}catch(n){throw console.error("Error in printProductionSheet:",n),n}},qZ=({onClose:t,onSheetAdded:e})=>{const{user:n,loading:r}=Li(),[i,s]=he.useState([]),[o,a]=he.useState([]),[l,c]=he.useState(!0),[d,f]=he.useState(!1),[h,p]=he.useState({dateProduction:new Date().toISOString().split("T")[0],responsable:n!=null&&n.firstName?`${n.firstName} ${n.lastName}`:"",materialsUsed:[],productsProduced:[],totals:{materialsTotalWeight:0,materialsTotalCost:0,productionTotalQuantity:0,productionTotalWeight:0,productionTotalAmount:0,profitabilityRate:0,weightDifference:0},agency:(n==null?void 0:n.agencyName)||"",createdBy:(n==null?void 0:n.id)||""}),[m,g]=he.useState({});he.useEffect(()=>{r||(async()=>{if(n!=null&&n.company)try{const k=mn(en(ot,"matieresPremiere"),pt("company","==",n.company),oi("nom","asc")),q=(await On(k)).docs.map(ne=>({id:ne.id,...ne.data()}));s(q);const O={};q.forEach(ne=>{O[ne.id]=ne.prixUnitaire}),g(O);const M=mn(en(ot,"products"),pt("company","==",n.company),pt("department","==","Boulangerie")),J=(await On(M)).docs.map(ne=>({id:ne.id,...ne.data()})).sort((ne,V)=>ne.name.localeCompare(V.name));a(J),c(!1)}catch(k){console.error("Error fetching data:",k),ke.error("Erreur lors du chargement des données"),c(!1)}})()},[n,r]);const b=()=>{p(P=>({...P,materialsUsed:[...P.materialsUsed,{materialId:"",quantity:0,unitPrice:0,unit:""}]}))},x=P=>{p(k=>{const F={...k,materialsUsed:k.materialsUsed.filter((q,O)=>O!==P)};return{...F,totals:C(F.materialsUsed,F.productsProduced)}})},w=(P,k,F)=>{p(q=>{const O=[...q.materialsUsed],M={...O[P]};if(k==="materialId"&&typeof F=="string"){if(q.materialsUsed.some((ne,V)=>V!==P&&ne.materialId===F))return ke.error("Cette matière est déjà présente dans la fiche"),q;const J=i.find(ne=>ne.id===F);M.materialId=F,M.materialName=(J==null?void 0:J.nom)||"",M.unitPrice=m[F]||0,M.unit=(J==null?void 0:J.uniteMessure)||""}else if(k==="quantity"){const z=typeof F=="string"?parseFloat(F):F;M.quantity=Math.max(0,Math.round(z*100)/100)}else M[k]=F;O[P]=M;const W={...q,materialsUsed:O};return{...W,totals:C(W.materialsUsed,W.productsProduced)}})},N=()=>{p(P=>({...P,productsProduced:[...P.productsProduced,{productId:"",productName:"",quantity:0,unitPrice:0,weightPerUnit:0}]}))},E=P=>{p(k=>{const F={...k,productsProduced:k.productsProduced.filter((q,O)=>O!==P)};return{...F,totals:C(F.materialsUsed,F.productsProduced)}})},D=(P,k,F)=>{p(q=>{const O=[...q.productsProduced],M={...O[P]};if(k==="productId"&&typeof F=="string"){const z=o.find(J=>J.id===F);z&&(M.productId=F,M.productName=z.name,M.unitPrice=z.price,M.weightPerUnit=z.freshWeight)}else if(k==="quantity"){const z=typeof F=="string"?parseInt(F):F;M.quantity=Math.max(0,z)}else M[k]=F;O[P]=M;const W={...q,productsProduced:O};return{...W,totals:C(W.materialsUsed,W.productsProduced)}})},j=(P,k)=>k==="g"?P/1e3:P,C=(P,k)=>{const F=P.reduce((ne,V)=>{const $=j(V.quantity,V.unit||"");return ne+Math.round($*100)/100},0),q=P.reduce((ne,V)=>ne+V.quantity*V.unitPrice,0),O=k.reduce((ne,V)=>ne+V.quantity,0),M=k.reduce((ne,V)=>ne+Math.round(V.quantity*V.weightPerUnit*100)/100,0),W=k.reduce((ne,V)=>ne+V.quantity*V.unitPrice,0),z=W>0?(W-q)/W*100:0,J=M-F;return{materialsTotalWeight:Math.round(F*100)/100,materialsTotalCost:q,productionTotalQuantity:O,productionTotalWeight:Math.round(M*100)/100,productionTotalAmount:W,profitabilityRate:Math.round(z*100)/100,weightDifference:Math.round(J*100)/100}},v=()=>h.materialsUsed.find(F=>F.quantity<=0||F.quantity>999.99)?(ke.error("Les quantités de matières premières doivent être comprises entre 0.01 et 999.99"),!1):h.productsProduced.find(F=>F.quantity<=0)?(ke.error("Les quantités de produits doivent être positives"),!1):!0,A=async P=>{if(P.preventDefault(),!v())return;const k=C(h.materialsUsed,h.productsProduced);p(F=>({...F,totals:k})),f(!0)},I=async()=>{if(n){c(!0);try{const P=C(h.materialsUsed,h.productsProduced),k=`FP-${Date.now()}`;for(const q of h.productsProduced){const O=ln(ot,"products",q.productId),M=await ps(O);if(M.exists()){const z=M.data().stockParAgence||{},J=z[n.agencyName]||0;z[n.agencyName]=J+q.quantity,await na(O,{stockParAgence:z,updatedAt:Bt.now()})}}const F={numero:k,dateProduction:Bt.fromDate(new Date(h.dateProduction)),responsable:h.responsable,materialsUsed:h.materialsUsed.map(q=>({...q,quantity:Math.round(q.quantity*100)/100})),productsProduced:h.productsProduced.map(q=>({...q,weightPerUnit:Math.round(q.weightPerUnit*100)/100})),poidsMatieres:P.materialsTotalWeight,coutMatieres:P.materialsTotalCost,quantiteTotale:P.productionTotalQuantity,poidsTotal:P.productionTotalWeight,montantTotal:P.productionTotalAmount,tauxRentabilite:P.profitabilityRate,differencePoidsTotal:P.weightDifference,entrepriseId:n.id,agency:h.agency,createdBy:h.createdBy,createdAt:Bt.now(),department:"Boulangerie"};await Ld(en(ot,"fichesProduction"),F),ID({...F,dateProduction:h.dateProduction,materialsUsed:h.materialsUsed,productsProduced:h.productsProduced,totals:P,company:n.company}),ke.success("Fiche de production créée avec succès"),e(),t()}catch(P){console.error("Erreur lors de la création:",P),ke.error("Erreur lors de la création de la fiche")}finally{c(!1)}}},S=P=>{const k=i.find(F=>F.id===P);return(k==null?void 0:k.uniteMessure)==="g"?"g":"kg"};return d?u.jsx(UZ,{data:h,onConfirm:I,onEdit:()=>f(!1),onClose:t}):u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-6 flex justify-between items-center sticky top-0 z-10",children:[u.jsx("div",{className:"flex items-center",children:u.jsx("h2",{className:"font-bold text-xl ml-2",children:"Nouvelle Fiche de Production - Boulangerie"})}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full transition-colors",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:A,className:"p-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Date de Production"}),u.jsx("input",{type:"date",value:h.dateProduction,onChange:P=>p({...h,dateProduction:P.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Responsable"}),u.jsx("input",{type:"text",value:h.responsable,onChange:P=>p({...h,responsable:P.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,placeholder:"Nom du responsable"})]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Matières Premières Utilisées"}),h.materialsUsed.map((P,k)=>u.jsxs("div",{className:"flex gap-4 mb-4",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsxs("select",{value:P.materialId,onChange:F=>w(k,"materialId",F.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"",children:"Sélectionner une matière"}),i.map(F=>u.jsxs("option",{value:F.id,children:[F.nom," (",F.uniteMessure,")"]},F.id))]}),P.materialName&&u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:P.materialName})]}),u.jsx("div",{className:"w-40",children:u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"number",value:P.quantity||"",onChange:F=>w(k,"quantity",F.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513] pr-12",placeholder:"Quantité",required:!0,min:"0.01",max:"999.99",step:"0.01"}),u.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:S(P.materialId)})]})}),u.jsx("div",{className:"w-40",children:u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"number",value:P.unitPrice||"",onChange:F=>w(k,"unitPrice",parseFloat(F.target.value)),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513] pr-16",placeholder:"Prix/unité",required:!0,min:"0",step:"0.01"}),u.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:["F/",S(P.materialId)]})]})}),u.jsx("button",{type:"button",onClick:()=>x(k),className:"p-3 text-red-500 hover:bg-red-50 rounded-lg",children:u.jsx(_p,{className:"h-5 w-5"})})]},k)),u.jsxs("button",{type:"button",onClick:b,className:"flex items-center text-[#8B4513] hover:bg-[#8B4513]/10 px-4 py-2 rounded-lg",children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Ajouter une matière"]})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Produits à Fabriquer"}),h.productsProduced.map((P,k)=>u.jsxs("div",{className:"flex gap-4 mb-4",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsxs("select",{value:P.productId,onChange:F=>D(k,"productId",F.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"",children:"Sélectionner un produit"}),o.map(F=>u.jsxs("option",{value:F.id,children:[F.name," - Réf: ",F.reference]},F.id))]}),P.productName&&u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:P.productName})]}),u.jsx("div",{className:"w-32",children:u.jsx("input",{type:"number",value:P.quantity||"",onChange:F=>D(k,"quantity",parseInt(F.target.value)),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",placeholder:"Quantité",required:!0,min:"1"})}),u.jsx("div",{className:"w-40",children:u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"number",value:P.weightPerUnit||"",className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 pr-12",placeholder:"Poids",disabled:!0}),u.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"kg"})]})}),u.jsx("div",{className:"w-40",children:u.jsx("input",{type:"number",value:P.unitPrice||"",className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50",placeholder:"Prix unitaire",disabled:!0})}),u.jsxs("div",{className:"w-32 p-3 text-right font-medium",children:[(P.quantity*P.unitPrice).toFixed(2)," Fcfa"]}),u.jsx("button",{type:"button",onClick:()=>E(k),className:"p-3 text-red-500 hover:bg-red-50 rounded-lg",children:u.jsx(_p,{className:"h-5 w-5"})})]},k)),u.jsxs("button",{type:"button",onClick:N,className:"flex items-center text-[#8B4513] hover:bg-[#8B4513]/10 px-4 py-2 rounded-lg",children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Ajouter un produit"]})]}),u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-8",children:[u.jsx("h4",{className:"font-bold mb-4",children:"Récapitulatif"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Poids total matières:"}),u.jsxs("p",{className:"font-bold",children:[h.totals.materialsTotalWeight.toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Coût total matières:"}),u.jsxs("p",{className:"font-bold",children:[h.totals.materialsTotalCost.toFixed(2)," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Quantité totale produite:"}),u.jsxs("p",{className:"font-bold",children:[h.totals.productionTotalQuantity," unités"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Poids total production:"}),u.jsxs("p",{className:"font-bold",children:[h.totals.productionTotalWeight.toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Montant total production:"}),u.jsxs("p",{className:"font-bold",children:[h.totals.productionTotalAmount.toFixed(2)," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Différence de poids:"}),u.jsxs("p",{className:`font-bold ${h.totals.weightDifference>0?"text-green-600":h.totals.weightDifference<0?"text-red-600":""}`,children:[h.totals.weightDifference>0?"+":"",h.totals.weightDifference.toFixed(2)," kg"]})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("p",{className:"text-gray-600",children:"Taux de rentabilité:"}),u.jsxs("p",{className:`font-bold ${h.totals.profitabilityRate>30?"text-green-600":"text-red-600"}`,children:[h.totals.profitabilityRate.toFixed(2),"%"]})]})]})]}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:l?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer"})]})]})]})})},HZ=({sheet:t,onClose:e,onUpdate:n})=>{const[r,i]=he.useState(t),[s,o]=he.useState(!1),[a,l]=he.useState(!1),[c,d]=he.useState(!1),f=async()=>{d(!0);try{const b={numero:r.numero,dateProduction:Kt(r.dateProduction,"yyyy-MM-dd"),responsable:r.responsable,agency:r.agency,createdBy:r.createdBy,materialsUsed:r.materialsUsed.map(x=>({materialName:x.materialName||"",quantity:x.quantity||0,unitPrice:x.unitPrice||0,unit:x.unit||"kg"})),productsProduced:r.productsProduced.map(x=>({productName:x.productName||"",quantity:x.quantity||0,unitPrice:x.unitPrice||0,weightPerUnit:x.weightPerUnit||0})),totals:{materialsTotalWeight:r.poidsMatieres||0,materialsTotalCost:r.coutMatieres||0,productionTotalQuantity:r.quantiteTotale||0,productionTotalWeight:r.poidsTotal||0,productionTotalAmount:r.montantTotal||0,profitabilityRate:r.tauxRentabilite||0,weightDifference:r.differencePoidsTotal||0},company:r.company||"EGREC BOULANGERIE"};await ID(b),ke.success("Document envoyé vers l'imprimante")}catch(b){console.error("Erreur lors de l'impression:",b),ke.error("Erreur lors de l'impression du document")}finally{d(!1)}},h=(b,x)=>{const w=[...r.materialsUsed];w[b]={...w[b],quantity:Math.max(0,x)};const N=w.reduce((C,v)=>{const A=v.unit==="g"?v.quantity/1e3:v.quantity;return C+A},0),E=w.reduce((C,v)=>C+v.quantity*v.unitPrice,0),D=r.montantTotal>0?(r.montantTotal-E)/r.montantTotal*100:0,j=r.poidsTotal-N;i(C=>({...C,materialsUsed:w,poidsMatieres:N,coutMatieres:E,tauxRentabilite:D,differencePoidsTotal:j}))},p=(b,x)=>{const w=[...r.productsProduced];w[b]={...w[b],quantity:Math.max(0,x)};const N=w.reduce((v,A)=>v+A.quantity,0),E=w.reduce((v,A)=>v+A.quantity*A.weightPerUnit,0),D=w.reduce((v,A)=>v+A.quantity*A.unitPrice,0),j=D>0?(D-r.coutMatieres)/D*100:0,C=E-r.poidsMatieres;i(v=>({...v,productsProduced:w,quantiteTotale:N,poidsTotal:E,montantTotal:D,tauxRentabilite:j,differencePoidsTotal:C}))},m=async()=>{o(!0);try{await cm(ot,async b=>{const w=(await Promise.all(r.productsProduced.map(async D=>{const j=ln(ot,"products",D.productId),C=await b.get(j);return{ref:j,doc:C,product:D}}))).map(({ref:D,doc:j,product:C})=>{if(j.exists()){const A=j.data().stockParAgence||{},I=t.productsProduced.find(P=>P.productId===C.productId),S=C.quantity-((I==null?void 0:I.quantity)||0);return A[r.agency]=(A[r.agency]||0)+S,{ref:D,data:{stockParAgence:A}}}return null}).filter(Boolean),N=ln(ot,"fichesProduction",r.id),E={materialsUsed:r.materialsUsed,productsProduced:r.productsProduced,poidsMatieres:r.poidsMatieres||0,coutMatieres:r.coutMatieres||0,quantiteTotale:r.quantiteTotale||0,poidsTotal:r.poidsTotal||0,montantTotal:r.montantTotal||0,tauxRentabilite:r.tauxRentabilite||0,differencePoidsTotal:r.differencePoidsTotal||0};b.update(N,E),w.forEach(D=>{D&&b.update(D.ref,D.data)})}),ke.success("Fiche de production mise à jour avec succès"),n==null||n(),l(!1)}catch(b){console.error("Error updating production sheet:",b),ke.error("Erreur lors de la mise à jour")}finally{o(!1)}},g=b=>b.unit==="g"?"g":"kg";return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center sticky top-0",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Détails de la Fiche de Production"}),u.jsx("button",{onClick:e,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"N° Fiche"}),u.jsx("p",{children:r.numero})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Date de Production"}),u.jsx("p",{children:Kt(r.dateProduction,"dd MMMM yyyy",{locale:zn})})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Responsable"}),u.jsx("p",{children:r.responsable})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Agence"}),u.jsx("p",{children:r.agency})]})]})}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Matières Premières Utilisées"}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-gray-600",children:[u.jsx("th",{className:"py-2",children:"Matière"}),u.jsx("th",{className:"py-2 text-right",children:"Quantité"}),u.jsx("th",{className:"py-2 text-right",children:"Prix Unitaire"}),u.jsx("th",{className:"py-2 text-right",children:"Montant Total"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:r.materialsUsed.map((b,x)=>u.jsxs("tr",{children:[u.jsx("td",{className:"py-2",children:b.materialName}),u.jsx("td",{className:"py-2 text-right",children:a?u.jsx("input",{type:"number",value:b.quantity,onChange:w=>h(x,parseFloat(w.target.value)),className:"w-24 text-right p-1 border rounded",min:"0",step:"0.01"}):`${b.quantity} ${g(b)}`}),u.jsxs("td",{className:"py-2 text-right",children:[b.unitPrice," Fcfa/",g(b)]}),u.jsxs("td",{className:"py-2 text-right",children:[(b.quantity*b.unitPrice).toFixed(2)," Fcfa"]})]},x))})]})})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"font-bold text-lg mb-4 text-[#8B4513]",children:"Produits Fabriqués"}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-gray-600",children:[u.jsx("th",{className:"py-2",children:"Produit"}),u.jsx("th",{className:"py-2 text-right",children:"Quantité"}),u.jsx("th",{className:"py-2 text-right",children:"Poids Unitaire"}),u.jsx("th",{className:"py-2 text-right",children:"Prix Unitaire"}),u.jsx("th",{className:"py-2 text-right",children:"Montant Total"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:r.productsProduced.map((b,x)=>u.jsxs("tr",{children:[u.jsx("td",{className:"py-2",children:b.productName}),u.jsx("td",{className:"py-2 text-right",children:a?u.jsx("input",{type:"number",value:b.quantity,onChange:w=>p(x,parseInt(w.target.value)),className:"w-24 text-right p-1 border rounded",min:"0"}):b.quantity}),u.jsxs("td",{className:"py-2 text-right",children:[b.weightPerUnit," kg"]}),u.jsxs("td",{className:"py-2 text-right",children:[b.unitPrice," Fcfa"]}),u.jsxs("td",{className:"py-2 text-right",children:[(b.quantity*b.unitPrice).toFixed(2)," Fcfa"]})]},x))})]})})]}),u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-8",children:[u.jsx("h4",{className:"font-bold mb-4",children:"Synthèse"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Poids total matières:"}),u.jsxs("p",{className:"font-bold",children:[(r.poidsMatieres||0).toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Poids total production:"}),u.jsxs("p",{className:"font-bold",children:[(r.poidsTotal||0).toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Différence de poids:"}),u.jsxs("p",{className:`font-bold ${(r.differencePoidsTotal||0)>0?"text-green-600":(r.differencePoidsTotal||0)<0?"text-red-600":""}`,children:[(r.differencePoidsTotal||0)>0?"+":"",(r.differencePoidsTotal||0).toFixed(2)," kg"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Coût total matières:"}),u.jsxs("p",{className:"font-bold",children:[(r.coutMatieres||0).toFixed(2)," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Montant total production:"}),u.jsxs("p",{className:"font-bold",children:[(r.montantTotal||0).toFixed(2)," Fcfa"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Taux de rentabilité:"}),u.jsxs("p",{className:`font-bold ${(r.tauxRentabilite||0)>30?"text-green-600":"text-red-600"}`,children:[(r.tauxRentabilite||0).toFixed(2),"%"]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Rendement:"}),u.jsxs("p",{className:"font-bold",children:[((r.poidsTotal||0)/(r.poidsMatieres||1)*100).toFixed(2),"%"]})]})]})]}),u.jsxs("div",{className:"flex justify-end space-x-4",children:[a?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>i(t),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",disabled:s,children:"Annuler"}),u.jsx("button",{onClick:m,disabled:s,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] flex items-center disabled:bg-gray-300",children:s?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):u.jsxs(u.Fragment,{children:[u.jsx(hm,{className:"h-5 w-5 mr-2"}),"Enregistrer"]})})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>l(!0),className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300]",children:"Modifier"}),u.jsx("button",{onClick:f,disabled:c,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] flex items-center",children:c?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Impression..."]}):u.jsxs(u.Fragment,{children:[u.jsx(bf,{className:"h-5 w-5 mr-2"}),"Imprimer"]})})]}),u.jsx("button",{onClick:e,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Fermer"})]})]})]})})},WZ=()=>{const[t,e]=he.useState([]),[n,r]=he.useState(!0),[i,s]=he.useState(!1),[o,a]=he.useState(!1),[l,c]=he.useState(null),[d,f]=he.useState(""),h=async()=>{if(fn.currentUser)try{const g=mn(en(ot,"fichesProduction"),pt("entrepriseId","==",fn.currentUser.uid),oi("dateProduction","desc")),x=(await On(g)).docs.map(w=>({id:w.id,...w.data(),dateProduction:w.data().dateProduction.toDate()}));e(x)}catch(g){console.error("Erreur lors du chargement des fiches:",g)}finally{r(!1)}};he.useEffect(()=>{h()},[]);const p=g=>{c(g),a(!0)},m=t.filter(g=>g.numero.toLowerCase().includes(d.toLowerCase())||g.responsable.toLowerCase().includes(d.toLowerCase()));return n?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513]"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Fiches de Production"}),u.jsxs("button",{className:"bg-[#8B4513] text-white px-4 py-2 rounded-lg flex items-center hover:bg-[#663300]",onClick:()=>s(!0),children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Nouvelle Fiche"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"mb-6 relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Wl,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Rechercher une fiche de production...",className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:d,onChange:g=>f(g.target.value)})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"N° Fiche"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Responsable"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Quantité"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Poids Total"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Montant Total"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Rentabilité"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-200",children:[m.map(g=>u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>p(g),children:[u.jsx("td",{className:"px-6 py-4 font-medium",children:g.numero}),u.jsx("td",{className:"px-6 py-4",children:Kt(g.dateProduction,"dd/MM/yyyy",{locale:zn})}),u.jsx("td",{className:"px-6 py-4",children:g.responsable}),u.jsx("td",{className:"px-6 py-4",children:g.quantiteTotale}),u.jsxs("td",{className:"px-6 py-4",children:[g.poidsTotal.toFixed(2)," kg"]}),u.jsxs("td",{className:"px-6 py-4",children:[g.montantTotal.toFixed(2)," Fcfa"]}),u.jsx("td",{className:"px-6 py-4",children:u.jsxs("span",{className:`font-medium ${(g.tauxRentabilite||0)>30?"text-green-600":"text-red-600"}`,children:[(g.tauxRentabilite||0).toFixed(2),"%"]})})]},g.id)),m.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"Aucune fiche de production trouvée"})})]})]})})]}),i&&u.jsx(qZ,{onClose:()=>s(!1),onSheetAdded:h}),o&&l&&u.jsx(HZ,{sheet:l,onClose:()=>{a(!1),c(null)},onUpdate:h})]})};let nu;const Ey=async()=>{nu=await s4("egrec-waste",2,{upgrade(t,e){e>0&&t.deleteObjectStore("waste-records");const n=t.createObjectStore("waste-records",{keyPath:"id",autoIncrement:!0});n.createIndex("by-sync-status","synced"),n.createIndex("by-company","company"),n.createIndex("by-agency","agencyName")}})},$Z=async t=>{nu||await Ey();try{const e={...t,synced:0};return await nu.add("waste-records",e),navigator.onLine&&await jD(),!0}catch(e){throw console.error("Error saving waste record:",e),e}},Q6=async(t,e)=>{nu||await Ey();try{return(await nu.transaction("waste-records","readonly").objectStore("waste-records").getAll()).filter(s=>s.company===t&&s.agencyName===e).map(s=>({...s,synced:s.synced===1}))}catch(n){return console.error("Error getting waste records:",n),[]}},jD=async()=>{nu||await Ey();try{const t=nu.transaction("waste-records","readonly"),r=await t.objectStore("waste-records").index("by-sync-status").getAll(0);await t.done;for(const i of r)try{const s=await Ld(en(ot,"avaries"),{...i,timestamp:Bt.fromDate(i.timestamp),synced:1}),o=nu.transaction("waste-records","readwrite");await o.objectStore("waste-records").put({...i,id:i.id,synced:1}),await o.done}catch(s){console.error("Error syncing waste record:",s)}return!0}catch(t){return console.error("Error during waste records sync:",t),ke.error("Erreur lors de la synchronisation des avaries"),!1}},GZ=()=>{window.addEventListener("online",()=>{jD()})},KZ=({onClose:t,onSubmit:e})=>{const{user:n}=Li(),[r,i]=he.useState([]),[s,o]=he.useState(!0),[a,l]=he.useState(!1),[c,d]=he.useState(!navigator.onLine),[f,h]=he.useState({productId:"",quantity:"",reason:"mauvaise production"});he.useEffect(()=>{const m=()=>d(!1),g=()=>d(!0);return window.addEventListener("online",m),window.addEventListener("offline",g),()=>{window.removeEventListener("online",m),window.removeEventListener("offline",g)}},[]),he.useEffect(()=>{(async()=>{if(n!=null&&n.company){o(!0);try{let g=[];if(navigator.onLine)try{g=await y5(n.company)}catch(b){if(console.error("Error fetching products:",b),g=await Ep(n.company),g.length===0)throw new Error("Aucun produit disponible en ligne ou en cache")}else if(g=await Ep(n.company),g.length===0)throw new Error("Connexion Internet requise pour le premier chargement des produits");i(g)}catch(g){console.error("Error loading products:",g),ke.error(g instanceof Error?g.message:"Erreur lors du chargement des produits")}finally{o(!1)}}})()},[n==null?void 0:n.company]);const p=async m=>{if(m.preventDefault(),!n)return;const g=parseInt(f.quantity);if(isNaN(g)||g<=0){ke.error("La quantité doit être un nombre positif");return}const b=r.find(x=>x.id===f.productId);if(!b){ke.error("Produit non trouvé");return}if(g>b.stock){ke.error("Quantité supérieure au stock disponible");return}l(!0);try{await e({productId:f.productId,productName:b.name,quantity:g,reason:f.reason,timestamp:new Date,userId:n.id,userName:`${n.firstName} ${n.lastName}`,company:n.company,agencyName:n.agencyName})}catch(x){console.error("Error submitting waste:",x),ke.error("Erreur lors de l'enregistrement")}finally{l(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"bg-[#8B4513] text-white p-4 flex justify-between items-center",children:[u.jsx("h2",{className:"font-bold text-xl",children:"Nouvelle Avarie"}),u.jsx("button",{onClick:t,className:"text-white hover:bg-[#663300] p-2 rounded-full",children:u.jsx(Cr,{className:"h-6 w-6"})})]}),c&&u.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 flex items-center",children:[u.jsx(Z1,{className:"h-5 w-5 text-yellow-700 mr-2"}),u.jsx("p",{className:"text-yellow-700 text-sm",children:"Mode hors-ligne actif. Les données seront synchronisées lors du retour de la connexion."})]}),u.jsxs("form",{onSubmit:p,className:"p-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Produit"}),s?u.jsx("div",{className:"flex items-center justify-center p-4",children:u.jsx(Un,{className:"h-6 w-6 animate-spin text-[#8B4513]"})}):r.length===0?u.jsx("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg text-sm",children:"Aucun produit disponible. Une connexion Internet est requise pour le premier chargement."}):u.jsxs("select",{value:f.productId,onChange:m=>h({...f,productId:m.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"",children:"Sélectionner un produit"}),r.map(m=>u.jsxs("option",{value:m.id,children:[m.name," (Stock: ",m.stock,")"]},m.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Quantité"}),u.jsx("input",{type:"number",value:f.quantity,onChange:m=>h({...f,quantity:m.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,min:"1",placeholder:"Quantité perdue"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Motif"}),u.jsxs("select",{value:f.reason,onChange:m=>h({...f,reason:m.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",required:!0,children:[u.jsx("option",{value:"mauvaise production",children:"Mauvaise production"}),u.jsx("option",{value:"produit bientôt périmé",children:"Produit bientôt périmé"})]})]})]}),u.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100",children:"Annuler"}),u.jsx("button",{type:"submit",disabled:a||s||r.length===0,className:"px-6 py-3 bg-[#8B4513] text-white rounded-lg font-medium hover:bg-[#663300] disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:a?u.jsxs(u.Fragment,{children:[u.jsx(Un,{className:"animate-spin h-5 w-5 mr-2"}),"Enregistrement..."]}):"Enregistrer"})]})]})]})})},QZ=()=>{const{user:t}=Li(),[e,n]=he.useState([]),[r,i]=he.useState(!0),[s,o]=he.useState(!1),[a,l]=he.useState(""),[c,d]=he.useState(!navigator.onLine);he.useEffect(()=>{(async()=>{await Ey(),GZ()})()},[]),he.useEffect(()=>{const p=()=>{d(!1),ke.success("Connexion rétablie")},m=()=>{d(!0),ke("Mode hors-ligne activé",{icon:"🔌",duration:3e3})};return window.addEventListener("online",p),window.addEventListener("offline",m),()=>{window.removeEventListener("online",p),window.removeEventListener("offline",m)}},[]),he.useEffect(()=>{(async()=>{if(!(!(t!=null&&t.company)||!(t!=null&&t.agencyName))){i(!0);try{let m=[];if(navigator.onLine){const x=mn(en(ot,"avaries"),pt("company","==",t.company),pt("agencyName","==",t.agencyName));m=(await On(x)).docs.map(N=>({id:N.id,...N.data(),timestamp:N.data().timestamp.toDate()}))}const b=[...(await Q6(t.company,t.agencyName)).filter(x=>!x.synced),...m].sort((x,w)=>w.timestamp.getTime()-x.timestamp.getTime());n(b)}catch(m){console.error("Error fetching waste records:",m),ke.error("Erreur lors du chargement des avaries")}finally{i(!1)}}})()},[t]);const f=async p=>{try{if(await $Z(p),navigator.onLine){const m=ln(ot,"products",p.productId);await na(m,{stock:jc(-p.quantity)})}if(ke.success("Avarie enregistrée avec succès"),o(!1),t!=null&&t.company&&(t!=null&&t.agencyName)){const m=await Q6(t.company,t.agencyName);n(m)}}catch(m){console.error("Error saving waste record:",m),ke.error("Erreur lors de l'enregistrement")}},h=e.filter(p=>p.productName.toLowerCase().includes(a.toLowerCase()));return!(t!=null&&t.company)||!(t!=null&&t.agencyName)?u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-4 rounded-lg",children:"Informations entreprise ou agence manquantes"})}):u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-[#8B4513]",children:"Gestion des Avaries"}),u.jsxs("button",{className:"bg-[#8B4513] text-white px-4 py-2 rounded-lg flex items-center hover:bg-[#663300]",onClick:()=>o(!0),children:[u.jsx(Po,{className:"h-5 w-5 mr-2"}),"Nouvelle Avarie"]})]}),c&&u.jsx("div",{className:"mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4",children:u.jsx("p",{className:"text-yellow-700",children:"Mode hors-ligne actif. Les avaries seront synchronisées automatiquement lors du retour de la connexion."})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"mb-6 relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Wl,{className:"h-5 w-5 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Rechercher une avarie...",className:"w-full pl-10 p-3 border border-gray-300 rounded-lg focus:ring-[#8B4513] focus:border-[#8B4513]",value:a,onChange:p=>l(p.target.value)})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left bg-gray-50",children:[u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Produit"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Quantité"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Motif"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Utilisateur"}),u.jsx("th",{className:"px-6 py-3 text-gray-500 font-medium",children:"Statut"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:r?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-8 text-center",children:u.jsx(Un,{className:"h-8 w-8 animate-spin text-[#8B4513] mx-auto"})})}):h.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"Aucune avarie enregistrée"})}):h.map(p=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4",children:Kt(p.timestamp,"dd/MM/yyyy HH:mm",{locale:zn})}),u.jsx("td",{className:"px-6 py-4",children:p.productName}),u.jsx("td",{className:"px-6 py-4",children:p.quantity}),u.jsx("td",{className:"px-6 py-4",children:p.reason}),u.jsx("td",{className:"px-6 py-4",children:p.userName}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.synced?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:p.synced?"Synchronisé":"En attente"})})]},p.id))})]})})]}),s&&u.jsx(KZ,{onClose:()=>o(!1),onSubmit:f})]})},YZ=()=>{const[t,e]=he.useState("materials"),n=()=>{switch(t){case"materials":return u.jsx(K6,{});case"sheets":return u.jsx(WZ,{});case"waste":return u.jsx(QZ,{});case"recipes":return u.jsx("div",{className:"p-6",children:u.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Recettes"})});case"settings":return u.jsx("div",{className:"p-6",children:u.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Paramètres de Production"})});default:return u.jsx(K6,{})}};return u.jsxs("div",{className:"flex h-full",children:[u.jsxs("div",{className:"w-64 bg-[#8B4513] text-white",children:[u.jsx("div",{className:"p-4 border-b border-[#663300]",children:u.jsx("h2",{className:"font-bold text-xl",children:"Production"})}),u.jsx("nav",{className:"p-4",children:u.jsxs("ul",{className:"space-y-2",children:[u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="materials"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("materials"),children:[u.jsx(BI,{className:"h-5 w-5"}),u.jsx("span",{children:"Matières Premières"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="sheets"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("sheets"),children:[u.jsx(RI,{className:"h-5 w-5"}),u.jsx("span",{children:"Fiches de Production"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="waste"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("waste"),children:[u.jsx(II,{className:"h-5 w-5"}),u.jsx("span",{children:"Avaries"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="recipes"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("recipes"),children:[u.jsx(wp,{className:"h-5 w-5"}),u.jsx("span",{children:"Recettes"})]})}),u.jsx("li",{children:u.jsxs("button",{className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${t==="settings"?"bg-white text-[#8B4513]":"text-white hover:bg-[#663300]"}`,onClick:()=>e("settings"),children:[u.jsx(OI,{className:"h-5 w-5"}),u.jsx("span",{children:"Paramètres"})]})})]})})]}),u.jsx("div",{className:"flex-grow bg-gray-100 overflow-auto",children:n()})]})};let kg=!1,Y6=0;const XZ=3,JZ=5e3,X6=50,q5=async()=>{if(!kg)try{kg=!0;const t=await IW();if(!t.length){kg=!1;return}let e=0,n=0;const r=t.length,i=ke.loading(`Synchronisation de ${r} élément${r>1?"s":""}...`);for(let s=0;s<t.length;s+=X6){const o=t.slice(s,s+X6);for(const a of o)try{const l=mn(en(ot,"ventes"),pt("syncId","==",a.syncId));if(!(await On(l)).empty){await ZS(a.id,a.syncId),e++;continue}await oI(ln(ot,"ventes",a.syncId),{...a,timestamp:Bt.fromMillis(a.timestamp),syncedAt:Bt.now(),syncAttempts:(a.syncAttempts||0)+1,synced:!0,stockUpdated:!1}),await ZS(a.id,a.syncId),e++,ke.loading(`Synchronisation en cours... (${e}/${r})`,{id:i})}catch(l){console.error("Error syncing sale:",l),n++,await jW(a.id)}}e>0&&(ke.success(`${e} élément${e>1?"s":""} synchronisé${e>1?"s":""} avec succès`,{id:i}),await RW(),await _G()),n>0&&(ke.error(`Échec de la synchronisation pour ${n} élément${n>1?"s":""}`,{duration:5e3}),Y6<XZ&&(Y6++,setTimeout(()=>{q5()},JZ)))}catch(t){console.error("Sync error:",t),ke.error("Erreur lors de la synchronisation",{duration:5e3})}finally{kg=!1}},ZZ=()=>{let t=!navigator.onLine;window.addEventListener("online",()=>{t&&(ke.success("Connexion internet rétablie"),q5()),t=!1}),window.addEventListener("offline",()=>{t=!0,ke.error("Mode hors-ligne activé",{duration:3e3})}),navigator.onLine&&q5()};function eee(){const[t,e]=he.useState("pos"),[n,r]=he.useState(fn.currentUser),[i,s]=he.useState(!0);return he.useEffect(()=>{Od().catch(console.error),ZZ();const o=XP(fn,a=>{r(a),s(!1)});return()=>o()},[]),i?u.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:u.jsx("div",{className:"text-[#8B4513] text-xl",children:"Chargement..."})}):n?u.jsx(Jq,{children:u.jsx(mq,{children:u.jsxs("div",{className:"flex flex-col h-screen bg-gray-100",children:[u.jsx(MH,{onViewChange:e,currentView:t}),u.jsx("main",{className:"flex-grow p-6 overflow-auto",children:u.jsxs("div",{className:"container mx-auto h-full",children:[t==="pos"&&u.jsx(SG,{}),t==="admin"&&u.jsx(MZ,{}),t==="production"&&u.jsx(YZ,{})]})})]})})}):u.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:u.jsxs("div",{className:"w-full max-w-md p-6",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-[#8B4513] mb-2",children:"EGREC GESTIONNAIRE"}),u.jsx("p",{className:"text-gray-600",children:"Connectez-vous pour accéder à l'application"})]}),u.jsx(zI,{onClose:()=>{}})]})})}dP(document.getElementById("root")).render(u.jsx(he.StrictMode,{children:u.jsx(eee,{})}));export{Vn as _,dn as c,H5 as g};
